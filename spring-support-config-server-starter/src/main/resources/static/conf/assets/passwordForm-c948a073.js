import{_ as A,E as k,D as g,r as p,o as b,g as x,w as f,b as i,d as v,e as C,t as _,l as S}from"./index-85936978.js";import"./index-12d1b444.js";import"./about-ecccad1a.js";import"./echarts-4c9039c4.js";import"./index-21a4a76f.js";import"./progress-69718525.js";import"./space-2ee84d94.js";import"./time-c46f9ba6.js";import"./ver-3b6b7c45.js";import"./welcome-694c723f.js";import"./Utils-d73ed2bc.js";const O=[{path:"/home",component:"home/index",name:"首页",hidden:!1,meta:{title:"首页",icon:"el-icon-eleme-filled",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null},children:[{path:"/dashboard",component:"home",name:"控制台",hidden:!1,meta:{title:"控制台",icon:"el-icon-menu",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}}]},{path:"/config",component:"config/index",name:"配置中心",hidden:!1,meta:{title:"配置中心",icon:"sc-icon-mapping-v2",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null},children:[{path:"/config/bean",component:"config/bean/index",name:"统一脚本",hidden:!1,meta:{title:"统一脚本",icon:"sc-icon-script",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/log",component:"config/log/index",name:"统一日志",hidden:!1,meta:{title:"统一日志",icon:"el-icon-warning",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/trace",component:"config/trace/index",name:"统一链路",hidden:!1,meta:{title:"统一链路",icon:"sc-icon-trace",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/actuator",component:"config/actuator/index",name:"监控管理",hidden:!1,meta:{title:"监控管理",icon:"sc-icon-sc",hidden:null,tag:"NEW",affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/actuator/oshi/:id",component:"config/actuator/oshi.vue",name:"OSHI",hidden:!0,meta:{title:"OSHI",icon:"",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/config",component:"config/config/index",name:"统一配置",hidden:!1,meta:{title:"统一配置",icon:"el-icon-grid",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}}]}],h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";class V{encode(e){if(!e)return"";var l="",r,o,n,t,c,u,d,s=0;for(e=this._utf8_encode(e);s<e.length;)r=e.charCodeAt(s++),o=e.charCodeAt(s++),n=e.charCodeAt(s++),t=r>>2,c=(r&3)<<4|o>>4,u=(o&15)<<2|n>>6,d=n&63,isNaN(o)?u=d=64:isNaN(n)&&(d=64),l=l+h.charAt(t)+h.charAt(c)+h.charAt(u)+h.charAt(d);return l}decode(e){if(!e)return"";var l="",r,o,n,t,c,u,d,s=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)t=h.indexOf(e.charAt(s++)),c=h.indexOf(e.charAt(s++)),u=h.indexOf(e.charAt(s++)),d=h.indexOf(e.charAt(s++)),r=t<<2|c>>4,o=(c&15)<<4|u>>2,n=(u&3)<<6|d,l=l+String.fromCharCode(r),u!=64&&(l=l+String.fromCharCode(o)),d!=64&&(l=l+String.fromCharCode(n));return l=this._utf8_decode(l),l}_utf8_encode(e){e=e.replace(/\r\n/g,`
`);for(var l="",r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?l+=String.fromCharCode(o):o>127&&o<2048?(l+=String.fromCharCode(o>>6|192),l+=String.fromCharCode(o&63|128)):(l+=String.fromCharCode(o>>12|224),l+=String.fromCharCode(o>>6&63|128),l+=String.fromCharCode(o&63|128))}return l}_utf8_decode(e){var l="",r=0;let o=0,n=0,t=0;for(;r<e.length;)o=e.charCodeAt(r),o<128?(l+=String.fromCharCode(o),r++):o>191&&o<224?(t=e.charCodeAt(r+1),l+=String.fromCharCode((o&31)<<6|t&63),r+=2):(t=e.charCodeAt(r+1),n=e.charCodeAt(r+2),l+=String.fromCharCode((o&15)<<12|(t&63)<<6|n&63),r+=3);return l}}const N=new V;const B={data(){return{userType:"admin",form:{user:"",password:"",autologin:!1,verifyCode:void 0},rules:{user:[{required:!0,message:this.$t("login.userError"),trigger:"blur"}],password:[{required:!0,message:this.$t("login.PWError"),trigger:"blur"}]},captchaBase64Key:void 0,captchaBase64:void 0,islogin:!1}},watch:{userType(a){a=="admin"?(this.form.user="",this.form.password=""):a=="user"&&(this.form.user="",this.form.password="")}},mounted(){this.getCaptcha()},methods:{getCaptcha(){this.$API.auth.captcha.get().then(({data:a})=>{const{verifyCodeBase64:e,verifyCodeKey:l}=a;this.captchaBase64=e,this.captchaBase64Key=l})},async login(){if(N.decode(this.captchaBase64Key)!=this.form.verifyCode)return k({type:"error",message:"校验码不正确"}),this.getCaptcha(),!1;var a=await this.$refs.loginForm.validate().catch(()=>{});if(!a)return!1;this.islogin=!0;var e={username:this.form.user,password:this.$TOOL.crypto.MD5(this.form.password),verifyCode:this.form.verifyCode};try{var l=await this.$API.auth.token.post(e)}catch(r){this.getCaptcha(),console.log(r),this.islogin=!1;return}if(this.getCaptcha(),l.code==="00000")this.$TOOL.cookie.set(g.TOKEN,l.data.accessToken,{expires:this.form.autologin?24*60*60:0}),this.$TOOL.data.set(g.USER_INFO,l.data.userInfo);else return this.islogin=!1,this.$message.warning(l.msg),!1;this.$TOOL.data.set(g.MENU,O),this.$TOOL.data.set(g.PERMISSIONS,[]),this.$router.replace({path:"/"}),this.$message.success("Login Success 登录成功"),this.islogin=!1}}},I={span:6,class:"captcha"},T=["src"],E={class:"login-reg"};function $(a,e,l,r,o,n){const t=p("el-input"),c=p("el-form-item"),u=p("el-checkbox"),d=p("el-col"),s=p("router-link"),y=p("el-button"),w=p("el-form");return b(),x(w,{ref:"loginForm",model:o.form,rules:o.rules,"label-width":"0",size:"large",onKeyup:S(n.login,["enter"])},{default:f(()=>[i(c,{prop:"user"},{default:f(()=>[i(t,{modelValue:o.form.user,"onUpdate:modelValue":e[0]||(e[0]=m=>o.form.user=m),"prefix-icon":"el-icon-user",clearable:"",placeholder:a.$t("login.userPlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),i(c,{prop:"password"},{default:f(()=>[i(t,{modelValue:o.form.password,"onUpdate:modelValue":e[1]||(e[1]=m=>o.form.password=m),"prefix-icon":"el-icon-lock",clearable:"","show-password":"",placeholder:a.$t("login.PWPlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),i(c,{prop:"verifyCode"},{default:f(()=>[i(t,{span:6,modelValue:o.form.verifyCode,"onUpdate:modelValue":e[2]||(e[2]=m=>o.form.verifyCode=m),class:"verifyCode",clearable:"",placeholder:a.$t("login.verifyCode")},null,8,["modelValue","placeholder"]),v("div",I,[v("img",{src:o.captchaBase64,onClick:e[3]||(e[3]=(...m)=>n.getCaptcha&&n.getCaptcha(...m))},null,8,T)])]),_:1}),i(c,{style:{"margin-bottom":"10px"}},{default:f(()=>[i(d,{span:12},{default:f(()=>[i(u,{label:a.$t("login.rememberMe"),modelValue:o.form.autologin,"onUpdate:modelValue":e[4]||(e[4]=m=>o.form.autologin=m)},null,8,["label","modelValue"])]),_:1}),i(d,{span:12,class:"login-forgot"},{default:f(()=>[i(s,{to:"/reset_password"},{default:f(()=>[C(_(a.$t("login.forgetPassword"))+"？",1)]),_:1})]),_:1})]),_:1}),i(c,null,{default:f(()=>[i(y,{type:"primary",style:{width:"100%"},loading:o.islogin,round:"",onClick:n.login},{default:f(()=>[C(_(a.$t("login.signIn")),1)]),_:1},8,["loading","onClick"])]),_:1}),v("div",E,[C(_(a.$t("login.noAccount"))+" ",1),i(s,{to:"/user_register"},{default:f(()=>[C(_(a.$t("login.createAccount")),1)]),_:1})])]),_:1},8,["model","rules","onKeyup"])}const R=A(B,[["render",$],["__scopeId","data-v-b1b4f708"],["__file","Z:/works/vue-support-parent-starter/vue-support-config-starter/src/views/login/components/passwordForm.vue"]]);export{R as default};
