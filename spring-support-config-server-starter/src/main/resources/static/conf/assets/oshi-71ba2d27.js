import{s as D}from"./index-21a4a76f.js";import{_ as G,r as a,o as h,g,w as t,b as l,d as f,e as s,t as _,c as x,f as T,F as b}from"./index-85936978.js";const I={name:"oshi",components:{scEcharts:D},mounted(){this.id=this.$route.params.id,this.doRefresh(),setTimeout(()=>{this.doRefreshValue()},0)},beforeUnmount(){clearInterval(window.oshiTimer),window.oshiTimer=null},watch:{refreshTime:{deep:!0,immediate:!0,handler(){clearInterval(window.oshiTimer),window.oshiTimer=null,this.doRefresh()}}},data(){return{refreshTime:1e4,jvm:{},sys:{},pid:null,id:null,apiCommand:this.$API.config.actuator.command,memOption:{animation:!1,animationDuration:0,animationEasing:"cubicInOut",title:{text:"内存"},series:[{itemStyle:{normal:{label:{show:!0}}},name:"Nightingale Chart",type:"pie",roseType:"area",itemStyle:{borderRadius:8},data:[{value:0,name:"剩余内存(0G)"},{value:0,name:"可用内存(0G)"}]}]},cpuOption:{animationDuration:5e3,title:{text:"CPU"},xAxis:{type:"category",data:[],show:!0},yAxis:{type:"value",boundaryGap:[0,"100%"],splitLine:{show:!1},max:100,min:0},series:[{itemStyle:{normal:{label:{show:!0}}},name:"Fake Data",type:"line",showSymbol:!0,smooth:!0,data:[]}]}}},methods:{doRefresh(){window.oshiTimer==null&&(window.oshiTimer=window.setInterval(()=>{setTimeout(()=>{this.doRefreshValue()},0)},this.refreshTime))},doRefreshValue(){this.apiCommand.get({dataId:this.id,command:"oshi",method:"GET",isOtherServer:!0}).then(e=>{var u,n,m;e.code==="00000"&&(this.jvm=(u=e==null?void 0:e.data)==null?void 0:u.jvm,this.sys=(n=e==null?void 0:e.data)==null?void 0:n.sys,this.pid=(m=e==null?void 0:e.data)==null?void 0:m.pid,setTimeout(()=>{var o,c;this.doAnalysisCpu((o=e==null?void 0:e.data)==null?void 0:o.cpu,((c=e==null?void 0:e.data)==null?void 0:c.time)||new Date/1e3)},0),setTimeout(()=>{var o,c;this.doAnalysisMem((o=e==null?void 0:e.data)==null?void 0:o.mem,((c=e==null?void 0:e.data)==null?void 0:c.time)||new Date/1e3)},0))})},doAnalysisCpu(e,u){var o;e==null&&(e={}),this.cpuOption.title.text=(o=e==null?void 0:e.cpuModel)==null?void 0:o.split(`
`)[0];let n=this.cpuOption.series[0].data;n.push((e==null?void 0:e.sys)||0);let m=this.cpuOption.xAxis.data;m.push(this.$TOOL.date.dateFormat(u*1e3,"hh:mm:ss")),n.length>100&&(n.split(0,1),m.split(0,1))},doAnalysisMem(e,u){e==null&&(e={});let n=this.memOption.series[0].data;this.memOption.title.text="内存("+(e==null?void 0:e.total)+"G)",n[0].value=(e==null?void 0:e.free)||0,n[0].name="剩余内存("+((e==null?void 0:e.free)||0)+"G)",n[1].value=(e==null?void 0:e.used)||0,n[1].name="可用内存("+((e==null?void 0:e.used)||0)+"G)"}}},R={class:"right-panel"},E=f("div",{class:"card-header"},[f("span",null,"虚拟机")],-1),S=f("div",{class:"card-header"},[f("span",null,"系统信息")],-1);function k(e,u,n,m,o,c){const r=a("el-option"),O=a("el-select"),V=a("el-header"),y=a("scEcharts"),d=a("el-card"),i=a("el-col"),v=a("el-row"),A=a("el-main"),C=a("el-container");return h(),g(C,null,{default:t(()=>[l(V,null,{default:t(()=>[f("div",R,[l(O,{modelValue:o.refreshTime,"onUpdate:modelValue":u[0]||(u[0]=p=>o.refreshTime=p),placeholder:"刷新频率"},{default:t(()=>[l(r,{value:5e3,label:"10s"},{default:t(()=>[s("5s")]),_:1}),l(r,{value:1e4,label:"10s"},{default:t(()=>[s("10s")]),_:1}),l(r,{value:2e4,label:"20s"},{default:t(()=>[s("20s")]),_:1}),l(r,{value:3e4,label:"30s"},{default:t(()=>[s("30s")]),_:1}),l(r,{value:4e4,label:"40s"},{default:t(()=>[s("40s")]),_:1}),l(r,{value:5e4,label:"50s"},{default:t(()=>[s("50s")]),_:1}),l(r,{value:6e4,label:"60s"},{default:t(()=>[s("60s")]),_:1})]),_:1},8,["modelValue"])])]),_:1}),l(A,null,{default:t(()=>[l(v,{gutter:15},{default:t(()=>[l(i,{lg:16},{default:t(()=>[l(d,{shadow:"never"},{default:t(()=>[l(y,{height:"300px",option:o.cpuOption},null,8,["option"])]),_:1})]),_:1}),l(i,{lg:8},{default:t(()=>[l(d,{shadow:"never"},{default:t(()=>[l(y,{height:"300px",option:o.memOption},null,8,["option"])]),_:1})]),_:1}),l(i,{lg:10,class:"fix-font"},{default:t(()=>[l(d,{shadow:"never"},{default:t(()=>[l(d,{class:"box-card"},{header:t(()=>[E]),default:t(()=>[l(v,{gutter:20},{default:t(()=>[l(i,{span:12},{default:t(()=>[s("PID")]),_:1}),l(i,{span:12},{default:t(()=>[s(_(o.pid),1)]),_:1})]),_:1}),(h(!0),x(b,null,T(o.jvm,(p,w)=>(h(),g(v,{gutter:20},{default:t(()=>[l(i,{span:12},{default:t(()=>[s(_(w),1)]),_:2},1024),l(i,{span:12},{default:t(()=>[s(_(p),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1}),l(i,{lg:10,class:"fix-font"},{default:t(()=>[l(d,{shadow:"never"},{default:t(()=>[l(d,{class:"box-card"},{header:t(()=>[S]),default:t(()=>[(h(!0),x(b,null,T(o.sys,(p,w)=>(h(),g(v,{gutter:20},{default:t(()=>[l(i,{span:12},{default:t(()=>[s(_(w),1)]),_:2},1024),l(i,{span:12},{default:t(()=>[s(_(p),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const F=G(I,[["render",k],["__file","Z:/works/vue-support-parent-starter/vue-support-config-starter/src/views/config/actuator/oshi.vue"]]);export{F as default};
