import{_ as A,E as k,D as g,r as p,o as b,g as S,w as f,b as i,d as v,e as C,t as _,l as O}from"./index-a5e257d7.js";import"./index-dc38eef1.js";import"./about-94d05d73.js";import"./echarts-87591a23.js";import"./index-509044ac.js";import"./progress-29a26793.js";import"./space-b1d6615a.js";import"./time-5f8305b6.js";import"./ver-7cf59a83.js";import"./welcome-e56924b4.js";import"./Utils-d73ed2bc.js";const x={content:[{path:"/config",component:"config/index",name:"配置中心",hidden:!1,meta:{title:"配置中心",icon:"sc-icon-mapping-v2",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null},children:[{path:"/config/bean",component:"config/bean/index",name:"统一脚本",hidden:!1,meta:{title:"统一脚本",icon:"sc-icon-script",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/log",component:"config/log/index",name:"统一日志",hidden:!1,meta:{title:"统一日志",icon:"el-icon-warning",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/trace",component:"config/trace/index",name:"统一链路",hidden:!1,meta:{title:"统一链路",icon:"sc-icon-trace",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/actuator",component:"config/actuator/index",name:"监控管理",hidden:!1,meta:{title:"监控管理",icon:"sc-icon-sc",hidden:null,tag:"NEW",affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/actuator/oshi/:id",component:"config/actuator/oshi.vue",name:"OSHI",hidden:!0,meta:{title:"OSHI",icon:"",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}},{path:"/config/config",component:"config/config/index",name:"统一配置",hidden:!1,meta:{title:"统一配置",icon:"el-icon-grid",hidden:null,tag:null,affix:!1,type:"menu",color:null,roles:[],keepAlive:null,params:null}}]}],datetime:0},m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";class V{encode(e){if(!e)return"";var r="",t,o,a,n,c,u,d,s=0;for(e=this._utf8_encode(e);s<e.length;)t=e.charCodeAt(s++),o=e.charCodeAt(s++),a=e.charCodeAt(s++),n=t>>2,c=(t&3)<<4|o>>4,u=(o&15)<<2|a>>6,d=a&63,isNaN(o)?u=d=64:isNaN(a)&&(d=64),r=r+m.charAt(n)+m.charAt(c)+m.charAt(u)+m.charAt(d);return r}decode(e){if(!e)return"";var r="",t,o,a,n,c,u,d,s=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)n=m.indexOf(e.charAt(s++)),c=m.indexOf(e.charAt(s++)),u=m.indexOf(e.charAt(s++)),d=m.indexOf(e.charAt(s++)),t=n<<2|c>>4,o=(c&15)<<4|u>>2,a=(u&3)<<6|d,r=r+String.fromCharCode(t),u!=64&&(r=r+String.fromCharCode(o)),d!=64&&(r=r+String.fromCharCode(a));return r=this._utf8_decode(r),r}_utf8_encode(e){e=e.replace(/\r\n/g,`
`);for(var r="",t=0;t<e.length;t++){var o=e.charCodeAt(t);o<128?r+=String.fromCharCode(o):o>127&&o<2048?(r+=String.fromCharCode(o>>6|192),r+=String.fromCharCode(o&63|128)):(r+=String.fromCharCode(o>>12|224),r+=String.fromCharCode(o>>6&63|128),r+=String.fromCharCode(o&63|128))}return r}_utf8_decode(e){var r="",t=0;let o=0,a=0,n=0;for(;t<e.length;)o=e.charCodeAt(t),o<128?(r+=String.fromCharCode(o),t++):o>191&&o<224?(n=e.charCodeAt(t+1),r+=String.fromCharCode((o&31)<<6|n&63),t+=2):(n=e.charCodeAt(t+1),a=e.charCodeAt(t+2),r+=String.fromCharCode((o&15)<<12|(n&63)<<6|a&63),t+=3);return r}}const N=new V;const B={data(){return{userType:"admin",form:{user:"",password:"",autologin:!1,verifyCode:void 0},rules:{user:[{required:!0,message:this.$t("login.userError"),trigger:"blur"}],password:[{required:!0,message:this.$t("login.PWError"),trigger:"blur"}]},captchaBase64Key:void 0,captchaBase64:void 0,islogin:!1}},watch:{userType(l){l=="admin"?(this.form.user="",this.form.password=""):l=="user"&&(this.form.user="",this.form.password="")}},mounted(){this.getCaptcha()},methods:{getCaptcha(){this.$API.auth.captcha.get().then(({data:l})=>{const{verifyCodeBase64:e,verifyCodeKey:r}=l;this.captchaBase64=e,this.captchaBase64Key=r})},async login(){if(N.decode(this.captchaBase64Key)!=this.form.verifyCode)return k({type:"error",message:"校验码不正确"}),this.getCaptcha(),!1;var l=await this.$refs.loginForm.validate().catch(()=>{});if(!l)return!1;this.islogin=!0;var e={username:this.form.user,password:this.$TOOL.crypto.MD5(this.form.password),verifyCode:this.form.verifyCode};try{var r=await this.$API.auth.token.post(e)}catch(o){this.getCaptcha(),console.log(o),this.islogin=!1;return}if(this.getCaptcha(),r.code==="00000")this.$TOOL.cookie.set(g.TOKEN,r.data.accessToken,{expires:this.form.autologin?24*60*60:0}),this.$TOOL.data.set(g.USER_INFO,r.data.userInfo);else return this.islogin=!1,this.$message.warning(r.msg),!1;var t=null;try{t=await this.$API.auth.menus.get()}catch(o){this.getCaptcha(),console.log(o),this.islogin=!1;return}this.$TOOL.data.set(g.MENU,x),this.$TOOL.data.set(g.PERMISSIONS,[]),this.$router.replace({path:"/"}),this.$message.success("Login Success 登录成功"),this.islogin=!1}}},I={span:6,class:"captcha"},T=["src"],E={class:"login-reg"};function $(l,e,r,t,o,a){const n=p("el-input"),c=p("el-form-item"),u=p("el-checkbox"),d=p("el-col"),s=p("router-link"),y=p("el-button"),w=p("el-form");return b(),S(w,{ref:"loginForm",model:o.form,rules:o.rules,"label-width":"0",size:"large",onKeyup:O(a.login,["enter"])},{default:f(()=>[i(c,{prop:"user"},{default:f(()=>[i(n,{modelValue:o.form.user,"onUpdate:modelValue":e[0]||(e[0]=h=>o.form.user=h),"prefix-icon":"el-icon-user",clearable:"",placeholder:l.$t("login.userPlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),i(c,{prop:"password"},{default:f(()=>[i(n,{modelValue:o.form.password,"onUpdate:modelValue":e[1]||(e[1]=h=>o.form.password=h),"prefix-icon":"el-icon-lock",clearable:"","show-password":"",placeholder:l.$t("login.PWPlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),i(c,{prop:"verifyCode"},{default:f(()=>[i(n,{span:6,modelValue:o.form.verifyCode,"onUpdate:modelValue":e[2]||(e[2]=h=>o.form.verifyCode=h),class:"verifyCode",clearable:"",placeholder:l.$t("login.verifyCode")},null,8,["modelValue","placeholder"]),v("div",I,[v("img",{src:o.captchaBase64,onClick:e[3]||(e[3]=(...h)=>a.getCaptcha&&a.getCaptcha(...h))},null,8,T)])]),_:1}),i(c,{style:{"margin-bottom":"10px"}},{default:f(()=>[i(d,{span:12},{default:f(()=>[i(u,{label:l.$t("login.rememberMe"),modelValue:o.form.autologin,"onUpdate:modelValue":e[4]||(e[4]=h=>o.form.autologin=h)},null,8,["label","modelValue"])]),_:1}),i(d,{span:12,class:"login-forgot"},{default:f(()=>[i(s,{to:"/reset_password"},{default:f(()=>[C(_(l.$t("login.forgetPassword"))+"？",1)]),_:1})]),_:1})]),_:1}),i(c,null,{default:f(()=>[i(y,{type:"primary",style:{width:"100%"},loading:o.islogin,round:"",onClick:a.login},{default:f(()=>[C(_(l.$t("login.signIn")),1)]),_:1},8,["loading","onClick"])]),_:1}),v("div",E,[C(_(l.$t("login.noAccount"))+" ",1),i(s,{to:"/user_register"},{default:f(()=>[C(_(l.$t("login.createAccount")),1)]),_:1})])]),_:1},8,["model","rules","onKeyup"])}const R=A(B,[["render",$],["__scopeId","data-v-b1b4f708"],["__file","Z:/works/vue-support-parent-starter/vue-support-config-starter/src/views/login/components/passwordForm.vue"]]);export{R as default};
