import{_ as y,r,o as f,c as g,w as t,a as l,b as p,f as U,g as h}from"./index-65c3e508.js";const T={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增",edit:"编辑",show:"查看"},visible:!1,isSaveing:!1,form:{genType:"DATABASE",genUrl:"jdbc:mysql://127.0.0.1:3306/config",genUser:"root",genPassword:"root"},rules:{genUser:[{required:!0,message:"请输入账号"}],genName:[{required:!0,message:"请输入数据库名称"}],genUrl:[{required:!0,message:"请输入数据库地址"}],genType:[{required:!0,message:"请选择数据库类型"}]}}},mounted(){},methods:{open(n="add"){return this.mode=n,this.visible=!0,this},submit(){this.$refs.dialogForm.validate(async n=>{if(n){this.isSaveing=!0;var e={};const m=this.$TOOL.string.getRandomString(16);var a={genPassword:this.$TOOL.crypto.BASE64.encrypt(this.$TOOL.crypto.AES.encrypt(JSON.stringify(this.form.genPassword),m))};this.form.genUid=m,a=Object.assign(a,this.form),this.mode==="add"?e=await this.$API.gen.database.save.post(a):this.mode==="edit"&&(e=await this.$API.gen.database.update.put(a)),this.isSaveing=!1,e.code=="00000"?(this.form.genId=this.form.genId||e.data.genId,this.$emit("success",this.form,this.mode),this.visible=!1,delete this.form.genPassword):this.$notify.error({title:"提示",message:e.msg})}})},setData(n){Object.assign(this.form,n)}}},A=h("div",{class:"el-upload__tip"}," 当前支支持jar ",-1);function P(n,e,a,m,o,b){const d=r("el-input"),i=r("el-form-item"),_=r("el-option"),v=r("el-select"),u=r("el-button"),c=r("el-upload"),V=r("el-form"),w=r("el-dialog");return f(),g(w,{title:o.titleMap[o.mode],modelValue:o.visible,"onUpdate:modelValue":e[8]||(e[8]=s=>o.visible=s),width:500,"destroy-on-close":"",onClosed:e[9]||(e[9]=s=>n.$emit("closed")),draggable:""},{footer:t(()=>[l(u,{onClick:e[6]||(e[6]=s=>o.visible=!1)},{default:t(()=>[p("取 消")]),_:1}),o.mode!="show"?(f(),g(u,{key:0,type:"primary",loading:o.isSaveing,onClick:e[7]||(e[7]=s=>b.submit())},{default:t(()=>[p("保 存")]),_:1},8,["loading"])):U("v-if",!0)]),default:t(()=>[l(V,{model:o.form,rules:o.rules,disabled:o.mode=="show",ref:"dialogForm","label-width":"100px","label-position":"left"},{default:t(()=>[l(i,{label:"数据库名称",prop:"genName"},{default:t(()=>[l(d,{modelValue:o.form.genName,"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.genName=s),clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"数据库账号",prop:"genUser"},{default:t(()=>[l(d,{modelValue:o.form.genUser,"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.genUser=s),clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"数据库URL",prop:"genUrl"},{default:t(()=>[l(d,{modelValue:o.form.genUrl,"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.genUrl=s)},null,8,["modelValue"])]),_:1}),l(i,{label:"数据库类型",prop:"genType"},{default:t(()=>[l(v,{modelValue:o.form.genType,"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.genType=s),placeholder:""},{default:t(()=>[l(_,{value:"DATABASE",label:"结构化数据库"})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"数据库名称"},{default:t(()=>[l(d,{modelValue:o.form.genDatabase,"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.genDatabase=s)},null,8,["modelValue"])]),_:1}),l(i,{label:"数据库密码",prop:"genPassword"},{default:t(()=>[l(d,{modelValue:o.form.genPassword,"onUpdate:modelValue":e[5]||(e[5]=s=>o.form.genPassword=s),type:"password"},null,8,["modelValue"])]),_:1}),l(i,{label:"数据库密码",prop:"genPassword"},{default:t(()=>[l(c,{class:"upload-demo",action:"none",accept:".jar","file-list":o.form.file,"auto-upload":!1},{trigger:t(()=>[l(u,{type:"primary",size:"small"},{default:t(()=>[p("选择驱动包")]),_:1})]),tip:t(()=>[A]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model","rules","disabled"])]),_:1},8,["title","modelValue"])}const N=y(T,[["render",P],["__file","Z:/workspace/vue-support-parent-starter/vue-support-gen-starter/src/views/gen/db/save.vue"]]);export{N as default};
