import{k as G1,G as GG,l as js,o as Zc,d as qc,D as zG,m as QG,w as KG,x as XG,H as NE,E as JG,j as ZG,y as Ag,e as qG,F as $G,I as tz,B as ez,u as nz,J as rz,K as oz,L as iz,M as az}from"./display-_0nm5nf0.js";import{f as W0,a as sz}from"./_commonjsHelpers-SRRim4kG.js";import{i as PB}from"./worker-ref-CHNAV_Da.js";import{r as Ep}from"./_commonjs-dynamic-modules-OUSn7nVQ.js";import{F as lz}from"./fileView-myRAlRds.js";const uz="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAC9FBMVEUAAAABAQEODw8AAAAAAAAAAAAzMzMBAQEAAAABAQFycnIAAAD9/f0mJiYAAAD9/f2EhITS0tIbf0qBgYHOzs6Kiorl5eVpgHRXWVgLDQz7+/v39/dDmWoObzoQfEIqi1YVf0Ukh1Ha2tofhE2lpaVebGTt7e15eXnh4eHX19cZgUmYmJg8Pj1VVVWoqKiEhIQObznGxsaxsbEng1C1tbXMzMy+vr7CwsLR0dHFxcVmZmampqa2trY/cFVTU1PZ2dnW1tYAAgDm5ubY2Ng/lmcObzo/lmcNbzo+lmYOcDo2kV////8QfEH9/f3+/v77+/v4+Pgri1YRfUIsjFjy8vIdg0v6+vopilXw8PAniVMTfkTt7e0liFIXgEfo6Ogbgkr3+PcVf0UfhU3q6uohhk/29vYZgUj19fX09PQjh1Dm5ubs7Ozk5OTv7+/e3t7i4uIho2YUSixbz5owuHkfmWAYXDdNtYT4+/nb29vc3NwjhlDg4ODW1tYtjFnQ0NDU1NTY2NjU1tUOcTsQekDIyclEmWvKysrHx8cxjlsXfUNAlmi/wL9OtYUAeDdFiFtYn3Y7l2YTbzsAbTQzdUpQvYVVzpcBoWEAQhkht3VHblVGYU8AViozuHpJqnZJoXHMzMwAl1tjuo4jmmFGtIEeXTn1+fbExMS7u7sAejoThk1FnGxs0qEogUwAfT5Nk2jBwcEyilc6hFQAeS0uiFQBgEMrhVAObjm0tLQAdiZCjmAbf0YigEkAfDOpqany9vRHjmIdiFEChEcWfEK4uLg/ilsAbwHO39Vt0qIAdBxzqIc8h1cOdT03kV8AchC/1Meurq6kw7ADk1jo8eygoKCXl5dgtozt9PC3z8APg0ni7OaxsrFr0aDc6eGNtZwjll7W5NysyLaevalEsX9poH6Aq5BUmXAdXDiTuaGGspfG2c0gckBLqnYAZx8AZAZo0Z9edmY9aE09XEgLfkJhroFhkXF61KdxvJZlwY88sH0BtXFXi2gATxf6D1MSAAAAS3RSTlMACQYNExgZHSQpVTD3Njb2O/wOPfwr9w0LEPb28fHx8fHx+/FxF/VD9vzxWy4RiUz91JhUrPLIspTmOMvjJGLlvEbSzbGxiorOzuSptM5HAAA3i0lEQVR42uycy04aURzGC0JvK0mxxXRn6C22Nppae9G0SdetLIiZhISYEILhuoVgABMDCx7CHSxZ+gC+RZ+m58rHOWeOA1bAtOc7MAzD0NjMr9/3P/859Z6Tk5OTk5OT020pHL53lxQO37Ef6J9W+K5K/GSOhv9U7Lo/oyPhQJiPwom1O6uDg/sPotH1lYlr/uxZwmFwu7n/4vXTJeu1rzY2vhH9+PH9+97ep09byc3VtYPoisTAUXBrDrv2NJPNzV1Z8vBRkT+EymPV+As9SL5ZKmXLzfqb2O723qed5OpBJMwoSDgG/h6ARHjtaS67EBXtKkO1sZpMVaKGULNWztbqbwgHW5trUQaBM4K/u/4hALAATUFATREHQCJQr28Q1euNZrl6trv9IbkaIX8HZwR/B0Bo7WkpuwT5IECeEFxAUkARIOrUO503b047jerp7sedzQdhwoBD4KbXP/RuhQDAQzrLttiRR7PihUicIT7C53Krfw/nkuGb/nxQkcC3IgACGAJEp6ftWKzdqbc+f9h8SBhwNnAzAFYoAJncQkQBstkBHVK+CIyDAASctWOteKvdiX/eeR9xNnBTANYBwMKkg8DeX1cUGggIAtqtVjx+0WoPPiYfOgRucv1X1iNrLzMlrhzZgXAsWDgNB7CXK7HBxPdFQGjxABvgiaCUhRoCHSLmAa3WxcX5eau7v/XWBcHsAKyvR1ZfVkoLEQfBKp/iUHEBoxZgBLRjlIBur9cVCDgCZgfAyyxAJcjCgW2SQAlQGWgQyRgQBJz3Rr3efjJ6z+XAbADcj84bACBABnnAD0xj8EcAPtBkDIxdAIUAJWDQHwy+vg+5HJgFgIgEoEIGfTEG2wQP/Tx5INgOYAqYP2KmyKVNClALCBMQBIz6g6udh84EplN4DEC6Mmd5GQ8oWInI2BJhwgXUIKiDgJYgYDjYfxxOuEpgBgCevEx785XkIOPRDX1YXcGOgGwTwQUEAjwG+GSAEtC/3Iq6GJglAuYMgAmCJAAZgSpBnTPqFQEDoIzGAGpBWgh0z2khMByOvr69lwg5AgIBCAkHOPEWrYomxQfQP2DSbIBJ5IBOgIyB0f77sCNgNgDS8x7XXn+PuwE3AUgnICsJqCkmYBYC/d9JR8D0ABTSCxAQMKV6AeQzO5ycEmgEnLFCgBIwGg6vtkKOgLsFwITL2BDIGHGAgpCMAAJOxx5AC4Hh1oqbDEwJQD69cFmcwDNNABTABCaDoNpUJwNxTgCJgZ31RCLkCJgOgJP5DjMP7G5QQS8JBMAEMCGACagEsBTo968GHyIhR8AUAFSOT25XaW2P8DVTdWAUBIgC5AAQQFOIVoIxRkCPEHDZ3Yu6QmDBANhVgBsYAEg/MCoCVIPIgZxiAigEpAfEeB1ACWg7AqYBwDsunJxoD2UX78ULhMP8Hd/iGzhfXHxrKPAy0bABeEDJtytQo5oggAIgU2B42dh74AgIBiBVWIT0mLDFQVoPAzSIDAbQE+D3B2U/IN5lbeGrYfnjQ0fAnQDAqBMmCk+tHtDCIGMDQCsF4QGtcUfoclB0BAQBsPo8lfdVIR+kwpSfEADyCg0KEAHzxIqHIEA5iJ4AhQClYKczcXuYhECsuP0o/MwREADA/BUQCBYvgA1I+caAJKBhEHDZb5S33zoClghAgW0CEPCdHAABBYCSMR+UMYAUEATQEIg1yp+/OAKuBeAof3xz5ac5h51kt4QT0GDLATCAFNBbApMp0BIEDIfNuiMgGIB5K09kEgD5x4G4fSAI8ER/UK8GJQCcANkPEIUgsYDyRm33lSNgOQDAJnyiQQGg4BMFRltAiwEhWEATFiAJGA5rtXpt970j4BoAUsdSKSKyPfYRPY4dCPvmoZTcpCQF7MH9gM8MJjCQLUPCAdkUcNfAhgAAwDIRVgeAgMHosl1s1pu7m44AKwCHqflKUGWiYkaCZX4IBtAXAgJFLk6ANhkkFtAvlpuNatwRsDwA4Cp2AHwnBzoAcAG5klwFgBIgJ4PizuBgcNXJUgJijoAlAWBPFbUmsF9/dIgNC9CXjCIEYAG9bLFcazRiSUfAEgAAA+Q5RgFI5PMgYcwAeXIWzHoQFpDRUwCFICfgrC0IaHIC2smQI2AWAI5SU+qIjBtIdQMyjPmhhoCU7AkoJoCOEBpCnIBhO0c+a5JgoAS4JSK+AByZAweDBlXwOaZ8E8GYF6T1UsAOADyALhOU3YD+IJflBNS3VhwBd8cBQAAACLAAvS3o2w/S5oLng2GtRAmoNeoNR4DNAZR/r4oDHOIYXnBcXPxD9UPttOsJSKEe0OcEZASGAJYKlkUdiI5grNUiFnCWyQoPaLiloiYAP4/mLcZGsMzJgcyBNDDQZwO4MYA6kKUAWyvOQmDQJWcJD6g6AhYKAHQYVBgcpybbxqgHaAqw56QN+LaF0QxAP4iFwCibkQRsND9EEm6JSDAAy7GAlFkNyOmgRAAA+FhAGRYgQoB2A7qjqpcDAW6p6DIAmGpqYLaIpAWgFgQB1gwQZQBmAoN2OiNToLrRdEtFVQB+HY51xJ9HZHAR65aHsCfe4Rg+wR/Bviw+YmIvKYUKf2n3ENEfRAhgpVgJKQACsEKM1YHx3gU5uQQP+OgIUAGYo4CWxRow7F6AO4XoB/jVAT7rgzo0BC56JU8hwC0VXTAAwg58Lr+lnaB0B7BmSK4UYfJbIzQZAg3ZDWjFB+W06gHbjxwBiwEABmBxAUtFgBiYTAGlDGC/wkoFoJhVLUDWgb1qwaMElMYEuKWiCwIAsmcAHMDMAAAAC+D/h6jiKRFAZVQB0gLOT088T/OA/36h4MIBCHYAgwBkgOoB44ZgRSFAbwgTcQv4Q97Z6zgNRFFYAiRKFLEVPACioaBD4g0sj1NYq0iRokhRtBabQJtoo9iRUCh4CDq2pKSi4gEo6Hga5tdnfuMJxc5i30ASktiLmI9zZ+49nhxHZWkTMHiraAtAViSIS4uIsXos9KqAREGWBPXugD0PFBDIkrCRBMQ0cKIIuFarwfdvBm4VVQA8YwDkxo2/wO87bojgu3gWyAtubnDXhaZjxF0MwiCCLKAtBev9cXoFDVAEDNwqqgGAwJiFB8477OF3gVMgvEnBygbwDJoSEADAloD6OFuyY0wCtsO2iuoA5H4JyGMlIPxuFEhBAYAE0PAQsLZngmgJ6BJwqL+s5lXlZIHNoAkIKgAkoDMw1OF3uxnoXBiq2rAnB6x9EoCrxlU58HgzFseZq8HNkM3CGgB+CYi68Tj5LrJAfAZwJcCnAGV0Djh82Y7ZoZwbXQOai+FaRYMKAN2OlYCOd/nd+bMAPYQE2AS4CgAJMPeN2G/mbDFZugTsB2sUBABsiPhQ5aQgRU74n9pX+HP2RP0m/AVxJw/Fh+QdzoPzdaQBjgF7LGT7sDAaxcslZgKV1RhUbaEFHVjLGCAJGO3o0dAALQvs6lcDJUAD4E6CYxGtLKImoMsAWkMgoHT2EUESMEzi9WFJVcSbBXa7gRoF7xoASzFw84TtI5IA6P1hCwBFgOMOEwAc9hQAg4CpImCza14/HKJN7M4BKBQB5zQO4FCGAtDwA6CXA62FwL4auwSwDzICNoM0CiZQAPnfv1sBQAAUABLQCQAIAAAlZ4gfCwIW7zgBLzdDNAomAIAzECcB5pqQ3cMvGGwJTAGAPQkYTdic0p0JtgQMzyh45wAI9c+7JgEgABoAApZzNwes7VkgWkKtPXS0FosKTxZYMQK2w7OKJpkEEvo7NrRJAEfAngYGZoHedUAzmkoAbAIWfB7QvBzerqIAgI4KISSnwe7YM/mL5AQv8j/JFxDEfUa019TR2mGmBpATKiBKAoWSANjG2cYiFQ1IAAqCXgI2GwaAgIlLiI+AoRkFNQDuKnLFlhsxZUK7NQQCOASBaYCQgPqaut9PEbChBAzLKJgAAJDgBgn3Gh0AVGfAAgAEmMYQDsCCXHYSMKxdRVMoAFKKp0oQXRQYAwDPtULoCaEYJAAo5CnmQQIGZRVNAoB89IcjAUECYgHALOAwYz2vTg0YklEwVQrISbBIlHdpABTAIWDtmwTAG8YA8BMw0QnYDMgomAaAnN5IrADknTnAd72o5gwyAVBnOk3AYIyCSQBg2T+kAeE2QTgHVNhWGrsJAwBsIbvjAIQJuFYENIOxiiYAABCEekWnZwEAQLlEjYKwDQByAACg0aEBzVCMgvdsGRi3EnDXAZVWEbYAoBEAgFeVQgTsPg6DgHQA5KGJgOsudABAMcDTEnDKwcgBzSzD2QwCqpaAmSTgcByEUTAhAOwusleQB3LAWCqAJMBIAT4JaBYZr0BHZYHDlyHsKQkAKAEMghAImfH4T7hk9pGBqaBtGCKuTcxQgCVM4tbOUTMWJgDy/GECpu1MsB6CVRQAiOHJMEyZO9h4EaxwcnCgeJLJD6hX1Qfw4MkGshVltItoCHOpcY25aAupwVvaXcEpZ6AFADvHba4zSZhHAwQCfAWpCBj13yioAZBpw6f+lOFODSJ/g6hP4xPidfUWjiWZOkw8B1sIOfCKBTlGyn3sFIc4ANAARsCVlgRY6P2AWbsO2EwzKTmuBnARmJgEjOpXfTcKKgCeZAiSRcS/fx44sQHvLBMW8jGwGlA9IZjE10wCnHIwAFB8uQSUtgbs6kPfjYIAIEVEl4pRItQJQEXYLAZgGmBdJSQACGsAO94kYLR7/ajXBCQF4LxeAS4zhQToAJhJwNsQ2K7ZzwxpwNJPQL+NgokBCFPQoQAFAAABavwnE8sZpBRgO+E/DhoQJuC6JaDpNQFpAQiPP1YDCFxfCgkAABUNZ8MAY/tQAUBIA+ZhAvpsFEwFABYQWXQOkAqAFKCPHAgQgUmAlIB3DIAya1egIQ2oPAT02CiYCgBgECoTdl1PgBzACbAtwk45UAIA5KAB3QT01yiYGoDwFMA3DSDYaQISMKehJMACwN4w5H2V0YjQgNIl4EE/CUgOABCIWgk6/hBIgD0LcAFYvb/KsmgNWBsE9NUomA4ATANCi4BTrUIAoAgAAI4EAIA5qDt3HtDTPSWTAhC/EkT4OoO+HDARG8iapYCbsaU77logSMCun0bBB8lTwMneYsAyljsAzB0A1gBgoQMQpwGlh4BeGgUfJFeAyPFHoB6IHEDDXgdMLAAYATdFpsW5a4FDHwl4kF4BkAKiEcg9SQCVADjEre+RAABhDXAvGQEB9df+2cTuAQBnSgAUwJ0GOgBMTQA+5Bkish7QcwLSA4BiUPz1g2Y5GPNASwLMvUMBAKJTAywCRp/6ZhRM3A4W9+chgA0sHQlov2TWBADTQFgXghqADpOPgP3HnhkF74UCkOzMtSAxe4KXAMAxCBsAvCOBKlQcATeMgGO/jIL3AQD4EKMJQGvYmQWUVg6YgoDVLEPEEeDWBPcXvTIK6qbQpOE2gGJmgkoCMGIgwM0Bq0WwEp3HEtCM9vs+GQUBAEkUOUq/JHqvQbMejOuEPC1BKMBsdZ15ApiFsoBDQI+MghoAebIg2tA6gYHxSIBxpYgnCZgtwdU08wayQAcBM0rAdje6GPXHKCgAePz0WZYnDG7+t4O/YncBveUgSIDvMiFIwGqS+SNCA6YtAZumvqh7YxO7JwAQNPlC31eDD1jmEBCgOgKuL6QFgPiHH6f0EVCZFaFtnwhQADwnxf8RHAKrL4hNQ9wdQ3Rr4KrUxjwsBuy8cvw9WUCsBSgB/TAKtgDQdJouvD+bjoJn8JEbIBlWErgqjZYQcsCqMhSAZf3L8bKU3yg8Yx+aricV25KyyLMsZxjMOVLm5uKCgH4YBQHA5ThdXOLRCM6BGTCFQbNBwJKPV8gatprzYS/m5XrByzr1/uLL8eOnr1+/ff58e3v78+d3Hj9vP3891s12Na2W46Kgp237AlMKCiOgoQT0wigoAXjxvGD/3sluJ4NTABZaGdAuGsUswE0CmAW8m1zRkb+hSbzZHQ6Huq5HdE1HIfhypBi0HFAM/vz6wePX98/H3c11uRyPr0qhJpwABs9F3QejYAvA5Xh+T2IpH+lfSKdABHKB/CXrgS4BrjeMt4PEThHqW+V3jALGAFOCj1QLGASUAoaB5OA3jR+3x+bdpFpWE3oioQGcgLf/v1HwL3vn9jJTFIbxGGdXNDlEKTkkh3IocsgFScqpmdiamtROMxnMrWkcyyku+AvMHZkLLuVCyJWaHKJE+RDCf+Fda717nv3utfaMzDDbzH4cvtworZ/ned611nzLADBl6bx9RwauUkn9RuI/MwoSAkYAy89CDzwCAEAAPiMUek4UDMwIfOCCcYJ7gMBQ8OYNUdCoFbz8cdME64aA//6iYACAd7g0OJUptekXSf2BvyoZDkjdEQgcAM9BOO6GtT8iVLcZ0FmQJQguGQgCCgwDGgKi4GmjWvAoR4IU2Py/XxQMAFhyJJ80BSAYBkgSASy/k4AyAPBgAZIATgJCgBjQNmAaQUNDACswaRBA8PDWuWKBSqROgRn/+zWxNgDl/CDl8ROQef1DfwUFcILY0QA9UJFSAgFGrqekqoyAsYFTphXOICkI7DzgSsBGcO3UUf+oJuDM7f+bgPHjFQBTly7JH0+EzGd76SuLKaAV7YbAARDg+C7yCAEQoBhAHyQpBAiCqBPcCo8H8IHa0WpNEXDt/74mRgTMnTCFAPASIcbAiNdffbEQAAFdQwAAcA3Ac2KyCpgkICENLpECIzAMwAfeZ0/UaT8gm2AC5szupJlKixdP2rJl+rRZfjF58kmVgnfkSJltwCRBdwJwLAiuAgtADCAHiADuAvCBM8yAHQZg4PW9U7Xz2ca9JBKweO2O7Tvn/7auJ1Vfnv349PxdWXdUdoGuBDAATgKKnAKCgBoToKQZgA1kzzTAgPABg8DtGafONG4l7qLg2u3zmzdvNn9fN5KrK6/Grn//efwIXAAE2ABYnxMBAEyAEgiowwOYAUSBtAGzUwQGgjrw9MyMxuVkXRRcu7N58+LwqNm8Ojb27LlX8hgBMgEnAQeYABwM258WlgRUQQAQUIomAf0IMcBzAdvA66fZ7AW6JpYUArZs5+W/OhS6eFUz0Hr14+MRTUBZEiBvEsSOAvAAIAAPwECoxAjwcQGPBVmCADsEzECAwO1GIzEErJ1/U6/+jVbrylCo1bqhGRhrPi97bAIgIKp98TWgYA5zLBOok9gFhA9wIWQjMBQQB2I2pDagEKCpMCkXBXc0zepfOX06lzs9BFL/iiuKgebVVy/z3QmABRACkoDYGGAEBATtKAAEQR7AB7QNGATuNxJxUXDHTb38p4di7aHcaY3Aq8+eJECEgD0L8reRxiaDfEoAVVDYAHwAY4HYI0IWKBtgBN48vJyAa2J6/Vv8fz83JGIfaN0gAuABggBxqzRMQHQUwBUxeICbAR4NTwKCMAXZsA2YLvD69bWBE7C2Scs/NAsvpRAgAt6WC4SAaYIIgd0gAB7g3g6AB8AEsDVMBCALrErQLobSBu4FCNwf8EXBLfOHef0VATQSfMwfVzvEIAAW0MkDcDlAFgEZBMwAq4Y8AAXcDNkG+B4JI/D6/aaBXhTcfvNqKzfUal0c+0r3NpkACgFYgCTggCBAFIECYkAiUAUDoIAwYMlSIGzAIKBM4MWmFQMgAAEw5OuvCHj1PF/g46GIBYQRCN0Qw7EAYgAmYCUBICBFIBC7BGBAI8BVYJAE7GzeGGL/5xS40Xrmq+NCEQJm+UmuWYAUQwAQAAPoA0wBOIhAwDbAjTDIgRfvB0bA2hFYfyLg6hhZgCKg3A4BdgCtAABBgLsKUgzoIEAhtCiAG9hWIGygYRC4TTlwfwAEcAMY+gBQao19oLXzmAAFgLAAx6aweGCWhcflQAAQgMBAaEJAJeA2MIMRMCbwdNPUcQPYEVo8fxQMQI0C3+oFUwRtC5CfF+tOABAABEWm4GgcBWBA3idkE6BTok2TM/+egLUXr+zPjYJaY8+9ChHAPRDbgSz7pjgI0IrsC0oEungBIMB1wrYN6CqgTOD2pgn//mRoR3MkDIAAePLyuE8eYFmA/R2EJAK4Ls5iAuACNgPSC6oseXqEQkg5oEyACBjA2eD2G7nR0JU7X4s+WQAGAZQAknUuwDlQcpoAkgCNUIwGkMMKhA0YBLgJ3P73N0R2jkQFJJ1+/OWYTxaAGrgPJcBOATQBBwLHtQqBKiTfdoMYCIAAPmemtgX0nsD7aeNX/tNRYM6uEakABMC3qh+yAAbA/d1DXAgwAbYNIBBsBiAnA5wE540JUAzc2/yPh8HZC3K5/SOh04/vVotFbQFEgCwBgaz7AbgnJh6ZDCQZ0AoQAATurQJGAC6gTIBi4MKmiXMy/zAEZo4SAPUiWkCoBECOIgAT4F0h2QdJYQQKgCCuHIIBIKC6AJlAVk0Dlzp+P8EUgF4AOGEB4M4ATgEgIF8YkwgoCLxCwEEFZuDDDFxGYCFAZVDFwOV7yzvUgBSAngCg7RqugaWSswWKJ8eZAPnSLBhAELAKwgziIQACCALKAWMCjcuNzVMz48alAPQfgEcEAFsAlwDMgZB8Yk6aAB8PkOw2wCCIWljBmIgjxBAE0Q8aqm2hxoWz6+bOjqsBKQC9AFA7dkzVQACADIAUD24TQBBEowAcRGsBM1CRDBiJLmDmARoH1OnA8tjdgBSAP1ZOA8AZgBIAB5AQuJqAOR+AC8jBEGZgGgEwkGkgGeAggAnQd6CasXpqJpMC0H8ATlaPcQbIFtjhseEDSiEAgokAMwEQgLgQRJzAr1ibBPiUSbsMkglkz63JxIRACkBvAFQJAD8A4HCcA+wRl4SMmAF2AbkxYHPASYBmWOHtQjsLjh2VJqC2BGZcWDpu5d8NAQAwIuvPAHAG5PMEAKYAVwIgBuQTM3xbCDZAP2wKUAcYgQADX2SBCAL+sKnqgrX1E2ZnUgD6DcA5A0BFXwzSpwGOKQBHgyCAFTYBEhNA6ugEJA8QVFjCBczNUn1SSATo04Hl41a6CEgB6AmAet04AEqACwDsCaIIsORMiJlAQuA5GAjtFKEOhKsAJkLlAbXVkxUAFgEpAH0AoGLGAN4IiHttgJdfICCembAYEC4ACoCAYy5QAOATxyBgWW2RsoAUgH4DoDOAHYAjAB3AIgAuAABkHyShE1qtMAoB+kClIGxAToTUBBbW3RaQAvDnevzoFAEQjAFogarzxyKAOmgHgYsACwEFgTw6QhQELuC3mwApIODE37UAALB//8GRkALgRN0eA5ABtjgEWBEAMBRgMMRYIH0AEmcGvEcoTYAHwqrTAlIAegPgBMYAAIDXhyzBAQQF6jNk7SQInKCEsSAfooBYkzYgs4AJAAImBogAYwEpAP0FoO4AYG8sAegAUQT2hcU+EK2EgEC6gNUHnSZw4ujqibYFpAD0CgDmwLADdHh6Dg4gEYAJiLmgRD9dDHjhueC4J9oATEB8G7qTyzNEwF8HYETWnwB40I4AC4COBMhvJiLOCSUC7dlQbg4AgrBEF5AIcA746+daFpAC0GsHqB7DRoB0gDgEsPRScAAQ4NggKjEEaASOsTAUA8W2CRzbunEunQqmAPQNgPMKgPBOEACg5Y97bpg7gA2C7AKYDNEGAmEssI6OnU2AEfBXZVamAPTTAWq6AxR9vhEAAJQ6TAPxj+M5GSDhc2UwAsjZByu+YIAIqGyjSVASkALQSwc4X1Md4KhfcQHQuQfghxAOCmMIcPuAFx4LwghEtgbrVANTAPoKQL1K9wJ1CZQAdEOggwWwJAG4OyIZCGTtETsJ8DZkIjUwBaB3AIo+IoAJwPLHCxYQYwJuBGwXKAOBfBcEClunTPhLGQAADh48NBI6CABwGmQBoNqgQ1h4iwA8YCoYQA5IBsITgRgJUAfDCFAGpAD0D4ATBoCKBQDUzQKAAIQUCG0Rh7qAhQDkhRGwZ8LyhrmLhQWkAPQNgLwFQHcESEDAQcBevGSrDwkYANhA5y4AAgIX8LZOmZsC0HcA/HgAEAG23A4ABNAF8NlieV4IBNwm4EkTIKkMSDIA+zsoSX8nOkDHCOi2H8AO4N4cDMUAEEAbjCBQcpqA50kXKJY2ZEQGJA2AOx30h6u1/04HHeqqHjoAq+PRkFl/tw64EYCYAfaAX+ydSajTQBjHUZ8bXgRBUE/igqDgVTyJHocmT7TVYsQSU2sRLyoWCh4FD4IXBQ8iLhRcqJSmBQWpFsQFRFRww31DvXgRt5uTpf6TZmaaZqmJ+m9eUh5JfDK/fvN9/5lJS2x70J0OFqkXNCe5AKy9wNcVEDBc+18R3HRtSADssQD4AB4ABheE8IX75cgEcn0EoCo0IUBRyIDAmQ3unL1yTnIBaLQ+kUKOI/ljvRHglvWPco6jAvnU8nNLMQCu0cDxAADwIwAyAdlGgL5c5qDlC7DnkzOWFlEENi6kfcCECTECECYAdA/VCFdPugFuvaH7hHBVO9RdGx0AJQEA4lwQL24yaBLAdIZcVSFnUQlqgq0yLQQdISBZAOQbzbskQ9jKkLuXG0Pf8LLwhs2hbygGQNAF+LCFxZaAudkvJwHCyeS2P4g5IzvG10ybk1wA8nr3GZEIUxLp7PebBiAB2N/h3+9ZV88HFADAjCB2EghLUCBZ4tjCNgKoBaECoyRkLixy5wIbZ88aixWA+aEAaLRuZQj3E3vHbwhAALhD+Pe7FSADEOcAOWskiPAk0Y0pMwxgVREnJ2AtJ8DUIXcuCPX1AxsXxtIHAIB8XgmhRvMRv8nkt611yhBaJ8Tp0eWGEkJ5OwIAgGKnU6oVaoXK8MJUwUqNq1KpU3Ko45D1jbZFyxFwRgHziGnENAbIKxINwIbqgftE4rXZy/pQbdaov+TRJJH7B7QNSgjlz/YDsP7bA6qTw+vBt4pkWwKVr59v3DjvR0/d+vx1vWUQmwiUMFK43T1OtCmzamqSAVAal58TiRtBn59pRHYrBIBA0i0A8IyQwvoHP95QnR5aPx5UJDsG1D4fCajPHbiDSAbMzZIdA4qrl40lGQDabNf5H9snZ/3fPq9cFQST6wHanx8BNpoR4MGbg3upDg6r0ycNAEwEajeO7AqkI0879iJzqIdAybWybMfyMWNAKLEA6N33NX7m/qrpu90azVd8kmrvu2uVAOIBsN4CYK8tCoJ/2QBQ0S4gBADjRTcBePAM3QOB7c4sMIEAKNQMEJSCFx777Lk3PBaBdBcg+ZcYgAIFAM0fCICMVDkfBIAjFgCYRQ5ZyYCTAGnFpHgBUMIKZgCrFPTbco3Ln0hGYAEoQSUGAATEDwCa3waAyg2AuarIbRFtJKsmLxpLNABr66jeWNX7Wp83kQQ3qTcSCkCYLqDfHDaORc9Igbx6+pRkRwCRGSD5LQX11ssIwgjkE4DTaNdRAnDEAmAcq0qLJgB08xBQWLxyzHCDEwxAXtt3n999fxDl7+gAPhCJbwGoQSwAcRXgjgAHD9L9qCMAVcGioGjPH+0xAARoj7Bz+RiSgOgBUMIIFbyg+a5WB0KWr64DQpFZAP6TQFrb/YEuwCYAM8cgJwIlVxmQxAggNAMyPkrBMkrAKC0A/zkAlXGg2+gBsAQEXAQYOykeMxgRoBxeG2AGMGv4DYMuPzTg8vASAGA0v0nAHwAAAgCOEWNjR1aMLRpLOABlgRmQIZ+aDfHVwhLwLq4OI0UYAWwGDo6uCzjfB0B/R4C5Q2TV1OQDIDIDiHSrrosu1uvvCOFbAHnxXxgeAGbzxw9Abtyj3wQAAwrA6mlTjOGARANQ1mEGMErBlu79V8LDI9aQANhpwOgAKAEAZhjomUTb5SXLJvfGg5ILQBlmALsUFF35WmgBlMPJPwBUowRAHhcRgOUE44tnjU2JEYByNMqrqOS8peA6VeFemL39kHvhwwNqfgQAIAaYx5EAUEMEYCDgDAUbl6cBgDLMAFYpeJH1QUboEFgA5VASA2C0+NCKCgBEAC8CzkmE49uXpgKAMswARi13qMX5JG9oHaoQvgUQMgEQA/CDTgcJNCEEAASfEEIByI3zZTNAd8XcQloHpgCAPMwA/6WgGJv3LmyiBuDbg5MPTgadEiZZANApYX06b/wM1OevNdleRsYRlhiTFXECUK5GJpgBDL07o7Ou0S9/5JeAdy82qlHJA0Cx0DG+N6YSRJnf4p5Soy9zT7dCoeaVPVeYbgNEAZhjADAhJgAiJKDdQj3nqedbLADK7e4T/iXddtg/TghATpYxKXwoSVKmFwOgAWuLWE+Zcz9WIIeDsycomhFgzqQUACA0A143vR9nDUGDbQFUQ0oIgP2FETYDkmRt9MeHMtZeKFkgo91zCAKy3fo4AIMinRISKwBadGpcREbvreiySv/5yuNLKAE9FsDFhhadyo+9ALBXhkiAgSc8SEAoibuMEI8XgtwRAG8KhhdsOUGJB0DJrr3PbdBHaFAAc0cAzBZFC61gAIAAMQJ+hEVEA9cO0Zfd8lZuYFNB1kxLCwCazjUDJFKhpWDf2fW3MuG6h01d+2MAoO3DI4AIwAfAPDrDP6gYLxiDAVNSAoCmN1HVear6pt6Py0v+yZdx8kgBwKJAEh4B5H4iDBxBwEwIrbe/f0dWT48TAC1S5VswAzx6h0ZFuOBbAFqUqvoAALIBIITuwqYCspkLQOw44H7gIN0gsnrG5NQAQLv1u8K6DmeWq4IS8FV0GWCwCNDrBkgk/YAsTget5rfeekVmL4sPgAVRAyA0A14bzQpUXnFPfNKlNeIoIoDMAUDyK9MK8EGAf3kBWBwnAFrUghnAyOxvb/7drkrrAv9pELfOoLOICoBrURpBPSFiGBKBgt5iEBJeAFamCQBVhxnAKAV19fdpd7in3TFOi1JMADqGF8w1g3PYe4R2rfgVNYbdhrDMFwuAsdQAoFWzG7hzvCtv63Zu1z6DQMGwAKpa3AAU1h86dzyQzn2pEMkUqXw/HFDfa35jgEzmzYoVADVq6U1k94zqTjXVrr8kEt8CUKMWA4D99+6dCKJ75wDA4Z9HA+nnYQAgJIC+l9IGgAozgFkK+oQkdgCO3zv14lQAnTjuAODosUA6KgYADhElQJo3M2UAKDADGGsF2/QMDaOArMkjihqxmACcu/diTwD1A7A7gAYBAH9IdgIwMSUAqLrADHje1I0A8EFgAZgB4K8HQPJTEcrxA6DGIK1dhxngKfHbNCdDAGBYAHH8TVrSAChIMIjFBJBYAVBjEXJ8lhuk6xdf8y2Ay23V0N8OQE3qtT0gYEtKIQCqfhNmgGe5sKqeRaHIsABM/e0AVCTZMVIoQoAgCUwPANUtMAO8q/0uIwB4LIDNVdXU3w9AxhAiAMYKEBZcAExIEwCo81iGcJcLx4ffAeAfAaBnCiMlBAeZNAPANwMy5PVHXgdwHQnAvwNARjbTAesh1C4MzN9myNx4AcjGo2rrQo1I7BCAANA/aahezcYjNcEAOL+o2jggMUgzAFn95l1eoOf9/tVNPRuT1G6SAZBdb+0IYGaJKQZA5ZsBfAtAzdpKOgDGfyIaAECA7KLAOKQagCzMAJ+iFgCuTjoAJDwAPMm9Q7ojQDbLNQM4FoCrA0g4ANF0AWKlHgB1m8JM93gWwGMN1yYfAPIfgIFqN5kFH9cCyEYvABDhcHCOmAQEHw5OEgDZONW+6DUDuKsGYkkAAEC0E0KIoTATQirkXwCgWmeYASO1AABAtFPCCAk5JcwAQPrrAfjF3rn8vhBFcdx/IKxEQmxsrCTWliIyv1KNiveoMB7xXIhHSUQXzKKEBUHsSCq5FcrImBGvqJSqiIVHQhDvVzxXbNyZaXvQnkunc5t5nG9+9fvJb2Za7mfu955zz72DJAMkpgBwANCi0N4Fn3uTb7XKhGMOQHZrRzIASQFIGowAAMGVhUMyg7/8qrmJgFcxHmMAjAvPU/+TApA0AgAAzl5DF4b4aj9YPsR/7E0p9wuUguUlgwcgK1kqJAPEKQA1K0cAAL40rH8BBS4TPohADWF6tAEQJgNggvjr3z1RpADwWh1A8KFU2xLcRofmlwzAhKxsqU4y4B96bBpqVrLkATAdW1LoF4WmH7T+iD0AvEww0gD80fztb/0KrEEyAKpkLfm6G/YBQncDKG9V5Uo+ACAAIABFHgCjBg8DEKUBVZmSBABOgPsiALgMEwxAZAI1yQRkAwwD8SIX2GiOegBPS3J/VgfjjxgtL1XlCQBAEkGDV0IAMGqwC4DYBEyZXUBXAFZ4qeD0ptm9Smlrk28lAwCj8uK/Z4NrhqZKEwAAk0E/Tu/xpdPf2wRs+nb0/dFOvXde8DP8DQ7gE0r/DcBwmQCoMpVd2PlIeDwZdHaJikgGAOlZp82iH5XM0wDA0QM+dfS/AVCiC4BmNLqlgbEd5SV2AV0B2FO0rl69qvcqq7QHAHh/YL0vHXjPp4P/2fRNAEZHFADNqNzoZRz9xpRGAALA1UKhMNSr9OJvABz1CwD0AHjTexNO0bWArIYsAsdMYPvX4EckAMDNUAKgKJ0NDwBwybcATZJwA8DnBA1NlsIGALeA35ofMgjuVyup7CqyAHADSCm96YUpiYDwAeD0AK0ZBJhHgkyyMjAANElS7bMPkSWA168jv7h7OZfVPCUBgJbJN+96pd0ReGhEHACj8VRJISH/DWx18P2GrC5ADSEAMJXcvPXb3z1FGgB24fkMZAR4/OQJmB8cjAmEFgBHnc8riAEAqs2LQVPYJgD4/jEPr2ieCSQHgOlKHAHgBoA/NqBSgkLRwZhAaAHoPhbir4gDwC7s3YRuFXmBscoTfJewylYtcIUSALSqfKAAaFJkuw+DwWyeMfMFvkLgrITINKQACDRAABYGL6NxB98J2GQLFzITf7TQ06qxMHhp4QNgemwBsIsv0X9e6nnF5kdgy0X4aTOeVxi/SPwBiG0PoHGLR+/vtw3D6yPwx0U8Ktn8QxEAkQXAaDwTPA2slHWOyZZOHse3i3YgCR6AsE0HhwKAccEDYONty6O8lsEbVZ4oRJeKF20JAIStICSuALgDPHQbmLLqHaV+nYk/NvjJBZkAyC8JwwUlYbEFwGi8RmN85U7DEBsFHBc8AOEqClViCkC2fOkiau53r1jtt9Ossw9FQ4WA+wAOQLjKwkMDwMJgxWqIAXiVv+z3I9EdpLgJmEwqALAwJAIMRAkAoQE8+tPaRQlh5VnAJqCVuwKQSjwAwbZ/tnxLsBL0xZ+3tV25gR3KTeAkjxcDEQEwOAByrIGuBOVJYM8AQP86mgAYBAC5AMVqj/H7n6d47T8Px1PG7oChwXLBySIA5AOglk+hBsBrfjsblFXv4yPGi+dLdq5fEQCDBIBhCX7P1KE9gZjzF3Fi3taaxBAA0QDAiesQuUlg1uWU6h0MGQ7G4xoLEAAKAyUDYA2tvIs7+r1TZavLOfqVf5wjEQCn+UPf+BECgFUxA3CTu1XW9SQ0b+DNHTOJAMxasXwZzwWne9ZvqeDZaZ+aHTsAWA0r8/IKvazu72RfEG0l+6bGZAGweNanz4d86fOn2e32//TlsC99+TQ7ZgBo8x5gnblr59i9bJsibu7O/WpJAiA96/PPI77083NaaSr95aBPfUnHC4B5eETnJoEraESHTx64sSM4h0/hABw6cuzVq2O968ghAODwwQ2+dPBwzABgpnArgBcmCoBdeT5DdGaNyQPg1UYfIgC6SNPRud1mWhc/Vzx4vHsioxEAEgHgvXffEhuAlwTGz7bwErJm/oC/Qd+yyqcJgK4AzAtAtulVeeNGLjqbueWBqG6Y9jwCINQA8P71oSKa2S1awrb5uoBPIQgiSH0hARBqAAS3sLfUh/3rfK88EDcBAiDMALjjePwOvnembPnpQQCB56ZNAIQXgJzFk3kpPJnz7N83sFceiGcRylaOAAgtAHxGT9R6D8t67j9GkU/+YSIEQFgBsCuwFQCSBP6fMOKGYK08xJH+pRMAcgDgmbwnIgN48n9Nx6pvRV3AowtWjgAIJQBgAH1F8RaUB2KzyQRAGAHgdZ3HRSHcdTAAocS5RL5e9GXFJgDCCAAyekOTwHhCGC8o9ZYKEQDhAyADKRwfSWDES/BoMjPPhwAAmg4OHACriMzjoElgXLmrZ+8GcS0cACoI6QLAWH4b+xU3ACjmwOL3zH9fnzW8VSX4nLLdx4flAFBJWFcAMv7Fqq+Fvfa9BeVcDzzZlUf/NIF+AKCi0IABsIrnLwbZYragrNRdKnSpaPUDAJWFBwwAa+AG0EwC64Fd0Isp7X4AoIUhwQLAqo8V/D+P/+ZNr+1ledOK+BUfV1kfANDSsKAAAAMQyI3ce2bqtiLSxfNFiwAIBwA8BXRbWTz7b21qiv/Ak8C9Q3Xy3oxNLXVcfLFym0NFAIQCgMyQfmlPpy61da2kZ3qWXjp9CdTl8vpQxp/0EgEQ9CCwWCz9rSKopPtrpyKoy+UzGQIgNADoYoXoogSACIBkiAAgAAgAAoAAIAAIAAKAACAACAACgAAgAAiAkWMzQ8nQVQKAACAACAACgAAgAAgAAoAAIAAIAAKAACAAEgnAmjlzCAACgAAgAAiA5AKwnABINAB8XShvfwIgaQDkW1GAC0B6hrM8lABIhAgAAmAbtwACIMEAtMYA851EkDsGIAASBcC2tXkCgADgAKxxAFhMACQSAD4EcABYQQAkGABIBM5IEQBDyZADQD6/btWqRQTAbxo1NpMQAvTi6R35ZhpgDQHQ1rTkAHBpsweA0/4uALMJgGHDpiQFAMt8viX/51zQ7IjsEicVgKlDCQHA/vh4HeSBnERgZLYJlArApJ2FoSQoY314utoNAlwLoB6gpfFj6kNJ0NX9bIQTBLhRYDsNEI3ZYBkAgKbUE9EF6B+et6eCIAigHsDxgCSYQOHdx6fOEACCgAglAqUAAJq2M/4m8PXdhx87/pgJiFIUKBmASfWJsSeg/u7jnXVr8+AAy6OUB5IDAGhK7Amov/vwfbPXAcAYkHqAliaP2RlvAur7zhV35dsOAEMAAqBtAhPjGwsU6jvffXyWb6UBvSEAAfCHptYnnotrLFDYue/dxxdbWg4wP4IOIBMAIGDizjh2AoW62/6bN/MOgGeB2g5AAHQQsJN3AvV4MVCo13eee3fOaX+nA4AYIGIOIBEA0KRf7Jk/S8NAGMax1QgOhUgHM3RxE9yKo4EORTr5IRwLmRM88qeEZBCF1g+QrY7FJV/Cb+BWdArp1snJ9+5Nc9cuFirNXcnvIHO533PPe0c7UAIpy8CBQO2n4yx/nqN/XgD0n6A6AJvc9j9oBIDRQZBS+1m+WE4d33aszSsgToA6ACLdwQgGAZBuzVhismyS5z/zwOb+ywLgE6AOgEi33xlBc27PRF7yRZ59feo2WfkXC0CtCbCfACBa964/6GzNq6y8vyy/53HgE/TPBwBcAZWbAHsMAHJx/heGoWmn1z3zbfYkBbOSKRDHcRi5xCdeIPp/EP2rNAGEAEhDo9E0tJ45DWMZCAsiIEmStuu6uq4z/aV/eAHQAVAH4H/8Hx0ZxycQgCiUhgjg/j0vYPXP/Q/X/Ss0AeQMQJMG4KadRJWScNqAi4ef6cfjD/e/wj8fAKoVgMwBcHHXq10iIB/tU/14/Ll/+gLgBVAHYPcAtD3Y8qpZ/QSPQgIC9rl+OP7cf1kA90oVgMwBIHTPK10BPfFgPaCfQj6zz9of3/9r/tUrAGkD0DJ1n1SOD4t+GDYF7a/00/ffpn8sgDoAuwVAa5lXji0VDmBR+6z8C/1DwT9eABQrAHkDcHZpOfJgIY949lE/TH+o/9I/HwAqFYDMAfhlvw5SHASCKAwvZyazz2b2OreJCxFBaAQJSqvjAebyqdRLpTtZB3wF+TXkAN/rDtn+CPq/PtZm+jHkxz/3fw/gRQP4PvwuG0XijpZr0fTBr/6jY3/mAcSFK9ibvvDDf8L//9z/PYBXDOAYIlEhRNhLM/hx+z/7O7sAaAfwdTgOgachx4c+/O/Xv1N/5gF0w0zyKLy8wDd98OP4m7+3HwDmARRrt3dzp+jqrvTd2iZ98Nv179SfdwBl0e69gNXCnS8v8HH4M37H/rQD+CyLut01gOfVho/Dn/H79WcewFQTJOxZk+Lj7Is++Bvw+/QnHsB6rgmatNv3qPZJ//n4O/RnHkA/7p6YI8DDPuknfrf+tAP4KH+qM089qtQe+Ekf/D79mQfQVD1Bgp3YYf+gfwK/V3/mAZwqsppGPglf/Z3zEw/gwj4d2wAIw0AUragp0sEADBPZ7th/FEAIGURFd1j/eYPcT5vjeG+Bu1bP6fPvH/zP++sGsMwWq4JIyS7+7/mFA2iThyCzsDrrawfQTUKc5/bgXmF9Avgipy+zvnAAwx6AmwK/KTa+fADCehVj0w1AroBekG4AY8cbAYAAQAAgABAACAAEAAIAAYAAQAAgABAACAAEAAIAAYAAQAAgABAANnbpoASAGAiAGNTA1b/ag37qoCxMoiECIAACIAACIAACxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0DcwADrBNgCPPHtE2CNCbAEeOgGGDPgb88OchsEYjAKS2QmMy60QcoKcgA2SBwEKfc/To1Tkl27qStTve8EUf4ngwQBfOv/B/B8BIzrfYWz+zpGewRYAIMG0K34A50GMAQMIPW3bryYDg4uZuxufYoYQMqlv07TsrzBzbJM07UvOcUL4JRyLqWKtOoDDlolUkvJOZ1CBbCfgHOp8yzyDicyz3Mt52gHYA/ATkAVkVZa/DppRaRuByBkAK8CqsBJfe0fKwA7AVZALtoAXJRadP5t/2BvAI8ArIBHArnAhc2v+4c7AM8CNIGU4Sbp/CH3t+8BmsDWwJDgZND1t/kjfQfYNV8JwJfNH3B/1VgDcNYEnX/TGEJw0ZjI85sGHg6y/u4Yv/Jo+FcBAAAAAAAAAAAAAAAA/OQT3R040atZehsAAAAASUVORK5CYII=",cz="data:image/gif;base64,R0lGODlhbwBvAPcAADS/SUDDVEHDVE3HX03HYFnLa1rLa2bPdmfPd3PTgXTTgoDXjYDXjozbmI3bmZnfpJrfpKbjr6fjsLPnurPnu7/rxszv0c3v0tnz3eb36PL79P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAwAbACwAAAAAbwBvAAAI/gA3CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDOsxw4YIECBOEitRAQYEAAFCjHlDqEQMEA1GzSqW6sQIBrWChTuV60QKCsGjHkp2Y4SzatGsnOnhLV23chhrc0oV7tyEGrHujFkjw4MEECxj6MqzwNHCCCRkUR5QQeEBSyRIj7A1wGXPECnQDPNDgWSKGxmEHJC4dUcNXtAVIs44IOOyC2RIbvH2AO2KGt7d7Q9SrtYBwiBbQDpB9vCHxqAFWN1+Mlvf0hq+1BmB+PSEGtJ27/id8kFo8w9pZw5s3qAHteoUTwiZ4nzBBWPX0B6LOGjm/wbDG+VfQb2DNJyBByYFl3YECJajVggxqBhZ+/pEHlgUMDmShVhjalAEEIIYIQYckbZgViTQ5mBWEIkmoFYUwxQdWBCapGBWLMpkYFYoi2QgVjjHpCBWPIRGolYE12QcWdyOFZcBN6EWFUgBh9TeTkVkFgJKSL9bkYlZIliTjkUneh1J7YdGE5pIpFWCmTGNmFSBKQgJAwEzZZUVjSt+9+dKXWUmH0gBhCcCkShrsF9UALIEWFpB0okXkSQcUKiifiorlko9QEXBoSYlK+lKlTiIaZVRhsoSlVgykxMBb31a6pBtaEJw0F1oNzERqWK2OpMGrfMmkgZtoGfCpRhqcKtixLWFAJVoEXKrRaW9FdxOnUQkAAbMSaQBBpifmFGehEmQkAbjp7TRuWARQUBEFeYLXkwXP7qWABLEmlIEECgQGQACT4oQBsf4aoACIFBR1AQUgKqAsbNLupMGu/la81wHc6jSrxRyDlStZGXDZscUJ5MuVBRSP/NYBAZNVAaEqp9byXRhEQPDIBUQQMWsaTJBAvaE9lrFwGlhgQQSFPRCB0UNn6PTTUEct9dRUV2311VhnrfXWXHft9deSBQQAIfkECQQAHAAsAAAAAG8AbwCHNL9JQMNUQcNUTcdfTcdgWctrWstrZs92Z893c9OBdNOCgNeNgNeOjNuYjduZmd+kmt+kpuOvp+Ows+e6s+e7v+vGwOvHzO/Rze/S2fPd5vfo8vv0////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzbUgEECBAgOGByFYAGD0I4YICgQAKCq1atWCWh4alEDBAJYw4rlSpECArFosR4gG/HC2bRwqz5g61CDgrh4AVSgyxBC3rxb+SLccPdv3AGCEWYwYLhAgwcXIkuu8CBBg8QGJ1DFu6DCBswRHeAdMOEz6IgP4gaYcHrihLgPTLeGmAFugAyzJWrYLLaA7NwONzBGexl4xAVpWRuHqCHtguURC4dNAB3iBbS+qz98izVAYO0MK/6gnQu+4fDuv8sjbC5WuXqFr8Mifr8wQXv6CjegTY+foPiwBfSXEHJhRSAgQudd9d2BBIk1H4ME6RfWWhASdF1YxVUo0IVYkachB6mFtdeHIIp1AYkcNGAiiiFidSKJLV714ofxYWUgiRxe5aGGOVqVoYbsYWXATUwtmFIAYhkJU21VCaAABBjwJ5J9YbknUwRiPXdSjVdRR1OCVo1okoRh0RQkVioVINaNMXFplZcoxWiVAFKuBFaVKjEZ1o4tYSlWnSMdIBadL23A21UBrtSjVXyqJGeYLREYFm4s7SYWhZWiRahKwqE1I0uSCrkSd1jB2dKZWDGQEgNpKbnSo9tWWTmSm1dpGROVYqlKEqvYAcqpmmgh4OtFnaLlXU0ZIImWAa5idMGh3VFa03+aQjAsRBv4BZesNKkIlwASZEQBtHvuBCtWBFDQ7EIbSHAnXD/mNIGycRkgwboRWsCramLylKxhBDzZFAYEEwwBA2DCVYC0PmkArGEQo5XAtTdtEGrEGLPJlQa4YvxXAvgCdYGgHsd1wKeJVfBwyVcdwC1oG0zQccQDPBAyzBUsMEBeASQA2YEXUPbAAws89sAEF9yM4tJMN+3001BHLfXUVFdt9dVYZ6311lyXFBAAIfkECQMAwAAsAAAAAG8AbwCHNL9JNb9KNr9LN8BLN8BMOMBNOcBNOcBOOsFOO8FPO8FQPcJRP8JSP8JTQMNUQsNVQ8RXRMRXRsRZR8VaScVcSsZcSsZdTcdfTsdgT8dhT8diU8hkU8llVMlmV8poWMppW8tsXMttXsxuX8xvX8xwYM1wYM1xYc1xYc1yYs1yY81zZM50Zc51Zs52Z893atB5atB6a9B7bNF7bdF8btF9b9J+cNJ/ctKAc9OCdtSEdtSFd9SFeNSGedWHetWHetWIe9WIe9WJfNWJfNaKftaMgNeNgtePg9iQhdiRhtmTiNmVidqVitqWi9qXjNuYjduZjtuZj9ybkNybkdycktydkt2ek92eld2glt6glt6hl96imN6jmd+jmt+lnOCmneConuGon+GpoOGqoeGqouKso+KtpOKtpeOupeOvp+OwqOSxqeSyquSzq+W0rOW0reW1reW2r+a3sOa4sea5see5s+e7tOe8tei9tui+uOm/uunBu+nCvOrDvuvFv+vGwOvGwevHwezIwuzIxOzKxe3Lx+3NyO7Nyu7Qy+/QzO/Rze/Sz/DU0PHV0fDV0vHX1PHY1PLZ1fLa1/Lb2PLc2PPc3PTg3fTh3fXh3vXh3/Xi4PXj4Pbk4fbk5Pbn5Pfn5ffo5vfo6Pfq6Pjq6Pjr6fjr6vjs6vns6/nt7Pnu7fnv7vnw7/rw8fry8fvz8vvz8/v08/v19Pz19fz29vz39/z39/z4+P34+P35+f36+v36+/37+/77+/78/P78/P79/v7+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AgQkcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59Agza0VYkQnC1EYPSAQiaPIk62hG6U9WfJBgBYs2rVOuKMKakUKW1RsbWs2awr2qwC69BRjbNw477AxDZhIhdx854tkKquQUMr9Aoue8QvwVo5BivWqsmwwE4dFku+4RiYnwWKTWSBEygSKWCfDsnJ8sND2UWGfU0R3ICHnbUMMV3BgFWEYyJ6LbChyKgJIcNc8l54s6tyRT1xNczxZbyiIgJwd/BqXjETA7hdqFfsxWHvH+0V1/7AFQSeoisHZ8eUp7jkLJD1EzMJMHtCF3yJKcwS+HwfIqCzVPQXEQ1mMQCLgA+xMl9ZZCD4UBxmUWCfgw29YFYYFDakoFmhZMhQG2aN4CFDLZhlxogK/TKAWaigmNApZmngYkKOmCXDjAghVxYTOB5Ehllp9GgQE2b9JiRBSJjFyZEEUWGWKEwOFIZZkUQp0BtmDWIlMDpuRceWhpglxpaQmBXElrIEUJYDWwJjglmUbJmFWepZqYhZL7SZgFlRWSmDWWds+WNZEOQSEy4ggPEKTJucpUZMXmCVwBOjvISDWRMY6pIqCmg1wBCXtETJWW68dMRZjrRkg1kOgNKSJf5nleCSJGd9gMtKsERm1iQvzXDWECr1wsJZRMDUCFxxpFTEWQaUElMSZwmAx0ljwKWFTLqEANcWJPlSBVwR0DITKeidJcSEH6mCAlwDoEZTIXGxsKhHj0wQ1x43bRGXBGT0mZEpRix4Vhk5RZEXBGHMclErUiCQlxI7iZfXA06kKtEtX5Qblw49/WGAYBlgQRdDq9SxQwOCOdGLT4xorJcHQWQhByKfAENKJIC8gYUIijXQR1CaVCDZ0GV50IlUsUxxANFEI3ErW6L4wLRiMFhsWCQkTB1XDFVSxwcMWm91Q9fltSIH2ExzYEWcCJodw4p6CbBCGZ7M+AkjepgxRSYPL+iQhBZo3FFIK20WbvjhiCeu+OKMN+7445BHLvnklFdueUcBAQAh+QQJAwAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDNtyAwQKEo0ghYMCQQWhHCw4MAJhKtSpVAQokNHU6MQMEBFbDir3qQANXhxfAjl27VoGFswnTsp3LlkAFuAQrqKXLd6wCs3Ah9B28VoAErhv2El5sdYHQCwIGB0jwYMKFy5crPGhQgG+ArT8leE4QAbTCDRUWBFgbIegDugMibJi4IcKAsAmCTpg7YELGCaunDpj988Lc1hs3NJhqmmeGyGMHNNd4wffPDdDFJiCON6PUsci7/meMsLaBeI3Yxzo+n3HB2ALsM2Z4zz1+RcVVL9i/uFvs+v0VJSBWAPUBGJEG4BlYEXlhDaBgRd9ZFd6DECEoVoEUNvQabhlKdIBY1nX4EAEXigiRWAeY+NB8HKrYkHFhPeBiQwxKOCNDG1ql340K5Zgfjz2KtSOQB/lI1ZBEFtSfVSEmSRCMVsnoZEFQViXllANVSVVuWA60gVgCdElQZ2FN5+RyYU2IZQXaiTkQmBg6+WGMbnJg5FQE1MliWE1iOadVebqpJVVqTvmnVWYSOSiecZK0AQOA1XRoVQqotIFUAtxV06JTXWkSA1Ux0GhLd1LlwEmgWmVAoi1NGmpJxoKNpalMGwQnlgGjYrSBAmsNtylbq36UAYljfXZTjWM5kKtEorHFKkzIgklBRhQQu1afNi25FgESLIvQBhBkx1pPF9haGAMWeMtBBhIoIO64PmVg7lwGOAABBUvlSwEE7kr27E0bkMnYwFMdoO6x8xLMl6dOaSCgwnwdgCRcFdwG8VgS71fBwxcXPLF9GjSQ8GAHPBBphhlEkMDIYRXwwMcuZnDZAzTX/PIFB9ep88489+zzz0AHLfTQRBdt9NFIJ6300iMFBAAh+QQJBAAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDOsSAwQKEo0cpYNggtKMGCgoEAJhKtSpVBAwkaGhK8YIDA1bDiqVqQCtXhxcQjF3LVgEFpmcPpmVLly2BCnEJZlBbt+9aBVvjSvBLeK0ACFw3KCjMeCyBDEEzECBcoMGDBxUuaL7woMGBAYQFQPY5oW+ABBMCL9wwIUFf0T1L0x0wgeKGCAXq1tYpey3tjBUC0N198wLdBxw3NKA7umYGqWMDXPiYIbdY4jSfrz0A9+OGA1YD/mCnOXnsgpILqAZoXvPB2vMm06/HqQF6WPgnH3S3uVjsgbwdVTBWAfsBeNEG5YXFnoEX9WZVAwxu5FpYAxQYIUUajIXXhRhFIFYBHGYEVlgRhHhRhmJZaCJE7oWVwIoWTWjVeDBCBF5YKtbYkFgD6DjRBv75KJFxYUEoJEQOUoXckQ+1aNV0TDrkZFVQRsnQlFRVaaVCWE6l5ZYIJTnVhmAmRKRVS5aJ0JlVpammQWxShd+bBQEZFgF0IgRaWKrlOVB6YdGYp5gAzOknByhaJUCOb+6J5qEEAWoVnpAKlOiMlQp046SZchCnkp1u+mSmn061aKaiVoVAphkIJxYDxZl6OBaslcoYFq0jfZnTBo6GhQCjGG2glqA3ZcCWAQtqdAF0sMVGlwPASgSBosniRGhVApBpEQUJYhvtTNdWVVafEHF77LcyXeAqXW6h+1RUfWm7U6uEEYCAAxAQRZRREDAwYl8DVKtTdY0VXFUC6N70wLoGE1ZiXBrY2jBbBwgs1AW9TmzVAbrmxZrEE3Nc423WFVyZxSFqEMECBzAcHWrkbrnBBRNcZvNmneas88489+zzz0AHLfTQRBdt9NFIJ620TAEBACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM21GABglEGCoxCoIBBaMcMEBAIAEC1qtWqBhhI0OCUogYHBK6KHVtVAYUNXR1eQEC2bVsBDC6kTbjWrV23BCrMJaiB7d2/bRVwnVthKuDDYwVA6LpBAeLHZA1kCHohLOACCyZc2Mz5woMEAxBP+PkA8AK9DTdMKAB4NM8JdwdMQCtRw4PQdl3nhO1WdsYKuNvqtsm7bQPaGTc0sBvhZvGxAeR6zHDArfSZF9wmQP5xQVsC3GH+GmjbnKR3sgpmlia74OT5sahfajAstj3K9WIFDHbpeKz9lAmw91IFZB3A0gYBXBXAAzBZJtZkLBFY1QLhrSShWA28tNwBEML0nlUDVJjSBvHBtAF9VpW4l0bPVTXAih75dRWDMG6kAVn71YhRBGMVoONGy4k13I8WVSeWiERKhCJVASSJ0QZjGeikRdlhOKVF+FlV3pUTZVnVdVxG5CVVYIb50JgAlGlmQ2iqueZCbb4JUZxyOoTmlnUudKFV/+WpEJRiEeBnQ6yJleOgB31Y1ZCIFtQiVX02WtCNYx0q6UDBWUXjpQWhKQCSjVIqFp6cCqQoVeCVyhdZGao6UIDK8LkqUJX5gYqokWKlJ6sGCY61mKx7XsWArBzAOtawrm6QqbCy0jqWZK7y6JYDttb56FUCqEgRBQhUu9O1VxHggKWpUWDZpl2BK5YBZzlkQX9V6beXumMRkJQFGGBwQb4YSMDAeOitmEGhkD3mplAP9FowYAbUqIGxC9+lbVrARezWAQfPdcECClsMAMZcqgbxYwM8QO6UGkSwAMFuBXDAAx0iekEFD9ScwAI1P3DBycT27PPPQAct9NBEF2300UgnrfTSTDftNE8BAQAh+QQJAwAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDNtyAAQOEowgYHIWAQYNQjhosODAAoKrVq1YFIJDg9OnEDRIIYB1L1ioBB129MtTAQEDZt28VXFCb0AICuHjhGphLd2AGqnkDv2Wwoa8Et4ITkxVQwauGu4ojk0WQ1ucExIEHJHgw4cKFDBcqPGhw4EBiARN+PhCcYELlhBsiFBCcmueEvAEavHaYoUGAvLVz3oY7YELhixN+ww1uc/jbBxw3LMAL4aZzsgP4drwwAG5jmhow/o9tcPyj9LcCdruETDZCyellEcy8jnXBSfjtY24Qf9U+ytWLZQATfvWt1EBZBrx0QVkDlIfSBt2R9R1LgI2lnUoLTtZSBmX519KBZKn3HlkBOMhShAWqtB9ZzLVEX1UCmFjSiwAEINMGymHlXkoVXtXATCBi9SNKHIY4kwZXtSYjSQBidUBNCyww4UoEWtViXxr1aNWSWF6EXZcdFekkmBzRCB2ZGjV51ZRoWqSmVRe2WdGbVcUp50R0AmDnnRHluSefD/kJ6Jxk/TkoQxGQdeahEYl51ZOMSrRYpBKZNpaAlAaaX6YOVUBWApw6tEFZIoZaEIo+moroYlyqKhCOyiy6qlCVVREga0JIKnorQpZauKtBnpJFQKuuzkbWkL/6lSNW1SU7UKJlMeDsQL2OJe20GiyLFWHT0miWoabmeRW3yXqbFQXOmpsVA5jequ5VBkhA7EAaUNAumcklZgACDkBgAQYZFEUBBAog5iGaGlQr2aR8VqDtwlfd2+Z5EI936AXGVlxrpBckoHFVEgOqQQOoRrZjphpEcMDDZBXQQAXzHqrBBQ/UvMABNT/gWczT9uzzz0AHLfTQRBdt9NFIJ6300kw37fStAQEAIfkECQQAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzrUYAGC0aMUMGDQIJQjUQgIBACYSrXqVAEKJDBtOlEDBAJWw4qlSoBBBq4OLzAYy7YtggtoE1IA27YuWwQU4hLMYMCuX7db0UqQ+rewWAESuGpAYLjxWAUbgk4g/PdAgwkXMmeO8KBBgcICzvqc8HdBhcAKN0xYEMDvhJ6k6w54EFnihggD7L7WGZttgQoZJ+Ruu/tm77EPOG5oULc4zQttB8D1eGH4WOcxN1AOu6D2xw0L2P4KQA1TAdsFJcOPRTCzwvmT6sVGyL69KnqU8a2OLz/2fsr8VRnwkntiDeAdShtYZxV2KdEV1nQrQScWAS1JGFYDLzEnFoT/FXggS59xt5IGYwEH03FVkVfSAwXOpCBVyTUoVowxsRgWhShZaNWHLpEolooiRSCWfzIBOJWJJhkJAJIyoTgVjSX1FRaPL2Ug1gEotWjTYSdZGVYCNx3wo0lOAgDlTBpaxaRINqp5UwUHPPAAZhyS1GZVdeql0Z1U5aknRnxO5eefFgUKwKCEUmQooolKZCiDjVJEoFUYRoqRj1ZhaSlGrYW1KUZihgXkpw8ZuiapEE1qH6oUYbojq8cTvfgkrI5OSGtErlZ16q0KKSkgr2khB6xDsgo6LENlAkAAlccSFGJYDDSrkAadQittQkKOFe21B4Uq1rbcEkQtWwww22yyUxHA6LDoTuWAuezWRUBe4QrUbroSwHvrvVcxQIG+rF5QrV0GOACBBEolPGqkGyTgmFVnohrBwI2ByasG3jamKbATZPzXr8de4LFd3GawQLFi1cuBBhEkQLFV6w6rQWYTyGnzAwurrPPOPPfs889ABy300EQXbfTRSCet9NJMVxQQACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM21IABAwUISJNa0CC0owYJCgQAmEq16lQBCCAsbUoxAwMCVsOKpUoAAlOuDS8gGMu2LYMLaBNSMNC2blsCFOIS1LDWrl+2Bs6ilSD1r2GxAiRw3dD3sOOwCAT7rFDYb4EGDyJc2Lx5QoMDhwVM+DnBb4AFEzY0zFBhwd/RPEvXHRBBtcQNDwbYhZ1TNtsBvC1WKFA3eE3fYxvY1tig+E3kYQfA9XhB91gBGWpqqBx2wXKPG1z+X/8Os3H3kuLFKpgZge2Ck+nDVoiZgXvV9yjjVxVAfiVdsfillMBY67kEHVUD9FfSBgGMNV9LYIk13UoVjEVASxeM9cBLA0rIkn5TFQDTBtZZFSBKGjgYU4ViKTjSA2INMFOJVW2YUoRW2RgTjGFdiOJYLq6UoocnsWhiTSACEAFKPFr14ExG3ocSaGFJFtMGYhmAkn1T3UQjVScNadUBN1FpVXYlRUlVAzc1WZVxIblJFZwriqXji0TWlGFYd4ok51QT0rRnjib9CUCgMw1aY6F5Cmono2EhKpOiVPUZp1hP0pTBAV9aCtKBAHhK0wabPWBlSBmIRaZeH4nlI6vSHREXVpCwUpRkprVi1N55uWpEKVW09grRl1OJKmxEhr56bEViOrnsRUkSEOyzCv06FZvUUkQsoNlOpCZZ03ZrUIdhMSBuRAyOZe65D31L1brsNkRuufE2lK664bJrLVmS1lsQqFU54K9CAFNlgAUDI1QwWWYl/O9fDFCApsMTNGgYAg70K64GZv5lrLgRWOwXrv5qIKtdGtc7wbZWnerwBUmC6TBCGuQm1swLaVDBAwc0uCrOQ00M9NBEF2300UgnrfTSTDft9NNQRy311FRXnWtAACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM21IABglEGCIxCwIBhg1COGiQgEACgqtWrVg04sOD06UQNDghgHUvWKgEJXb0yvKCgrFu3AhhoUJvwgoG3eN8isECX4AYGeQO/NZChbwWqghOTFSDBqwYEiiOXRTAX6ATEgQ8caPCgwoUMFy5MeJBgQGIBFX5OEFwgQlqFGiYkEPyg52q8ARoUlqihQYC8E3bedhsg+MUNE0y/NX4TAt4FrzE2wMuc5nCyAy58vKC8bPWYGjD+j4UecsP0sgIqy4RcdkHJB24RzIzg1r3JBW5Tw8wg/mqElPgtFt1Kd5HVwEoBjvdSBWUNMGBJG3SHlXYtsTcWhStdUJYBLWlQVm0uzUbWbioleNUAMG3wm4IqbdBfVd+xdJ1VAjw4En1jBWCjSitiFSNJYo11oEznYcUhShuUpR5MHo6IEoNjJVDTAWT9dxJ8Y1k504xV2WcSlWORKFOSYx1pElkB3CShVSdlQNYBN4GJlZgi4YgViDVh6aNJel6FIU1Q3sknWX/OpOFYeI7Up1WFynSooO8RetOjVyUq0qJVNRoTpVZZGhKmAGgKE6dVeQoSqPrVRCoApn7EJav3N4Gq5UhujgWnTXJeRadIZBFwU1koFUDWjizVitWt95H1o0t2VooSqPIBuiYAqZZkLFZLypRBBMJWRexH3WI15E0aRODlSa8K0NdHKiq7rkcm0vjtuxFde9W59GIU7oT5arQqAATM229D8VrFwMAYtUvWwQhbFOhYDDdMUa6QSsxbj2M5ILDFBb1qlqgcJ+SxVRCEDNHIVRFAwcYho1yVAA5ka/JBoJLV6swDVYCxdzgvpAHFY7FscgQ7WyVlzw1lsK9VsyK9UAUUy+w0bAv8VsDUEm0QwbJYd+3112CHLfbYZJdt9tlop6322my37fbbcMct90oBAQAh+QQJBAAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDOsRAAYJRBQyMQrCgQShHDRIYGABAtarVqgIQQMjglOIGCgquih1blQCEpl0bXmAggKxbtwgupE1YgcDbu2/jziWoISzev3DRpoXQFrDhsQIqdL0w9bDjsQo2BJ1weECCBxcya74wYUEBwwTk+qT8t8AEyQ0rJAAcoSfptwMeCIa4YcIAvBN2viY7QDFG23dz44xwtwHqjBsaBL954e0Brh4rBHgrfOYGu2QXiNyw2i10mX7H/mon+cCtgZkV3I4vucDtg5gaCottjbI94tksEZBNsNK+WAUvNTdWAMel9NlYvrHUnViirZQBWQS0pAFZDbyk3FgNpuSfVQMUuNIG04m1HkoTjkXfS+mJJYCHJZUnFoEy3SZWdSdhd9V7Ml14FX8kksWihGThN9JuVY0Y04FXncjeWDTGRCRVFZ7U2FVCvlTiVQectMFYA9wUolUCnJTiVUbKdMBYP37kYpI36WhVhiKt+eZNxM1nkpxVwSmTgDfeiSFzY+FI3p828WmVoCPhSZWeMRlaFaJxElqTo1RBGlKdbBYaqEmUAhBlTZgeatKWYmVp04JWJUjSl1jdZKNV5Wl+dKZYsbJ0pVUFoORmVU3C9KSnKIVa1Xk0bchrj2NVaWuQKc3ap0yKAtBlSr9GGNMG8omaEogIxhQtALWGZCxVBIRb0qtFstQpsC9l4GxVypYko1jfuQQcVWWiNOZVCMi0gYuMooSqVQzMpIGlKmnAKsF7efQtAAU3zBGSYkEg8UYPuhXZxRn9ipWqHFPkcVUOmBuyQiMDEEC8Jzc0MsItQyQsVdPGbNEF81IFss0TcVeVqTxjJB0A9QZtkQZKGq300kw37fTTUEct9dRUV2311VhnrfXWXHft9ddghy322GR/FBAAIfkECQMAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzrcgIEChKNHLWDAILSjBggKEACYSrUqVQEKKGhoSlGDBANWw4qlasDBBa4NN1BQMLatWwRn0SKsQMCt3bdx5QrUwPau37YIMuiFIOCv4bYSuGaoe7ixWAUbgmYo/HfAgQYPLmi+UOHBgwYFDBMQ7PMCZbsJJkRmqGFCggB+J/SccLdAhNUSJwy4K1snbbcDKmTUbbf3zd9tG+DO+MAu6ZoZ3BZ4zvEC7LECqMfcwFjsgeUdN/4caJudZl+xC0ouaGtgZoS26U2uH/sgZvSx8U/ODytg60up3q003mMvXTBWAOCZtEFoYuW1EoBhOZjSfWERkKBJBopVn0sNjGVcShBWNQBMG1xnVQIraeBhTBWMdeFI+4k4E4NWRaBSd1VtGNN7YbWHkophITgTkGH5ZxJyVeUnUwJi2aifWB/GhCRVSpKEI1VGyrRBgAqKNaJNu1klwEkZWlWlTANaRaaGN3UYIYZs2tRcWFGGNOVUwtlUZo4mzWmVhDLtSZWOI/lZFaAxCToVoSIZShWiMCkKAKMhOToVpC/dCUCeJGlKaUyWAoBpR5I2cFOoo3K0ZVgH3BTjo+oniUXATVdO9eJHaVZ1K0tEVlUASkzSWZOmpp4UKoo0vTpVnSL1qutMG5xWVZYl0ViVk6B6qRKPVvkYk7RUquQsVZy6pCkA1JoUrJi7mlQrAMiqdG6xLYUqKksbhBmWdihJCkCrLbUolgHtghTtWKmStK5VCDw4FsAuaWCiVQykdG4A/K5kLwAVo6QsAMyypK+wKLkZ7kwZTHyyxVQVUPCEKv/K0m8ZR+rryyFdELKUUw2As14WTYAx0CX9TPTRSCet9NJMN+3001BHLfXUVFdt9dVYZ6311lx37fXXYIct9thkl2322WhbFBAAIfkECQMAGwAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4ANwgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzbEcOEChKNIIVS4oEEoRwwSFAgAQLWq1aoGHFxwWjGDg6lXw4qligACBq4OKyAYy7YtAgtoE1Ig0LauW7hxB2ZQYLfv3bwSwPodLBYCVw0GCCsei6ApUAyC7RZo8ICChcuXJzxIEGCwALw9LUQeG2ABBccLMUTg3FdCzwl2B0RADVHDgwF2I+yEUHfAhIwTcLf9jTNC3Qa0MRpve9amhbYFmnfEIFysAOkyNYy2WiA5Rw0J2P4K8O5y7dgFJR+wNTBT/dgGJxewJf6SAlvdKOVbJ5/SfNgEKxXw3kvPiTUAfyNpIKBY2Knk31UNolRgWAi0NOFV+LWkX1j09WcgTBp09t9KGIzVYUvLhYVgSO5dNcBM1VmV4UkHiDXjSylaxV5KYgWwYkoajJUBSvaNSFN4Yd04UgM21gRbWAeglFhYEb4UZFgEnHTlVQHcVGNYJ11YFYA2fQmhSWJS9cBNLVoF2khpArCmTTlWpSRIT151okxxzklSm1W9OVOfJgFKlaB8iuXnSIYCgGhMhKYn1qMw1UkVBSZZCsCdMDVKqUeR1uSpSSUaWROSV33qkVhR2rQdANc/chRjVbGmVOpVBaBkplV74qgoSo2SOROqbqKUwVi1mqSdWCotiGF7rKqkaZYyvbqoScc2CVOeVw2pErFVjQcTXVCyxK1V6LmkqaMt7VosS7de1Sq8BlZZkgbkhqVqSUxalUCyH/EVrZUiBtDrSY0eGpNx0bnEAFvXuhQxSho8PNa8eWGEGFs+ZqyRu2d6nFGR2oqc0YYymryRBrMerDJFtwZg78sVGTfAzDRXhFzOPPfs889ABy300EQXbfTRSCet9NJMN+3001BHLfXUVFdt9dVYZ11QQAAh+QQJBAC+ACwAAAAAbwBvAIc0v0k1v0o2v0s3wEs3wEw4wE06wU47wVA8wVA9wlE/wlI/wlNAw1RBw1VCw1VDw1ZDxFdExFhIxVtJxVxKxlxLxl5Mxl9Nx19Ox2BPx2FRyGNTyWVWymhXymhay2tby2xcy21dzG5ezG5fzHBizXJjznNlznVmznZnz3Znz3doz3hp0Hhq0Hlq0Hps0Xtu0X1v0n5w0n9x0oBy0oBy04F004J104N31IV51Yd61Yh71Yh71Yl+1oyC14+C2I+E2JGG2ZKI2ZSJ2pWK2paN25mO25mO25qQ3JuS3J2S3Z6T3Z6V3aCW3qCW3qGY3qOZ36Oa36Wc4Kad4Ked4Kie4aif4amg4aqh4aqh4qui4qyj4q2k4q2l466l46+m46+n47Co5LGp5LKq5LOr5bSs5bSt5bWt5bau5rew5rix5rmx57mz57u057y26L636L636L+46b+56cC56cG66cG86sO+68XA68bB68fB7MjC7MjD7MnE7MrF7MvF7cvH7c3J7s/L79DM79HN79LP8NTQ8NXQ8dXR8dbS8dfU8tnV8trX89vY8tzY89zZ893c9N/c9ODd9OHd9eHe9eHf9eLg9uTh9eTh9uTi9uXj9ubk9ufk9+bk9+fl9+jn9+no+Oro+Ovp+Ovq+Ozq+ezs+e7t+e/u+vDv+vDw+vHw+vLw+/Lx+vLy+/Pz+/X0+/X0/PX1/Pb2/Pf3/Pj3/fj4/fj4/fn5/fr6/fr7/fv7/vv8/vz8/v39/v39//3+/v7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gB9CRxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDMpxlKZCbLEVwtODh5EyfSLOEchSVJQSAq1izZt0wBM8rqRRHgSmhtaxZrCWeMALrkI6Ks3DjwkjENiGjEXHzxmVxqC5BTzn0Co6LIlBdV0kMDF4MV0ctqZAqMJ58tkOmoH8QLO6wowkaQJx8gUp0pwwTEYsT6PnJRoDgDEwkNTS15sYCwUt48Tyid8GQQhTFTNDbQyetGHkHCDl1EVcZC3ml5KyRVwamjbnQZIj75maZuBwI/n20hQMuAUE1Hyk+i2OXSCdwFVSaSUsDXCG9SMYpcNZD/pg/wPXESXfAZUZMi8A1REpRnNVAKzC9cNYHt6h0w1lEvJSgWQ6EslItqJUlwCUuIVdWAOixlAkBZrXQkiJnAfFSEWftwdIMZhlAykuo3FYWDCtJclYSMVlx1ioqXWGWAqzERAsFZqmhUgpmWTETFWa5kNIrZ8ky0yZnpYKSHVnWBIJZZ6AEhFle1ISFWSygJIFZlNTUiVkHnLSKWRLcJFlZppg0iVlB3LSCWYqYJIhZZNy0Zll1mDSHWXLcpAWbJn1hlh83FViWESYtYRYiNwlZlhAm+WAWiTZpYlYT/iY9qtUjNxli1hYmTWFWHjeRWVYaJrVhVhg3nWFWpCUNYhaoNjVYlmEleWKWDTddWFYjJvUyQFkf2NSLj1kN8JhJF5RFgCo1IWKWCSgFVtaBNOlaFhQo0WHWCTWdYBZwJ82ynlafzDSLWQmoRF1ZWMx0aVkyqCRsVg0sUYpMsUCAaUquYDUBF17O1MVZrKb0wgdw6FKTLRaXVQNLo+AExlmO+NVRJ+BmRYPMHNXSwVmL4LyRDmfF4LNGY8DV89AXtXbWgkhbpARcH+TSNEW22ABXh1NPpApeZ6GYdUSwVBFBXFF8/ZArUTyQFxJmO+QKA3qJ0fZDKMRlAB9zP4THStV05e1QLxiYZcF1fj9EhlYGIOFK4RDZ0gBWO3jCuERMAEDCWpNLNIodmXfu+eeghy766KSXbvrpqKeu+uqst+7667DHLvvsdQUEACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM6xGABglEGDoxKwKBBKMcNFhgQAEC1qtWqAhRAwOCU4gYKCq6KHVuVAISmXRtWMEC2rVsEFNImvIDArd23F+QS1BD2rt+2CtB23cDgr2G3ELpqYHu48VgFG4JmEGB4QIIHFS5o3vygQQHDBjL8nPC3QATBCjdUWOBXQIWeEO4OmID64YYIA+462NnAboAJGScEsPsgJ+m2AR5E1rjhgV3gNie3LVBbY4bhZAWIprmB8dgEyz/+bvicvbrLvmMXlGRN1kD4l87JQi95PH1MDW0bpGQ/1vx+sgWsdABZCryE31gBvHfSeGTl1RJ6V223kgbYXYVASxeQVZxL8Yn12kp1iZXgSxtUaJUBK2WgYUwRkKVgSR1aNWJMuYk130neWRXBTPVZlUBKG5BF04FipdRjVT/SRN5VH5qUwFg3smjfSZSJ5V9LRJ54kopiBWhTjVedlKFY+tk0YJEmjXnVhjX1JpaDJB1J1Y42xVgVnCPZSRWeM1UwFpt5jsWnTGpaBahI/Fk1aEyFVnVoSHoCsChMjVL1KEiRNklTpQBc+hGnnsI3lqYicVpmTZFO6lGQYh1wk5vjV6nq0VWWRSlTjlVd6dEBB2D24kxZVhWAXh+1KJZ6xHb0pI3JduRisxtF6iW0GG1Q5VV0UntRpABIqK1X11rl6rcWcSsruQtxCgCy6EpkLVm6tpsQrlWxK+9DhcF7L0RyVpXtvgzl+x3ADW0Q4lgF/ErwXvQK6+3CBW0AQbgeQoyQBBSTaXFBGlAwlV3/QpyBBA2LaCvBy/oVwMMQw2oXdRsT1O+xCi/MZVsJxLuwieKea/GZVhVAaswGdZjABDUTPdAFCwyt9NNQRy311FRXbfXVWGet9dZcd+3112CHLbbUAQEAIfkECQMAGwAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4ANwgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzrMcOGCBAhIJRTNILSjBgoKBACYSrUqVQEKKGhoShEDBANWw4qlakACBq4OKxAYy7YtgQpoE1pA0LZuWwQW4hLMQNeuX7YKmMZ18LdwWwdcNfQ1zDgsgq1AMYD9WyDBgwcTLGiecDlBgcIGzvqsINVuggmCF2aYkMCvgLw8JdgdMKHihAF2a+uMUDeA7osTAtT9bbNC2wAPIGfU8EA4W9g1MZQWO0B0Rwy4xwqwLlPD2rEFlP571PB5rAHxMCeLXVByAVsEMxuwfXDyAdsGMTOwZY/S/djULS1mVQEqkTeWAi9ZMNYA6JmkgXNhQbeSgFQFwF1KGEBYFXwsGScWfS7ZJ5aEKH1nVQANpvSgWASshMFYxLXEm1gXliSiVQPMlJ1VEaikXlUxujSBWAaoOFZNY6UY0pBhJVBTa2EFKRKUVknp0oxWOXnSdFUBmJ9YAqAkFoE2lWfVSfo1eROVVSnpkYJhgVjTjVWRGBKcVslJE51U2QkSlkDexCSPJvE5lZ8w4VmVniJZcNmjl3kpk6JUMaqXRpROZemlGA1aVY+ccmQoAIiGStGopZoqEZtUualqRN4/UvVqRmmeOCtGgFKl5a0VsTqVlbw2pEGSwVLkKVVkFiuRiZ8qK1GuVNXorEIacElVjtM+NCqp2ToknVgHdCustX2Ku5AGsepq7kIMsCXpugMRNhZ+8BqkQbtjhVtvQeiyFd6+BH07loUAC6QBBOTWWfAGEiQcKMAUMAtjvRlIoIBfAaSqKgYXUICUAun6Ky2vBzQ21QGuzlpyY/SKu3JhCbzr7Mt2HaBxsTSzNcDNyuY8YAQjm+tzAKelbC5nEWhm9MJMN+3001BHLfXUVFdt9dVYZ6311lx37XVJAQEAIfkECQQAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzbUgEECBAgOGByFYAGD0I4YICgQAKCq1atWCTCwsOEpRQ0QCGAdS9aqAgpdvTakgKCs27cGKqhNeKHt27tuEVyYS1CDAryA3yrQwBdC4MNvGaQNuuEv4sdkDRAGmsHA4QINHlzYzLnCgwQDDgvI8HMCVbwLKixWqCFCAcACJvR0gHfAhNUPNUwIfRfCzgd3A8jGGCHA3QY5J9x9gNvihgfG3cq1meFtANIeNbwuO7qmhtNkC/4037jhgFsD41lusFwWOckFbhXMhF92eEnlZSPE1OB2QUr6ZE3mkmNjJbDSdmP559IFZYm30gbRjSXgSnZhFcCEKVVHloIrVVDWAy8BR9ZeK7FnYXonQUgWAivxR5Z9Lok4FnYo4YfVADKpOJZ+KSXw4kwyXmVAShuUheJKRqLk4VgF1OTjWDC+RxaPM0VAloEpXvBZhBjC5CJWArSkgWc3IXhVl3xl1MCIaXoUpFUktrnRm1VNJ6dGDI4F4p14krUnnxjliZV7gF4k6FV/FlrRklglquhEdAIQ56MTrTnWpJRGZN5YmVYkFqedSqQhVk2GGpGVCZoakYlX2akqQ9ZfYvXqQzZeheWsDH2KVZS4HoTqWEf2ugF4V5Xaa0KRAuDqsQV9R9YBzCK0XlmYRitQhVjdau1ADLiFJrO1YsXhthx022Cwqk5b1oXkcnABsRbSGO0Ghr3Fa68UwKuntRtIoKtbhOK6gQXmBrfsnQ0owBQGDDcMAQOs3lWAvIDqC1lVCaCrVqwXW0Xlo4x2DEAC3/JpaccHVPvoppAdcC+lkA3wQMmPasBbcAlotu0Fnj3wwAKZPTDBBTS3a/TRSCet9NJMN+3001BHLfXUVFdt9dVYSxQQACH5BAkDALoALAAAAABvAG8AhzS/STa/SzfASzfATDjATTnATTrBTjvBTzvBUDzBUD3CUT/CUj/CU0DDVETEV0fFWkrGXUvGXk3HX07HYE/HYU/HYlHIY1PIZFPJZVTJZlbKaFfKaFvLbFzLbV7Mbl/Mb1/McGDNcGDNcWHNcWHNcmLNcmPNc2TOdGXOdWfPd2nQeGrQeWrQemvQe2/SfnDSf3HSgHLSgHTTgnXTg3XThHbUhHbUhXfUhXjUhnnVh3rViHvViHvViXzViX3Win7Wi37WjIDXjYLXj4LYj4PYkITYkYXYkYbZk4fZk4jZlIjZlYnalYralozbmI3bmY7bmZDcm5HcnJLcnZLdnpPdnpXdoJbeoJbeoZfeopjeo5nfo5rfpZvgpZ3gqKHhqqLirKPiraTiraXjrqXjr6fjsKnksqrks6vltK3lta3ltrDmuLHmubPnu7TnvLXovbjpv7npwbrpwbvpwrvqwr3qw77rxb/rxsDrxsHrx8HsyMLsyMPsycXty8ftzcjuzcru0Mvv0Mzv0c3v0s/w1NDx1dHx1tLx19Px19Tx2NTy2dXy2tfy29jy3Njz3Nv039z04N304d314d714d/14uD14+D25OH25OT25+T35uT35+X36Oj46+n46+r47Or57Oz57u357+758O/68PD68fD68vH68vH78/L78/P79PP79fT89fX89vb89/f89/f8+Pj9+Pj9+fn9+vr9+vv9+/v++/v+/Pz+/Pz+/f3+/f7+/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+AHUJHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM2fPWIT5osQFjkePLljSBLr4RuXHVnyQUAWLNq1fpBjCepFBtlMbG1rNmsJ86IAuvQkIuzcOOumMM2YaAUcfPGBdGoLkE/J/QKjuvjK1tXNQYrhmugiiqplzIsnnw2AqWgdhQoFnElTR5FnHRp+qPmio4NihkE8nkrimAGONqsZSipygTBA9r0BKIXghmKhJgw0Etlp5a8EtDQujgqiYC8M2DhjBO3wppbGyu9jUvjpqABcG/+1PooSEPcNTUnLYC7RSSuHowvy7SF4SyBOyRzIYGrQZbMMnDpcZIVcCUR0ykNnOVFSkbAtQhMS5y1g0qzdHBWDC9NEoBZI8yyEicJmvWISyWYNUBoLPVxlgwtFXKWFC8JcZYjLTnCw3NZLZDKS5uAV1YNPDpxAFZgxPTEWZbAhEoXHCwHEykJmPWFXx9xYZYKVHq0ylmsZNkRC2YJ6OVGYZi1xJgbRWJWBGhuFIFZXbaJURFmYSInRmSYVcidF7lhlh18WrSHWWkEWhEhZnFhKEWSmLnoRI2Y1cSjEtVhVhiURlRmWXRkChETZiXi6UMvmPXJqA6htpUAuaDKUCn+G25lgasMAVjWD7QuNIJZ+OWK0CZmHeCfrwd1YRYOxB4UywNmwZGsQVaWRYArzxIUCgJmYVjtQESclce2AkFyVgjg6pKKZGYxAq4tKJwFRLlBnFVAJ+B6ARcW294yBVwOtFJtKCTAJcAg1SLCLFxyPOuJELGeVSSxpkBhQF5KULlHE4ZMBEsXIcZlQ5YeYEWBFZI0JAobNwynVxO2UDlIWRvwcIUagGiiCyeK4IGGFSEPxkAdXsJAmWIbXOIlJUMPZkQsYw6RdF4sZDwmKAQ8fVYLisgpCZhWaxXDIYaaogbXQ2NARV+Zit0CjnkFcAIYmRCrCSFxhBFFDivYcAQhFmO40Ycp5QYu+OCEF2744YgnrvjijDfu+OOQRy55pgEBACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM23IDBAoSjSCFgwJBBaEcLDgwAmEq1KlUBCiQ0dToxAwQEVsOKvepAA1eHF8COXbtWgYWzCdOyncuWQAW4BCuopct3rAKzcCH0HbxWgASuG/YSXmzVwIagFwQMDpDgwYQLmDFXeNCgwGABW3tK4Es5QmiFGyosCEAXdM8HdAdEeCxxQ4QBdCfsnDB3gG6ME1izPYzzwtwIHDc0OH4zg+SxA05vvOB57YWaG56LTUD744bqYgX+dI9ZYS3ykRsWrEVQMwN4qg1Oqh/7APv8qQtSwh57vWYF1gWslMBY7NmkwQLjnbQBbmL1hxdHGRD4oEcR8DdhRwxaVeCFGvEmFmAcZpRhVfWFmNF+Vh1gYkYbCGfVihkNGJaDMFJUYVgl1khRhGEZoKNFLlaV4I8PyWgVjUQ+hGJVSCbZ0JJUNenkQjdaddeUDxmHI5ZZipUjlwtpadWXYMblZZkMVVnVeWgmBOVUUrY50AEfypkQnWHZidAGYg2g50EepvinQUauOShBGowF4qFqUhXgoQMRIBabjI41pJ3ZbQepQPdZ9duhYgoK6QZSiSUdpqWGFR+kDIwVwKXCbbY61qd/CjbWo39uoMBaA8CK0wSnZpSBpK4Gm5OWDvg60WhsGYvTBsQCIAAFGVEQ7axB7WoVARIom9AGEGhnXlCNViUAAxZ4K1AGEigg7rhA8UiXAQ5AQMFS+FIAgbuTOZtTp4wFfIC6OEUQZMCDkSmUBoUiPNcBcQpVwYgOhwXxihU0XPHFOmrQwMGEHfDAokRmEEECIItVwAMRT5kBZg/ELDPLFxC86c0456zzzjz37PPPQAct9NBEF2300UhfGBAAIfkECQQAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzrEgMEChKNHKWDYILSjBgoKBACYSrUqVQQMJGhoSvGCAwNWw4qlakArV4cXEIxdy1YBBaZnD6ZlS5ctgQpxCWZQW7fvWgVb40rwS3itAAhcNygozHgsgQxBMxAgXKDBgwcVLmi+8KDBgQGEBUD2WaFvgAQTAi/cMCFBX9E+NxRgO2ACxQ0RZtO13XNDALG1M1b4zZY3zwzEqT7guKHBbp/Ipwa48DGD7rGjeU4AcADuxw0H1v4a8L6TOskFaxnk9Yh+rPH1GtuHhQ1/Y3ixCOpv9D3WvH6MF4yV338ZPdAfgRmBFlYCCGK0nViqNUhRclUtIKFFBoZFwIUV8RdWhBxCJF9V74X40INWNWCiRBqIZcCKEiloFXkwMuRaWP7VyFCGVuWoo0I8VuXjjwihWBVeRC4UYFjLJanQklY16SRCUFYl5ZQGVakclggFSVWJXArkHI5hGnTfjGUWJJVVAaRJ0AZiHeDmQEZSZeGcHNxoVQR4tgghnhGIVQCeHIAVFp9z1kkVjVxusKZVDM45ZlhgYpnBWAMwOuUGhpLpZqeQ5rQBYigxMFYAIM6UgVTqmWTqWMFX0rQqVa2O9KqgOCmKgKYabcCXWAFkR5OiUxkg7EYXPBpWsDddypYDvFIEAV3HDkuXAEheRMFkxe1ErFVlperQtnVVatMFFP71VkNPRdWXuc2maxcCDkBAFFFGQcAAqHQNUO1O1jUmcFUJRLvTA/IOXBeiZ2mgp8J0HfBvUxfICHFYBwyZF2sPX5wxh7hd11hlEzeoQQQLHJAwm6iJq+MGF0xw2cybEWrzzTjnrPPOPPfs889ABy300EQXbfTRMgUEACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM21GABglEGCoxCoIBBaMcMEBAIAEC1qtWqBhhI0OCUogYHBK6KHVtVAYUNXR1eQEC2bVsBDC6kTbjWrV23BCrMLVjhrl+3CrjuFVjgr2GxAiAM5nDhsGOrBjIMTtC2wIIJFzJrvvAgwYDDE/ZqELtAb8MNEwr7DT33AdUBE9BK1PDgs13WXTccwG2xgu22vBdX3NDAbgThGTMccCsXOcYFbQnIdm4ROlkF1J+3NZ29ouuxAgT+d6dIeSyC8cMDkG2OXmLfsQvaUyw+Vrz8hxt+W41/P+J3sdP1d5p6Yj0gIET/WUXAgQ+NVh+DDll3VXAQIjTBWA1UyJCDVxmgIUP6VRXghwaVdxV3JBoUwVgGpnhQYwW6+CKLMhoE41Ut1jjQjVblqCNjNP4oEI9V+ajjimIdJyQH9F3F3o/LAbgkB1NdFcCUHFp1wJQXipXhkgaMpeSPWVplX41NWpXAlGGJRaGL71k5oksVzJnSBlVexR9MGbD1ZUtpWvUkSxswYBWKKWVA1gAwQZAnVQLYWVKYYw2qkoRXYaeSoWOt+ZIGBIqlGEqcihXAmSzFKRYDJ5Wa5EzGJq5akgOV0ZRfW6yGtIECbklGE5Ed+tpRBY+6eROSbTkg6UQb0OrWmzJ1+RaiFFHQJnA7SRudA6ieZu1d0NakrVsGnOWQBbyu9tO4dhGQlAUYYHBBvBhIwAClfg1g6U4ZqPbYv1QlsOxOD4QK8F8BUBuUBrEe7NYB3Trlm8NtHbDvXhcsYLDDFreHWsOHDfBAxN1pEMEC/roVwAEPCPvhBRU8IHMCC8j8wAUkT6nzzjz37PPPQAct9NBEF2300UgnrfTSKAUEACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM23IABA4SjCBgchYBBg1COGiw4MACgqtWrVgUgkOD0acUHWMOKtUrAQVevEDOMXStWwQW0EAewnXvVwFu4DBvQ3VuVwQa8Ci/w5SugAuCEAQbzRXD28MAFVQckeDDhwoUMFyo8aHDgwGABExwTzDChccINEQrwDS2aYoYGieeybk1xQuy1s2lL3ACZLQTdFS/IXWsY+ETeawWYNv6wt1gEzCk6Dxsh+kSwYgVksC5Rr1gD3CP+bhgetnh4h4Kfn4foPezy9QnJX10A3+GE7H/rL9xw+2p1/Qu1VxeAC2kwVn4EIpSAWOYlaFAEYj3gIEJqhXXAhAiNheFBnoW13YYEYYfVfyAKlB5WEpZoYoQqrhhWiiqeeBWMJcpoFY0g2lgVjhtWwGKLIl6VG4gdYvWhigSI1SIHG4hVwJL3hUVfSxYwMOVMCIhF4kkbUKDAVe+xZKBYR5okoFUNzHRmVU+mBGFYAiD4kgBiDVkSf3XGFCVWAch50nRkwbQBnVKKORaPKX1JZktFYnXXSjqy6ZKPYhHgp0kbJCnWoyypJlaaKjEw1pUtZdDfVb+hJKpYfcb0pljWDJy0KoMzNYpVrCStadWFM2lw6lV+hbSBA2sFEGZLe1bK6UYXaDqWnTEFCeulFhHLFrQyJZsdBRh16eyzO2mbHQNlPqSBA4Re25O4YxkgAbUGaeAlX1uG++taBiDgAAQWYJBBURRAoEC6dAXQYE8a2KrYwrseu1MF9zJccL1CISfxYAU4DNQFnl681gEHH3bBgh5fFcACGuOlQQPyLVxABPACp0EEB0SMVQENVBBzeBpc8MDPCxzw8wOW7bzk0UgnrfTSTDft9NNQRy311FRXbfXVWJ8UEAAh+QQJBAAbACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA3CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDPswAoahRChcuZBAq0gKAp1CjClAgYSnTjlGzZiXAAMNVjVrDRkVg4evFAWLTAkBAwSzFA2rVIrDq9mGCuGoFSKj78AHeuAo08GWYwYJhwxEeNCjw96kAr4MnapiwIMDfCZEraoiANi7mzBUndE77GbTkBp5NV7QwOmxp1RE1LEgrgC7siLPFIrhNMXfYCLwn+s5aO7jE4VENGI/dOurr5QydhiUAHSLqsGWrO2SsdYF2hxPE/tr+nrD50wfkGfrVSj29wgzi3StE/rSC/IThtaK/fxBD2AP8IRSWAAEeBJdW4xV4XVb2FUhQflnt56BA0kU44UAVRiXhhBlCtaGDHZ53IYVhfThSUhQUhUCDNVVQokkuatXATetl9VxI8GkFoE0HZgVZSZZpdRMBYaHUY1QJvqTBfyjVGBWLMsWYlXcnSRkVlTPRBwBwJ+WolWAyeZlVdieZB4CJLTkJ1QAqqflUezERqZ9KYj4ZE4RZgZmSlsopKUBYWKYUooguKSAWmSqZCQCiKVkZFZst4RkVAXqipMGfYUG5EndaMbCSoWElAFMGQXaaEgNiBVBpSxGk5alJz6iKpalLR2b16kixhkoTqa6uypEGuWqlak2SbsWoRhbIKdaPNBWblQO+WuRAajg5O2lbGFFgALU5WTupBNESBoGypPXkrVQMUBBuQRhQEKxaN+ZkQal4GeAABBIkpS8FDiDQ2FMBzLqTBnf9a3BaByTZUwT0HmxwAFx+lUGtDuNVgMJCTUBxxVoVEK9bFmzM8QLHZobBAor+NcAD65qWQQQJNBxWAAc8UAHGyxVmwQQP9OzzzSMGLfTQRBdt9NFIJ6300kw37fTTUEct9VcBAQAh+QQJAwAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDXsygQejKAwAEIIBgoahRkgCiSgVAAILTpx+nagXA4ALWjhm2biVA4avGC2LFGrhqlmKFtGIFSGhb8QHctAjY0nV4oQHSu1oFTNhLMUOFBYClDiZMccODAYkXM3ZbALDkyRMbWMZc8QJkuBk4N0acVsAG0RRJi1WAOjXcCq0nqg58OnbEBGlZ24a4IUBa2LsfvhVLIDhE3GK9Gm+44bPWBcsdDt9aO/pC51MfWGdod+z2hRrS/ir/jnC21AjkE06fCj39wQ1q3SPELlX+wb9aQ5fMAAEDhuo4dafVZSIJGBUBCOhX03pSaVeSgVKNRxNaWzlIEoRRSTgThVpZOBKGAGgoE4fZmQSiiDGR2KCJyd2kYlQeFigWcDVNIFaMIdlY4U2abYXiR2FtdcBN+E2ll0jE3SRWAChVRl1NQWo15EnmRUWjTDp2iFIEYrU3U5UAXEnSi1EB+FJ4Yh05En0wzgTiACqBWJxMBNyoEppbiclSllqZaRKYBPipkgFdskQmAA281KOPLbGZYUuHFuASg1IFutIGdYpFoErIbcXASgykJelLvaX1KUqhLqmmSpRKdWpJ0amKhZ5MnXoKK1xTylSqqYJqtIECcAWwKqR3EfDjRRdk+ttNfIrlAEcbOLAZTs1uZYAFGVGgbFqb1phYVcMqtIEE23LbU7WmUqCgQhpQwIAAiQHQLbW+xRsVAg5Q4N++EkDgAKH2BrBuTxoUae/BaSXQK08R1Ivww1EFMCtWGjgJ8cEHhAvUBI5eLOW8X10ApscHHEuXBo95DMAACwzcmgYVPHCAw8EmEIHGtsH8wM48T3DBBTjbJ/TQRBdt9NFIJ6300kw37fTTUEct9dRUQxQQACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIMKHUp05gQJG4qeNABAAAMNSkdqAECVKgILUUFGqMrVQIasHZlyrSpAAliNG8aqRQD1rMUJatUKqOC24oO4cSPUpaihQQC8XCfspbhhwgDAVAUPptgAMQDFiyVeOAwYcmSIGxrjFdD2csS7eBF4nrgAMN3REUvHFZAUNUTVahe4xkxZ7YXZDy/gNYD7YQK8X3sz3PA3tvCGcOW2Pq6w+FjLJhVI6GxT81jeKNNSNSAhOM2pcb3+l6yglsDpmQfyogQ9Vi/N5GNln0yvVnxM7ddRxg1wszbXkxnEdcBN9I1lX0hbqfXATewFZlKDVd1mE3kKPhiXhDXpVmFJEFKFIU0ajrUghxfeFCJXI5LUIQAfznRiVSmOtGKLMr1IVYwirXgeiHHhGBJ8KDKoXkkBqjWgTQVydWBIcRFwE14oFRDXcjIVOdaRJsHmIE0JirheXKLR9JtaO5Jk5VjUvQSeWlSWJKVaDcxkHVcFqAQkWTJtIMCQ2Tm35Ut3UhVAm1muRqhKBMQln0pncrUoS3NylWaUeNF4ko1UYbkSpgAQcChJGyQaV5kqackVAytFWlWdLxGHF6ryKDmAVwCTrkRhXLCWxABg7sWUpJck7YqXpjBp4OdYDnya0QbC7lerS4FyRYClGF0gKl6kxhQtVxBwtIECjvVq07ZVEUCBsg9RsCdi0I3rWFMOPLtQBgysy25PK8alAAXyErSBBGK9225OFRyLmAAKQEABBhhkgIEFEDiAQMDvBjCwThr8+u7Gjh3Qr04RGMzxyIJmC1QGb5Ks8gLoAlWBxirjVQC1SmmwgMgxA5AAzWBtEIF/Kg/QwMd1bVBBAykjFsABERDt2QYXXPDA1AcsMPUDFzjN3NZcd+3112CHLfbYZJdt9tlop6322my37TZGAQEAIfkECQQAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgwodSrSo0aNIk5KMoEGpyAwABFRwChIBgKsKNlDlWOGqVwIXtmbcQMCr2QhiLz4wy3ZCWooaBLBt+1bihgZz6daNWCFAXq9u90LckODv1QyCI679ayBxxAWGHziGCDmvgKYvIWCOWXmugpcXrkLQGrPA36ktC18lQCEm1LwEWmqYiwDxS7x5w67sbHYAzA1+5y5YOTsvWphd5wogjXIx2wDMXw7IGxhl2bmSZeJmmyBl8bnRX/5+Z7u55IS8w2mannvcJG/ANc/PbYDSQN7yMcd7PXByQ17fNgVnlgAnJcdWejUdkFd4ITl31k3bmaUbSQ56NSFNERhnUoVXXThTaNhtmNtNILKVHYUj2lSiWSeOxCEAHsq0olctivRijDHNeFWNIWXIHol58QiSjgDQZ5OPJprk31z82aQaW6iVJKBXBNp0HVsMhqQgeDXpd1UBKEUIH03ysWWkSUia1RhN711VXUleXoWfS3ECMOdIWyYp04sAolSmWbHFtIFcIaYEXF5RuvQiAFmS1CYABDTa35VmIZgSkUXe9tedJk2Xl20rGXigS6KahQBLg/6FI0pPssXASvAK/NUknVOa9SpKDvwVAKcpLQrArSUxYFiiL62XFwTBGmYpTK/9lZVIwv41gKQs/akcsRplYJ9hq75k7VwOUBvRBrkaBsCb8ZkLaWsYVUCoYeja9O1crImLkAYOUPpXvDelaa4CFji0AQXbqnvuTxd4ajAABjAgAQYQXwCxBRAooK+6/OpE2MIcc1wAqEH11fHIcwUgJFAa5ElyxwnwGtQFKq9s2ADdFgWzzHkFsEDNSGnwgMIrJzCBvU5l8MABtf5VwAJMTXbvBQ9EvUACUT9QAc9OZ6311lx37fXXYIct9thkl2322WinrfbabLc9UEAAIfkECQMAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgwodSrSo0aNIkypdyrSp06cbN0DtmEHAhKkaNwgAAOAqzgkXXG4wwJVrhpsZuHpVObYsVwFnaW4gUHYtSgZuy8KlqSCvg5QT8ro1MDOCYAAMUi44zPVBzLSM7ZZcfFiABpgIGB9YeYCxgpcXGAeQyrYA47AtMx9GvRKyYAKkVYY+7Nhlg8gsVecdAHNDgMMJVmrADbMC49gnKe+eaVpwBJV0BdeOaVgwYZTDBY+emV3w5ZOBBf4vqJng8PPkhyXDDJ93/Mnoeb/P3HB4s0n6gnnbHCBYwMnZ7d3UmWD/0XbTbYKxNhKAbk1H0wPpmcSeWxXcxGBZDooEYYIWGljShnkpONOFjZkEolsiykQiABmGdGJZKcY0YVkVljRjiTa9yFWMH63YwE06AsCjR/jlZV9NyqF40mEE3ASfW8iNNGBeUcLUnVsFoFSeYOq9dCMAP54UZHA0JVkXdsfNt5V3KTWX13kxBakfStXldV1MawaY0pUUysiYfFpWViV0wLH0JZgvBSkkSxvwd1hcK60IwJErGXeYAYOSpNVpL20pGAIr6Waklb8dlthdokHqkqKInYQXcdwxOWpqSa8e5p5MGZR6GAKZZtQWYwX0ylKujAEgwJAWZUBWsaqOWCxXEHC0gQPPdpXToWURQEFGFeQJ61fVAqAtRRpIsOyzXdqErVsCKEABoAltQEFf4QbQrE4ZyBquAQxAAIEFGASMAQQOIPBktfYGtYGn4TbccAH3+lSnwxRr12JQGUxZccUJwFvUBRpv/OwAyBIFssjFJjCBsEdl0ICbIhcQActMaTBBAroWG8ABC0TgMVYHXSD0A0QTDRbNQCet9NJMN+3001BHLfXUVFdt9dVYZ6311lx3/XRAACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIMKHUq0qNGjSJMqXVp0gwOmIDMIABABascLUwEAyGBV4wStYAls6HoRAtizDMhWjHC2bQW1Ei+0bXsALsQNWecCKDDWrkMEerUueAlh5oPAABq4zGAAwISYFRBXbTkhq4C+LgHrTdByg4K2il3K1TsAc8oMBPRybal57uqVo+ciaBm77eSWCwI/Xtn67ACYGwJsXplBd0y2ek2bPDz3t8wBem+fPBB9JvK2BlTqDaDc5YbAGlD+Rp7LmWaC6icboJ/5dW7dk41d1/w+l8BJ+m0D3KQ+92RtsOXVxF9br430n1YP3MRcWxeYdCAACdp03VnSidReW7vV9GCEJC14VoM2bbicXiBqqBeHI3kIVok0iViSilqxaJ1eb5U0IVgVygQjADKG5GJNO/YY1XA2nTeXkCDp9V5NeZ3VXUjQzfXkYnoVgNKAZ2Uo040IorRjgDIZySBKGgQ25Up46aVSAevBtOOSJ3EJgH0yNQkWiiaV2SZl4K0k5lmXwZSaeyxd2NZgLsnJY0tYfthScUpSqZcBZ4q0waBHvqTepCt9FulLwQWWlpeIIZmSoomdxABieLrEZmDahY20waqBwQmccIEpUOlFG8S33a4qZYCrXgQUuNEFvqp204NnScCRU4hplSN70c5JQUYU2DnXtDShGhYEwB60gQSYIqZlTt6CJYACEhiL0AYWMKDtXAG4m9MFw1YLwLoQUIDBv/9SAIEDyVY7gL06bdCovgxXyxdROzYssVYBcPvTBQtPzHAC4SWFscYND1AjUx+DHFgCpialwQMZNxxAAx37JdAFDbxabQAJRICwzBxscMEFDwQt9AM/78zz0UgnrfTSTDft9NNQRy311FRXbfXVWGet9dYaBQQAIfkECQQAvAAsAAAAAG8AbwCHNL9JNb9KNr9LN8BLN8BMOsFOO8FPO8FQPMFQPcJRPsJSP8JSP8JTQMNUQcNVQsNVQ8NWQ8RXRMRYSMVbScVcS8ZeTMZfTcdfTsdgUchjUshkU8hkVMlmVspoV8poWstrW8tsXMttX8xwYM1xYc1yYs1yY85zZc51Zs52Z893adB4atB5atB6a9B7bNF7btF9b9J+cNJ/cdKActKActOBdNOCddODdtSFd9SFeNSGedWHetWHetWIe9WIe9WJfNaKgNeNgtiPhNiRhdiRhtmSiNmUidqVitqWi9qXjtuaktydkt2ek92elN2fld2glt6hl96imd+jmt+lnOCmneConuGon+GpoOGqoeGqoeKrouKso+KtpOKtpeOupeOvpuOvp+OwqOSxqeSyquSzq+W0rOW0reW1reW2rua3r+a3sOa4sea5see5tOe8tei9tui+uenBuunBvOrDverDvuvFwOvGwevHwezIwuzIxezLxe3Lx+3Nye7Oy+7Qy+/QzO/Rze/Sz/DU0PDV0PHV0fHW0vHX0/HX1PHY1PLZ1fLa1/Lb1/Pb2PLc2PPc2fPd3PTf3PTg3fTh3vXh3/Xi4Pbk4vbl4/bm5Pbn5Pfm5Pfn5ffo5/fp6Pjq6Pjr6fjr6vjs7Pnu7fnv7frv7vrw7/rw8Prx8Pry8Pvy8fry8fvz8vvz8/v19Pz19fz29vz39/z49/34+P34+P35+f36+v36+v76+/37/P78/P79/f79/f/9/v7+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AeQkcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgwodSrToUDmjjJZsJAJAFKUiOfEAQNUBLageWS0pQLVrGqwcI1XoSlbDLrAZ+yQgy1YP2ottBLBlu+JtRSVz5zJwZTeirBh5yQ4wUqpvxBqBu8qwZDiimcQAOghqHBES18A6clGGKCtDYiNnNz8Ukvip6IeMEh85DfFFYBC2WDtMnffBJ9kOAc8NAAh3w0WBieAUxXJG3gKhauJ68wHGSkmBl9CE1YVCV1UqseRdsErmKCYN2P6yUZki75WZVfK6SNkqMKyZmQKfQllHfc0QedGgJJL3S80sedV10gR5UVLTJnkdcJIqeU1w01hzkWLSJHkVcZMKeS1iEiB5lXETf3PRYVIcecFx0xb9mQRGXnvcZEdeSZjkRF6I3ATdXEaYFEReldyESV5PmAQiW5DcREheXJhERV543FTfXGuY9EZeYtyERl4ilhQIjDdNkdcfJnGSlw034ZCXIybtMsBcINi0CwNzDTDLSRfMRQAqNSGS1wkoTTXXGTUtOZcUKMmRFwo1oZDXICjFchlbncwUS14JqITYXFnMhOJcMqg05VwUyBLTKxGkmBIrgVERkxeB9aiSa/5zIZCcS7SUOlcNLL2Yl3AuhRHYIy2RkFcAwLK0CZxz0eCSIoFxwJdKs3gQGCMv/RAYC7eo1ENgMcDkyaNsAZESGYlRC1MTiXVxUlyBrRaTKw8kBoUuJDGRGAjZysQHAYmdYEpItNiQmG01kZgYBYd8hEpTgfF2U3qJDTAEKBu5YoUEkE2RE2mQGcAEKxexMgUEkAGgxE40lAyAA1iIKhEhSIRX8hg81XKEygAwkEMbEjIkiRMY4FxAHj/NoQDOVI3wxBl3JOIJL5r4ocYTPEiL9AOGBHWJ1Uh3DZkFjAk1yxBel81WAUqAXFQgK5hdtg+cgFUIC26rXEIjfRXiQkzdebEgx2aNMLEB3y2skQpumWhhQgA4E+CCGof7RtApe7jhBRRE3LDCDkp0Eccgmkgu+uikl2766ainrvrqrLfu+uuwxy777LTXblhAACH5BAkDABsALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmJnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADcIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIMKtamhAgMLQ0tqmKAAgFMHSUVSMOC0KoADUT9aQGDVqoCsHDM07do1A1iMGhiQXSvhrMUMVNeSbeCWIgYBctcmqCtRQt6uBSCY5QvxwV+nAyQMJgyxweEAbRn3/RvAgQbJEu/mLbAY80MNcfVe9hxx7NoFpCU6yBs59cMMeem6hrhAboHZEGGvDTAad0PTXTH4dmhBLtThDbmS5Y2cIQbjzRmuXt47OsLQViFYV6hB7naFfsn+7v2OMAFb8gjxku1cs+gDBAhOPid726YEBQS6niw+9+aBtfutdVxNjpGFVEnhdaWdTdN1dSBJDVr1IE0UCGhShFVNOBN/XQ04Um0G3sShVR6KhKFTGso0YlUlhnQiABSIaGFJKz5104sx0riWbDW9mCJI3ZGFlU0FOnjSWgTchF1V7IlUwFpNvqRbVwGgBKKCNUFwGkoVkmVATeaR1ZpSckXZklzVlRRmV2O+9GJ9KCVoVZIxaaAelikFKWZMLwIgnEpPkiVAmirZudaQKnVJVosp9fmjSf8JaqaOW7ZUo1MGEKrUnWW9tGZXCqy0ZFWoSZkXAympVWZMV+5pkpzceMKkQaBroUqSqnrRlEEAeWUakgbKrVWApi7NJ5cAf3YEV14BJEsTrGQ9QOxEGjzAKVk53niYABNkFMG1/elUZF4ERDCtQhlMkN9hC+5EAa+HAcBABecOhEEEo+7Wpk4Y0BqvAQw8cMHABFfwAH7xVtVsUBp8mvDDf3GWVJ8QV7xAvTtl4HDFDycwaVAWRMpxvAc8mpUEIo9MX7aYZeDAACo7lYAEGPNlgQMJwHvYAAuwbF0GFkjggAMNLDC0AxSYjN7STDft9NNQRy311FRXbfXVWGet9dZcd81TQAA7AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=";var Tp=function(e){return e&&e.Math==Math&&e},me=Tp(typeof globalThis=="object"&&globalThis)||Tp(typeof window=="object"&&window)||Tp(typeof self=="object"&&self)||Tp(typeof W0=="object"&&W0)||function(){return this}()||Function("return this")(),Hr={},Wt=function(e){try{return!!e()}catch{return!0}},fz=Wt,Fe=!fz(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),hz=Wt,Id=!hz(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),dz=Id,Pp=Function.prototype.call,Ke=dz?Pp.bind(Pp):function(){return Pp.apply(Pp,arguments)},xd={},MB={}.propertyIsEnumerable,IB=Object.getOwnPropertyDescriptor,pz=IB&&!MB.call({1:2},1);xd.f=pz?function(e){var t=IB(this,e);return!!t&&t.enumerable}:MB;var jd=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},xB=Id,jB=Function.prototype,U0=jB.call,yz=xB&&jB.bind.bind(U0,U0),Kt=xB?yz:function(e){return function(){return U0.apply(e,arguments)}},DB=Kt,gz=DB({}.toString),mz=DB("".slice),Nr=function(e){return mz(gz(e),8,-1)},vz=Kt,bz=Wt,wz=Nr,pw=Object,Az=vz("".split),Dd=bz(function(){return!pw("z").propertyIsEnumerable(0)})?function(e){return wz(e)=="String"?Az(e,""):pw(e)}:pw,mr=function(e){return e==null},Sz=mr,Cz=TypeError,Rn=function(e){if(Sz(e))throw Cz("Can't call method on "+e);return e},Oz=Dd,kz=Rn,Fn=function(e){return Oz(kz(e))},Y0=typeof document=="object"&&document.all,Rz=typeof Y0>"u"&&Y0!==void 0,_B={all:Y0,IS_HTMLDDA:Rz},HB=_B,Ez=HB.all,Ae=HB.IS_HTMLDDA?function(e){return typeof e=="function"||e===Ez}:function(e){return typeof e=="function"},BE=Ae,NB=_B,Tz=NB.all,We=NB.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:BE(e)||e===Tz}:function(e){return typeof e=="object"?e!==null:BE(e)},yw=me,Pz=Ae,Mz=function(e){return Pz(e)?e:void 0},Do=function(e,t){return arguments.length<2?Mz(yw[e]):yw[e]&&yw[e][t]},Iz=Kt,Si=Iz({}.isPrototypeOf),_a=typeof navigator<"u"&&String(navigator.userAgent)||"",BB=me,gw=_a,LE=BB.process,VE=BB.Deno,FE=LE&&LE.versions||VE&&VE.version,WE=FE&&FE.v8,sr,Sg;WE&&(sr=WE.split("."),Sg=sr[0]>0&&sr[0]<4?1:+(sr[0]+sr[1]));!Sg&&gw&&(sr=gw.match(/Edge\/(\d+)/),(!sr||sr[1]>=74)&&(sr=gw.match(/Chrome\/(\d+)/),sr&&(Sg=+sr[1])));var _d=Sg,UE=_d,xz=Wt,oc=!!Object.getOwnPropertySymbols&&!xz(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&UE&&UE<41}),jz=oc,LB=jz&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Dz=Do,_z=Ae,Hz=Si,Nz=LB,Bz=Object,Hd=Nz?function(e){return typeof e=="symbol"}:function(e){var t=Dz("Symbol");return _z(t)&&Hz(t.prototype,Bz(e))},Lz=String,ic=function(e){try{return Lz(e)}catch{return"Object"}},Vz=Ae,Fz=ic,Wz=TypeError,Ha=function(e){if(Vz(e))return e;throw Wz(Fz(e)+" is not a function")},Uz=Ha,Yz=mr,Na=function(e,t){var r=e[t];return Yz(r)?void 0:Uz(r)},mw=Ke,vw=Ae,bw=We,Gz=TypeError,VB=function(e,t){var r,n;if(t==="string"&&vw(r=e.toString)&&!bw(n=mw(r,e))||vw(r=e.valueOf)&&!bw(n=mw(r,e))||t!=="string"&&vw(r=e.toString)&&!bw(n=mw(r,e)))return n;throw Gz("Can't convert object to primitive value")},gi={},zz={get exports(){return gi},set exports(e){gi=e}},Qz=!1,YE=me,Kz=Object.defineProperty,z1=function(e,t){try{Kz(YE,e,{value:t,configurable:!0,writable:!0})}catch{YE[e]=t}return t},Xz=me,Jz=z1,GE="__core-js_shared__",Zz=Xz[GE]||Jz(GE,{}),Q1=Zz,zE=Q1;(zz.exports=function(e,t){return zE[e]||(zE[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.29.1",mode:"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.1/LICENSE",source:"https://github.com/zloirock/core-js"});var qz=Rn,$z=Object,En=function(e){return $z(qz(e))},tQ=Kt,eQ=En,nQ=tQ({}.hasOwnProperty),Me=Object.hasOwn||function(e,t){return nQ(eQ(e),t)},rQ=Kt,oQ=0,iQ=Math.random(),aQ=rQ(1 .toString),Lm=function(e){return"Symbol("+(e===void 0?"":e)+")_"+aQ(++oQ+iQ,36)},sQ=me,lQ=gi,QE=Me,uQ=Lm,cQ=oc,fQ=LB,Ts=sQ.Symbol,ww=lQ("wks"),hQ=fQ?Ts.for||Ts:Ts&&Ts.withoutSetter||uQ,ve=function(e){return QE(ww,e)||(ww[e]=cQ&&QE(Ts,e)?Ts[e]:hQ("Symbol."+e)),ww[e]},dQ=Ke,KE=We,XE=Hd,pQ=Na,yQ=VB,gQ=ve,mQ=TypeError,vQ=gQ("toPrimitive"),FB=function(e,t){if(!KE(e)||XE(e))return e;var r=pQ(e,vQ),n;if(r){if(t===void 0&&(t="default"),n=dQ(r,e,t),!KE(n)||XE(n))return n;throw mQ("Can't convert object to primitive value")}return t===void 0&&(t="number"),yQ(e,t)},bQ=FB,wQ=Hd,Vm=function(e){var t=bQ(e,"string");return wQ(t)?t:t+""},AQ=me,JE=We,G0=AQ.document,SQ=JE(G0)&&JE(G0.createElement),Fm=function(e){return SQ?G0.createElement(e):{}},CQ=Fe,OQ=Wt,kQ=Fm,WB=!CQ&&!OQ(function(){return Object.defineProperty(kQ("div"),"a",{get:function(){return 7}}).a!=7}),RQ=Fe,EQ=Ke,TQ=xd,PQ=jd,MQ=Fn,IQ=Vm,xQ=Me,jQ=WB,ZE=Object.getOwnPropertyDescriptor;Hr.f=RQ?ZE:function(e,t){if(e=MQ(e),t=IQ(t),jQ)try{return ZE(e,t)}catch{}if(xQ(e,t))return PQ(!EQ(TQ.f,e,t),e[t])};var mn={},DQ=Fe,_Q=Wt,UB=DQ&&_Q(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),HQ=We,NQ=String,BQ=TypeError,De=function(e){if(HQ(e))return e;throw BQ(NQ(e)+" is not an object")},LQ=Fe,VQ=WB,FQ=UB,Mp=De,qE=Vm,WQ=TypeError,Aw=Object.defineProperty,UQ=Object.getOwnPropertyDescriptor,Sw="enumerable",Cw="configurable",Ow="writable";mn.f=LQ?FQ?function(e,t,r){if(Mp(e),t=qE(t),Mp(r),typeof e=="function"&&t==="prototype"&&"value"in r&&Ow in r&&!r[Ow]){var n=UQ(e,t);n&&n[Ow]&&(e[t]=r.value,r={configurable:Cw in r?r[Cw]:n[Cw],enumerable:Sw in r?r[Sw]:n[Sw],writable:!1})}return Aw(e,t,r)}:Aw:function(e,t,r){if(Mp(e),t=qE(t),Mp(r),VQ)try{return Aw(e,t,r)}catch{}if("get"in r||"set"in r)throw WQ("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var YQ=Fe,GQ=mn,zQ=jd,Ba=YQ?function(e,t,r){return GQ.f(e,t,zQ(1,r))}:function(e,t,r){return e[t]=r,e},Cg={},QQ={get exports(){return Cg},set exports(e){Cg=e}},z0=Fe,KQ=Me,YB=Function.prototype,XQ=z0&&Object.getOwnPropertyDescriptor,K1=KQ(YB,"name"),JQ=K1&&(function(){}).name==="something",ZQ=K1&&(!z0||z0&&XQ(YB,"name").configurable),Nd={EXISTS:K1,PROPER:JQ,CONFIGURABLE:ZQ},qQ=Kt,$Q=Ae,Q0=Q1,t3=qQ(Function.toString);$Q(Q0.inspectSource)||(Q0.inspectSource=function(e){return t3(e)});var GB=Q0.inspectSource,e3=me,n3=Ae,$E=e3.WeakMap,zB=n3($E)&&/native code/.test(String($E)),r3=gi,o3=Lm,tT=r3("keys"),Wm=function(e){return tT[e]||(tT[e]=o3(e))},Bd={},i3=zB,QB=me,a3=We,s3=Ba,kw=Me,Rw=Q1,l3=Wm,u3=Bd,eT="Object already initialized",K0=QB.TypeError,c3=QB.WeakMap,Og,Of,kg,f3=function(e){return kg(e)?Of(e):Og(e,{})},h3=function(e){return function(t){var r;if(!a3(t)||(r=Of(t)).type!==e)throw K0("Incompatible receiver, "+e+" required");return r}};if(i3||Rw.state){var br=Rw.state||(Rw.state=new c3);br.get=br.get,br.has=br.has,br.set=br.set,Og=function(e,t){if(br.has(e))throw K0(eT);return t.facade=e,br.set(e,t),t},Of=function(e){return br.get(e)||{}},kg=function(e){return br.has(e)}}else{var Xa=l3("state");u3[Xa]=!0,Og=function(e,t){if(kw(e,Xa))throw K0(eT);return t.facade=e,s3(e,Xa,t),t},Of=function(e){return kw(e,Xa)?e[Xa]:{}},kg=function(e){return kw(e,Xa)}}var _o={set:Og,get:Of,has:kg,enforce:f3,getterFor:h3},X1=Kt,d3=Wt,p3=Ae,Ip=Me,X0=Fe,y3=Nd.CONFIGURABLE,g3=GB,KB=_o,m3=KB.enforce,v3=KB.get,nT=String,xy=Object.defineProperty,b3=X1("".slice),w3=X1("".replace),A3=X1([].join),S3=X0&&!d3(function(){return xy(function(){},"length",{value:8}).length!==8}),C3=String(String).split("String"),O3=QQ.exports=function(e,t,r){b3(nT(t),0,7)==="Symbol("&&(t="["+w3(nT(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Ip(e,"name")||y3&&e.name!==t)&&(X0?xy(e,"name",{value:t,configurable:!0}):e.name=t),S3&&r&&Ip(r,"arity")&&e.length!==r.arity&&xy(e,"length",{value:r.arity});try{r&&Ip(r,"constructor")&&r.constructor?X0&&xy(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=m3(e);return Ip(n,"source")||(n.source=A3(C3,typeof t=="string"?t:"")),e};Function.prototype.toString=O3(function(){return p3(this)&&v3(this).source||g3(this)},"toString");var k3=Ae,R3=mn,E3=Cg,T3=z1,Jn=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(k3(r)&&E3(r,i,n),n.global)o?e[t]=r:T3(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:R3.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},La={},P3=Math.ceil,M3=Math.floor,I3=Math.trunc||function(e){var t=+e;return(t>0?M3:P3)(t)},x3=I3,Ci=function(e){var t=+e;return t!==t||t===0?0:x3(t)},j3=Ci,D3=Math.max,_3=Math.min,Ld=function(e,t){var r=j3(e);return r<0?D3(r+t,0):_3(r,t)},H3=Ci,N3=Math.min,Va=function(e){return e>0?N3(H3(e),9007199254740991):0},B3=Va,Zn=function(e){return B3(e.length)},L3=Fn,V3=Ld,F3=Zn,rT=function(e){return function(t,r,n){var o=L3(t),i=F3(o),a=V3(n,i),s;if(e&&r!=r){for(;i>a;)if(s=o[a++],s!=s)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},J1={includes:rT(!0),indexOf:rT(!1)},W3=Kt,Ew=Me,U3=Fn,Y3=J1.indexOf,G3=Bd,oT=W3([].push),XB=function(e,t){var r=U3(e),n=0,o=[],i;for(i in r)!Ew(G3,i)&&Ew(r,i)&&oT(o,i);for(;t.length>n;)Ew(r,i=t[n++])&&(~Y3(o,i)||oT(o,i));return o},Z1=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],z3=XB,Q3=Z1,K3=Q3.concat("length","prototype");La.f=Object.getOwnPropertyNames||function(e){return z3(e,K3)};var Vd={};Vd.f=Object.getOwnPropertySymbols;var X3=Do,J3=Kt,Z3=La,q3=Vd,$3=De,tK=J3([].concat),JB=X3("Reflect","ownKeys")||function(e){var t=Z3.f($3(e)),r=q3.f;return r?tK(t,r(e)):t},iT=Me,eK=JB,nK=Hr,rK=mn,ZB=function(e,t,r){for(var n=eK(t),o=rK.f,i=nK.f,a=0;a<n.length;a++){var s=n[a];!iT(e,s)&&!(r&&iT(r,s))&&o(e,s,i(t,s))}},oK=Wt,iK=Ae,aK=/#|\.prototype\./,Fd=function(e,t){var r=lK[sK(e)];return r==cK?!0:r==uK?!1:iK(t)?oK(t):!!t},sK=Fd.normalize=function(e){return String(e).replace(aK,".").toLowerCase()},lK=Fd.data={},uK=Fd.NATIVE="N",cK=Fd.POLYFILL="P",Um=Fd,Tw=me,fK=Hr.f,hK=Ba,dK=Jn,pK=z1,yK=ZB,gK=Um,jt=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,s,l,u,c;if(n?a=Tw:o?a=Tw[r]||pK(r,{}):a=(Tw[r]||{}).prototype,a)for(s in t){if(u=t[s],e.dontCallGetSet?(c=fK(a,s),l=c&&c.value):l=a[s],i=gK(n?s:r+(o?".":"#")+s,e.forced),!i&&l!==void 0){if(typeof u==typeof l)continue;yK(u,l)}(e.sham||l&&l.sham)&&hK(u,"sham",!0),dK(a,s,u,e)}},mK=ve,vK=mK("toStringTag"),qB={};qB[vK]="z";var q1=String(qB)==="[object z]",bK=q1,wK=Ae,jy=Nr,AK=ve,SK=AK("toStringTag"),CK=Object,OK=jy(function(){return arguments}())=="Arguments",kK=function(e,t){try{return e[t]}catch{}},Ym=bK?jy:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=kK(t=CK(e),SK))=="string"?r:OK?jy(t):(n=jy(t))=="Object"&&wK(t.callee)?"Arguments":n},RK=Ym,EK=String,Ue=function(e){if(RK(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return EK(e)},$1={},TK=XB,PK=Z1,Wd=Object.keys||function(e){return TK(e,PK)},MK=Fe,IK=UB,xK=mn,jK=De,DK=Fn,_K=Wd;$1.f=MK&&!IK?Object.defineProperties:function(e,t){jK(e);for(var r=DK(t),n=_K(t),o=n.length,i=0,a;o>i;)xK.f(e,a=n[i++],r[a]);return e};var HK=Do,$B=HK("document","documentElement"),NK=De,BK=$1,aT=Z1,LK=Bd,VK=$B,FK=Fm,WK=Wm,sT=">",lT="<",J0="prototype",Z0="script",tL=WK("IE_PROTO"),Pw=function(){},eL=function(e){return lT+Z0+sT+e+lT+"/"+Z0+sT},uT=function(e){e.write(eL("")),e.close();var t=e.parentWindow.Object;return e=null,t},UK=function(){var e=FK("iframe"),t="java"+Z0+":",r;return e.style.display="none",VK.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(eL("document.F=Object")),r.close(),r.F},xp,Dy=function(){try{xp=new ActiveXObject("htmlfile")}catch{}Dy=typeof document<"u"?document.domain&&xp?uT(xp):UK():uT(xp);for(var e=aT.length;e--;)delete Dy[J0][aT[e]];return Dy()};LK[tL]=!0;var ac=Object.create||function(e,t){var r;return e!==null?(Pw[J0]=NK(e),r=new Pw,Pw[J0]=null,r[tL]=e):r=Dy(),t===void 0?r:BK.f(r,t)},Gm={},YK=Vm,GK=mn,zK=jd,sc=function(e,t,r){var n=YK(t);n in e?GK.f(e,n,zK(0,r)):e[n]=r},cT=Ld,QK=Zn,KK=sc,XK=Array,JK=Math.max,tk=function(e,t,r){for(var n=QK(e),o=cT(t,n),i=cT(r===void 0?n:r,n),a=XK(JK(i-o,0)),s=0;o<i;o++,s++)KK(a,s,e[o]);return a.length=s,a},ZK=Nr,qK=Fn,nL=La.f,$K=tk,rL=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],tX=function(e){try{return nL(e)}catch{return $K(rL)}};Gm.f=function(e){return rL&&ZK(e)=="Window"?tX(e):nL(qK(e))};var fT=Cg,eX=mn,Ud=function(e,t,r){return r.get&&fT(r.get,t,{getter:!0}),r.set&&fT(r.set,t,{setter:!0}),eX.f(e,t,r)},ek={},nX=ve;ek.f=nX;var rX=me,oL=rX,hT=oL,oX=Me,iX=ek,aX=mn.f,nk=function(e){var t=hT.Symbol||(hT.Symbol={});oX(t,e)||aX(t,e,{value:iX.f(e)})},sX=Ke,lX=Do,uX=ve,cX=Jn,iL=function(){var e=lX("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=uX("toPrimitive");t&&!t[n]&&cX(t,n,function(o){return sX(r,this)},{arity:1})},fX=mn.f,hX=Me,dX=ve,dT=dX("toStringTag"),zm=function(e,t,r){e&&!r&&(e=e.prototype),e&&!hX(e,dT)&&fX(e,dT,{configurable:!0,value:t})},pX=Nr,yX=Kt,Yd=function(e){if(pX(e)==="Function")return yX(e)},pT=Yd,gX=Ha,mX=Id,vX=pT(pT.bind),Gd=function(e,t){return gX(e),t===void 0?e:mX?vX(e,t):function(){return e.apply(t,arguments)}},bX=Nr,lc=Array.isArray||function(e){return bX(e)=="Array"},wX=Kt,AX=Wt,aL=Ae,SX=Ym,CX=Do,OX=GB,sL=function(){},kX=[],lL=CX("Reflect","construct"),rk=/^\s*(?:class|function)\b/,RX=wX(rk.exec),EX=!rk.exec(sL),wc=function(e){if(!aL(e))return!1;try{return lL(sL,kX,e),!0}catch{return!1}},uL=function(e){if(!aL(e))return!1;switch(SX(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return EX||!!RX(rk,OX(e))}catch{return!0}};uL.sham=!0;var Qm=!lL||AX(function(){var e;return wc(wc.call)||!wc(Object)||!wc(function(){e=!0})||e})?uL:wc,yT=lc,TX=Qm,PX=We,MX=ve,IX=MX("species"),gT=Array,xX=function(e){var t;return yT(e)&&(t=e.constructor,TX(t)&&(t===gT||yT(t.prototype))?t=void 0:PX(t)&&(t=t[IX],t===null&&(t=void 0))),t===void 0?gT:t},jX=xX,ok=function(e,t){return new(jX(e))(t===0?0:t)},DX=Gd,_X=Kt,HX=Dd,NX=En,BX=Zn,LX=ok,mT=_X([].push),Lo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,s=e==5||i;return function(l,u,c,f){for(var h=NX(l),p=HX(h),y=DX(u,c),m=BX(p),v=0,w=f||LX,C=t?w(l,m):r||a?w(l,0):void 0,A,D;m>v;v++)if((s||v in p)&&(A=p[v],D=y(A,v,h),e))if(t)C[v]=D;else if(D)switch(e){case 3:return!0;case 5:return A;case 6:return v;case 2:mT(C,A)}else switch(e){case 4:return!1;case 7:mT(C,A)}return i?-1:n||o?o:C}},Fa={forEach:Lo(0),map:Lo(1),filter:Lo(2),some:Lo(3),every:Lo(4),find:Lo(5),findIndex:Lo(6),filterReject:Lo(7)},Km=jt,ik=me,ak=Ke,VX=Kt,Js=Fe,Zs=oc,FX=Wt,en=Me,WX=Si,q0=De,Xm=Fn,sk=Vm,UX=Ue,$0=jd,kf=ac,cL=Wd,YX=La,fL=Gm,GX=Vd,hL=Hr,dL=mn,zX=$1,pL=xd,Mw=Jn,QX=Ud,lk=gi,KX=Wm,yL=Bd,vT=Lm,XX=ve,JX=ek,ZX=nk,qX=iL,$X=zm,gL=_o,Jm=Fa.forEach,On=KX("hidden"),Zm="Symbol",Rf="prototype",t4=gL.set,bT=gL.getterFor(Zm),Kn=Object[Rf],va=ik.Symbol,$c=va&&va[Rf],e4=ik.TypeError,Iw=ik.QObject,mL=hL.f,Ui=dL.f,vL=fL.f,n4=pL.f,bL=VX([].push),Po=lk("symbols"),zd=lk("op-symbols"),r4=lk("wks"),tS=!Iw||!Iw[Rf]||!Iw[Rf].findChild,eS=Js&&FX(function(){return kf(Ui({},"a",{get:function(){return Ui(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=mL(Kn,t);n&&delete Kn[t],Ui(e,t,r),n&&e!==Kn&&Ui(Kn,t,n)}:Ui,xw=function(e,t){var r=Po[e]=kf($c);return t4(r,{type:Zm,tag:e,description:t}),Js||(r.description=t),r},qm=function(e,t,r){e===Kn&&qm(zd,t,r),q0(e);var n=sk(t);return q0(r),en(Po,n)?(r.enumerable?(en(e,On)&&e[On][n]&&(e[On][n]=!1),r=kf(r,{enumerable:$0(0,!1)})):(en(e,On)||Ui(e,On,$0(1,{})),e[On][n]=!0),eS(e,n,r)):Ui(e,n,r)},uk=function(e,t){q0(e);var r=Xm(t),n=cL(r).concat(SL(r));return Jm(n,function(o){(!Js||ak(nS,r,o))&&qm(e,o,r[o])}),e},o4=function(e,t){return t===void 0?kf(e):uk(kf(e),t)},nS=function(e){var t=sk(e),r=ak(n4,this,t);return this===Kn&&en(Po,t)&&!en(zd,t)?!1:r||!en(this,t)||!en(Po,t)||en(this,On)&&this[On][t]?r:!0},wL=function(e,t){var r=Xm(e),n=sk(t);if(!(r===Kn&&en(Po,n)&&!en(zd,n))){var o=mL(r,n);return o&&en(Po,n)&&!(en(r,On)&&r[On][n])&&(o.enumerable=!0),o}},AL=function(e){var t=vL(Xm(e)),r=[];return Jm(t,function(n){!en(Po,n)&&!en(yL,n)&&bL(r,n)}),r},SL=function(e){var t=e===Kn,r=vL(t?zd:Xm(e)),n=[];return Jm(r,function(o){en(Po,o)&&(!t||en(Kn,o))&&bL(n,Po[o])}),n};Zs||(va=function(){if(WX($c,this))throw e4("Symbol is not a constructor");var e=!arguments.length||arguments[0]===void 0?void 0:UX(arguments[0]),t=vT(e),r=function(n){this===Kn&&ak(r,zd,n),en(this,On)&&en(this[On],t)&&(this[On][t]=!1),eS(this,t,$0(1,n))};return Js&&tS&&eS(Kn,t,{configurable:!0,set:r}),xw(t,e)},$c=va[Rf],Mw($c,"toString",function(){return bT(this).tag}),Mw(va,"withoutSetter",function(e){return xw(vT(e),e)}),pL.f=nS,dL.f=qm,zX.f=uk,hL.f=wL,YX.f=fL.f=AL,GX.f=SL,JX.f=function(e){return xw(XX(e),e)},Js&&(QX($c,"description",{configurable:!0,get:function(){return bT(this).description}}),Mw(Kn,"propertyIsEnumerable",nS,{unsafe:!0})));Km({global:!0,constructor:!0,wrap:!0,forced:!Zs,sham:!Zs},{Symbol:va});Jm(cL(r4),function(e){ZX(e)});Km({target:Zm,stat:!0,forced:!Zs},{useSetter:function(){tS=!0},useSimple:function(){tS=!1}});Km({target:"Object",stat:!0,forced:!Zs,sham:!Js},{create:o4,defineProperty:qm,defineProperties:uk,getOwnPropertyDescriptor:wL});Km({target:"Object",stat:!0,forced:!Zs},{getOwnPropertyNames:AL});qX();$X(va,Zm);yL[On]=!0;var i4=oc,CL=i4&&!!Symbol.for&&!!Symbol.keyFor,a4=jt,s4=Do,l4=Me,u4=Ue,OL=gi,c4=CL,jw=OL("string-to-symbol-registry"),f4=OL("symbol-to-string-registry");a4({target:"Symbol",stat:!0,forced:!c4},{for:function(e){var t=u4(e);if(l4(jw,t))return jw[t];var r=s4("Symbol")(t);return jw[t]=r,f4[r]=t,r}});var h4=jt,d4=Me,p4=Hd,y4=ic,g4=gi,m4=CL,wT=g4("symbol-to-string-registry");h4({target:"Symbol",stat:!0,forced:!m4},{keyFor:function(e){if(!p4(e))throw TypeError(y4(e)+" is not a symbol");if(d4(wT,e))return wT[e]}});var v4=Id,kL=Function.prototype,AT=kL.apply,ST=kL.call,Wa=typeof Reflect=="object"&&Reflect.apply||(v4?ST.bind(AT):function(){return ST.apply(AT,arguments)}),b4=Kt,Qd=b4([].slice),w4=Kt,CT=lc,A4=Ae,OT=Nr,S4=Ue,kT=w4([].push),C4=function(e){if(A4(e))return e;if(CT(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?kT(r,o):(typeof o=="number"||OT(o)=="Number"||OT(o)=="String")&&kT(r,S4(o))}var i=r.length,a=!0;return function(s,l){if(a)return a=!1,l;if(CT(this))return l;for(var u=0;u<i;u++)if(r[u]===s)return l}}},O4=jt,RL=Do,EL=Wa,k4=Ke,Kd=Kt,TL=Wt,RT=Ae,ET=Hd,PL=Qd,R4=C4,E4=oc,T4=String,ti=RL("JSON","stringify"),jp=Kd(/./.exec),TT=Kd("".charAt),P4=Kd("".charCodeAt),M4=Kd("".replace),I4=Kd(1 .toString),x4=/[\uD800-\uDFFF]/g,PT=/^[\uD800-\uDBFF]$/,MT=/^[\uDC00-\uDFFF]$/,IT=!E4||TL(function(){var e=RL("Symbol")();return ti([e])!="[null]"||ti({a:e})!="{}"||ti(Object(e))!="{}"}),xT=TL(function(){return ti("\uDF06\uD834")!=='"\\udf06\\ud834"'||ti("\uDEAD")!=='"\\udead"'}),j4=function(e,t){var r=PL(arguments),n=R4(t);if(!(!RT(n)&&(e===void 0||ET(e))))return r[1]=function(o,i){if(RT(n)&&(i=k4(n,this,T4(o),i)),!ET(i))return i},EL(ti,null,r)},D4=function(e,t,r){var n=TT(r,t-1),o=TT(r,t+1);return jp(PT,e)&&!jp(MT,o)||jp(MT,e)&&!jp(PT,n)?"\\u"+I4(P4(e,0),16):e};ti&&O4({target:"JSON",stat:!0,arity:3,forced:IT||xT},{stringify:function(e,t,r){var n=PL(arguments),o=EL(IT?j4:ti,null,n);return xT&&typeof o=="string"?M4(o,x4,D4):o}});var _4=jt,H4=oc,N4=Wt,ML=Vd,B4=En,L4=!H4||N4(function(){ML.f(1)});_4({target:"Object",stat:!0,forced:L4},{getOwnPropertySymbols:function(e){var t=ML.f;return t?t(B4(e)):[]}});var V4=jt,F4=Fe,W4=me,Dp=Kt,U4=Me,Y4=Ae,G4=Si,z4=Ue,Q4=Ud,K4=ZB,Xr=W4.Symbol,Ri=Xr&&Xr.prototype;if(F4&&Y4(Xr)&&(!("description"in Ri)||Xr().description!==void 0)){var jT={},_p=function(){var e=arguments.length<1||arguments[0]===void 0?void 0:z4(arguments[0]),t=G4(Ri,this)?new Xr(e):e===void 0?Xr():Xr(e);return e===""&&(jT[t]=!0),t};K4(_p,Xr),_p.prototype=Ri,Ri.constructor=_p;var X4=String(Xr("test"))=="Symbol(test)",J4=Dp(Ri.valueOf),Z4=Dp(Ri.toString),q4=/^Symbol\((.*)\)[^)]+$/,$4=Dp("".replace),t8=Dp("".slice);Q4(Ri,"description",{configurable:!0,get:function(){var e=J4(this);if(U4(jT,e))return"";var t=Z4(e),r=X4?t8(t,7,-1):$4(t,q4,"$1");return r===""?void 0:r}}),V4({global:!0,constructor:!0,forced:!0},{Symbol:_p})}var e8=nk;e8("iterator");var n8=Fe,r8=Nd.EXISTS,IL=Kt,o8=Ud,xL=Function.prototype,i8=IL(xL.toString),jL=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,a8=IL(jL.exec),s8="name";n8&&!r8&&o8(xL,s8,{configurable:!0,get:function(){try{return a8(jL,i8(this))[1]}catch{return""}}});var l8=Wt,ck=!l8(function(){return Object.isExtensible(Object.preventExtensions({}))}),Aa={},u8={get exports(){return Aa},set exports(e){Aa=e}},c8=Wt,f8=c8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),h8=Wt,d8=We,p8=Nr,DT=f8,_y=Object.isExtensible,y8=h8(function(){_y(1)}),g8=y8||DT?function(e){return!d8(e)||DT&&p8(e)=="ArrayBuffer"?!1:_y?_y(e):!0}:_y,m8=jt,v8=Kt,b8=Bd,w8=We,fk=Me,A8=mn.f,_T=La,S8=Gm,hk=g8,C8=Lm,O8=ck,DL=!1,Mo=C8("meta"),k8=0,dk=function(e){A8(e,Mo,{value:{objectID:"O"+k8++,weakData:{}}})},R8=function(e,t){if(!w8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!fk(e,Mo)){if(!hk(e))return"F";if(!t)return"E";dk(e)}return e[Mo].objectID},E8=function(e,t){if(!fk(e,Mo)){if(!hk(e))return!0;if(!t)return!1;dk(e)}return e[Mo].weakData},T8=function(e){return O8&&DL&&hk(e)&&!fk(e,Mo)&&dk(e),e},P8=function(){M8.enable=function(){},DL=!0;var e=_T.f,t=v8([].splice),r={};r[Mo]=1,e(r).length&&(_T.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===Mo){t(o,i,1);break}return o},m8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:S8.f}))},M8=u8.exports={enable:P8,fastKey:R8,getWeakData:E8,onFreeze:T8};b8[Mo]=!0;var I8=jt,x8=ck,j8=Wt,D8=We,_8=Aa.onFreeze,rS=Object.freeze,H8=j8(function(){rS(1)});I8({target:"Object",stat:!0,forced:H8,sham:!x8},{freeze:function(e){return rS&&D8(e)?rS(_8(e)):e}});var N8=ve,B8=ac,L8=mn.f,oS=N8("unscopables"),iS=Array.prototype;iS[oS]==null&&L8(iS,oS,{configurable:!0,value:B8(null)});var Xd=function(e){iS[oS][e]=!0},Jd={},V8=Wt,_L=!V8(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),F8=Me,W8=Ae,U8=En,Y8=Wm,G8=_L,HT=Y8("IE_PROTO"),aS=Object,z8=aS.prototype,$m=G8?aS.getPrototypeOf:function(e){var t=U8(e);if(F8(t,HT))return t[HT];var r=t.constructor;return W8(r)&&t instanceof r?r.prototype:t instanceof aS?z8:null},Q8=Wt,K8=Ae,X8=We,NT=$m,J8=Jn,Z8=ve,sS=Z8("iterator"),HL=!1,Sa,Dw,_w;[].keys&&(_w=[].keys(),"next"in _w?(Dw=NT(NT(_w)),Dw!==Object.prototype&&(Sa=Dw)):HL=!0);var q8=!X8(Sa)||Q8(function(){var e={};return Sa[sS].call(e)!==e});q8&&(Sa={});K8(Sa[sS])||J8(Sa,sS,function(){return this});var NL={IteratorPrototype:Sa,BUGGY_SAFARI_ITERATORS:HL},$8=NL.IteratorPrototype,tJ=ac,eJ=jd,nJ=zm,rJ=Jd,oJ=function(){return this},iJ=function(e,t,r,n){var o=t+" Iterator";return e.prototype=tJ($8,{next:eJ(+!n,r)}),nJ(e,o,!1),rJ[o]=oJ,e},aJ=Kt,sJ=Ha,lJ=function(e,t,r){try{return aJ(sJ(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},uJ=Ae,cJ=String,fJ=TypeError,hJ=function(e){if(typeof e=="object"||uJ(e))return e;throw fJ("Can't set "+cJ(e)+" as a prototype")},dJ=lJ,pJ=De,yJ=hJ,pk=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=dJ(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(n,o){return pJ(n),yJ(o),e?r(n,o):n.__proto__=o,n}}():void 0),gJ=jt,mJ=Ke,BL=Nd,vJ=Ae,bJ=iJ,BT=$m,LT=pk,wJ=zm,AJ=Ba,Hw=Jn,SJ=ve,CJ=Jd,LL=NL,OJ=BL.PROPER,kJ=BL.CONFIGURABLE,VT=LL.IteratorPrototype,Hp=LL.BUGGY_SAFARI_ITERATORS,Ac=SJ("iterator"),FT="keys",Sc="values",WT="entries",RJ=function(){return this},yk=function(e,t,r,n,o,i,a){bJ(r,t,n);var s=function(w){if(w===o&&h)return h;if(!Hp&&w in c)return c[w];switch(w){case FT:return function(){return new r(this,w)};case Sc:return function(){return new r(this,w)};case WT:return function(){return new r(this,w)}}return function(){return new r(this)}},l=t+" Iterator",u=!1,c=e.prototype,f=c[Ac]||c["@@iterator"]||o&&c[o],h=!Hp&&f||s(o),p=t=="Array"&&c.entries||f,y,m,v;if(p&&(y=BT(p.call(new e)),y!==Object.prototype&&y.next&&(BT(y)!==VT&&(LT?LT(y,VT):vJ(y[Ac])||Hw(y,Ac,RJ)),wJ(y,l,!0))),OJ&&o==Sc&&f&&f.name!==Sc&&(kJ?AJ(c,"name",Sc):(u=!0,h=function(){return mJ(f,this)})),o)if(m={values:s(Sc),keys:i?h:s(FT),entries:s(WT)},a)for(v in m)(Hp||u||!(v in c))&&Hw(c,v,m[v]);else gJ({target:t,proto:!0,forced:Hp||u},m);return c[Ac]!==h&&Hw(c,Ac,h,{name:o}),CJ[t]=h,m},gk=function(e,t){return{value:e,done:t}},EJ=Fn,mk=Xd,UT=Jd,VL=_o,TJ=mn.f,PJ=yk,Np=gk,MJ=Fe,FL="Array Iterator",IJ=VL.set,xJ=VL.getterFor(FL),jJ=PJ(Array,"Array",function(e,t){IJ(this,{type:FL,target:EJ(e),index:0,kind:t})},function(){var e=xJ(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Np(void 0,!0)):r=="keys"?Np(n,!1):r=="values"?Np(t[n],!1):Np([n,t[n]],!1)},"values"),YT=UT.Arguments=UT.Array;mk("keys");mk("values");mk("entries");if(MJ&&YT.name!=="values")try{TJ(YT,"name",{value:"values"})}catch{}var DJ=q1,_J=Ym,HJ=DJ?{}.toString:function(){return"[object "+_J(this)+"]"},NJ=q1,BJ=Jn,LJ=HJ;NJ||BJ(Object.prototype,"toString",LJ,{unsafe:!0});var VJ=ve,FJ=Jd,WJ=VJ("iterator"),UJ=Array.prototype,WL=function(e){return e!==void 0&&(FJ.Array===e||UJ[WJ]===e)},YJ=Ym,GT=Na,GJ=mr,zJ=Jd,QJ=ve,KJ=QJ("iterator"),vk=function(e){if(!GJ(e))return GT(e,KJ)||GT(e,"@@iterator")||zJ[YJ(e)]},XJ=Ke,JJ=Ha,ZJ=De,qJ=ic,$J=vk,tZ=TypeError,UL=function(e,t){var r=arguments.length<2?$J(e):t;if(JJ(r))return ZJ(XJ(r,e));throw tZ(qJ(e)+" is not iterable")},eZ=Ke,zT=De,nZ=Na,YL=function(e,t,r){var n,o;zT(e);try{if(n=nZ(e,"return"),!n){if(t==="throw")throw r;return r}n=eZ(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return zT(n),r},rZ=Gd,oZ=Ke,iZ=De,aZ=ic,sZ=WL,lZ=Zn,QT=Si,uZ=UL,cZ=vk,KT=YL,fZ=TypeError,Hy=function(e,t){this.stopped=e,this.result=t},XT=Hy.prototype,bk=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=rZ(t,n),u,c,f,h,p,y,m,v=function(C){return u&&KT(u,"normal",C),new Hy(!0,C)},w=function(C){return o?(iZ(C),s?l(C[0],C[1],v):l(C[0],C[1])):s?l(C,v):l(C)};if(i)u=e.iterator;else if(a)u=e;else{if(c=cZ(e),!c)throw fZ(aZ(e)+" is not iterable");if(sZ(c)){for(f=0,h=lZ(e);h>f;f++)if(p=w(e[f]),p&&QT(XT,p))return p;return new Hy(!1)}u=uZ(e,c)}for(y=i?e.next:u.next;!(m=oZ(y,u)).done;){try{p=w(m.value)}catch(C){KT(u,"throw",C)}if(typeof p=="object"&&p&&QT(XT,p))return p}return new Hy(!1)},hZ=Si,dZ=TypeError,wk=function(e,t){if(hZ(t,e))return e;throw dZ("Incorrect invocation")},pZ=ve,GL=pZ("iterator"),zL=!1;try{var yZ=0,JT={next:function(){return{done:!!yZ++}},return:function(){zL=!0}};JT[GL]=function(){return this},Array.from(JT,function(){throw 2})}catch{}var QL=function(e,t){if(!t&&!zL)return!1;var r=!1;try{var n={};n[GL]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},gZ=Ae,mZ=We,ZT=pk,Ak=function(e,t,r){var n,o;return ZT&&gZ(n=t.constructor)&&n!==r&&mZ(o=n.prototype)&&o!==r.prototype&&ZT(e,o),e},vZ=jt,bZ=me,wZ=Kt,qT=Um,AZ=Jn,SZ=Aa,CZ=bk,OZ=wk,kZ=Ae,RZ=mr,Nw=We,Bw=Wt,EZ=QL,TZ=zm,PZ=Ak,tv=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=bZ[e],s=a&&a.prototype,l=a,u={},c=function(w){var C=wZ(s[w]);AZ(s,w,w=="add"?function(A){return C(this,A===0?0:A),this}:w=="delete"?function(A){return o&&!Nw(A)?!1:C(this,A===0?0:A)}:w=="get"?function(A){return o&&!Nw(A)?void 0:C(this,A===0?0:A)}:w=="has"?function(A){return o&&!Nw(A)?!1:C(this,A===0?0:A)}:function(A,D){return C(this,A===0?0:A,D),this})},f=qT(e,!kZ(a)||!(o||s.forEach&&!Bw(function(){new a().entries().next()})));if(f)l=r.getConstructor(t,e,n,i),SZ.enable();else if(qT(e,!0)){var h=new l,p=h[i](o?{}:-0,1)!=h,y=Bw(function(){h.has(1)}),m=EZ(function(w){new a(w)}),v=!o&&Bw(function(){for(var w=new a,C=5;C--;)w[i](C,C);return!w.has(-0)});m||(l=t(function(w,C){OZ(w,s);var A=PZ(new a,w,l);return RZ(C)||CZ(C,A[i],{that:A,AS_ENTRIES:n}),A}),l.prototype=s,s.constructor=l),(y||v)&&(c("delete"),c("has"),n&&c("get")),(v||p)&&c(i),o&&s.clear&&delete s.clear}return u[e]=l,vZ({global:!0,constructor:!0,forced:l!=a},u),TZ(l,e),o||r.setStrong(l,e,n),l},MZ=Jn,Sk=function(e,t,r){for(var n in t)MZ(e,n,t[n],r);return e},IZ=Do,xZ=Ud,jZ=ve,DZ=Fe,$T=jZ("species"),KL=function(e){var t=IZ(e);DZ&&t&&!t[$T]&&xZ(t,$T,{configurable:!0,get:function(){return this}})},_Z=ac,HZ=Ud,tP=Sk,NZ=Gd,BZ=wk,LZ=mr,VZ=bk,FZ=yk,Bp=gk,WZ=KL,Cc=Fe,eP=Aa.fastKey,XL=_o,nP=XL.set,Lw=XL.getterFor,JL={getConstructor:function(e,t,r,n){var o=e(function(u,c){BZ(u,i),nP(u,{type:t,index:_Z(null),first:void 0,last:void 0,size:0}),Cc||(u.size=0),LZ(c)||VZ(c,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=Lw(t),s=function(u,c,f){var h=a(u),p=l(u,c),y,m;return p?p.value=f:(h.last=p={index:m=eP(c,!0),key:c,value:f,previous:y=h.last,next:void 0,removed:!1},h.first||(h.first=p),y&&(y.next=p),Cc?h.size++:u.size++,m!=="F"&&(h.index[m]=p)),u},l=function(u,c){var f=a(u),h=eP(c),p;if(h!=="F")return f.index[h];for(p=f.first;p;p=p.next)if(p.key==c)return p};return tP(i,{clear:function(){for(var u=this,c=a(u),f=c.index,h=c.first;h;)h.removed=!0,h.previous&&(h.previous=h.previous.next=void 0),delete f[h.index],h=h.next;c.first=c.last=void 0,Cc?c.size=0:u.size=0},delete:function(u){var c=this,f=a(c),h=l(c,u);if(h){var p=h.next,y=h.previous;delete f.index[h.index],h.removed=!0,y&&(y.next=p),p&&(p.previous=y),f.first==h&&(f.first=p),f.last==h&&(f.last=y),Cc?f.size--:c.size--}return!!h},forEach:function(u){for(var c=a(this),f=NZ(u,arguments.length>1?arguments[1]:void 0),h;h=h?h.next:c.first;)for(f(h.value,h.key,this);h&&h.removed;)h=h.previous},has:function(u){return!!l(this,u)}}),tP(i,r?{get:function(u){var c=l(this,u);return c&&c.value},set:function(u,c){return s(this,u===0?0:u,c)}}:{add:function(u){return s(this,u=u===0?0:u,u)}}),Cc&&HZ(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=Lw(t),i=Lw(n);FZ(e,t,function(a,s){nP(this,{type:n,target:a,state:o(a),kind:s,last:void 0})},function(){for(var a=i(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,Bp(void 0,!0)):s=="keys"?Bp(l.key,!1):s=="values"?Bp(l.value,!1):Bp([l.key,l.value],!1)},r?"entries":"values",!r,!0),WZ(t)}},UZ=tv,YZ=JL;UZ("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},YZ);var Ck=Kt,GZ=Ci,zZ=Ue,QZ=Rn,KZ=Ck("".charAt),rP=Ck("".charCodeAt),XZ=Ck("".slice),oP=function(e){return function(t,r){var n=zZ(QZ(t)),o=GZ(r),i=n.length,a,s;return o<0||o>=i?e?"":void 0:(a=rP(n,o),a<55296||a>56319||o+1===i||(s=rP(n,o+1))<56320||s>57343?e?KZ(n,o):a:e?XZ(n,o,o+2):(a-55296<<10)+(s-56320)+65536)}},Ok={codeAt:oP(!1),charAt:oP(!0)},JZ=Ok.charAt,ZZ=Ue,ZL=_o,qZ=yk,iP=gk,qL="String Iterator",$Z=ZL.set,tq=ZL.getterFor(qL);qZ(String,"String",function(e){$Z(this,{type:qL,string:ZZ(e),index:0})},function(){var e=tq(this),t=e.string,r=e.index,n;return r>=t.length?iP(void 0,!0):(n=JZ(t,r),e.index+=n.length,iP(n,!1))});var $L={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},eq=Fm,Vw=eq("span").classList,aP=Vw&&Vw.constructor&&Vw.constructor.prototype,tV=aP===Object.prototype?void 0:aP,sP=me,eV=$L,nq=tV,tf=jJ,Fw=Ba,nV=ve,Ww=nV("iterator"),lP=nV("toStringTag"),Uw=tf.values,rV=function(e,t){if(e){if(e[Ww]!==Uw)try{Fw(e,Ww,Uw)}catch{e[Ww]=Uw}if(e[lP]||Fw(e,lP,t),eV[t]){for(var r in tf)if(e[r]!==tf[r])try{Fw(e,r,tf[r])}catch{e[r]=tf[r]}}}};for(var Yw in eV)rV(sP[Yw]&&sP[Yw].prototype,Yw);rV(nq,"DOMTokenList");var rq=jt,oq=J1.includes,iq=Wt,aq=Xd,sq=iq(function(){return!Array(1).includes()});rq({target:"Array",proto:!0,forced:sq},{includes:function(e){return oq(this,e,arguments.length>1?arguments[1]:void 0)}});aq("includes");var uP=ic,lq=TypeError,oV=function(e,t){if(!delete e[t])throw lq("Cannot delete property "+uP(t)+" of "+uP(e))},cP=tk,uq=Math.floor,lS=function(e,t){var r=e.length,n=uq(r/2);return r<8?cq(e,t):fq(e,lS(cP(e,0,n),t),lS(cP(e,n),t),t)},cq=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},fq=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,s=0;a<o||s<i;)e[a+s]=a<o&&s<i?n(t[a],r[s])<=0?t[a++]:r[s++]:a<o?t[a++]:r[s++];return e},hq=lS,dq=Wt,uc=function(e,t){var r=[][e];return!!r&&dq(function(){r.call(null,t||function(){return 1},1)})},pq=_a,fP=pq.match(/firefox\/(\d+)/i),yq=!!fP&&+fP[1],gq=_a,mq=/MSIE|Trident/.test(gq),vq=_a,hP=vq.match(/AppleWebKit\/(\d+)\./),bq=!!hP&&+hP[1],wq=jt,iV=Kt,Aq=Ha,Sq=En,dP=Zn,Cq=oV,pP=Ue,kk=Wt,Oq=hq,kq=uc,yP=yq,Rq=mq,gP=_d,mP=bq,Zo=[],vP=iV(Zo.sort),Eq=iV(Zo.push),Tq=kk(function(){Zo.sort(void 0)}),Pq=kk(function(){Zo.sort(null)}),Mq=kq("sort"),aV=!kk(function(){if(gP)return gP<70;if(!(yP&&yP>3)){if(Rq)return!0;if(mP)return mP<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)Zo.push({k:r+o,v:n})}for(Zo.sort(function(i,a){return a.v-i.v}),o=0;o<Zo.length;o++)r=Zo[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),Iq=Tq||!Pq||!Mq||!aV,xq=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:pP(t)>pP(r)?1:-1}};wq({target:"Array",proto:!0,forced:Iq},{sort:function(e){e!==void 0&&Aq(e);var t=Sq(this);if(aV)return e===void 0?vP(t):vP(t,e);var r=[],n=dP(t),o,i;for(i=0;i<n;i++)i in t&&Eq(r,t[i]);for(Oq(r,xq(e)),o=dP(r),i=0;i<o;)t[i]=r[i++];for(;i<n;)Cq(t,i++);return t}});var jq=Fe,Dq=lc,_q=TypeError,Hq=Object.getOwnPropertyDescriptor,Nq=jq&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),Bq=Nq?function(e,t){if(Dq(e)&&!Hq(e,"length").writable)throw _q("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Lq=TypeError,Vq=9007199254740991,sV=function(e){if(e>Vq)throw Lq("Maximum allowed index exceeded");return e},Fq=Wt,Wq=ve,Uq=_d,Yq=Wq("species"),Zd=function(e){return Uq>=51||!Fq(function(){var t=[],r=t.constructor={};return r[Yq]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Gq=jt,zq=En,Qq=Ld,Kq=Ci,Xq=Zn,Jq=Bq,Zq=sV,qq=ok,$q=sc,Gw=oV,t6=Zd,e6=t6("splice"),n6=Math.max,r6=Math.min;Gq({target:"Array",proto:!0,forced:!e6},{splice:function(e,t){var r=zq(this),n=Xq(r),o=Qq(e,n),i=arguments.length,a,s,l,u,c,f;for(i===0?a=s=0:i===1?(a=0,s=n-o):(a=i-2,s=r6(n6(Kq(t),0),n-o)),Zq(n+a-s),l=qq(r,s),u=0;u<s;u++)c=o+u,c in r&&$q(l,u,r[c]);if(l.length=s,a<s){for(u=o;u<n-s;u++)c=u+s,f=u+a,c in r?r[f]=r[c]:Gw(r,f);for(u=n;u>n-s+a;u--)Gw(r,u-1)}else if(a>s)for(u=n-s;u>o;u--)c=u+s-1,f=u+a-1,c in r?r[f]=r[c]:Gw(r,f);for(u=0;u<a;u++)r[u+o]=arguments[u+2];return Jq(r,n-s+a),l}});var o6=We,i6=Math.floor,a6=Number.isInteger||function(e){return!o6(e)&&isFinite(e)&&i6(e)===e},s6=jt,l6=a6;s6({target:"Number",stat:!0},{isInteger:l6});var u6=Kt,lV=u6(1 .valueOf),uV=`	
\v\f\r \u2028\u2029\uFEFF`,c6=Kt,f6=Rn,h6=Ue,uS=uV,bP=c6("".replace),d6=RegExp("^["+uS+"]+"),p6=RegExp("(^|[^"+uS+"])["+uS+"]+$"),zw=function(e){return function(t){var r=h6(f6(t));return e&1&&(r=bP(r,d6,"")),e&2&&(r=bP(r,p6,"$1")),r}},cV={start:zw(1),end:zw(2),trim:zw(3)},y6=jt,fV=Qz,g6=Fe,hV=me,dV=oL,pV=Kt,m6=Um,wP=Me,v6=Ak,b6=Si,w6=Hd,yV=FB,A6=Wt,S6=La.f,C6=Hr.f,O6=mn.f,k6=lV,R6=cV.trim,ev="Number",Ds=hV[ev];dV[ev];var Rk=Ds.prototype,E6=hV.TypeError,T6=pV("".slice),Lp=pV("".charCodeAt),P6=function(e){var t=yV(e,"number");return typeof t=="bigint"?t:M6(t)},M6=function(e){var t=yV(e,"number"),r,n,o,i,a,s,l,u;if(w6(t))throw E6("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=R6(t),r=Lp(t,0),r===43||r===45){if(n=Lp(t,2),n===88||n===120)return NaN}else if(r===48){switch(Lp(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=T6(t,2),s=a.length,l=0;l<s;l++)if(u=Lp(a,l),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},Ek=m6(ev,!Ds(" 0o1")||!Ds("0b1")||Ds("+0x1")),I6=function(e){return b6(Rk,e)&&A6(function(){k6(e)})},nv=function(e){var t=arguments.length<1?0:Ds(P6(e));return I6(this)?v6(Object(t),this,nv):t};nv.prototype=Rk;Ek&&!fV&&(Rk.constructor=nv);y6({global:!0,constructor:!0,wrap:!0,forced:Ek},{Number:nv});var x6=function(e,t){for(var r=g6?S6(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)wP(t,o=r[n])&&!wP(e,o)&&O6(e,o,C6(t,o))};(Ek||fV)&&x6(dV[ev],Ds);var j6=jt,AP=lc,D6=Qm,_6=We,SP=Ld,H6=Zn,N6=Fn,B6=sc,L6=ve,V6=Zd,F6=Qd,W6=V6("slice"),U6=L6("species"),Qw=Array,Y6=Math.max;j6({target:"Array",proto:!0,forced:!W6},{slice:function(e,t){var r=N6(this),n=H6(r),o=SP(e,n),i=SP(t===void 0?n:t,n),a,s,l;if(AP(r)&&(a=r.constructor,D6(a)&&(a===Qw||AP(a.prototype))?a=void 0:_6(a)&&(a=a[U6],a===null&&(a=void 0)),a===Qw||a===void 0))return F6(r,o,i);for(s=new(a===void 0?Qw:a)(Y6(i-o,0)),l=0;o<i;o++,l++)o in r&&B6(s,l,r[o]);return s.length=l,s}});var G6=jt,z6=Wt,Q6=lc,K6=We,X6=En,J6=Zn,CP=sV,OP=sc,Z6=ok,q6=Zd,$6=ve,t9=_d,gV=$6("isConcatSpreadable"),e9=t9>=51||!z6(function(){var e=[];return e[gV]=!1,e.concat()[0]!==e}),n9=function(e){if(!K6(e))return!1;var t=e[gV];return t!==void 0?!!t:Q6(e)},r9=!e9||!q6("concat");G6({target:"Array",proto:!0,arity:1,forced:r9},{concat:function(e){var t=X6(this),r=Z6(t,0),n=0,o,i,a,s,l;for(o=-1,a=arguments.length;o<a;o++)if(l=o===-1?t:arguments[o],n9(l))for(s=J6(l),CP(n+s),i=0;i<s;i++,n++)i in l&&OP(r,n,l[i]);else CP(n+1),OP(r,n++,l);return r.length=n,r}});var o9=En,kP=Ld,i9=Zn,a9=function(e){for(var t=o9(this),r=i9(t),n=arguments.length,o=kP(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=i===void 0?r:kP(i,r);a>o;)t[o++]=e;return t},s9=jt,l9=a9,u9=Xd;s9({target:"Array",proto:!0},{fill:l9});u9("fill");var c9=jt,f9=Fa.map,h9=Zd,d9=h9("map");c9({target:"Array",proto:!0,forced:!d9},{map:function(e){return f9(this,e,arguments.length>1?arguments[1]:void 0)}});var p9=De,mV=function(){var e=p9(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Tk=Wt,y9=me,Pk=y9.RegExp,Mk=Tk(function(){var e=Pk("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),g9=Mk||Tk(function(){return!Pk("a","y").sticky}),m9=Mk||Tk(function(){var e=Pk("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),Ik={BROKEN_CARET:m9,MISSED_STICKY:g9,UNSUPPORTED_Y:Mk},v9=Wt,b9=me,w9=b9.RegExp,vV=v9(function(){var e=w9(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),A9=Wt,S9=me,C9=S9.RegExp,bV=A9(function(){var e=C9("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Ps=Ke,rv=Kt,O9=Ue,k9=mV,R9=Ik,E9=gi,T9=ac,P9=_o.get,M9=vV,I9=bV,x9=E9("native-string-replace",String.prototype.replace),Rg=RegExp.prototype.exec,cS=Rg,j9=rv("".charAt),D9=rv("".indexOf),_9=rv("".replace),Kw=rv("".slice),fS=function(){var e=/a/,t=/b*/g;return Ps(Rg,e,"a"),Ps(Rg,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),wV=R9.BROKEN_CARET,hS=/()??/.exec("")[1]!==void 0,H9=fS||hS||wV||M9||I9;H9&&(cS=function(e){var t=this,r=P9(t),n=O9(e),o=r.raw,i,a,s,l,u,c,f;if(o)return o.lastIndex=t.lastIndex,i=Ps(cS,o,n),t.lastIndex=o.lastIndex,i;var h=r.groups,p=wV&&t.sticky,y=Ps(k9,t),m=t.source,v=0,w=n;if(p&&(y=_9(y,"y",""),D9(y,"g")===-1&&(y+="g"),w=Kw(n,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&j9(n,t.lastIndex-1)!==`
`)&&(m="(?: "+m+")",w=" "+w,v++),a=new RegExp("^(?:"+m+")",y)),hS&&(a=new RegExp("^"+m+"$(?!\\s)",y)),fS&&(s=t.lastIndex),l=Ps(Rg,p?a:t,w),p?l?(l.input=Kw(l.input,v),l[0]=Kw(l[0],v),l.index=t.lastIndex,t.lastIndex+=l[0].length):t.lastIndex=0:fS&&l&&(t.lastIndex=t.global?l.index+l[0].length:s),hS&&l&&l.length>1&&Ps(x9,l[0],a,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(l[u]=void 0)}),l&&h)for(l.groups=c=T9(null),u=0;u<h.length;u++)f=h[u],c[f[0]]=l[f[1]];return l});var ov=cS,N9=jt,RP=ov;N9({target:"RegExp",proto:!0,forced:/./.exec!==RP},{exec:RP});var EP=Yd,TP=Jn,B9=ov,PP=Wt,AV=ve,L9=Ba,V9=AV("species"),Xw=RegExp.prototype,iv=function(e,t,r,n){var o=AV(e),i=!PP(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!PP(function(){var u=!1,c=/a/;return e==="split"&&(c={},c.constructor={},c.constructor[V9]=function(){return c},c.flags="",c[o]=/./[o]),c.exec=function(){return u=!0,null},c[o](""),!u});if(!i||!a||r){var s=EP(/./[o]),l=t(o,""[e],function(u,c,f,h,p){var y=EP(u),m=c.exec;return m===B9||m===Xw.exec?i&&!p?{done:!0,value:s(c,f,h)}:{done:!0,value:y(f,c,h)}:{done:!1}});TP(String.prototype,e,l[0]),TP(Xw,o,l[1])}n&&L9(Xw[o],"sham",!0)},F9=Ok.charAt,xk=function(e,t,r){return t+(r?F9(e,t).length:1)},jk=Kt,W9=En,U9=Math.floor,Jw=jk("".charAt),Y9=jk("".replace),Zw=jk("".slice),G9=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,z9=/\$([$&'`]|\d{1,2})/g,Q9=function(e,t,r,n,o,i){var a=r+e.length,s=n.length,l=z9;return o!==void 0&&(o=W9(o),l=G9),Y9(i,l,function(u,c){var f;switch(Jw(c,0)){case"$":return"$";case"&":return e;case"`":return Zw(t,0,r);case"'":return Zw(t,a);case"<":f=o[Zw(c,1,-1)];break;default:var h=+c;if(h===0)return u;if(h>s){var p=U9(h/10);return p===0?u:p<=s?n[p-1]===void 0?Jw(c,1):n[p-1]+Jw(c,1):u}f=n[h-1]}return f===void 0?"":f})},MP=Ke,K9=De,X9=Ae,J9=Nr,Z9=ov,q9=TypeError,av=function(e,t){var r=e.exec;if(X9(r)){var n=MP(r,e,t);return n!==null&&K9(n),n}if(J9(e)==="RegExp")return MP(Z9,e,t);throw q9("RegExp#exec called on incompatible receiver")},$9=Wa,IP=Ke,sv=Kt,t5=iv,e5=Wt,n5=De,r5=Ae,o5=mr,i5=Ci,a5=Va,Ja=Ue,s5=Rn,l5=xk,u5=Na,c5=Q9,f5=av,h5=ve,dS=h5("replace"),d5=Math.max,p5=Math.min,y5=sv([].concat),qw=sv([].push),xP=sv("".indexOf),jP=sv("".slice),g5=function(e){return e===void 0?e:String(e)},m5=function(){return"a".replace(/./,"$0")==="$0"}(),DP=function(){return/./[dS]?/./[dS]("a","$0")==="":!1}(),v5=!e5(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});t5("replace",function(e,t,r){var n=DP?"$":"$0";return[function(o,i){var a=s5(this),s=o5(o)?void 0:u5(o,dS);return s?IP(s,o,a,i):IP(t,Ja(a),o,i)},function(o,i){var a=n5(this),s=Ja(o);if(typeof i=="string"&&xP(i,n)===-1&&xP(i,"$<")===-1){var l=r(t,a,s,i);if(l.done)return l.value}var u=r5(i);u||(i=Ja(i));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var h=[];;){var p=f5(a,s);if(p===null||(qw(h,p),!c))break;var y=Ja(p[0]);y===""&&(a.lastIndex=l5(s,a5(a.lastIndex),f))}for(var m="",v=0,w=0;w<h.length;w++){p=h[w];for(var C=Ja(p[0]),A=d5(p5(i5(p.index),s.length),0),D=[],E=1;E<p.length;E++)qw(D,g5(p[E]));var G=p.groups;if(u){var K=y5([C],D,A,s);G!==void 0&&qw(K,G);var nt=Ja($9(i,void 0,K))}else nt=c5(C,s,A,D,G,i);A>=v&&(m+=jP(s,v,A)+nt,v=A+C.length)}return m+jP(s,v)}]},!v5||!m5||DP);var b5=De,w5=YL,A5=function(e,t,r,n){try{return n?t(b5(r)[0],r[1]):t(r)}catch(o){w5(e,"throw",o)}},S5=Gd,C5=Ke,O5=En,k5=A5,R5=WL,E5=Qm,T5=Zn,_P=sc,P5=UL,M5=vk,HP=Array,I5=function(e){var t=O5(e),r=E5(this),n=arguments.length,o=n>1?arguments[1]:void 0,i=o!==void 0;i&&(o=S5(o,n>2?arguments[2]:void 0));var a=M5(t),s=0,l,u,c,f,h,p;if(a&&!(this===HP&&R5(a)))for(f=P5(t,a),h=f.next,u=r?new this:[];!(c=C5(h,f)).done;s++)p=i?k5(f,o,[c.value,s],!0):c.value,_P(u,s,p);else for(l=T5(t),u=r?new this(l):HP(l);l>s;s++)p=i?o(t[s],s):t[s],_P(u,s,p);return u.length=s,u},x5=jt,j5=I5,D5=QL,_5=!D5(function(e){Array.from(e)});x5({target:"Array",stat:!0,forced:_5},{from:j5});var H5=jt,N5=Yd,B5=J1.indexOf,L5=uc,pS=N5([].indexOf),SV=!!pS&&1/pS([1],1,-0)<0,V5=SV||!L5("indexOf");H5({target:"Array",proto:!0,forced:V5},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return SV?pS(this,e,t)||0:B5(this,e,t)}});var F5=jt,W5=Kt,U5=lc,Y5=W5([].reverse),NP=[1,2];F5({target:"Array",proto:!0,forced:String(NP)===String(NP.reverse())},{reverse:function(){return U5(this)&&(this.length=this.length),Y5(this)}});var G5=Fa.forEach,z5=uc,Q5=z5("forEach"),K5=Q5?[].forEach:function(e){return G5(this,e,arguments.length>1?arguments[1]:void 0)},BP=me,LP=$L,X5=tV,$w=K5,J5=Ba,CV=function(e){if(e&&e.forEach!==$w)try{J5(e,"forEach",$w)}catch{e.forEach=$w}};for(var tA in LP)LP[tA]&&CV(BP[tA]&&BP[tA].prototype);CV(X5);var Z5=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",q5=TypeError,OV=function(e,t){if(e<t)throw q5("Not enough arguments");return e},kV=me,$5=Wa,t7=Ae,e7=Z5,n7=_a,r7=Qd,o7=OV,i7=kV.Function,a7=/MSIE .\./.test(n7)||e7&&function(){var e=kV.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),Dk=function(e,t){var r=t?2:1;return a7?function(n,o){var i=o7(arguments.length,1)>r,a=t7(n)?n:i7(n),s=i?r7(arguments,r):[],l=i?function(){$5(a,this,s)}:a;return t?e(l,o):e(l)}:e},s7=jt,RV=me,l7=Dk,VP=l7(RV.setInterval,!0);s7({global:!0,bind:!0,forced:RV.setInterval!==VP},{setInterval:VP});var u7=jt,EV=me,c7=Dk,FP=c7(EV.setTimeout,!0);u7({global:!0,bind:!0,forced:EV.setTimeout!==FP},{setTimeout:FP});var f7=_a,h7=/(?:ipad|iphone|ipod).*applewebkit/i.test(f7),d7=Nr,TV=typeof process<"u"&&d7(process)=="process",Bn=me,p7=Wa,y7=Gd,WP=Ae,g7=Me,PV=Wt,UP=$B,m7=Qd,YP=Fm,v7=OV,b7=h7,w7=TV,yS=Bn.setImmediate,gS=Bn.clearImmediate,A7=Bn.process,eA=Bn.Dispatch,S7=Bn.Function,GP=Bn.MessageChannel,C7=Bn.String,nA=0,sf={},zP="onreadystatechange",Ef,Ei,rA,oA;PV(function(){Ef=Bn.location});var _k=function(e){if(g7(sf,e)){var t=sf[e];delete sf[e],t()}},iA=function(e){return function(){_k(e)}},QP=function(e){_k(e.data)},KP=function(e){Bn.postMessage(C7(e),Ef.protocol+"//"+Ef.host)};(!yS||!gS)&&(yS=function(e){v7(arguments.length,1);var t=WP(e)?e:S7(e),r=m7(arguments,1);return sf[++nA]=function(){p7(t,void 0,r)},Ei(nA),nA},gS=function(e){delete sf[e]},w7?Ei=function(e){A7.nextTick(iA(e))}:eA&&eA.now?Ei=function(e){eA.now(iA(e))}:GP&&!b7?(rA=new GP,oA=rA.port2,rA.port1.onmessage=QP,Ei=y7(oA.postMessage,oA)):Bn.addEventListener&&WP(Bn.postMessage)&&!Bn.importScripts&&Ef&&Ef.protocol!=="file:"&&!PV(KP)?(Ei=KP,Bn.addEventListener("message",QP,!1)):zP in YP("script")?Ei=function(e){UP.appendChild(YP("script"))[zP]=function(){UP.removeChild(this),_k(e)}}:Ei=function(e){setTimeout(iA(e),0)});var MV={set:yS,clear:gS},O7=jt,k7=me,XP=MV.clear;O7({global:!0,bind:!0,enumerable:!0,forced:k7.clearImmediate!==XP},{clearImmediate:XP});var R7=jt,IV=me,JP=MV.set,E7=Dk,ZP=IV.setImmediate?E7(JP,!1):JP;R7({global:!0,bind:!0,enumerable:!0,forced:IV.setImmediate!==ZP},{setImmediate:ZP});var T7=tv,P7=JL;T7("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},P7);var M7=jt,I7=Wt,x7=En,xV=$m,j7=_L,D7=I7(function(){xV(1)});M7({target:"Object",stat:!0,forced:D7,sham:!j7},{getPrototypeOf:function(e){return xV(x7(e))}});var _7=We,H7=Nr,N7=ve,B7=N7("match"),Hk=function(e){var t;return _7(e)&&((t=e[B7])!==void 0?!!t:H7(e)=="RegExp")},L7=Hk,V7=TypeError,Nk=function(e){if(L7(e))throw V7("The method doesn't accept regular expressions");return e},F7=ve,W7=F7("match"),Bk=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[W7]=!1,"/./"[e](t)}catch{}}return!1},U7=jt,Y7=Kt,G7=Nk,z7=Rn,qP=Ue,Q7=Bk,K7=Y7("".indexOf);U7({target:"String",proto:!0,forced:!Q7("includes")},{includes:function(e){return!!~K7(qP(z7(this)),qP(G7(e)),arguments.length>1?arguments[1]:void 0)}});var X7=jt,J7=Fa.filter,Z7=Zd,q7=Z7("filter");X7({target:"Array",proto:!0,forced:!q7},{filter:function(e){return J7(this,e,arguments.length>1?arguments[1]:void 0)}});var $7=Ke,t$=Me,e$=Si,n$=mV,$P=RegExp.prototype,jV=function(e){var t=e.flags;return t===void 0&&!("flags"in $P)&&!t$(e,"flags")&&e$($P,e)?$7(n$,e):t},r$=mn.f,o$=function(e,t,r){r in e||r$(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},i$=Fe,Lk=me,qd=Kt,a$=Um,s$=Ak,l$=Ba,u$=La.f,tM=Si,c$=Hk,eM=Ue,f$=jV,DV=Ik,h$=o$,d$=Jn,p$=Wt,y$=Me,g$=_o.enforce,m$=KL,v$=ve,_V=vV,HV=bV,b$=v$("match"),ei=Lk.RegExp,Os=ei.prototype,w$=Lk.SyntaxError,A$=qd(Os.exec),Eg=qd("".charAt),nM=qd("".replace),rM=qd("".indexOf),S$=qd("".slice),C$=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,ba=/a/g,aA=/a/g,O$=new ei(ba)!==ba,NV=DV.MISSED_STICKY,k$=DV.UNSUPPORTED_Y,R$=i$&&(!O$||NV||_V||HV||p$(function(){return aA[b$]=!1,ei(ba)!=ba||ei(aA)==aA||ei(ba,"i")!="/a/i"})),E$=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Eg(e,r),i==="\\"){n+=i+Eg(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},T$=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,s=!1,l=0,u="",c;r<=t;r++){if(c=Eg(e,r),c==="\\")c=c+Eg(e,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":A$(C$,S$(e,r+1))&&(r+=2,s=!0),n+=c,l++;continue;case(c===">"&&s):if(u===""||y$(i,u))throw new w$("Invalid capture group name");i[u]=!0,o[o.length]=[u,l],s=!1,u="";continue}s?u+=c:n+=c}return[n,o]};if(a$("RegExp",R$)){for(var Ti=function(e,t){var r=tM(Os,this),n=c$(e),o=t===void 0,i=[],a=e,s,l,u,c,f,h;if(!r&&n&&o&&e.constructor===Ti)return e;if((n||tM(Os,e))&&(e=e.source,o&&(t=f$(a))),e=e===void 0?"":eM(e),t=t===void 0?"":eM(t),a=e,_V&&"dotAll"in ba&&(l=!!t&&rM(t,"s")>-1,l&&(t=nM(t,/s/g,""))),s=t,NV&&"sticky"in ba&&(u=!!t&&rM(t,"y")>-1,u&&k$&&(t=nM(t,/y/g,""))),HV&&(c=T$(e),e=c[0],i=c[1]),f=s$(ei(e,t),r?this:Os,Ti),(l||u||i.length)&&(h=g$(f),l&&(h.dotAll=!0,h.raw=Ti(E$(e),s)),u&&(h.sticky=!0),i.length&&(h.groups=i)),e!==a)try{l$(f,"source",a===""?"(?:)":a)}catch{}return f},oM=u$(ei),iM=0;oM.length>iM;)h$(Ti,ei,oM[iM++]);Os.constructor=Ti,Ti.prototype=Os,d$(Lk,"RegExp",Ti,{constructor:!0})}m$("RegExp");var P$=Nd.PROPER,M$=Jn,I$=De,aM=Ue,x$=Wt,j$=jV,Vk="toString",D$=RegExp.prototype,BV=D$[Vk],_$=x$(function(){return BV.call({source:"a",flags:"b"})!="/a/b"}),H$=P$&&BV.name!=Vk;(_$||H$)&&M$(RegExp.prototype,Vk,function(){var e=I$(this),t=aM(e.source),r=aM(j$(e));return"/"+t+"/"+r},{unsafe:!0});var N$=jt,B$=Kt,L$=Dd,V$=Fn,F$=uc,W$=B$([].join),U$=L$!=Object,Y$=U$||!F$("join",",");N$({target:"Array",proto:!0,forced:Y$},{join:function(e){return W$(V$(this),e===void 0?",":e)}});var G$=Nd.PROPER,z$=Wt,sM=uV,lM="",Q$=function(e){return z$(function(){return!!sM[e]()||lM[e]()!==lM||G$&&sM[e].name!==e})},K$=jt,X$=cV.trim,J$=Q$;K$({target:"String",proto:!0,forced:J$("trim")},{trim:function(){return X$(this)}});function mS(e){return mS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mS(e)}function lv(e){return window.requestAnimationFrame(e)}function LV(){return!!document.documentElement.classList}function VV(){return!!document.createTextNode("test").textContent}function FV(){return!!window.getComputedStyle}function Tf(e){window.cancelAnimationFrame(e)}function Fk(){return"ontouchstart"in window}var vS;function Z$(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),vS=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function Wk(){return vS===void 0&&Z$(),vS}var Oc;function WV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Oc||((typeof Intl>"u"?"undefined":mS(Intl))==="object"?Oc=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?Oc=function(r,n){return"".concat(r).localeCompare(n)}:Oc=function(r,n){return r===n?0:r>n?-1:1},Oc)}var kc;function UV(){if(kc!==void 0)return kc;try{var e={get passive(){kc=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{kc=!1}return kc}const q$=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Tf,getComparisonFunction:WV,hasCaptionProblem:Wk,isClassListSupported:LV,isGetComputedStyleSupported:FV,isPassiveEventSupported:UV,isTextContentSupported:VV,isTouchSupported:Fk,requestAnimationFrame:lv},Symbol.toStringTag,{value:"Module"}));var $$=nk,ttt=iL;$$("toPrimitive");ttt();var ett=De,ntt=VB,rtt=TypeError,ott=function(e){if(ett(this),e==="string"||e==="default")e="string";else if(e!=="number")throw rtt("Incorrect hint");return ntt(this,e)},itt=Me,att=Jn,stt=ott,ltt=ve,uM=ltt("toPrimitive"),cM=Date.prototype;itt(cM,uM)||att(cM,uM,stt);var utt=Qm,ctt=ic,ftt=TypeError,YV=function(e){if(utt(e))return e;throw ftt(ctt(e)+" is not a constructor")},fM=De,htt=YV,dtt=mr,ptt=ve,ytt=ptt("species"),gtt=function(e,t){var r=fM(e).constructor,n;return r===void 0||dtt(n=fM(r)[ytt])?t:htt(n)},mtt=Wa,Rc=Ke,Uk=Kt,vtt=iv,btt=De,wtt=mr,Att=Hk,hM=Rn,Stt=gtt,Ctt=xk,Ott=Va,sA=Ue,ktt=Na,dM=tk,pM=av,Rtt=ov,Ett=Ik,Ttt=Wt,Za=Ett.UNSUPPORTED_Y,yM=4294967295,Ptt=Math.min,GV=[].push,Mtt=Uk(/./.exec),qa=Uk(GV),Ec=Uk("".slice),Itt=!Ttt(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});vtt("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=sA(hM(this)),s=i===void 0?yM:i>>>0;if(s===0)return[];if(o===void 0)return[a];if(!Att(o))return Rc(t,a,o,s);for(var l=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),c=0,f=new RegExp(o.source,u+"g"),h,p,y;(h=Rc(Rtt,f,a))&&(p=f.lastIndex,!(p>c&&(qa(l,Ec(a,c,h.index)),h.length>1&&h.index<a.length&&mtt(GV,l,dM(h,1)),y=h[0].length,c=p,l.length>=s)));)f.lastIndex===h.index&&f.lastIndex++;return c===a.length?(y||!Mtt(f,""))&&qa(l,""):qa(l,Ec(a,c)),l.length>s?dM(l,0,s):l}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Rc(t,this,o,i)}:n=t,[function(o,i){var a=hM(this),s=wtt(o)?void 0:ktt(o,e);return s?Rc(s,o,a,i):Rc(n,sA(a),o,i)},function(o,i){var a=btt(this),s=sA(o),l=r(n,a,s,i,n!==t);if(l.done)return l.value;var u=Stt(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Za?"g":"y"),h=new u(Za?"^(?:"+a.source+")":a,f),p=i===void 0?yM:i>>>0;if(p===0)return[];if(s.length===0)return pM(h,s)===null?[s]:[];for(var y=0,m=0,v=[];m<s.length;){h.lastIndex=Za?0:m;var w=pM(h,Za?Ec(s,m):s),C;if(w===null||(C=Ptt(Ott(h.lastIndex+(Za?m:0)),s.length))===y)m=Ctt(s,m,c);else{if(qa(v,Ec(s,y,m)),v.length===p)return v;for(var A=1;A<=w.length-1;A++)if(qa(v,w[A]),v.length===p)return v;m=y=C}}return qa(v,Ec(s,y)),v}]},!Itt,Za);function zV(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function bS(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function lf(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function _e(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var s=i.length;for(n&&s&&(o+=1,a=i[o]),o+=1;o<s;)a=t(a,i[o],o,i),o+=1;return a}function Ln(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];t(s,r,n)&&(a+=1,i[a]=s),r+=1}return i}function Gt(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];a+=1,i[a]=t(s,r,n),r+=1}return i}function T(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function QV(e){return _e(e,function(t,r){return t+r},0)}function xtt(e){return _e(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function jtt(e){return _e(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function Dtt(e){return e.length?QV(e)/e.length:0}function KV(e){return _e(e,function(t,r){return t.concat(Array.isArray(r)?KV(r):r)},[])}function Yk(e){var t=[];return T(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function wS(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return T(i,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function _tt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return T(i,function(s){a=a.filter(function(l){return s.includes(l)})}),a}function Htt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return T(i,function(s){T(s,function(l){a.has(l)||a.add(l)})}),Array.from(a)}function AS(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const Ntt=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Dtt,arrayEach:T,arrayFilter:Ln,arrayFlatten:KV,arrayMap:Gt,arrayMax:xtt,arrayMin:jtt,arrayReduce:_e,arraySum:QV,arrayUnique:Yk,extendArray:bS,getDifferenceOfArrays:wS,getIntersectionOfArrays:_tt,getUnionOfArrays:Htt,pivot:lf,stringToArray:AS,to2dArray:zV},Symbol.toStringTag,{value:"Module"}));function gM(e,t,r){return t=Btt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Btt(e){var t=Ltt(e,"string");return Io(t)==="symbol"?t:String(t)}function Ltt(e,t){if(Io(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Io(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Io(e){return Io=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Io(e)}function qs(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},Qt(e,function(r,n){n!=="__children"&&(r&&Io(r)==="object"&&!Array.isArray(r)?t[n]=qs(r):Array.isArray(r)?r.length&&Io(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[qs(r[0])]:t[n]=[]:t[n]=null)})),t}function Ho(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function Ve(e,t,r){var n=Array.isArray(r);return Qt(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function $d(e,t){Qt(t,function(r,n){t[n]&&Io(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),$d(e[n],t[n])):e[n]=t[n]})}function on(e){return Io(e)==="object"?JSON.parse(JSON.stringify(e)):e}function yn(e){var t={};return Qt(e,function(r,n){t[n]=r}),t}function pe(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return T(r,function(o){e.MIXINS.push(o.MIXIN_NAME),Qt(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var s=function(u,c){var f="_".concat(u),h=function(p){var y=p;return(Array.isArray(y)||zt(y))&&(y=on(y)),y};return function(){return this[f]===void 0&&(this[f]=h(c)),this[f]}},l=function(u){var c="_".concat(u);return function(f){this[c]=f}};Object.defineProperty(e.prototype,a,{get:s(a,i),set:l(a),configurable:!0})}})}),e}function Gk(e,t){return JSON.stringify(e)===JSON.stringify(t)}function zt(e){return Object.prototype.toString.call(e)==="[object Object]"}function Br(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function Qt(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function XV(e,t){var r=t.split("."),n=e;return Qt(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function Ny(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(Te(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function uv(e){if(!zt(e))return 0;var t=function r(n){var o=0;return zt(n)?Qt(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function Ca(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},gM(t,n,e),gM(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),o}function Te(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Vtt=Object.freeze(Object.defineProperty({__proto__:null,clone:yn,createObjectPropListener:Ca,deepClone:on,deepExtend:$d,deepObjectSize:uv,defineGetter:Br,duckSchema:qs,extend:Ve,getProperty:XV,hasOwnProperty:Te,inherit:Ho,isObject:zt,isObjectEqual:Gk,mixin:pe,objectEach:Qt,setProperty:Ny},Symbol.toStringTag,{value:"Module"}));var Cn=function(e){var t={value:!1};return t.test=function(r,n){t.value=e(r,n)},t},Vn={chrome:Cn(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Cn(function(e){return/CriOS/.test(e)}),edge:Cn(function(e){return/Edge/.test(e)}),edgeWebKit:Cn(function(e){return/EdgiOS/.test(e)}),firefox:Cn(function(e){return/Firefox/.test(e)}),firefoxWebKit:Cn(function(e){return/FxiOS/.test(e)}),ie:Cn(function(e){return/Trident/.test(e)}),ie9:Cn(function(){return!!document.documentMode}),mobile:Cn(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Cn(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},cc={mac:Cn(function(e){return/^Mac/.test(e)}),win:Cn(function(e){return/^Win/.test(e)}),linux:Cn(function(e){return/^Linux/.test(e)}),ios:Cn(function(e){return/iPhone|iPad|iPod/i.test(e)})};function JV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;Qt(Vn,function(i){var a=i.test;return void a(r,o)})}function ZV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;Qt(cc,function(n){var o=n.test;return void o(r)})}JV();ZV();function zk(){return Vn.chrome.value}function qV(){return Vn.chromeWebKit.value}function By(){return Vn.firefox.value}function $V(){return Vn.firefoxWebKit.value}function tF(){return Vn.safari.value}function eF(){return Vn.edge.value}function Ftt(){return Vn.edgeWebKit.value}function nF(){return Vn.ie.value}function rF(){return Vn.ie9.value}function Wtt(){return Vn.ie.value||Vn.edge.value}function cr(){return Vn.mobile.value}function Qk(){return cc.ios.value}function Kk(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&cc.mac.value}function SS(){return cc.win.value}function Tg(){return cc.mac.value}function Utt(){return cc.linux.value}const Ytt=Object.freeze(Object.defineProperty({__proto__:null,isChrome:zk,isChromeWebKit:qV,isEdge:eF,isEdgeWebKit:Ftt,isFirefox:By,isFirefoxWebKit:$V,isIE:nF,isIE9:rF,isIOS:Qk,isIpadOS:Kk,isLinuxOS:Utt,isMSBrowser:Wtt,isMacOS:Tg,isMobileBrowser:cr,isSafari:tF,isWindowsOS:SS,setBrowserMeta:JV,setPlatformMeta:ZV},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function Xo(e){return Xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xo(e)}function CS(e,t){return CS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},CS(e,t)}function Gtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ly(e,t,r){return Gtt()?Ly=Reflect.construct:Ly=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&CS(l,i.prototype),l},Ly.apply(null,arguments)}function or(e){return ztt(e)||Qtt(e)||Ktt(e)||Xtt()}function ztt(e){if(Array.isArray(e))return OS(e)}function Qtt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ktt(e,t){if(e){if(typeof e=="string")return OS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OS(e,t)}}function OS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xtt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Jtt=Object.hasOwnProperty,mM=Object.setPrototypeOf,Ztt=Object.isFrozen,qtt=Object.getPrototypeOf,$tt=Object.getOwnPropertyDescriptor,gn=Object.freeze,hr=Object.seal,tet=Object.create,oF=typeof Reflect<"u"&&Reflect,Pg=oF.apply,kS=oF.construct;Pg||(Pg=function(e,t,r){return e.apply(t,r)});gn||(gn=function(e){return e});hr||(hr=function(e){return e});kS||(kS=function(e,t){return Ly(e,or(t))});var eet=Xn(Array.prototype.forEach),vM=Xn(Array.prototype.pop),Tc=Xn(Array.prototype.push),Vy=Xn(String.prototype.toLowerCase),lA=Xn(String.prototype.toString),net=Xn(String.prototype.match),er=Xn(String.prototype.replace),ret=Xn(String.prototype.indexOf),oet=Xn(String.prototype.trim),ln=Xn(RegExp.prototype.test),uA=iet(TypeError);function Xn(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Pg(e,t,n)}}function iet(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return kS(e,r)}}function Zt(e,t,r){r=r||Vy,mM&&mM(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(Ztt(t)||(t[n]=i),o=i)}e[o]=!0}return e}function Pi(e){var t=tet(null),r;for(r in e)Pg(Jtt,e,[r])===!0&&(t[r]=e[r]);return t}function Vp(e,t){for(;e!==null;){var r=$tt(e,t);if(r){if(r.get)return Xn(r.get);if(typeof r.value=="function")return Xn(r.value)}e=qtt(e)}function n(o){return console.warn("fallback value for",o),null}return n}var bM=gn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),cA=gn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fA=gn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),aet=gn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),hA=gn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),set=gn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),wM=gn(["#text"]),AM=gn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),dA=gn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),SM=gn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Fp=gn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),uet=hr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),cet=hr(/<%[\w\W]*|[\w\W]*%>/gm),fet=hr(/\${[\w\W]*}/gm),het=hr(/^data-[\-\w.\u00B7-\uFFFF]/),det=hr(/^aria-[\-\w]+$/),pet=hr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yet=hr(/^(?:\w+script|data):/i),get=hr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),met=hr(/^html$/i),vet=function(){return typeof window>"u"?null:window},bet=function(e,t){if(Xo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(r=t.currentScript.getAttribute(n));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(i){return i},createScriptURL:function(i){return i}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function iF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vet(),t=function(x){return iF(x)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,c=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,f=e.HTMLFormElement,h=e.DOMParser,p=e.trustedTypes,y=s.prototype,m=Vp(y,"cloneNode"),v=Vp(y,"nextSibling"),w=Vp(y,"childNodes"),C=Vp(y,"parentNode");if(typeof i=="function"){var A=n.createElement("template");A.content&&A.content.ownerDocument&&(n=A.content.ownerDocument)}var D=bet(p,r),E=D?D.createHTML(""):"",G=n,K=G.implementation,nt=G.createNodeIterator,z=G.createDocumentFragment,X=G.getElementsByTagName,Z=r.importNode,tt={};try{tt=Pi(n).documentMode?n.documentMode:{}}catch{}var et={};t.isSupported=typeof C=="function"&&K&&typeof K.createHTMLDocument<"u"&&tt!==9;var bt=uet,yt=cet,kt=fet,Et=het,P=det,d=yet,g=get,b=pet,O=null,R=Zt({},[].concat(or(bM),or(cA),or(fA),or(hA),or(wM))),I=null,W=Zt({},[].concat(or(AM),or(dA),or(SM),or(Fp))),N=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,J=null,rt=!0,mt=!0,ut=!1,Ot=!0,St=!1,Y=!1,Ft=!1,Lt=!1,Tt=!1,Vt=!1,It=!1,S=!0,k=!1,M="user-content-",L=!0,j=!1,V={},_=null,H=Zt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),F=null,B=Zt({},["audio","video","img","source","image","track"]),U=null,it=Zt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),vt="http://www.w3.org/1998/Math/MathML",Rt="http://www.w3.org/2000/svg",_t="http://www.w3.org/1999/xhtml",Yt=_t,qt=!1,Ht=null,Nt=Zt({},[vt,Rt,_t],lA),Pt,oe=["application/xhtml+xml","text/html"],xe="text/html",te,ue=null,Xe=n.createElement("form"),be=function(x){return x instanceof RegExp||x instanceof Function},Ce=function(x){ue&&ue===x||((!x||Xo(x)!=="object")&&(x={}),x=Pi(x),Pt=oe.indexOf(x.PARSER_MEDIA_TYPE)===-1?Pt=xe:Pt=x.PARSER_MEDIA_TYPE,te=Pt==="application/xhtml+xml"?lA:Vy,O="ALLOWED_TAGS"in x?Zt({},x.ALLOWED_TAGS,te):R,I="ALLOWED_ATTR"in x?Zt({},x.ALLOWED_ATTR,te):W,Ht="ALLOWED_NAMESPACES"in x?Zt({},x.ALLOWED_NAMESPACES,lA):Nt,U="ADD_URI_SAFE_ATTR"in x?Zt(Pi(it),x.ADD_URI_SAFE_ATTR,te):it,F="ADD_DATA_URI_TAGS"in x?Zt(Pi(B),x.ADD_DATA_URI_TAGS,te):B,_="FORBID_CONTENTS"in x?Zt({},x.FORBID_CONTENTS,te):H,Q="FORBID_TAGS"in x?Zt({},x.FORBID_TAGS,te):{},J="FORBID_ATTR"in x?Zt({},x.FORBID_ATTR,te):{},V="USE_PROFILES"in x?x.USE_PROFILES:!1,rt=x.ALLOW_ARIA_ATTR!==!1,mt=x.ALLOW_DATA_ATTR!==!1,ut=x.ALLOW_UNKNOWN_PROTOCOLS||!1,Ot=x.ALLOW_SELF_CLOSE_IN_ATTR!==!1,St=x.SAFE_FOR_TEMPLATES||!1,Y=x.WHOLE_DOCUMENT||!1,Tt=x.RETURN_DOM||!1,Vt=x.RETURN_DOM_FRAGMENT||!1,It=x.RETURN_TRUSTED_TYPE||!1,Lt=x.FORCE_BODY||!1,S=x.SANITIZE_DOM!==!1,k=x.SANITIZE_NAMED_PROPS||!1,L=x.KEEP_CONTENT!==!1,j=x.IN_PLACE||!1,b=x.ALLOWED_URI_REGEXP||b,Yt=x.NAMESPACE||_t,N=x.CUSTOM_ELEMENT_HANDLING||{},x.CUSTOM_ELEMENT_HANDLING&&be(x.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(N.tagNameCheck=x.CUSTOM_ELEMENT_HANDLING.tagNameCheck),x.CUSTOM_ELEMENT_HANDLING&&be(x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(N.attributeNameCheck=x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),x.CUSTOM_ELEMENT_HANDLING&&typeof x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(N.allowCustomizedBuiltInElements=x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),St&&(mt=!1),Vt&&(Tt=!0),V&&(O=Zt({},or(wM)),I=[],V.html===!0&&(Zt(O,bM),Zt(I,AM)),V.svg===!0&&(Zt(O,cA),Zt(I,dA),Zt(I,Fp)),V.svgFilters===!0&&(Zt(O,fA),Zt(I,dA),Zt(I,Fp)),V.mathMl===!0&&(Zt(O,hA),Zt(I,SM),Zt(I,Fp))),x.ADD_TAGS&&(O===R&&(O=Pi(O)),Zt(O,x.ADD_TAGS,te)),x.ADD_ATTR&&(I===W&&(I=Pi(I)),Zt(I,x.ADD_ATTR,te)),x.ADD_URI_SAFE_ATTR&&Zt(U,x.ADD_URI_SAFE_ATTR,te),x.FORBID_CONTENTS&&(_===H&&(_=Pi(_)),Zt(_,x.FORBID_CONTENTS,te)),L&&(O["#text"]=!0),Y&&Zt(O,["html","head","body"]),O.table&&(Zt(O,["tbody"]),delete Q.tbody),gn&&gn(x),ue=x)},ie=Zt({},["mi","mo","mn","ms","mtext"]),kp=Zt({},["foreignobject","desc","title","annotation-xml"]),FG=Zt({},["title","style","font","a","script"]),Rp=Zt({},cA);Zt(Rp,fA),Zt(Rp,aet);var hw=Zt({},hA);Zt(hw,set);var WG=function(x){var pt=C(x);(!pt||!pt.tagName)&&(pt={namespaceURI:Yt,tagName:"template"});var at=Vy(x.tagName),le=Vy(pt.tagName);return Ht[x.namespaceURI]?x.namespaceURI===Rt?pt.namespaceURI===_t?at==="svg":pt.namespaceURI===vt?at==="svg"&&(le==="annotation-xml"||ie[le]):!!Rp[at]:x.namespaceURI===vt?pt.namespaceURI===_t?at==="math":pt.namespaceURI===Rt?at==="math"&&kp[le]:!!hw[at]:x.namespaceURI===_t?pt.namespaceURI===Rt&&!kp[le]||pt.namespaceURI===vt&&!ie[le]?!1:!hw[at]&&(FG[at]||!Rp[at]):!!(Pt==="application/xhtml+xml"&&Ht[x.namespaceURI]):!1},Ka=function(x){Tc(t.removed,{element:x});try{x.parentNode.removeChild(x)}catch{try{x.outerHTML=E}catch{x.remove()}}},dw=function(x,pt){try{Tc(t.removed,{attribute:pt.getAttributeNode(x),from:pt})}catch{Tc(t.removed,{attribute:null,from:pt})}if(pt.removeAttribute(x),x==="is"&&!I[x])if(Tt||Vt)try{Ka(pt)}catch{}else try{pt.setAttribute(x,"")}catch{}},ME=function(x){var pt,at;if(Lt)x="<remove></remove>"+x;else{var le=net(x,/^[\r\n\t ]+/);at=le&&le[0]}Pt==="application/xhtml+xml"&&Yt===_t&&(x='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+x+"</body></html>");var He=D?D.createHTML(x):x;if(Yt===_t)try{pt=new h().parseFromString(He,Pt)}catch{}if(!pt||!pt.documentElement){pt=K.createDocument(Yt,"template",null);try{pt.documentElement.innerHTML=qt?E:He}catch{}}var Pn=pt.body||pt.documentElement;return x&&at&&Pn.insertBefore(n.createTextNode(at),Pn.childNodes[0]||null),Yt===_t?X.call(pt,Y?"html":"body")[0]:Y?pt.documentElement:Pn},IE=function(x){return nt.call(x.ownerDocument||x,x,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},UG=function(x){return x instanceof f&&(typeof x.nodeName!="string"||typeof x.textContent!="string"||typeof x.removeChild!="function"||!(x.attributes instanceof c)||typeof x.removeAttribute!="function"||typeof x.setAttribute!="function"||typeof x.namespaceURI!="string"||typeof x.insertBefore!="function"||typeof x.hasChildNodes!="function")},vc=function(x){return Xo(a)==="object"?x instanceof a:x&&Xo(x)==="object"&&typeof x.nodeType=="number"&&typeof x.nodeName=="string"},Fr=function(x,pt,at){et[x]&&eet(et[x],function(le){le.call(t,pt,at,ue)})},xE=function(x){var pt;if(Fr("beforeSanitizeElements",x,null),UG(x)||ln(/[\u0080-\uFFFF]/,x.nodeName))return Ka(x),!0;var at=te(x.nodeName);if(Fr("uponSanitizeElement",x,{tagName:at,allowedTags:O}),x.hasChildNodes()&&!vc(x.firstElementChild)&&(!vc(x.content)||!vc(x.content.firstElementChild))&&ln(/<[/\w]/g,x.innerHTML)&&ln(/<[/\w]/g,x.textContent)||at==="select"&&ln(/<template/i,x.innerHTML))return Ka(x),!0;if(!O[at]||Q[at]){if(!Q[at]&&DE(at)&&(N.tagNameCheck instanceof RegExp&&ln(N.tagNameCheck,at)||N.tagNameCheck instanceof Function&&N.tagNameCheck(at)))return!1;if(L&&!_[at]){var le=C(x)||x.parentNode,He=w(x)||x.childNodes;if(He&&le)for(var Pn=He.length,Je=Pn-1;Je>=0;--Je)le.insertBefore(m(He[Je],!0),v(x))}return Ka(x),!0}return x instanceof s&&!WG(x)||(at==="noscript"||at==="noembed")&&ln(/<\/no(script|embed)/i,x.innerHTML)?(Ka(x),!0):(St&&x.nodeType===3&&(pt=x.textContent,pt=er(pt,bt," "),pt=er(pt,yt," "),pt=er(pt,kt," "),x.textContent!==pt&&(Tc(t.removed,{element:x.cloneNode()}),x.textContent=pt)),Fr("afterSanitizeElements",x,null),!1)},jE=function(x,pt,at){if(S&&(pt==="id"||pt==="name")&&(at in n||at in Xe))return!1;if(!(mt&&!J[pt]&&ln(Et,pt))&&!(rt&&ln(P,pt))){if(!I[pt]||J[pt]){if(!(DE(x)&&(N.tagNameCheck instanceof RegExp&&ln(N.tagNameCheck,x)||N.tagNameCheck instanceof Function&&N.tagNameCheck(x))&&(N.attributeNameCheck instanceof RegExp&&ln(N.attributeNameCheck,pt)||N.attributeNameCheck instanceof Function&&N.attributeNameCheck(pt))||pt==="is"&&N.allowCustomizedBuiltInElements&&(N.tagNameCheck instanceof RegExp&&ln(N.tagNameCheck,at)||N.tagNameCheck instanceof Function&&N.tagNameCheck(at))))return!1}else if(!U[pt]&&!ln(b,er(at,g,""))&&!((pt==="src"||pt==="xlink:href"||pt==="href")&&x!=="script"&&ret(at,"data:")===0&&F[x])&&!(ut&&!ln(d,er(at,g,"")))&&at)return!1}return!0},DE=function(x){return x.indexOf("-")>0},_E=function(x){var pt,at,le,He;Fr("beforeSanitizeAttributes",x,null);var Pn=x.attributes;if(Pn){var Je={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I};for(He=Pn.length;He--;){pt=Pn[He];var bc=pt,Wr=bc.name,bn=bc.namespaceURI;if(at=Wr==="value"?pt.value:oet(pt.value),le=te(Wr),Je.attrName=le,Je.attrValue=at,Je.keepAttr=!0,Je.forceKeepAttr=void 0,Fr("uponSanitizeAttribute",x,Je),at=Je.attrValue,!Je.forceKeepAttr&&(dw(Wr,x),!!Je.keepAttr)){if(!Ot&&ln(/\/>/i,at)){dw(Wr,x);continue}St&&(at=er(at,bt," "),at=er(at,yt," "),at=er(at,kt," "));var HE=te(x.nodeName);if(jE(HE,le,at)){if(k&&(le==="id"||le==="name")&&(dw(Wr,x),at=M+at),D&&Xo(p)==="object"&&typeof p.getAttributeType=="function"&&!bn)switch(p.getAttributeType(HE,le)){case"TrustedHTML":at=D.createHTML(at);break;case"TrustedScriptURL":at=D.createScriptURL(at);break}try{bn?x.setAttributeNS(bn,Wr,at):x.setAttribute(Wr,at),vM(t.removed)}catch{}}}}Fr("afterSanitizeAttributes",x,null)}},YG=function x(pt){var at,le=IE(pt);for(Fr("beforeSanitizeShadowDOM",pt,null);at=le.nextNode();)Fr("uponSanitizeShadowNode",at,null),!xE(at)&&(at.content instanceof o&&x(at.content),_E(at));Fr("afterSanitizeShadowDOM",pt,null)};return t.sanitize=function(x){var pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},at,le,He,Pn,Je;if(qt=!x,qt&&(x="<!-->"),typeof x!="string"&&!vc(x)){if(typeof x.toString!="function")throw uA("toString is not a function");if(x=x.toString(),typeof x!="string")throw uA("dirty is not a string, aborting")}if(!t.isSupported){if(Xo(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof x=="string")return e.toStaticHTML(x);if(vc(x))return e.toStaticHTML(x.outerHTML)}return x}if(Ft||Ce(pt),t.removed=[],typeof x=="string"&&(j=!1),j){if(x.nodeName){var bc=te(x.nodeName);if(!O[bc]||Q[bc])throw uA("root node is forbidden and cannot be sanitized in-place")}}else if(x instanceof a)at=ME("<!---->"),le=at.ownerDocument.importNode(x,!0),le.nodeType===1&&le.nodeName==="BODY"||le.nodeName==="HTML"?at=le:at.appendChild(le);else{if(!Tt&&!St&&!Y&&x.indexOf("<")===-1)return D&&It?D.createHTML(x):x;if(at=ME(x),!at)return Tt?null:It?E:""}at&&Lt&&Ka(at.firstChild);for(var Wr=IE(j?x:at);He=Wr.nextNode();)He.nodeType===3&&He===Pn||xE(He)||(He.content instanceof o&&YG(He.content),_E(He),Pn=He);if(Pn=null,j)return x;if(Tt){if(Vt)for(Je=z.call(at.ownerDocument);at.firstChild;)Je.appendChild(at.firstChild);else Je=at;return(I.shadowroot||I.shadowrootmod)&&(Je=Z.call(r,Je,!0)),Je}var bn=Y?at.outerHTML:at.innerHTML;return Y&&O["!doctype"]&&at.ownerDocument&&at.ownerDocument.doctype&&at.ownerDocument.doctype.name&&ln(met,at.ownerDocument.doctype.name)&&(bn="<!DOCTYPE "+at.ownerDocument.doctype.name+`>
`+bn),St&&(bn=er(bn,bt," "),bn=er(bn,yt," "),bn=er(bn,kt," ")),D&&It?D.createHTML(bn):bn},t.setConfig=function(x){Ce(x),Ft=!0},t.clearConfig=function(){ue=null,Ft=!1},t.isValidAttribute=function(x,pt,at){ue||Ce({});var le=te(x),He=te(pt);return jE(le,He,at)},t.addHook=function(x,pt){typeof pt=="function"&&(et[x]=et[x]||[],Tc(et[x],pt))},t.removeHook=function(x){if(et[x])return vM(et[x])},t.removeHooks=function(x){et[x]&&(et[x]=[])},t.removeAllHooks=function(){et={}},t}var wet=iF(),Aet=jt,Cet=Ok.codeAt;Aet({target:"String",proto:!0},{codePointAt:function(e){return Cet(this,e)}});var Oet=Ci,ket=Ue,Ret=Rn,Eet=RangeError,aF=function(e){var t=ket(Ret(this)),r="",n=Oet(e);if(n<0||n==1/0)throw Eet("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))n&1&&(r+=t);return r},sF=Kt,Tet=Va,CM=Ue,Pet=aF,Met=Rn,Iet=sF(Pet),xet=sF("".slice),jet=Math.ceil,OM=function(e){return function(t,r,n){var o=CM(Met(t)),i=Tet(r),a=o.length,s=n===void 0?" ":CM(n),l,u;return i<=a||s==""?o:(l=i-a,u=Iet(s,jet(l/s.length)),u.length>l&&(u=xet(u,0,l)),e?o+u:u+o)}},Det={start:OM(!1),end:OM(!0)},_et=_a,Het=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(_et),Net=jt,Bet=Det.start,Let=Het;Net({target:"String",proto:!0,forced:Let},{padStart:function(e){return Bet(this,e,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var lF;function $(){return lF.apply(null,arguments)}function Vet(e){lF=e}function dr(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function wa(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function ae(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Xk(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(ae(e,t))return!1;return!0}function An(e){return e===void 0}function xo(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function tp(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function uF(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function qo(e,t){for(var r in t)ae(t,r)&&(e[r]=t[r]);return ae(t,"toString")&&(e.toString=t.toString),ae(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Lr(e,t,r,n){return jF(e,t,r,n,!0).utc()}function Fet(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Xt(e){return e._pf==null&&(e._pf=Fet()),e._pf}var RS;Array.prototype.some?RS=Array.prototype.some:RS=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function Jk(e){if(e._isValid==null){var t=Xt(e),r=RS.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function cv(e){var t=Lr(NaN);return e!=null?qo(Xt(t),e):Xt(t).userInvalidated=!0,t}var kM=$.momentProperties=[],pA=!1;function Zk(e,t){var r,n,o,i=kM.length;if(An(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),An(t._i)||(e._i=t._i),An(t._f)||(e._f=t._f),An(t._l)||(e._l=t._l),An(t._strict)||(e._strict=t._strict),An(t._tzm)||(e._tzm=t._tzm),An(t._isUTC)||(e._isUTC=t._isUTC),An(t._offset)||(e._offset=t._offset),An(t._pf)||(e._pf=Xt(t)),An(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=kM[r],o=t[n],An(o)||(e[n]=o);return e}function ep(e){Zk(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),pA===!1&&(pA=!0,$.updateOffset(this),pA=!1)}function pr(e){return e instanceof ep||e!=null&&e._isAMomentObject!=null}function cF(e){$.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function qn(e,t){var r=!0;return qo(function(){if($.deprecationHandler!=null&&$.deprecationHandler(null,e),r){var n=[],o,i,a,s=arguments.length;for(i=0;i<s;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])ae(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}cF(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var RM={};function fF(e,t){$.deprecationHandler!=null&&$.deprecationHandler(e,t),RM[e]||(cF(t),RM[e]=!0)}$.suppressDeprecationWarnings=!1;$.deprecationHandler=null;function Vr(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function Wet(e){var t,r;for(r in e)ae(e,r)&&(t=e[r],Vr(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ES(e,t){var r=qo({},e),n;for(n in t)ae(t,n)&&(wa(e[n])&&wa(t[n])?(r[n]={},qo(r[n],e[n]),qo(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)ae(e,n)&&!ae(t,n)&&wa(e[n])&&(r[n]=qo({},r[n]));return r}function qk(e){e!=null&&this.set(e)}var TS;Object.keys?TS=Object.keys:TS=function(e){var t,r=[];for(t in e)ae(e,t)&&r.push(t);return r};var Uet={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Yet(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Vr(n)?n.call(t,r):n}function _r(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var $k=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Wp=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,yA={},_s={};function Mt(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(_s[e]=o),t&&(_s[t[0]]=function(){return _r(o.apply(this,arguments),t[1],t[2])}),r&&(_s[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function Get(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function zet(e){var t=e.match($k),r,n;for(r=0,n=t.length;r<n;r++)_s[t[r]]?t[r]=_s[t[r]]:t[r]=Get(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Vr(t[a])?t[a].call(o,e):t[a];return i}}function Fy(e,t){return e.isValid()?(t=hF(t,e.localeData()),yA[t]=yA[t]||zet(t),yA[t](e)):e.localeData().invalidDate()}function hF(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(Wp.lastIndex=0;r>=0&&Wp.test(e);)e=e.replace(Wp,n),Wp.lastIndex=0,r-=1;return e}var Qet={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Ket(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match($k).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var Xet="Invalid date";function Jet(){return this._invalidDate}var Zet="%d",qet=/\d{1,2}/;function $et(e){return this._ordinal.replace("%d",e)}var tnt={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ent(e,t,r,n){var o=this._relativeTime[r];return Vr(o)?o(e,t,r,n):o.replace(/%d/i,e)}function nnt(e,t){var r=this._relativeTime[e>0?"future":"past"];return Vr(r)?r(t):r.replace(/%s/i,t)}var uf={};function an(e,t){var r=e.toLowerCase();uf[r]=uf[r+"s"]=uf[t]=e}function $n(e){return typeof e=="string"?uf[e]||uf[e.toLowerCase()]:void 0}function tR(e){var t={},r,n;for(n in e)ae(e,n)&&(r=$n(n),r&&(t[r]=e[n]));return t}var dF={};function sn(e,t){dF[e]=t}function rnt(e){var t=[],r;for(r in e)ae(e,r)&&t.push({unit:r,priority:dF[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function fv(e){return e%4===0&&e%100!==0||e%400===0}function Qn(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function $t(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Qn(t)),r}function fc(e,t){return function(r){return r!=null?(pF(this,e,r),$.updateOffset(this,t),this):Mg(this,e)}}function Mg(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function pF(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&fv(e.year())&&e.month()===1&&e.date()===29?(r=$t(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),mv(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function ont(e){return e=$n(e),Vr(this[e])?this[e]():this}function int(e,t){if(typeof e=="object"){e=tR(e);var r=rnt(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=$n(e),Vr(this[e]))return this[e](t);return this}var yF=/\d/,Wn=/\d\d/,gF=/\d{3}/,eR=/\d{4}/,hv=/[+-]?\d{6}/,Se=/\d\d?/,mF=/\d\d\d\d?/,vF=/\d\d\d\d\d\d?/,dv=/\d{1,3}/,nR=/\d{1,4}/,pv=/[+-]?\d{1,6}/,hc=/\d+/,yv=/[+-]?\d+/,ant=/Z|[+-]\d\d:?\d\d/gi,gv=/Z|[+-]\d\d(?::?\d\d)?/gi,snt=/[+-]?\d+(\.\d{1,3})?/,np=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ig;Ig={};function At(e,t,r){Ig[e]=Vr(t)?t:function(n,o){return n&&r?r:t}}function lnt(e,t){return ae(Ig,e)?Ig[e](t._strict,t._locale):new RegExp(unt(e))}function unt(e){return Hn(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Hn(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var PS={};function ye(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),xo(t)&&(n=function(i,a){a[t]=$t(i)}),o=e.length,r=0;r<o;r++)PS[e[r]]=n}function rp(e,t){ye(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function cnt(e,t,r){t!=null&&ae(PS,e)&&PS[e](t,r._a,r,e)}var rn=0,to=1,xr=2,Ze=3,fr=4,eo=5,zi=6,fnt=7,hnt=8;function dnt(e,t){return(e%t+t)%t}var Be;Array.prototype.indexOf?Be=Array.prototype.indexOf:Be=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function mv(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=dnt(t,12);return e+=(t-r)/12,r===1?fv(e)?29:28:31-r%7%2}Mt("M",["MM",2],"Mo",function(){return this.month()+1});Mt("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Mt("MMMM",0,0,function(e){return this.localeData().months(this,e)});an("month","M");sn("month",8);At("M",Se);At("MM",Se,Wn);At("MMM",function(e,t){return t.monthsShortRegex(e)});At("MMMM",function(e,t){return t.monthsRegex(e)});ye(["M","MM"],function(e,t){t[to]=$t(e)-1});ye(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[to]=o:Xt(r).invalidMonth=e});var pnt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),bF="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),wF=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ynt=np,gnt=np;function mnt(e,t){return e?dr(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||wF).test(t)?"format":"standalone"][e.month()]:dr(this._months)?this._months:this._months.standalone}function vnt(e,t){return e?dr(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[wF.test(t)?"format":"standalone"][e.month()]:dr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function bnt(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Lr([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Be.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Be.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Be.call(this._shortMonthsParse,a),o!==-1?o:(o=Be.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Be.call(this._longMonthsParse,a),o!==-1?o:(o=Be.call(this._shortMonthsParse,a),o!==-1?o:null))}function wnt(e,t,r){var n,o,i;if(this._monthsParseExact)return bnt.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++)if(o=Lr([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e)||r&&t==="MMM"&&this._shortMonthsParse[n].test(e)||!r&&this._monthsParse[n].test(e))return n}function AF(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=$t(t);else if(t=e.localeData().monthsParse(t),!xo(t))return e}return r=Math.min(e.date(),mv(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function SF(e){return e!=null?(AF(this,e),$.updateOffset(this,!0),this):Mg(this,"Month")}function Ant(){return mv(this.year(),this.month())}function Snt(e){return this._monthsParseExact?(ae(this,"_monthsRegex")||CF.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(ae(this,"_monthsShortRegex")||(this._monthsShortRegex=ynt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Cnt(e){return this._monthsParseExact?(ae(this,"_monthsRegex")||CF.call(this),e?this._monthsStrictRegex:this._monthsRegex):(ae(this,"_monthsRegex")||(this._monthsRegex=gnt),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function CF(){function e(a,s){return s.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Lr([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Hn(t[o]),r[o]=Hn(r[o]);for(o=0;o<24;o++)n[o]=Hn(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Mt("Y",0,0,function(){var e=this.year();return e<=9999?_r(e,4):"+"+e});Mt(0,["YY",2],0,function(){return this.year()%100});Mt(0,["YYYY",4],0,"year");Mt(0,["YYYYY",5],0,"year");Mt(0,["YYYYYY",6,!0],0,"year");an("year","y");sn("year",1);At("Y",yv);At("YY",Se,Wn);At("YYYY",nR,eR);At("YYYYY",pv,hv);At("YYYYYY",pv,hv);ye(["YYYYY","YYYYYY"],rn);ye("YYYY",function(e,t){t[rn]=e.length===2?$.parseTwoDigitYear(e):$t(e)});ye("YY",function(e,t){t[rn]=$.parseTwoDigitYear(e)});ye("Y",function(e,t){t[rn]=parseInt(e,10)});function cf(e){return fv(e)?366:365}$.parseTwoDigitYear=function(e){return $t(e)+($t(e)>68?1900:2e3)};var OF=fc("FullYear",!0);function Ont(){return fv(this.year())}function knt(e,t,r,n,o,i,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,o,i,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,o,i,a),s}function Pf(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function xg(e,t,r){var n=7+t-r,o=(7+Pf(e,0,n).getUTCDay()-t)%7;return-o+n-1}function kF(e,t,r,n,o){var i=(7+r-n)%7,a=xg(e,n,o),s=1+7*(t-1)+i+a,l,u;return s<=0?(l=e-1,u=cf(l)+s):s>cf(e)?(l=e+1,u=s-cf(e)):(l=e,u=s),{year:l,dayOfYear:u}}function Mf(e,t,r){var n=xg(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+To(a,t,r)):o>To(e.year(),t,r)?(i=o-To(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function To(e,t,r){var n=xg(e,t,r),o=xg(e+1,t,r);return(cf(e)-n+o)/7}Mt("w",["ww",2],"wo","week");Mt("W",["WW",2],"Wo","isoWeek");an("week","w");an("isoWeek","W");sn("week",5);sn("isoWeek",5);At("w",Se);At("ww",Se,Wn);At("W",Se);At("WW",Se,Wn);rp(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=$t(e)});function Rnt(e){return Mf(e,this._week.dow,this._week.doy).week}var Ent={dow:0,doy:6};function Tnt(){return this._week.dow}function Pnt(){return this._week.doy}function Mnt(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Int(e){var t=Mf(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Mt("d",0,"do","day");Mt("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Mt("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Mt("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Mt("e",0,0,"weekday");Mt("E",0,0,"isoWeekday");an("day","d");an("weekday","e");an("isoWeekday","E");sn("day",11);sn("weekday",11);sn("isoWeekday",11);At("d",Se);At("e",Se);At("E",Se);At("dd",function(e,t){return t.weekdaysMinRegex(e)});At("ddd",function(e,t){return t.weekdaysShortRegex(e)});At("dddd",function(e,t){return t.weekdaysRegex(e)});rp(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:Xt(r).invalidWeekday=e});rp(["d","e","E"],function(e,t,r,n){t[n]=$t(e)});function xnt(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function jnt(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function rR(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Dnt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),RF="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),_nt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Hnt=np,Nnt=np,Bnt=np;function Lnt(e,t){var r=dr(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?rR(r,this._week.dow):e?r[e.day()]:r}function Vnt(e){return e===!0?rR(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Fnt(e){return e===!0?rR(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Wnt(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Lr([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Be.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Be.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Be.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Be.call(this._weekdaysParse,a),o!==-1||(o=Be.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Be.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Be.call(this._shortWeekdaysParse,a),o!==-1||(o=Be.call(this._weekdaysParse,a),o!==-1)?o:(o=Be.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Be.call(this._minWeekdaysParse,a),o!==-1||(o=Be.call(this._weekdaysParse,a),o!==-1)?o:(o=Be.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function Unt(e,t,r){var n,o,i;if(this._weekdaysParseExact)return Wnt.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++)if(o=Lr([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e)||r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e)||r&&t==="dd"&&this._minWeekdaysParse[n].test(e)||!r&&this._weekdaysParse[n].test(e))return n}function Ynt(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=xnt(e,this.localeData()),this.add(e-t,"d")):t}function Gnt(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function znt(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=jnt(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Qnt(e){return this._weekdaysParseExact?(ae(this,"_weekdaysRegex")||oR.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(ae(this,"_weekdaysRegex")||(this._weekdaysRegex=Hnt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Knt(e){return this._weekdaysParseExact?(ae(this,"_weekdaysRegex")||oR.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ae(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Nnt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Xnt(e){return this._weekdaysParseExact?(ae(this,"_weekdaysRegex")||oR.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ae(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Bnt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function oR(){function e(c,f){return f.length-c.length}var t=[],r=[],n=[],o=[],i,a,s,l,u;for(i=0;i<7;i++)a=Lr([2e3,1]).day(i),s=Hn(this.weekdaysMin(a,"")),l=Hn(this.weekdaysShort(a,"")),u=Hn(this.weekdays(a,"")),t.push(s),r.push(l),n.push(u),o.push(s),o.push(l),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function iR(){return this.hours()%12||12}function Jnt(){return this.hours()||24}Mt("H",["HH",2],0,"hour");Mt("h",["hh",2],0,iR);Mt("k",["kk",2],0,Jnt);Mt("hmm",0,0,function(){return""+iR.apply(this)+_r(this.minutes(),2)});Mt("hmmss",0,0,function(){return""+iR.apply(this)+_r(this.minutes(),2)+_r(this.seconds(),2)});Mt("Hmm",0,0,function(){return""+this.hours()+_r(this.minutes(),2)});Mt("Hmmss",0,0,function(){return""+this.hours()+_r(this.minutes(),2)+_r(this.seconds(),2)});function EF(e,t){Mt(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}EF("a",!0);EF("A",!1);an("hour","h");sn("hour",13);function TF(e,t){return t._meridiemParse}At("a",TF);At("A",TF);At("H",Se);At("h",Se);At("k",Se);At("HH",Se,Wn);At("hh",Se,Wn);At("kk",Se,Wn);At("hmm",mF);At("hmmss",vF);At("Hmm",mF);At("Hmmss",vF);ye(["H","HH"],Ze);ye(["k","kk"],function(e,t,r){var n=$t(e);t[Ze]=n===24?0:n});ye(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});ye(["h","hh"],function(e,t,r){t[Ze]=$t(e),Xt(r).bigHour=!0});ye("hmm",function(e,t,r){var n=e.length-2;t[Ze]=$t(e.substr(0,n)),t[fr]=$t(e.substr(n)),Xt(r).bigHour=!0});ye("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Ze]=$t(e.substr(0,n)),t[fr]=$t(e.substr(n,2)),t[eo]=$t(e.substr(o)),Xt(r).bigHour=!0});ye("Hmm",function(e,t,r){var n=e.length-2;t[Ze]=$t(e.substr(0,n)),t[fr]=$t(e.substr(n))});ye("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Ze]=$t(e.substr(0,n)),t[fr]=$t(e.substr(n,2)),t[eo]=$t(e.substr(o))});function Znt(e){return(e+"").toLowerCase().charAt(0)==="p"}var qnt=/[ap]\.?m?\.?/i,$nt=fc("Hours",!0);function trt(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var PF={calendar:Uet,longDateFormat:Qet,invalidDate:Xet,ordinal:Zet,dayOfMonthOrdinalParse:qet,relativeTime:tnt,months:pnt,monthsShort:bF,week:Ent,weekdays:Dnt,weekdaysMin:_nt,weekdaysShort:RF,meridiemParse:qnt},Oe={},Pc={},If;function ert(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function EM(e){return e&&e.toLowerCase().replace("_","-")}function nrt(e){for(var t=0,r,n,o,i;t<e.length;){for(i=EM(e[t]).split("-"),r=i.length,n=EM(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=vv(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&ert(i,n)>=r-1)break;r--}t++}return If}function rrt(e){return e.match("^[^/\\\\]*$")!=null}function vv(e){var t=null,r;if(Oe[e]===void 0&&typeof module<"u"&&module&&module.exports&&rrt(e))try{t=If._abbr,r=require,r("./locale/"+e),ni(t)}catch{Oe[e]=null}return Oe[e]}function ni(e,t){var r;return e&&(An(t)?r=No(e):r=aR(e,t),r?If=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),If._abbr}function aR(e,t){if(t!==null){var r,n=PF;if(t.abbr=e,Oe[e]!=null)fF("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Oe[e]._config;else if(t.parentLocale!=null)if(Oe[t.parentLocale]!=null)n=Oe[t.parentLocale]._config;else if(r=vv(t.parentLocale),r!=null)n=r._config;else return Pc[t.parentLocale]||(Pc[t.parentLocale]=[]),Pc[t.parentLocale].push({name:e,config:t}),null;return Oe[e]=new qk(ES(n,t)),Pc[e]&&Pc[e].forEach(function(o){aR(o.name,o.config)}),ni(e),Oe[e]}else return delete Oe[e],null}function ort(e,t){if(t!=null){var r,n,o=PF;Oe[e]!=null&&Oe[e].parentLocale!=null?Oe[e].set(ES(Oe[e]._config,t)):(n=vv(e),n!=null&&(o=n._config),t=ES(o,t),n==null&&(t.abbr=e),r=new qk(t),r.parentLocale=Oe[e],Oe[e]=r),ni(e)}else Oe[e]!=null&&(Oe[e].parentLocale!=null?(Oe[e]=Oe[e].parentLocale,e===ni()&&ni(e)):Oe[e]!=null&&delete Oe[e]);return Oe[e]}function No(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return If;if(!dr(e)){if(t=vv(e),t)return t;e=[e]}return nrt(e)}function irt(){return TS(Oe)}function sR(e){var t,r=e._a;return r&&Xt(e).overflow===-2&&(t=r[to]<0||r[to]>11?to:r[xr]<1||r[xr]>mv(r[rn],r[to])?xr:r[Ze]<0||r[Ze]>24||r[Ze]===24&&(r[fr]!==0||r[eo]!==0||r[zi]!==0)?Ze:r[fr]<0||r[fr]>59?fr:r[eo]<0||r[eo]>59?eo:r[zi]<0||r[zi]>999?zi:-1,Xt(e)._overflowDayOfYear&&(t<rn||t>xr)&&(t=xr),Xt(e)._overflowWeeks&&t===-1&&(t=fnt),Xt(e)._overflowWeekday&&t===-1&&(t=hnt),Xt(e).overflow=t),e}var art=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,srt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,lrt=/Z|[+-]\d\d(?::?\d\d)?/,Up=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],gA=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],urt=/^\/?Date\((-?\d+)/i,crt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,frt={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function MF(e){var t,r,n=e._i,o=art.exec(n)||srt.exec(n),i,a,s,l,u=Up.length,c=gA.length;if(o){for(Xt(e).iso=!0,t=0,r=u;t<r;t++)if(Up[t][1].exec(o[1])){a=Up[t][0],i=Up[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=c;t<r;t++)if(gA[t][1].exec(o[3])){s=(o[2]||" ")+gA[t][0];break}if(s==null){e._isValid=!1;return}}if(!i&&s!=null){e._isValid=!1;return}if(o[4])if(lrt.exec(o[4]))l="Z";else{e._isValid=!1;return}e._f=a+(s||"")+(l||""),uR(e)}else e._isValid=!1}function hrt(e,t,r,n,o,i){var a=[drt(e),bF.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function drt(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function prt(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function yrt(e,t,r){if(e){var n=RF.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return Xt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function grt(e,t,r){if(e)return frt[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function IF(e){var t=crt.exec(prt(e._i)),r;if(t){if(r=hrt(t[4],t[3],t[2],t[5],t[6],t[7]),!yrt(t[1],r,e))return;e._a=r,e._tzm=grt(t[8],t[9],t[10]),e._d=Pf.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Xt(e).rfc2822=!0}else e._isValid=!1}function mrt(e){var t=urt.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(MF(e),e._isValid===!1)delete e._isValid;else return;if(IF(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:$.createFromInputFallback(e)}$.createFromInputFallback=qn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function ks(e,t,r){return e??t??r}function vrt(e){var t=new Date($.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function lR(e){var t,r,n=[],o,i,a;if(!e._d){for(o=vrt(e),e._w&&e._a[xr]==null&&e._a[to]==null&&brt(e),e._dayOfYear!=null&&(a=ks(e._a[rn],o[rn]),(e._dayOfYear>cf(a)||e._dayOfYear===0)&&(Xt(e)._overflowDayOfYear=!0),r=Pf(a,0,e._dayOfYear),e._a[to]=r.getUTCMonth(),e._a[xr]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Ze]===24&&e._a[fr]===0&&e._a[eo]===0&&e._a[zi]===0&&(e._nextDay=!0,e._a[Ze]=0),e._d=(e._useUTC?Pf:knt).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ze]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Xt(e).weekdayMismatch=!0)}}function brt(e){var t,r,n,o,i,a,s,l,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=ks(t.GG,e._a[rn],Mf(we(),1,4).year),n=ks(t.W,1),o=ks(t.E,1),(o<1||o>7)&&(l=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Mf(we(),i,a),r=ks(t.gg,e._a[rn],u.year),n=ks(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(l=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(l=!0)):o=i),n<1||n>To(r,i,a)?Xt(e)._overflowWeeks=!0:l!=null?Xt(e)._overflowWeekday=!0:(s=kF(r,n,o,i,a),e._a[rn]=s.year,e._dayOfYear=s.dayOfYear)}$.ISO_8601=function(){};$.RFC_2822=function(){};function uR(e){if(e._f===$.ISO_8601){MF(e);return}if(e._f===$.RFC_2822){IF(e);return}e._a=[],Xt(e).empty=!0;var t=""+e._i,r,n,o,i,a,s=t.length,l=0,u,c;for(o=hF(e._f,e._locale).match($k)||[],c=o.length,r=0;r<c;r++)i=o[r],n=(t.match(lnt(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Xt(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),l+=n.length),_s[i]?(n?Xt(e).empty=!1:Xt(e).unusedTokens.push(i),cnt(i,n,e)):e._strict&&!n&&Xt(e).unusedTokens.push(i);Xt(e).charsLeftOver=s-l,t.length>0&&Xt(e).unusedInput.push(t),e._a[Ze]<=12&&Xt(e).bigHour===!0&&e._a[Ze]>0&&(Xt(e).bigHour=void 0),Xt(e).parsedDateParts=e._a.slice(0),Xt(e).meridiem=e._meridiem,e._a[Ze]=wrt(e._locale,e._a[Ze],e._meridiem),u=Xt(e).era,u!==null&&(e._a[rn]=e._locale.erasConvertYear(u,e._a[rn])),lR(e),sR(e)}function wrt(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Art(e){var t,r,n,o,i,a,s=!1,l=e._f.length;if(l===0){Xt(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<l;o++)i=0,a=!1,t=Zk({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],uR(t),Jk(t)&&(a=!0),i+=Xt(t).charsLeftOver,i+=Xt(t).unusedTokens.length*10,Xt(t).score=i,s?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(s=!0));qo(e,r||t)}function Srt(e){if(!e._d){var t=tR(e._i),r=t.day===void 0?t.date:t.day;e._a=uF([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),lR(e)}}function Crt(e){var t=new ep(sR(xF(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function xF(e){var t=e._i,r=e._f;return e._locale=e._locale||No(e._l),t===null||r===void 0&&t===""?cv({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),pr(t)?new ep(sR(t)):(tp(t)?e._d=t:dr(r)?Art(e):r?uR(e):Ort(e),Jk(e)||(e._d=null),e))}function Ort(e){var t=e._i;An(t)?e._d=new Date($.now()):tp(t)?e._d=new Date(t.valueOf()):typeof t=="string"?mrt(e):dr(t)?(e._a=uF(t.slice(0),function(r){return parseInt(r,10)}),lR(e)):wa(t)?Srt(e):xo(t)?e._d=new Date(t):$.createFromInputFallback(e)}function jF(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(wa(e)&&Xk(e)||dr(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,Crt(i)}function we(e,t,r,n){return jF(e,t,r,n,!1)}var krt=qn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=we.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:cv()}),Rrt=qn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=we.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:cv()});function DF(e,t){var r,n;if(t.length===1&&dr(t[0])&&(t=t[0]),!t.length)return we();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Ert(){var e=[].slice.call(arguments,0);return DF("isBefore",e)}function Trt(){var e=[].slice.call(arguments,0);return DF("isAfter",e)}var Prt=function(){return Date.now?Date.now():+new Date},Mc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Mrt(e){var t,r=!1,n,o=Mc.length;for(t in e)if(ae(e,t)&&!(Be.call(Mc,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Mc[n]]){if(r)return!1;parseFloat(e[Mc[n]])!==$t(e[Mc[n]])&&(r=!0)}return!0}function Irt(){return this._isValid}function xrt(){return vr(NaN)}function bv(e){var t=tR(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=Mrt(t),this._milliseconds=+c+u*1e3+l*6e4+s*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=No(),this._bubble()}function Wy(e){return e instanceof bv}function MS(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function jrt(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&$t(e[a])!==$t(t[a]))&&i++;return i+o}function _F(e,t){Mt(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+_r(~~(r/60),2)+t+_r(~~r%60,2)})}_F("Z",":");_F("ZZ","");At("Z",gv);At("ZZ",gv);ye(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=cR(gv,e)});var Drt=/([\+\-]|\d\d)/gi;function cR(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(Drt)||["-",0,0],i=+(o[1]*60)+$t(o[2]),i===0?0:o[0]==="+"?i:-i)}function fR(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(pr(e)||tp(e)?e.valueOf():we(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),$.updateOffset(r,!1),r):we(e).local()}function IS(e){return-Math.round(e._d.getTimezoneOffset())}$.updateOffset=function(){};function _rt(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=cR(gv,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=IS(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?BF(this,vr(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,$.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:IS(this)}function Hrt(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Nrt(e){return this.utcOffset(0,e)}function Brt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(IS(this),"m")),this}function Lrt(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=cR(ant,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Vrt(e){return this.isValid()?(e=e?we(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Frt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Wrt(){if(!An(this._isDSTShifted))return this._isDSTShifted;var e={},t;return Zk(e,this),e=xF(e),e._a?(t=e._isUTC?Lr(e._a):we(e._a),this._isDSTShifted=this.isValid()&&jrt(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Urt(){return this.isValid()?!this._isUTC:!1}function Yrt(){return this.isValid()?this._isUTC:!1}function HF(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Grt=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,zrt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function vr(e,t){var r=e,n=null,o,i,a;return Wy(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:xo(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=Grt.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:$t(n[xr])*o,h:$t(n[Ze])*o,m:$t(n[fr])*o,s:$t(n[eo])*o,ms:$t(MS(n[zi]*1e3))*o}):(n=zrt.exec(e))?(o=n[1]==="-"?-1:1,r={y:Mi(n[2],o),M:Mi(n[3],o),w:Mi(n[4],o),d:Mi(n[5],o),h:Mi(n[6],o),m:Mi(n[7],o),s:Mi(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=Qrt(we(r.from),we(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new bv(r),Wy(e)&&ae(e,"_locale")&&(i._locale=e._locale),Wy(e)&&ae(e,"_isValid")&&(i._isValid=e._isValid),i}vr.fn=bv.prototype;vr.invalid=xrt;function Mi(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function TM(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Qrt(e,t){var r;return e.isValid()&&t.isValid()?(t=fR(t,e),e.isBefore(t)?r=TM(e,t):(r=TM(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function NF(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(fF(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=vr(r,n),BF(this,o,e),this}}function BF(e,t,r,n){var o=t._milliseconds,i=MS(t._days),a=MS(t._months);e.isValid()&&(n=n??!0,a&&AF(e,Mg(e,"Month")+a*r),i&&pF(e,"Date",Mg(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&$.updateOffset(e,i||a))}var Krt=NF(1,"add"),Xrt=NF(-1,"subtract");function LF(e){return typeof e=="string"||e instanceof String}function Jrt(e){return pr(e)||tp(e)||LF(e)||xo(e)||qrt(e)||Zrt(e)||e===null||e===void 0}function Zrt(e){var t=wa(e)&&!Xk(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||ae(e,i);return t&&r}function qrt(e){var t=dr(e),r=!1;return t&&(r=e.filter(function(n){return!xo(n)&&LF(e)}).length===0),t&&r}function $rt(e){var t=wa(e)&&!Xk(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||ae(e,i);return t&&r}function tot(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function eot(e,t){arguments.length===1&&(arguments[0]?Jrt(arguments[0])?(e=arguments[0],t=void 0):$rt(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||we(),n=fR(r,this).startOf("day"),o=$.calendarFormat(this,n)||"sameElse",i=t&&(Vr(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,we(r)))}function not(){return new ep(this)}function rot(e,t){var r=pr(e)?e:we(e);return this.isValid()&&r.isValid()?(t=$n(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function oot(e,t){var r=pr(e)?e:we(e);return this.isValid()&&r.isValid()?(t=$n(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function iot(e,t,r,n){var o=pr(e)?e:we(e),i=pr(t)?t:we(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function aot(e,t){var r=pr(e)?e:we(e),n;return this.isValid()&&r.isValid()?(t=$n(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function sot(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function lot(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function uot(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=fR(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=$n(t),t){case"year":i=Uy(this,n)/12;break;case"month":i=Uy(this,n);break;case"quarter":i=Uy(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Qn(i)}function Uy(e,t){if(e.date()<t.date())return-Uy(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}$.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";$.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function cot(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function fot(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Fy(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Vr(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Fy(r,"Z")):Fy(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function hot(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function dot(e){e||(e=this.isUtc()?$.defaultFormatUtc:$.defaultFormat);var t=Fy(this,e);return this.localeData().postformat(t)}function pot(e,t){return this.isValid()&&(pr(e)&&e.isValid()||we(e).isValid())?vr({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function yot(e){return this.from(we(),e)}function got(e,t){return this.isValid()&&(pr(e)&&e.isValid()||we(e).isValid())?vr({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function mot(e){return this.to(we(),e)}function VF(e){var t;return e===void 0?this._locale._abbr:(t=No(e),t!=null&&(this._locale=t),this)}var FF=qn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function WF(){return this._locale}var jg=1e3,Hs=60*jg,Dg=60*Hs,UF=(365*400+97)*24*Dg;function Ns(e,t){return(e%t+t)%t}function YF(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-UF:new Date(e,t,r).valueOf()}function GF(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-UF:Date.UTC(e,t,r)}function vot(e){var t,r;if(e=$n(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?GF:YF,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Ns(t+(this._isUTC?0:this.utcOffset()*Hs),Dg);break;case"minute":t=this._d.valueOf(),t-=Ns(t,Hs);break;case"second":t=this._d.valueOf(),t-=Ns(t,jg);break}return this._d.setTime(t),$.updateOffset(this,!0),this}function bot(e){var t,r;if(e=$n(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?GF:YF,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Dg-Ns(t+(this._isUTC?0:this.utcOffset()*Hs),Dg)-1;break;case"minute":t=this._d.valueOf(),t+=Hs-Ns(t,Hs)-1;break;case"second":t=this._d.valueOf(),t+=jg-Ns(t,jg)-1;break}return this._d.setTime(t),$.updateOffset(this,!0),this}function wot(){return this._d.valueOf()-(this._offset||0)*6e4}function Aot(){return Math.floor(this.valueOf()/1e3)}function Sot(){return new Date(this.valueOf())}function Cot(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Oot(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function kot(){return this.isValid()?this.toISOString():null}function Rot(){return Jk(this)}function Eot(){return qo({},Xt(this))}function Tot(){return Xt(this).overflow}function Pot(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Mt("N",0,0,"eraAbbr");Mt("NN",0,0,"eraAbbr");Mt("NNN",0,0,"eraAbbr");Mt("NNNN",0,0,"eraName");Mt("NNNNN",0,0,"eraNarrow");Mt("y",["y",1],"yo","eraYear");Mt("y",["yy",2],0,"eraYear");Mt("y",["yyy",3],0,"eraYear");Mt("y",["yyyy",4],0,"eraYear");At("N",hR);At("NN",hR);At("NNN",hR);At("NNNN",Vot);At("NNNNN",Fot);ye(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?Xt(r).era=o:Xt(r).invalidEra=e});At("y",hc);At("yy",hc);At("yyy",hc);At("yyyy",hc);At("yo",Wot);ye(["y","yy","yyy","yyyy"],rn);ye(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[rn]=r._locale.eraYearOrdinalParse(e,o):t[rn]=parseInt(e,10)});function Mot(e,t){var r,n,o,i=this._eras||No("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=$(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=$(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function Iot(e,t,r){var n,o,i=this.eras(),a,s,l;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),s=i[n].abbr.toUpperCase(),l=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(l===e)return i[n];break}else if([a,s,l].indexOf(e)>=0)return i[n]}function xot(e,t){var r=e.since<=e.until?1:-1;return t===void 0?$(e.since).year():$(e.since).year()+(t-e.offset)*r}function jot(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function Dot(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function _ot(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function Hot(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-$(o[e].since).year())*r+o[e].offset;return this.year()}function Not(e){return ae(this,"_erasNameRegex")||dR.call(this),e?this._erasNameRegex:this._erasRegex}function Bot(e){return ae(this,"_erasAbbrRegex")||dR.call(this),e?this._erasAbbrRegex:this._erasRegex}function Lot(e){return ae(this,"_erasNarrowRegex")||dR.call(this),e?this._erasNarrowRegex:this._erasRegex}function hR(e,t){return t.erasAbbrRegex(e)}function Vot(e,t){return t.erasNameRegex(e)}function Fot(e,t){return t.erasNarrowRegex(e)}function Wot(e,t){return t._eraYearOrdinalRegex||hc}function dR(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Hn(a[o].name)),e.push(Hn(a[o].abbr)),r.push(Hn(a[o].narrow)),n.push(Hn(a[o].name)),n.push(Hn(a[o].abbr)),n.push(Hn(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Mt(0,["gg",2],0,function(){return this.weekYear()%100});Mt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function wv(e,t){Mt(0,[e,e.length],0,t)}wv("gggg","weekYear");wv("ggggg","weekYear");wv("GGGG","isoWeekYear");wv("GGGGG","isoWeekYear");an("weekYear","gg");an("isoWeekYear","GG");sn("weekYear",1);sn("isoWeekYear",1);At("G",yv);At("g",yv);At("GG",Se,Wn);At("gg",Se,Wn);At("GGGG",nR,eR);At("gggg",nR,eR);At("GGGGG",pv,hv);At("ggggg",pv,hv);rp(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=$t(e)});rp(["gg","GG"],function(e,t,r,n){t[n]=$.parseTwoDigitYear(e)});function Uot(e){return zF.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Yot(e){return zF.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Got(){return To(this.year(),1,4)}function zot(){return To(this.isoWeekYear(),1,4)}function Qot(){var e=this.localeData()._week;return To(this.year(),e.dow,e.doy)}function Kot(){var e=this.localeData()._week;return To(this.weekYear(),e.dow,e.doy)}function zF(e,t,r,n,o){var i;return e==null?Mf(this,n,o).year:(i=To(e,n,o),t>i&&(t=i),Xot.call(this,e,t,r,n,o))}function Xot(e,t,r,n,o){var i=kF(e,t,r,n,o),a=Pf(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Mt("Q",0,"Qo","quarter");an("quarter","Q");sn("quarter",7);At("Q",yF);ye("Q",function(e,t){t[to]=($t(e)-1)*3});function Jot(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Mt("D",["DD",2],"Do","date");an("date","D");sn("date",9);At("D",Se);At("DD",Se,Wn);At("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});ye(["D","DD"],xr);ye("Do",function(e,t){t[xr]=$t(e.match(Se)[0])});var QF=fc("Date",!0);Mt("DDD",["DDDD",3],"DDDo","dayOfYear");an("dayOfYear","DDD");sn("dayOfYear",4);At("DDD",dv);At("DDDD",gF);ye(["DDD","DDDD"],function(e,t,r){r._dayOfYear=$t(e)});function Zot(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Mt("m",["mm",2],0,"minute");an("minute","m");sn("minute",14);At("m",Se);At("mm",Se,Wn);ye(["m","mm"],fr);var qot=fc("Minutes",!1);Mt("s",["ss",2],0,"second");an("second","s");sn("second",15);At("s",Se);At("ss",Se,Wn);ye(["s","ss"],eo);var $ot=fc("Seconds",!1);Mt("S",0,0,function(){return~~(this.millisecond()/100)});Mt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Mt(0,["SSS",3],0,"millisecond");Mt(0,["SSSS",4],0,function(){return this.millisecond()*10});Mt(0,["SSSSS",5],0,function(){return this.millisecond()*100});Mt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Mt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Mt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Mt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});an("millisecond","ms");sn("millisecond",16);At("S",dv,yF);At("SS",dv,Wn);At("SSS",dv,gF);var $o,KF;for($o="SSSS";$o.length<=9;$o+="S")At($o,hc);function tit(e,t){t[zi]=$t(("0."+e)*1e3)}for($o="S";$o.length<=9;$o+="S")ye($o,tit);KF=fc("Milliseconds",!1);Mt("z",0,0,"zoneAbbr");Mt("zz",0,0,"zoneName");function eit(){return this._isUTC?"UTC":""}function nit(){return this._isUTC?"Coordinated Universal Time":""}var ot=ep.prototype;ot.add=Krt;ot.calendar=eot;ot.clone=not;ot.diff=uot;ot.endOf=bot;ot.format=dot;ot.from=pot;ot.fromNow=yot;ot.to=got;ot.toNow=mot;ot.get=ont;ot.invalidAt=Tot;ot.isAfter=rot;ot.isBefore=oot;ot.isBetween=iot;ot.isSame=aot;ot.isSameOrAfter=sot;ot.isSameOrBefore=lot;ot.isValid=Rot;ot.lang=FF;ot.locale=VF;ot.localeData=WF;ot.max=Rrt;ot.min=krt;ot.parsingFlags=Eot;ot.set=int;ot.startOf=vot;ot.subtract=Xrt;ot.toArray=Cot;ot.toObject=Oot;ot.toDate=Sot;ot.toISOString=fot;ot.inspect=hot;typeof Symbol<"u"&&Symbol.for!=null&&(ot[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ot.toJSON=kot;ot.toString=cot;ot.unix=Aot;ot.valueOf=wot;ot.creationData=Pot;ot.eraName=jot;ot.eraNarrow=Dot;ot.eraAbbr=_ot;ot.eraYear=Hot;ot.year=OF;ot.isLeapYear=Ont;ot.weekYear=Uot;ot.isoWeekYear=Yot;ot.quarter=ot.quarters=Jot;ot.month=SF;ot.daysInMonth=Ant;ot.week=ot.weeks=Mnt;ot.isoWeek=ot.isoWeeks=Int;ot.weeksInYear=Qot;ot.weeksInWeekYear=Kot;ot.isoWeeksInYear=Got;ot.isoWeeksInISOWeekYear=zot;ot.date=QF;ot.day=ot.days=Ynt;ot.weekday=Gnt;ot.isoWeekday=znt;ot.dayOfYear=Zot;ot.hour=ot.hours=$nt;ot.minute=ot.minutes=qot;ot.second=ot.seconds=$ot;ot.millisecond=ot.milliseconds=KF;ot.utcOffset=_rt;ot.utc=Nrt;ot.local=Brt;ot.parseZone=Lrt;ot.hasAlignedHourOffset=Vrt;ot.isDST=Frt;ot.isLocal=Urt;ot.isUtcOffset=Yrt;ot.isUtc=HF;ot.isUTC=HF;ot.zoneAbbr=eit;ot.zoneName=nit;ot.dates=qn("dates accessor is deprecated. Use date instead.",QF);ot.months=qn("months accessor is deprecated. Use month instead",SF);ot.years=qn("years accessor is deprecated. Use year instead",OF);ot.zone=qn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Hrt);ot.isDSTShifted=qn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Wrt);function rit(e){return we(e*1e3)}function oit(){return we.apply(null,arguments).parseZone()}function XF(e){return e}var se=qk.prototype;se.calendar=Yet;se.longDateFormat=Ket;se.invalidDate=Jet;se.ordinal=$et;se.preparse=XF;se.postformat=XF;se.relativeTime=ent;se.pastFuture=nnt;se.set=Wet;se.eras=Mot;se.erasParse=Iot;se.erasConvertYear=xot;se.erasAbbrRegex=Bot;se.erasNameRegex=Not;se.erasNarrowRegex=Lot;se.months=mnt;se.monthsShort=vnt;se.monthsParse=wnt;se.monthsRegex=Cnt;se.monthsShortRegex=Snt;se.week=Rnt;se.firstDayOfYear=Pnt;se.firstDayOfWeek=Tnt;se.weekdays=Lnt;se.weekdaysMin=Fnt;se.weekdaysShort=Vnt;se.weekdaysParse=Unt;se.weekdaysRegex=Qnt;se.weekdaysShortRegex=Knt;se.weekdaysMinRegex=Xnt;se.isPM=Znt;se.meridiem=trt;function _g(e,t,r,n){var o=No(),i=Lr().set(n,t);return o[r](i,e)}function JF(e,t,r){if(xo(e)&&(t=e,e=void 0),e=e||"",t!=null)return _g(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=_g(e,n,r,"month");return o}function pR(e,t,r,n){typeof e=="boolean"?(xo(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,xo(t)&&(r=t,t=void 0),t=t||"");var o=No(),i=e?o._week.dow:0,a,s=[];if(r!=null)return _g(t,(r+i)%7,n,"day");for(a=0;a<7;a++)s[a]=_g(t,(a+i)%7,n,"day");return s}function iit(e,t){return JF(e,t,"months")}function ait(e,t){return JF(e,t,"monthsShort")}function sit(e,t,r){return pR(e,t,r,"weekdays")}function lit(e,t,r){return pR(e,t,r,"weekdaysShort")}function uit(e,t,r){return pR(e,t,r,"weekdaysMin")}ni("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=$t(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});$.lang=qn("moment.lang is deprecated. Use moment.locale instead.",ni);$.langData=qn("moment.langData is deprecated. Use moment.localeData instead.",No);var Ur=Math.abs;function cit(){var e=this._data;return this._milliseconds=Ur(this._milliseconds),this._days=Ur(this._days),this._months=Ur(this._months),e.milliseconds=Ur(e.milliseconds),e.seconds=Ur(e.seconds),e.minutes=Ur(e.minutes),e.hours=Ur(e.hours),e.months=Ur(e.months),e.years=Ur(e.years),this}function ZF(e,t,r,n){var o=vr(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function fit(e,t){return ZF(this,e,t,1)}function hit(e,t){return ZF(this,e,t,-1)}function PM(e){return e<0?Math.floor(e):Math.ceil(e)}function dit(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,s,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=PM(xS(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Qn(e/1e3),n.seconds=o%60,i=Qn(o/60),n.minutes=i%60,a=Qn(i/60),n.hours=a%24,t+=Qn(a/24),l=Qn(qF(t)),r+=l,t-=PM(xS(l)),s=Qn(r/12),r%=12,n.days=t,n.months=r,n.years=s,this}function qF(e){return e*4800/146097}function xS(e){return e*146097/4800}function pit(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=$n(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+qF(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(xS(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function yit(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+$t(this._months/12)*31536e6:NaN}function Bo(e){return function(){return this.as(e)}}var git=Bo("ms"),mit=Bo("s"),vit=Bo("m"),bit=Bo("h"),wit=Bo("d"),Ait=Bo("w"),Sit=Bo("M"),Cit=Bo("Q"),Oit=Bo("y");function kit(){return vr(this)}function Rit(e){return e=$n(e),this.isValid()?this[e+"s"]():NaN}function Ua(e){return function(){return this.isValid()?this._data[e]:NaN}}var Eit=Ua("milliseconds"),Tit=Ua("seconds"),Pit=Ua("minutes"),Mit=Ua("hours"),Iit=Ua("days"),xit=Ua("months"),jit=Ua("years");function Dit(){return Qn(this.days()/7)}var Jr=Math.round,Ms={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function _it(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function Hit(e,t,r,n){var o=vr(e).abs(),i=Jr(o.as("s")),a=Jr(o.as("m")),s=Jr(o.as("h")),l=Jr(o.as("d")),u=Jr(o.as("M")),c=Jr(o.as("w")),f=Jr(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||c<=1&&["w"]||c<r.w&&["ww",c]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||f<=1&&["y"]||["yy",f],h[2]=t,h[3]=+e>0,h[4]=n,_it.apply(null,h)}function Nit(e){return e===void 0?Jr:typeof e=="function"?(Jr=e,!0):!1}function Bit(e,t){return Ms[e]===void 0?!1:t===void 0?Ms[e]:(Ms[e]=t,e==="s"&&(Ms.ss=t-1),!0)}function Lit(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Ms,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Ms,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=Hit(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var mA=Math.abs;function $a(e){return(e>0)-(e<0)||+e}function Av(){if(!this.isValid())return this.localeData().invalidDate();var e=mA(this._milliseconds)/1e3,t=mA(this._days),r=mA(this._months),n,o,i,a,s=this.asSeconds(),l,u,c,f;return s?(n=Qn(e/60),o=Qn(n/60),e%=60,n%=60,i=Qn(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=$a(this._months)!==$a(s)?"-":"",c=$a(this._days)!==$a(s)?"-":"",f=$a(this._milliseconds)!==$a(s)?"-":"",l+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?c+t+"D":"")+(o||n||e?"T":"")+(o?f+o+"H":"")+(n?f+n+"M":"")+(e?f+a+"S":"")):"P0D"}var ne=bv.prototype;ne.isValid=Irt;ne.abs=cit;ne.add=fit;ne.subtract=hit;ne.as=pit;ne.asMilliseconds=git;ne.asSeconds=mit;ne.asMinutes=vit;ne.asHours=bit;ne.asDays=wit;ne.asWeeks=Ait;ne.asMonths=Sit;ne.asQuarters=Cit;ne.asYears=Oit;ne.valueOf=yit;ne._bubble=dit;ne.clone=kit;ne.get=Rit;ne.milliseconds=Eit;ne.seconds=Tit;ne.minutes=Pit;ne.hours=Mit;ne.days=Iit;ne.weeks=Dit;ne.months=xit;ne.years=jit;ne.humanize=Lit;ne.toISOString=Av;ne.toString=Av;ne.toJSON=Av;ne.locale=VF;ne.localeData=WF;ne.toIsoString=qn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Av);ne.lang=FF;Mt("X",0,0,"unix");Mt("x",0,0,"valueOf");At("x",yv);At("X",snt);ye("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});ye("x",function(e,t,r){r._d=new Date($t(e))});//! moment.js
$.version="2.29.4";Vet(we);$.fn=ot;$.min=Ert;$.max=Trt;$.now=Prt;$.utc=Lr;$.unix=rit;$.months=iit;$.isDate=tp;$.locale=ni;$.invalid=cv;$.duration=vr;$.isMoment=pr;$.weekdays=sit;$.parseZone=oit;$.localeData=No;$.isDuration=Wy;$.monthsShort=ait;$.weekdaysMin=uit;$.defineLocale=aR;$.updateLocale=ort;$.locales=irt;$.weekdaysShort=lit;$.normalizeUnits=$n;$.relativeTimeRounding=Nit;$.relativeTimeThreshold=Bit;$.calendarFormat=tot;$.prototype=ot;$.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Vit=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"}));function ce(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=_e(e,function(i,a,s){var l=a.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return i+l+u},"");return o.trim()}var MM,IM,xM,jM,DM,_M;function Bs(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jS(e){return jS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jS(e)}function Pe(e){var t;switch(jS(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ht(e){return typeof e<"u"}function he(e){return typeof e>"u"}function Qe(e){return e===null||e===""||he(e)}function $F(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var ef="length",ff=function(e){return parseInt(e,16)},HM=function(e){return parseInt(e,10)},Hg=function(e,t,r){return e.substr(t,r)},hf=function(e){return e.codePointAt(0)-65},DS=function(e){return"".concat(e).replace(/\-/g,"")},Fit=function(e){return ff(Hg(DS(e),ff("12"),hf("F")))/(ff(Hg(DS(e),hf("B"),~~![][ef]))||9)},Wit=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},NM=!1,BM={invalid:function(){return ce(MM||(MM=Bs([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(e){var t=e.keyValidityDate,r=e.hotVersion;return ce(IM||(IM=Bs([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),t,r,t)},missing:function(){return ce(xM||(xM=Bs([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},LM={invalid:function(){return ce(jM||(jM=Bs([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(e){var t=e.keyValidityDate,r=e.hotVersion;return ce(DM||(DM=Bs([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),t,r,t)},missing:function(){return ce(_M||(_M=Bs([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function tW(e,t){var r=!Qe(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="12.3.2",i,a="invalid",s="invalid";e=DS(e||"");var l=Uit(e);if(r||n||l)if(l){var u=$("23/03/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=Fit(e);i=$((f+1)*864e5,"x").format("MMMM DD, YYYY"),c>f?(a="expired",s="expired"):(a="valid",s="valid")}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(Wit()&&(a="valid",s="valid"),!NM&&a!=="valid"){var h=BM[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](BM[a]({keyValidityDate:i,hotVersion:o})),NM=!0}if(s!=="valid"&&t.parentNode){var p=LM[s]({keyValidityDate:i,hotVersion:o});if(p){var y=document.createElement("div");y.className="hot-display-license-info",y.innerHTML=LM[s]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(y,t.nextSibling)}}}function Uit(e){var t=[][ef],r=t;if(e[ef]!==hf("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=hf(o.shift());i;i=hf(o.shift()||"A"))--i<""[ef]?r=r|(HM("".concat(HM(ff(n)+(ff(Hg(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Hg(e,i,i?o[ef]===1?9:8:6);return r===t}const Yit=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:tW,isDefined:ht,isEmpty:Qe,isRegExp:$F,isUndefined:he,stringify:Pe},Symbol.toStringTag,{value:"Module"}));function kn(e){return e[0].toUpperCase()+e.substr(1)}function Git(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=Pe(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function yR(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function gR(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function mR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function _S(e){return Sv("".concat(e),{ALLOWED_TAGS:[]})}function Sv(e,t){return wet.sanitize(e,t)}const zit=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Git,isPercentValue:gR,randomString:yR,sanitize:Sv,stripTags:_S,substitute:mR,toUpperCaseFirst:kn},Symbol.toStringTag,{value:"Module"}));function VM(e){return Jit(e)||Xit(e)||Kit(e)||Qit()}function Qit(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kit(e,t){if(e){if(typeof e=="string")return HS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HS(e,t)}}function Xit(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jit(e){if(Array.isArray(e))return HS(e)}function HS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eW(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function nW(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function xf(e){return nW(e)&&e.parent}function Zit(e){return!!Object.getPrototypeOf(e.parent)}function ri(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===o&&(t.includes(u)||t.includes(a)))return a;var c=a,f=c.host;f&&l===i?a=f:a=a.parentNode}return null}function nf(e,t,r){for(var n=[],o=e;o&&(o=ri(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function oi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function rW(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function Qo(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var NS,BS,LS;function Yp(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(LV()){var FM=function(e){var t=e.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")};NS=function(e,t){return e.classList===void 0||typeof t!="string"||t===""?!1:e.classList.contains(t)},BS=function(e,t){var r=e.ownerDocument,n=t;if(typeof n=="string"&&(n=n.split(" ")),n=Yp(n),n.length>0)if(FM(r)){var o;(o=e.classList).add.apply(o,VM(n))}else for(var i=0;n[i];)e.classList.add(n[i]),i+=1},LS=function(e,t){var r=e.ownerDocument,n=t;if(typeof n=="string"&&(n=n.split(" ")),n=Yp(n),n.length>0)if(FM(r)){var o;(o=e.classList).remove.apply(o,VM(n))}else for(var i=0;n[i];)e.classList.remove(n[i]),i+=1}}else{var vA=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};NS=function(e,t){return e.className!==void 0&&vA(t).test(e.className)},BS=function(e,t){var r=e.className,n=t;if(typeof n=="string"&&(n=n.split(" ")),n=Yp(n),r==="")r=n.join(" ");else for(var o=0;o<n.length;o++)n[o]&&!vA(n[o]).test(r)&&(r+=" ".concat(n[o]));e.className=r},LS=function(e,t){var r=0,n=e.className,o=t;for(typeof o=="string"&&(o=o.split(" ")),o=Yp(o);o[r];)n=n.replace(vA(o[r])," ").trim(),r+=1;e.className!==n&&(e.className=n)}}function Dt(e,t){return NS(e,t)}function q(e,t){BS(e,t)}function Bt(e,t){LS(e,t)}function vR(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)vR(t[r])}function yr(e){for(var t;t=e.lastChild;)e.removeChild(t)}var oW=/(<(.*)>|&(.*);)/;function Ya(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;oW.test(t)?e.innerHTML=r?Sv(t):t:mi(e,t)}function mi(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?VV?r.textContent=t:r.data=t:(yr(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function $s(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return $s(r.host.impl);if(r.host)return $s(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Le(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,s,l;if(Wk()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return l=o.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,s=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,s=o;return s&&s.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function tl(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Oa(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function jf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?tl(t):e.scrollTop}function Ng(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Oa(t):e.scrollLeft}function Df(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=FV(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return i;if(o){var c=r.getComputedStyle(i);if(s=c.overflow,l=c.overflowX,u=c.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(l)||n.includes(s)))return i;i=i.parentNode}return r}function el(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=vi(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),s=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(s)||i.includes(l))return n;n=n.parentNode}return r}function nl(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=vi(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function qit(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function vi(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function fe(e){return e.offsetWidth}function ke(e){return Wk()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function no(e){return e.clientHeight||e.innerHeight}function df(e){return e.clientWidth||e.innerWidth}function $it(e,t,r){e.addEventListener(t,r,!1)}function tat(e,t,r){e.removeEventListener(t,r,!1)}function bR(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function iW(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function aW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function VS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function op(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var bA;function eat(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function qe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return bA===void 0&&(bA=eat(e)),bA}function sW(e){return e.offsetWidth!==e.clientWidth}function lW(e){return e.offsetHeight!==e.clientHeight}function Cv(e,t,r){rF()?(e.style.top=r,e.style.left=t):tF()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function nat(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function ip(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function _f(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function Ov(e){return _f(e)&&e.hasAttribute("data-hot-input")===!1}function uW(e){var t=e.ownerDocument.activeElement;Ov(t)||e.select()}function wR(e){return!e.parentNode}function cW(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const rat=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:oW,addClass:q,addEvent:$it,clearTextSelection:VS,closest:ri,closestDown:nf,empty:yr,fastInnerHTML:Ya,fastInnerText:mi,getCaretPosition:bR,getComputedStyle:vi,getCssTransform:nat,getFrameElement:nW,getParent:eW,getParentWindow:xf,getScrollLeft:Ng,getScrollTop:jf,getScrollableElement:Df,getScrollbarWidth:qe,getSelectionEndPosition:iW,getSelectionText:aW,getStyle:nl,getTrimmingContainer:el,getWindowScrollLeft:Oa,getWindowScrollTop:tl,hasAccessToParentWindow:Zit,hasClass:Dt,hasHorizontalScrollbar:lW,hasVerticalScrollbar:sW,index:rW,innerHeight:no,innerWidth:df,isChildOf:oi,isDetached:wR,isInput:_f,isOutsideInput:Ov,isVisible:$s,matchesCSSRules:qit,observeVisibilityChangeOnce:cW,offset:Le,outerHeight:ke,outerWidth:fe,overlayContainsElement:Qo,removeClass:Bt,removeEvent:tat,removeTextNodes:vR,resetCssTransform:ip,selectElementIfAllowed:uW,setCaretPosition:op,setOverlayPosition:Cv},Symbol.toStringTag,{value:"Module"}));function ge(e){return typeof e=="function"}function fW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var c=Date.now(),f=!1;n.lastCallThrottled=!0,r||(r=c,f=!0);var h=t-(c-r);return f?(n.lastCallThrottled=!1,e.apply(this,l)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,l),r=0,o=void 0},h)),n}return i}function oat(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=fW(e,t),o=r;function i(){o=r}function a(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return o?(o-=1,e.apply(this,l)):n.apply(this,l)}return a.clearHits=i,a}function AR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,s)},t),n}return o}function iat(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return _e(o,function(l,u){return u(l)},n.apply(this,a))}}function SR(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return e.apply(this,r.concat(i))}}function hW(e){var t=e.length;function r(n){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=n.concat(i),l;return s.length>=t?l=e.apply(this,s):l=r(s),l}}return r([])}function aat(e){var t=e.length;function r(n){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=n.concat(i.reverse()),l;return s.length>=t?l=e.apply(this,s):l=r(s),l}}return r([])}function Bg(e,t,r,n,o,i,a,s){return ht(s)?e.call(t,r,n,o,i,a,s):ht(a)?e.call(t,r,n,o,i,a):ht(i)?e.call(t,r,n,o,i):ht(o)?e.call(t,r,n,o):ht(n)?e.call(t,r,n):ht(r)?e.call(t,r):e.call(t)}const sat=Object.freeze(Object.defineProperty({__proto__:null,curry:hW,curryRight:aat,debounce:AR,fastCall:Bg,isFunction:ge,partial:SR,pipe:iat,throttle:fW,throttleAfterHits:oat},Symbol.toStringTag,{value:"Module"}));function de(){if(ht(console)){var e;(e=console).warn.apply(e,arguments)}}function CR(){if(ht(console)){var e;(e=console).error.apply(e,arguments)}}var lat=Kt,WM=Sk,Gp=Aa.getWeakData,uat=wk,cat=De,fat=mr,wA=We,hat=bk,dW=Fa,UM=Me,pW=_o,dat=pW.set,pat=pW.getterFor,yat=dW.find,gat=dW.findIndex,mat=lat([].splice),vat=0,zp=function(e){return e.frozen||(e.frozen=new yW)},yW=function(){this.entries=[]},AA=function(e,t){return yat(e.entries,function(r){return r[0]===t})};yW.prototype={get:function(e){var t=AA(this,e);if(t)return t[1]},has:function(e){return!!AA(this,e)},set:function(e,t){var r=AA(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=gat(this.entries,function(r){return r[0]===e});return~t&&mat(this.entries,t,1),!!~t}};var gW={getConstructor:function(e,t,r,n){var o=e(function(l,u){uat(l,i),dat(l,{type:t,id:vat++,frozen:void 0}),fat(u)||hat(u,l[n],{that:l,AS_ENTRIES:r})}),i=o.prototype,a=pat(t),s=function(l,u,c){var f=a(l),h=Gp(cat(u),!0);return h===!0?zp(f).set(u,c):h[f.id]=c,l};return WM(i,{delete:function(l){var u=a(this);if(!wA(l))return!1;var c=Gp(l);return c===!0?zp(u).delete(l):c&&UM(c,u.id)&&delete c[u.id]},has:function(l){var u=a(this);if(!wA(l))return!1;var c=Gp(l);return c===!0?zp(u).has(l):c&&UM(c,u.id)}}),WM(i,r?{get:function(l){var u=a(this);if(wA(l)){var c=Gp(l);return c===!0?zp(u).get(l):c?c[u.id]:void 0}},set:function(l,u){return s(this,l,u)}}:{add:function(l){return s(this,l,!0)}}),o}},bat=ck,YM=me,Yy=Kt,GM=Sk,wat=Aa,Aat=tv,mW=gW,Qp=We,Kp=_o.enforce,Sat=Wt,Cat=zB,ap=Object,Oat=Array.isArray,Xp=ap.isExtensible,vW=ap.isFrozen,kat=ap.isSealed,bW=ap.freeze,Rat=ap.seal,zM={},QM={},Eat=!YM.ActiveXObject&&"ActiveXObject"in YM,Ic,wW=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},AW=Aat("WeakMap",wW,mW),Rs=AW.prototype,Gy=Yy(Rs.set),Tat=function(){return bat&&Sat(function(){var e=bW([]);return Gy(new AW,e,1),!vW(e)})};if(Cat)if(Eat){Ic=mW.getConstructor(wW,"WeakMap",!0),wat.enable();var KM=Yy(Rs.delete),Jp=Yy(Rs.has),XM=Yy(Rs.get);GM(Rs,{delete:function(e){if(Qp(e)&&!Xp(e)){var t=Kp(this);return t.frozen||(t.frozen=new Ic),KM(this,e)||t.frozen.delete(e)}return KM(this,e)},has:function(e){if(Qp(e)&&!Xp(e)){var t=Kp(this);return t.frozen||(t.frozen=new Ic),Jp(this,e)||t.frozen.has(e)}return Jp(this,e)},get:function(e){if(Qp(e)&&!Xp(e)){var t=Kp(this);return t.frozen||(t.frozen=new Ic),Jp(this,e)?XM(this,e):t.frozen.get(e)}return XM(this,e)},set:function(e,t){if(Qp(e)&&!Xp(e)){var r=Kp(this);r.frozen||(r.frozen=new Ic),Jp(this,e)?Gy(this,e,t):r.frozen.set(e,t)}else Gy(this,e,t);return this}})}else Tat()&&GM(Rs,{set:function(e,t){var r;return Oat(e)&&(vW(e)?r=zM:kat(e)&&(r=QM)),Gy(this,e,t),r==zM&&bW(e),r==QM&&Rat(e),this}});var wt={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:By()?182:174,AUDIO_MUTE:By()?181:173,AUDIO_UP:By()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Pat=[wt.ALT,wt.ARROW_DOWN,wt.ARROW_LEFT,wt.ARROW_RIGHT,wt.ARROW_UP,wt.AUDIO_DOWN,wt.AUDIO_MUTE,wt.AUDIO_UP,wt.BACKSPACE,wt.CAPS_LOCK,wt.DELETE,wt.END,wt.ENTER,wt.ESCAPE,wt.F1,wt.F2,wt.F3,wt.F4,wt.F5,wt.F6,wt.F7,wt.F8,wt.F9,wt.F10,wt.F11,wt.F12,wt.F13,wt.F14,wt.F15,wt.F16,wt.F17,wt.F18,wt.F19,wt.HOME,wt.INSERT,wt.MEDIA_NEXT,wt.MEDIA_PLAY_PAUSE,wt.MEDIA_PREV,wt.MEDIA_STOP,wt.NULL,wt.NUM_LOCK,wt.PAGE_DOWN,wt.PAGE_UP,wt.PAUSE,wt.SCROLL_LOCK,wt.SHIFT,wt.TAB];function SW(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function OR(e){return Pat.includes(e)}function Mat(e){var t=[];return Tg()?t.push(wt.COMMAND_LEFT,wt.COMMAND_RIGHT,wt.COMMAND_FIREFOX):t.push(wt.CONTROL),t.includes(e)}function CW(e){return[wt.CONTROL,wt.COMMAND_LEFT,wt.COMMAND_RIGHT,wt.COMMAND_FIREFOX].includes(e)}function rl(e,t){var r=t.split("|"),n=!1;return T(r,function(o){if(e===wt[o])return n=!0,!1}),n}const Iat=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:wt,isCtrlKey:Mat,isCtrlMetaKey:CW,isFunctionKey:OR,isKey:rl,isPrintableChar:SW},Symbol.toStringTag,{value:"Module"}));function gr(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Yi(e){return e.isImmediatePropagationEnabled===!1}function bi(e){return e.button===2}function kv(e){return e.button===0}const xat=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Yi,isLeftClick:kv,isRightClick:bi,stopImmediatePropagation:gr},Symbol.toStringTag,{value:"Module"}));function Hf(e){return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hf(e)}var JM;function jat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_at(n.key),n)}}function Dat(e,t,r){return t&&ZM(e.prototype,t),r&&ZM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _at(e){var t=Hat(e,"string");return Hf(t)==="symbol"?t:String(t)}function Hat(e,t){if(Hf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nat(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ts=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Bat=ce(JM||(JM=Nat([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),SA=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),CA=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),OW=function(){function e(){jat(this,e),this.globalBucket=this.createEmptyBucket()}return Dat(e,[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return T(ts,function(r){return t[r]=[]}),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(r))T(r,function(s){return n.add(t,s,o)});else{SA.has(t)&&de(mR(Bat,{hookName:t,removedInVersion:SA.get(t)})),CA.has(t)&&de(CA.get(t));var i=this.getBucket(o);if(typeof i[t]>"u"&&(this.register(t),i[t]=[]),r.skip=!1,i[t].indexOf(r)===-1){var a=!1;r.initialHook&&T(i[t],function(s,l){if(s.initialHook)return i[t][l]=r,a=!0,!1}),a||i[t].push(r)}}return this}},{key:"once",value:function(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(r)?T(r,function(i){return n.once(t,i,o)}):(r.runOnce=!0,this.add(t,r,o))}},{key:"remove",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(n);return typeof o[t]<"u"&&o[t].indexOf(r)>=0?(r.skip=!0,!0):!1}},{key:"has",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=this.getBucket(r);return!!(n[t]!==void 0&&n[t].length)}},{key:"run",value:function(t,r,n,o,i,a,s,l){{var u=this.globalBucket[r],c=u?u.length:0,f=0;if(c)for(;f<c;){if(!u[f]||u[f].skip){f+=1;continue}var h=Bg(u[f],t,n,o,i,a,s,l);h!==void 0&&(n=h),u[f]&&u[f].runOnce&&this.remove(r,u[f]),f+=1}}{var p=this.getBucket(t)[r],y=p?p.length:0,m=0;if(y)for(;m<y;){if(!p[m]||p[m].skip){m+=1;continue}var v=Bg(p[m],t,n,o,i,a,s,l);v!==void 0&&(n=v),p[m]&&p[m].runOnce&&this.remove(r,p[m],t),m+=1}}return n}},{key:"destroy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Qt(this.getBucket(t),function(r,n,o){return o[n].length=0})}},{key:"register",value:function(t){this.isRegistered(t)||ts.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&ts.splice(ts.indexOf(t),1)}},{key:"isDeprecated",value:function(t){return CA.has(t)||SA.has(t)}},{key:"isRegistered",value:function(t){return ts.indexOf(t)>=0}},{key:"getRegistered",value:function(){return ts}}],[{key:"getSingleton",value:function(){return Vat()}}]),e}(),Lat=new OW;function Vat(){return Lat}const gt=OW;function qM(e){return Yat(e)||Uat(e)||Wat(e)||Fat()}function Fat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wat(e,t){if(e){if(typeof e=="string")return FS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FS(e,t)}}function Uat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Yat(e){if(Array.isArray(e))return FS(e)}function FS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var OA=new Map;function tr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";OA.has(e)||OA.set(e,new Map);var t=OA.get(e);function r(s,l){t.set(s,l)}function n(s){return t.get(s)}function o(s){return t.has(s)}function i(){return qM(t.keys())}function a(){return qM(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var WS=new WeakMap,sp=tr("editors"),Gat=sp.register,kW=sp.getItem,RW=sp.hasItem,zat=sp.getNames;sp.getValues;function Qat(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},gt.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function EW(e,t){var r;if(typeof e=="function")WS.get(e)||Sn(null,e),r=WS.get(e);else if(typeof e=="string")r=kW(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function Lg(e){if(typeof e=="function")return e;if(!RW(e))throw Error('No registered editor found under "'.concat(e,'" name'));return kW(e).getConstructor()}function Sn(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new Qat(t);typeof e=="string"&&Gat(e,r),WS.set(t,r)}function Nf(e){return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(e)}function Kat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jat(n.key),n)}}function Xat(e,t,r){return t&&$M(e.prototype,t),r&&$M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jat(e){var t=Zat(e,"string");return Nf(t)==="symbol"?t:String(t)}function Zat(e,t){if(Nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zy=0,qat=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Kat(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return Xat(e,[{key:"addEventListener",value:function(t,r,n){var o=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function a(s){n.call(this,$at(s))}return typeof i!="boolean"&&!UV()&&(i=!1),this.context.eventListeners.push({element:t,event:r,callback:n,callbackProxy:a,options:i,eventManager:this}),t.addEventListener(r,a,i),zy+=1,function(){o.removeEventListener(t,r,n)}}},{key:"removeEventListener",value:function(t,r,n){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=this.context.eventListeners.length,a;i;)if(i-=1,a=this.context.eventListeners[i],a.event===r&&a.element===t){if(n&&n!==a.callback||o&&a.eventManager!==this)continue;this.context.eventListeners.splice(i,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options),zy-=1}}},{key:"clearEvents",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var r=this.context.eventListeners.length;r;){r-=1;var n=this.context.eventListeners[r];t&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),zy-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(t,r){var n=t.document,o=t;n||(n=t.ownerDocument?t.ownerDocument:t,o=n.defaultView);var i={bubbles:!0,cancelable:r!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},a;n.createEvent?(a=n.createEvent("MouseEvents"),a.initMouseEvent(r,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):a=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(a):t.fireEvent("on".concat(r),a)}}]),e}();function $at(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),gr(this)},e}const Re=qat;function tst(){return zy}function Bf(e){return Bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bf(e)}function est(e,t){return ist(e)||ost(e,t)||rst(e,t)||nst()}function nst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rst(e,t){if(e){if(typeof e=="string")return tI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tI(e,t)}}function tI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ost(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function ist(e){if(Array.isArray(e))return e}function ast(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lst(n.key),n)}}function sst(e,t,r){return t&&eI(e.prototype,t),r&&eI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lst(e){var t=ust(e,"string");return Bf(t)==="symbol"?t:String(t)}function ust(e,t){if(Bf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rv="editorManager.navigation",pf="editorManager.handlingEditor",US=function(){function e(t,r,n){var o=this;ast(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Re(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,s,l){return o.onCellDblClick(a,s,l)})}return sst(e,[{key:"registerShortcuts",value:function(){var t=this,r=this.instance.getShortcutManager(),n=r.getContext("grid"),o=r.getContext("editor"),i={group:pf};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(a,s){t.closeEditorAndSaveChanges(r.isCtrlPressed()),t.moveSelectionAfterEnter(s.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){t.closeEditorAndRestoreOriginalValue(r.isCtrlPressed()),t.activeEditor.focus()}}],i),n.addShortcuts([{keys:[["F2"]],callback:function(a){t.openEditor(null,a,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){t.instance.emptySelectedCells(),t.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(a,s){t.instance.getSettings().enterBeginsEditing?t.cellProperties.readOnly?t.moveSelectionAfterEnter():t.openEditor(null,a,!0):t.moveSelectionAfterEnter(s.includes("shift")),gr(a)}}],i)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&t.prepareEditor()});return}var r=this.instance.getSelectedRangeLast().highlight,n=r.row,o=r.col,i=this.instance.runHooks("modifyGetCellCoords",n,o),a=n,s=o;if(Array.isArray(i)){var l=est(i,2);a=l[0],s=l[1]}this.cellProperties=this.instance.getCellMeta(a,s);var u=this.instance.rootDocument.activeElement;if(u&&Ov(u)&&u.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(n,o,!0);if(c){var f=this.instance.getCellEditor(this.cellProperties),h=this.instance.colToProp(s),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(a),s);this.activeEditor=EW(f,this.instance),this.activeEditor.prepare(n,o,h,c,p,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,i=o.row,a=o.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(i),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(a);this.instance.view.scrollViewport(this.instance._createCellCoords(s,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,r))}},{key:"closeEditor",value:function(t,r,n){this.activeEditor?this.activeEditor.finishEditing(t,r,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){this.closeEditor(!0,t)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var t=this.instance.getCellEditor(this.cellProperties),r=this.instance.getSelectedRangeLast().highlight,n=r.row,o=r.col,i=this.instance,a=i.rowIndexMapper,s=i.columnIndexMapper,l=a.isHidden(this.instance.toPhysicalRow(n))||s.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!t||l)}},{key:"moveSelectionAfterEnter",value:function(t){var r=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-r.row,-r.col):this.selection.transformStart(r.row,r.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(t){var r=this;if(this.instance.isListening()){var n=t.keyCode;if(this.selection.isSelected()){var o=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!OR(n)&&!CW(n)&&!o&&!this.isEditorOpened()){var i=this.instance.getShortcutManager(),a=i.getContext("editor"),s={runOnlyIf:function(){return ht(r.instance.getSelected())},group:Rv};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){r.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){r.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){r.instance.selection.transformStart(0,-1*r.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){r.instance.selection.transformStart(0,r.instance.getDirectionFactor())}}],s),this.openEditor("",t)}}}}},{key:"onCellDblClick",value:function(t,r,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),nI=new WeakMap;US.getInstance=function(e,t,r){var n=nI.get(e);return n||(n=new US(e,t,r),nI.set(e,n)),n};const cst=US;var fst=jt,hst=En,TW=Wd,dst=Wt,pst=dst(function(){TW(1)});fst({target:"Object",stat:!0,forced:pst},{keys:function(e){return TW(hst(e))}});var yst=Ke,gst=iv,mst=De,vst=mr,bst=Va,kA=Ue,wst=Rn,Ast=Na,Sst=xk,rI=av;gst("match",function(e,t,r){return[function(n){var o=wst(this),i=vst(n)?void 0:Ast(n,e);return i?yst(i,n,o):new RegExp(n)[e](kA(o))},function(n){var o=mst(this),i=kA(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return rI(o,i);var s=o.unicode;o.lastIndex=0;for(var l=[],u=0,c;(c=rI(o,i))!==null;){var f=kA(c[0]);l[u]=f,f===""&&(o.lastIndex=Sst(i,bst(o.lastIndex),s)),u++}return u===0?null:l}]});var Cst=Wa,Ost=Fn,kst=Ci,Rst=Zn,Est=uc,Tst=Math.min,YS=[].lastIndexOf,PW=!!YS&&1/[1].lastIndexOf(1,-0)<0,Pst=Est("lastIndexOf"),Mst=PW||!Pst,Ist=Mst?function(e){if(PW)return Cst(YS,this,arguments)||0;var t=Ost(this),r=Rst(t),n=r-1;for(arguments.length>1&&(n=Tst(n,kst(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:YS,xst=jt,oI=Ist;xst({target:"Array",proto:!0,forced:oI!==[].lastIndexOf},{lastIndexOf:oI});var jst=Ha,Dst=En,_st=Dd,Hst=Zn,Nst=TypeError,iI=function(e){return function(t,r,n,o){jst(r);var i=Dst(t),a=_st(i),s=Hst(i),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in a){o=a[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw Nst("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in a&&(o=r(o,a[l],l,i));return o}},Bst={left:iI(!1),right:iI(!0)},Lst=jt,Vst=Bst.left,Fst=uc,aI=_d,Wst=TV,Ust=!Wst&&aI>79&&aI<83,Yst=Ust||!Fst("reduce");Lst({target:"Array",proto:!0,forced:Yst},{reduce:function(e){var t=arguments.length;return Vst(this,e,t,t>1?arguments[1]:void 0)}});var Gst=jt,zst=Fa.findIndex,Qst=Xd,GS="findIndex",MW=!0;GS in[]&&Array(1)[GS](function(){MW=!1});Gst({target:"Array",proto:!0,forced:MW},{findIndex:function(e){return zst(this,e,arguments.length>1?arguments[1]:void 0)}});Qst(GS);function RA(e){return Zst(e)||Jst(e)||Xst(e)||Kst()}function Kst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xst(e,t){if(e){if(typeof e=="string")return zS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zS(e,t)}}function Jst(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zst(e){if(Array.isArray(e))return zS(e)}function zS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var IW={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},qst=new RegExp(Object.keys(IW).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function $st(e){return(e&&e.nodeName||"")==="TABLE"}function QS(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=t?1:0,h=0;h<i;h+=1){for(var p=t&&h===0,y=[],m=0;m<a;m+=1){var v=!p&&r&&m===0,w="";if(p)w="<th>".concat(e.getColHeader(m-c),"</th>");else if(v)w="<th>".concat(e.getRowHeader(h-f),"</th>");else{var C=o[h][m],A=e.getCellMeta(h-f,m-c),D=A.hidden,E=A.rowspan,G=A.colspan;if(!D){var K=[];if(E&&K.push('rowspan="'.concat(E,'"')),G&&K.push('colspan="'.concat(G,'"')),Qe(C))w="<td ".concat(K.join(" "),"></td>");else{var nt=C.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(K.join(" "),">").concat(nt,"</td>")}}}y.push(w)}var z=["<tr>"].concat(y,["</tr>"]).join("");p?l.splice(1,0,z):u.splice(-1,0,z)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function KS(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var s=0;s<i;s+=1){var l=o[s],u=Qe(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function xW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(O){var R=O.match(/<td\b[^>]*?>/g)[0],I=O.substring(R.length,O.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),W="</td>";return"".concat(R).concat(I).concat(W)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!$st(i))){var s=o.querySelector('meta[name$="enerator"]'),l=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),c=u?Array.from(u.cells).reduce(function(O,R){return O+R.colSpan},0)-(l?1:0):0,f=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],p=!1,y=0,m=0;if(i.tHead){var v=Array.from(i.tHead.rows).filter(function(O){var R=O.querySelector("td")!==null;return R&&h.push(O),!R});y=v.length,p=y>0,y>1?r.nestedHeaders=Array.from(v).reduce(function(O,R){var I=Array.from(R.cells).reduce(function(W,N,Q){if(l&&Q===0)return W;var J=N.colSpan,rt=N.innerHTML,mt=J>1?{label:rt,colspan:J}:rt;return W.push(mt),W},[]);return O.push(I),O},[]):p&&(r.colHeaders=Array.from(v[0].children).reduce(function(O,R,I){return l&&I===0||O.push(R.innerHTML),O},[]))}h.length&&(r.fixedRowsTop=h.length),f.length&&(r.fixedRowsBottom=f.length);var w=[].concat(h,RA(Array.from(i.tBodies).reduce(function(O,R){return O.push.apply(O,RA(Array.from(R.rows))),O},[])),RA(f));m=w.length;for(var C=new Array(m),A=0;A<m;A++)C[A]=new Array(c);for(var D=[],E=[],G=0;G<m;G++)for(var K=w[G],nt=Array.from(K.cells),z=nt.length,X=0;X<z;X++){var Z=nt[X],tt=Z.nodeName,et=Z.innerHTML,bt=Z.rowSpan,yt=Z.colSpan,kt=C[G].findIndex(function(O){return O===void 0});if(tt==="TD"){if(bt>1||yt>1){for(var Et=G;Et<G+bt;Et++)if(Et<m)for(var P=kt;P<kt+yt;P++)C[Et][P]=null;var d=Z.getAttribute("style"),g=d&&d.includes("mso-ignore:colspan");g||D.push({col:kt,row:G,rowspan:bt,colspan:yt})}var b="";s&&/excel/gi.test(s.content)?b=et.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):b=et.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[G][kt]=b.replace(qst,function(O){return IW[O]})}else E.push(et)}return D.length&&(r.mergeCells=D),E.length&&(r.rowHeaders=E),C.length&&(r.data=C),r}}const tlt=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:KS,htmlToGridSettings:xW,instanceToHTML:QS},Symbol.toStringTag,{value:"Module"}));function elt(e){return ilt(e)||olt(e)||rlt(e)||nlt()}function nlt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rlt(e,t){if(e){if(typeof e=="string")return XS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XS(e,t)}}function olt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ilt(e){if(Array.isArray(e))return XS(e)}function XS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JS(e){return JS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},JS(e)}function Nn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=JS(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(elt(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function jW(e){return Nn(e,[","])}function Ct(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function Vg(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function kR(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const alt=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:Nn,isNumericLike:jW,rangeEach:Ct,rangeEachReverse:Vg,valueAccordingPercent:kR},Symbol.toStringTag,{value:"Module"}));function slt(e){return clt(e)||ult(e)||DW(e)||llt()}function llt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ult(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function clt(e){if(Array.isArray(e))return ZS(e)}function flt(e,t){return plt(e)||dlt(e,t)||DW(e,t)||hlt()}function hlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DW(e,t){if(e){if(typeof e=="string")return ZS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZS(e,t)}}function ZS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dlt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function plt(e){if(Array.isArray(e))return e}var qS="asc",ylt="desc",sI=new Map([[qS,[-1,1]],[ylt,[1,-1]]]),glt=function(e){return"The priority '".concat(e,"' is already declared in a map.")},mlt=function(e){return"The priority '".concat(e,"' is not a number.")};function vlt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=ge(t)?t:glt,r=ge(r)?r:mlt;function o(a,s){if(!Nn(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,s)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qS,s=sI.get(a)||sI.get(qS),l=flt(s,2),u=l[0],c=l[1];return slt(n).sort(function(f,h){return f[0]<h[0]?u:c}).map(function(f){return f[1]})}return{addItem:o,getItems:i}}var blt=jt,wlt=Fa.find,Alt=Xd,$S="find",_W=!0;$S in[]&&Array(1)[$S](function(){_W=!1});blt({target:"Array",proto:!0,forced:_W},{find:function(e){return wlt(this,e,arguments.length>1?arguments[1]:void 0)}});Alt($S);function Slt(e){return klt(e)||Olt(e)||HW(e)||Clt()}function Clt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Olt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function klt(e){if(Array.isArray(e))return tC(e)}function lI(e,t){return Tlt(e)||Elt(e,t)||HW(e,t)||Rlt()}function Rlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HW(e,t){if(e){if(typeof e=="string")return tC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tC(e,t)}}function tC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Elt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Tlt(e){if(Array.isArray(e))return e}var Plt=function(e){return"The id '".concat(e,"' is already declared in a map.")};function Ev(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=ge(t)?t:Plt;function n(c,f){if(u(c))throw new Error(t(c));r.set(c,f)}function o(c){return r.delete(c)}function i(){r.clear()}function a(c){var f=l().find(function(y){var m=lI(y,2),v=m[0],w=m[1];return c===w?v:!1})||[null],h=lI(f,1),p=h[0];return p}function s(c){return r.get(c)}function l(){return Slt(r)}function u(c){return r.has(c)}return{addItem:n,clear:i,getId:a,getItem:s,getItems:l,hasItem:u,removeItem:o}}function Mlt(e){return Dlt(e)||jlt(e)||xlt(e)||Ilt()}function Ilt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xlt(e,t){if(e){if(typeof e=="string")return eC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eC(e,t)}}function jlt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dlt(e){if(Array.isArray(e))return eC(e)}function eC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _lt=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function Hlt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=ge(t)?t:_lt;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return Mlt(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function Nlt(e,t){return Vlt(e)||Llt(e,t)||NW(e,t)||Blt()}function Blt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Llt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Vlt(e){if(Array.isArray(e))return e}function uI(e){return Ult(e)||Wlt(e)||NW(e)||Flt()}function Flt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NW(e,t){if(e){if(typeof e=="string")return nC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nC(e,t)}}function Wlt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ult(e){if(Array.isArray(e))return nC(e)}function nC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var RR=function(e){return'There is already registered "'.concat(e,'" plugin.')},Ylt=function(e){return'There is already registered plugin on priority "'.concat(e,'".')},Glt=function(e){return'The priority "'.concat(e,'" is not a number.')},BW=vlt({errorPriorityExists:Ylt,errorPriorityNaN:Glt}),LW=Hlt({errorItemExists:RR}),rC=Ev({errorIdExists:RR});function ER(){return[].concat(uI(BW.getItems()),uI(LW.getItems()))}function lp(e){var t=kn(e);return rC.getItem(t)}function zlt(e){return!!lp(e)}function ee(e,t,r){var n=Klt(e,t,r),o=Nlt(n,3);e=o[0],t=o[1],r=o[2],lp(e)===void 0&&Qlt(e,t,r)}function Qlt(e,t,r){var n=kn(e);if(rC.hasItem(n))throw new Error(RR(n));r===void 0?LW.addItem(n):BW.addItem(r,n),rC.addItem(n,t)}function Klt(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var up=tr("renderers"),Xlt=up.register,Jlt=up.getItem,VW=up.hasItem,Zlt=up.getNames;up.getValues;function Fg(e){if(typeof e=="function")return e;if(!VW(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Jlt(e)}function Pr(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),Xlt(e,t)}var cp=tr("validators"),qlt=cp.register,$lt=cp.getItem,FW=cp.hasItem,tut=cp.getNames;cp.getValues;function TR(e){if(typeof e=="function")return e;if(!FW(e))throw Error('No registered validator found under "'.concat(e,'" name'));return $lt(e)}function Is(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),qlt(e,t)}var Gi=1,nn=2;function Lf(e){return Lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lf(e)}function eut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rut(n.key),n)}}function nut(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rut(e){var t=out(e,"string");return Lf(t)==="symbol"?t:String(t)}function out(e,t){if(Lf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var es=new WeakMap,iut=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,c=u===void 0?function(h){return h}:u,f=t.inlineStartOffset;eut(this,e),es.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c,inlineStartOffset:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return nut(e,[{key:"calculate",value:function(){for(var t=0,r=!0,n=[],o,i=0,a=0,s=es.get(this),l=s.calculationType,u=s.overrideFn,c=s.scrollOffset,f=Math.max(s.scrollOffset,0),h=s.totalColumns,p=s.viewportWidth,y=f>0?p+1:p,m=0;m<h;m++)if(o=this._getColumnWidth(m),t<=f&&l!==nn&&(this.startColumn=m,i=o),t>=f&&t+(l===nn?o:0)<=f+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=m,i=o),this.endColumn=m),n.push(t),t+=o,a=o,l!==nn&&(this.endColumn=m),t>=f+p){r=!1;break}var v=c+p-y,w=l===nn?0:a,C=l===nn?i:0;if(v<-1*s.inlineStartOffset||c>n.at(-1)+w||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===h-1&&r)for(this.startColumn=this.endColumn;this.startColumn>0;){var A=n[this.endColumn]+o-n[this.startColumn-1];if((A<=p||l!==nn)&&(this.startColumn-=1),A>p)break}l===Gi&&this.startColumn!==null&&u&&u(this),this.startPosition=n[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),h<this.endColumn&&(this.endColumn=h-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if(this.stretch!=="none"){var r=t;this.totalTargetWidth=r;for(var n=es.get(this),o=n.totalColumns,i=0,a=0;a<o;a++){var s=this._getColumnWidth(a),l=n.stretchingColumnWidthFn(void 0,a);typeof l=="number"?r-=l:i+=s}var u=r-i;if(this.stretch==="all"&&u>0)this.stretchAllRatio=r/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&r!==1/0){var c=this._getColumnWidth(o-1),f=u+c;this.stretchLastWidth=f>=0?f:c}}}},{key:"getStretchedColumnWidth",value:function(t,r){var n=null;return this.stretch==="all"&&this.stretchAllRatio!==0?n=this._getStretchedAllColumnWidth(t,r):this.stretch==="last"&&this.stretchLastWidth!==0&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,r){var n=0,o=es.get(this),i=o.totalColumns;if(!this.stretchAllColumnsWidth[t]){var a=Math.round(r*this.stretchAllRatio),s=o.stretchingColumnWidthFn(a,t);s===void 0?this.stretchAllColumnsWidth[t]=a:this.stretchAllColumnsWidth[t]=isNaN(s)?this._getColumnWidth(t):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){var r=es.get(this),n=r.totalColumns;return t===n-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var r=es.get(this).columnWidthFn(t);return isNaN(r)&&(r=e.DEFAULT_WIDTH),r}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const PR=iut;function Vf(e){return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(e)}function aut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lut(n.key),n)}}function sut(e,t,r){return t&&fI(e.prototype,t),r&&fI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lut(e){var t=uut(e,"string");return Vf(t)==="symbol"?t:String(t)}function uut(e,t){if(Vf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hI=new WeakMap,cut=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;aut(this,e),hI.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return sut(e,[{key:"calculate",value:function(){for(var t=hI.get(this),r=t.calculationType,n=t.overrideFn,o=t.rowHeightFn,i=t.scrollOffset,a=Math.max(t.scrollOffset,0),s=t.totalRows,l=t.viewportHeight,u=t.horizontalScrollbarHeight||0,c=0,f=!0,h=[],p,y=0,m=0,v=0;v<s;v++)if(p=o(v),isNaN(p)&&(p=e.DEFAULT_HEIGHT),c<=a&&r!==nn&&(this.startRow=v,y=p),c>=a&&c+(r===nn?p:0)<=a+l-u&&(this.startRow===null&&(this.startRow=v,y=p),this.endRow=v),h.push(c),c+=p,m=p,r!==nn&&(this.endRow=v),c>=a+l-u){f=!1;break}var w=i+l-u,C=r===nn?y:0,A=r===nn?0:m;if(w<C||i>h.at(-1)+A?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&f)for(this.startRow=this.endRow;this.startRow>0;){var D=h[this.endRow]+p-h[this.startRow-1];if((D<=l-u||r!==nn)&&(this.startRow-=1),D>=l-u)break}r===Gi&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const WW=cut;function Ff(e){return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ff(e)}function fut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UW(n.key),n)}}function hut(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dut(e,t,r){put(e,t),t.set(e,r)}function put(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pI(e,t,r){return t=UW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UW(e){var t=yut(e,"string");return Ff(t)==="symbol"?t:String(t)}function yut(e,t){if(Ff(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xc(e,t){var r=YW(e,t,"get");return gut(e,r)}function gut(e,t){return t.get?t.get.call(e):t.value}function mut(e,t,r){var n=YW(e,t,"set");return vut(e,n,r),r}function YW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function vut(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ii=new WeakMap,but=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;fut(this,e),pI(this,"row",null),pI(this,"col",null),dut(this,Ii,{writable:!0,value:!1}),mut(this,Ii,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return hut(e,[{key:"isValid",value:function(t){return!(this.row<0||this.col<0||this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this?!0:this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&(xc(this,Ii)?this.col<=t.col:this.col>=t.col)}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&(xc(this,Ii)?this.col>=t.col:this.col<=t.col)}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&(xc(this,Ii)?this.col>=t.col:this.col<=t.col)}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&(xc(this,Ii)?this.col<=t.col:this.col>=t.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,xc(this,Ii))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const Wg=but;function Wf(e){return Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wf(e)}function wut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GW(n.key),n)}}function Aut(e,t,r){return t&&yI(e.prototype,t),r&&yI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sut(e,t,r){Cut(e,t),t.set(e,r)}function Cut(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EA(e,t,r){return t=GW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GW(e){var t=Out(e,"string");return Wf(t)==="symbol"?t:String(t)}function Out(e,t){if(Wf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wr(e,t){var r=zW(e,t,"get");return kut(e,r)}function kut(e,t){return t.get?t.get.call(e):t.value}function Rut(e,t,r){var n=zW(e,t,"set");return Eut(e,n,r),r}function zW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Eut(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Un=new WeakMap,Tut=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;wut(this,e),EA(this,"highlight",null),EA(this,"from",null),EA(this,"to",null),Sut(this,Un,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Rut(this,Un,o)}return Aut(e,[{key:"setHighlight",value:function(t){return this.highlight=t.clone().normalize(),this}},{key:"setFrom",value:function(t){return this.from=t.clone(),this}},{key:"setTo",value:function(t){return this.to=t.clone(),this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var t=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(t,r)-Math.min(t,r)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var t=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(t,r)-Math.min(t,r)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(t){var r=t.row,n=t.col,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=r&&i.row>=r&&o.col<=n&&i.col>=n}},{key:"includesRange",value:function(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}},{key:"expand",value:function(t){var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return t.row<r.row||t.col<r.col||t.row>n.row||t.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,t.row),Math.min(r.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0):!1}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=this.getDirection(),i=t.getOuterTopStartCorner(),a=t.getOuterBottomEndCorner(),s=Math.min(r.row,i.row),l=Math.min(r.col,i.col),u=Math.max(n.row,a.row),c=Math.max(n.col,a.col),f=this._createCellCoords(s,l),h=this._createCellCoords(u,c);return this.from=f,this.to=h,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var r=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=r[0],this.to=r[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var i=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=i[0],this.to=i[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return wr(this,Un)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return wr(this,Un)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return wr(this,Un)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return wr(this,Un)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return wr(this,Un)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return wr(this,Un)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return wr(this,Un)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return wr(this,Un)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(t,r){return r&&r.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(r.from.row,r.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(r.from.row,r.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(r.to.row,r.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(r.to.row,r.to.col)))?!0:t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,r){if(!(t instanceof Wg))return!1;if(r){var n=r.from,o=r.to;if(r.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(t.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(t.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(t.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(t.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},o=[];return r.top===n.top&&o.push("top"),r.right===n.right&&o.push("right"),r.bottom===n.bottom&&o.push("bottom"),r.left===n.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[],o=t.row;o<=r.row;o++)for(var i=t.col;i<=r.col;i++)!(this.from.row===o&&this.from.col===i)&&!(this.to.row===o&&this.to.col===i)&&n.push(this._createCellCoords(o,i));return n}},{key:"getAll",value:function(){for(var t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[],o=t.row;o<=r.row;o++)for(var i=t.col;i<=r.col;i++)t.row===o&&t.col===i?n.push(t):r.row===o&&r.col===i?n.push(r):n.push(this._createCellCoords(o,i));return n}},{key:"forAll",value:function(t){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=r.row;o<=n.row;o++)for(var i=r.col;i<=n.col;i++){var a=t(o,i);if(a===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,wr(this,Un))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(t,r){return new Wg(t,r,wr(this,Un))}}]),e}();const MR=Tut;var Put=jt,Mut=pk;Put({target:"Object",stat:!0},{setPrototypeOf:Mut});var QW=Kt,Iut=Ha,xut=We,jut=Me,gI=Qd,Dut=Id,KW=Function,_ut=QW([].concat),Hut=QW([].join),TA={},Nut=function(e,t,r){if(!jut(TA,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";TA[t]=KW("C,a","return new C("+Hut(n,",")+")")}return TA[t](e,r)},But=Dut?KW.bind:function(e){var t=Iut(this),r=t.prototype,n=gI(arguments,1),o=function(){var i=_ut(n,gI(arguments));return this instanceof o?Nut(t,i.length,i):t.apply(e,i)};return xut(r)&&(o.prototype=r),o},Lut=jt,Vut=Do,PA=Wa,Fut=But,mI=YV,Wut=De,vI=We,Uut=ac,XW=Wt,IR=Vut("Reflect","construct"),Yut=Object.prototype,Gut=[].push,JW=XW(function(){function e(){}return!(IR(function(){},[],e)instanceof e)}),ZW=!XW(function(){IR(function(){})}),bI=JW||ZW;Lut({target:"Reflect",stat:!0,forced:bI,sham:bI},{construct:function(e,t){mI(e),Wut(t);var r=arguments.length<3?e:mI(arguments[2]);if(ZW&&!JW)return IR(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return PA(Gut,n,t),new(PA(Fut,e,n))}var o=r.prototype,i=Uut(vI(o)?o:Yut),a=PA(e,i,t);return vI(a)?a:i}});function Uf(e){return Uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uf(e)}function zut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kut(n.key),n)}}function Qut(e,t,r){return t&&wI(e.prototype,t),r&&wI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kut(e){var t=Xut(e,"string");return Uf(t)==="symbol"?t:String(t)}function Xut(e,t){if(Uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ns=new WeakMap,Jut=function(){function e(t,r,n,o,i,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;zut(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=s,this.eventManager=o,this.facadeGetter=t,ns.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return Qut(e,[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return t.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return t.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return t.onMouseOut(o)});var r=function(){t.eventManager.addEventListener(t.wtTable.holder,"touchstart",function(o){return t.onTouchStart(o)}),t.eventManager.addEventListener(t.wtTable.holder,"touchend",function(o){return t.onTouchEnd(o)}),t.momentumScrolling||(t.momentumScrolling={}),t.eventManager.addEventListener(t.wtTable.holder,"scroll",function(){clearTimeout(t.momentumScrolling._timeout),t.momentumScrolling.ongoing||t.wtSettings.getSetting("onBeforeTouchScroll"),t.momentumScrolling.ongoing=!0,t.momentumScrolling._timeout=setTimeout(function(){t.touchApplied||(t.momentumScrolling.ongoing=!1,t.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},n=function(){t.eventManager.addEventListener(t.wtTable.holder,"mouseup",function(o){return t.onMouseUp(o)}),t.eventManager.addEventListener(t.wtTable.holder,"mousedown",function(o){return t.onMouseDown(o)})};cr()?r():(Fk()&&r(),n())}},{key:"selectedCellWasTouched",value:function(t){var r=ns.get(this),n=this.parentCell(t),o=n.coords;if(r.selectedCellBeforeTouchEnd&&o){var i=[o.row,r.selectedCellBeforeTouchEnd.from.row],a=i[0],s=i[1],l=[o.col,r.selectedCellBeforeTouchEnd.from.col],u=l[0],c=l[1];return a===s&&u===c}return!1}},{key:"parentCell",value:function(t){var r={},n=this.wtTable.TABLE,o=nf(t,["TD","TH"],n);return o?(r.coords=this.wtTable.getCoords(o),r.TD=o):Dt(t,"wtBorder")&&Dt(t,"current")?(r.coords=this.selections.getCell().cellRange.highlight,r.TD=this.wtTable.getCell(r.coords)):Dt(t,"wtBorder")&&Dt(t,"area")&&this.selections.createOrGetArea().cellRange&&(r.coords=this.selections.createOrGetArea().cellRange.to,r.TD=this.wtTable.getCell(r.coords)),r}},{key:"onMouseDown",value:function(t){var r=ns.get(this),n=this.domBindings.rootDocument.activeElement,o=SR(eW,t.target),i=t.target;if(!(i===n||o(0)===n||o(1)===n)){var a=this.parentCell(i);Dt(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",t,i):a.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,a.coords,a.TD),(t.button===0||this.touchApplied)&&a.TD&&(r.dblClickOrigin[0]=a.TD,clearTimeout(r.dblClickTimeout[0]),r.dblClickTimeout[0]=setTimeout(function(){r.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(t){if(this.wtSettings.has("onCellContextMenu")){var r=this.parentCell(t.target);r.TD&&this.callListener("onCellContextMenu",t,r.coords,r.TD)}}},{key:"onMouseOver",value:function(t){if(this.wtSettings.has("onCellMouseOver")){var r=this.wtTable.TABLE,n=nf(t.target,["TD","TH"],r),o=this.parent||this;n&&n!==o.lastMouseOver&&oi(n,r)&&(o.lastMouseOver=n,this.callListener("onCellMouseOver",t,this.wtTable.getCoords(n),n))}}},{key:"onMouseOut",value:function(t){if(this.wtSettings.has("onCellMouseOut")){var r=this.wtTable.TABLE,n=nf(t.target,["TD","TH"],r),o=nf(t.relatedTarget,["TD","TH"],r);n&&n!==o&&oi(n,r)&&this.callListener("onCellMouseOut",t,this.wtTable.getCoords(n),n)}}},{key:"onMouseUp",value:function(t){var r=ns.get(this),n=this.parentCell(t.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,n.coords,n.TD),!(t.button!==0&&!this.touchApplied)&&(n.TD===r.dblClickOrigin[0]&&n.TD===r.dblClickOrigin[1]?(Dt(t.target,"corner")?this.callListener("onCellCornerDblClick",t,n.coords,n.TD):this.callListener("onCellDblClick",t,n.coords,n.TD),r.dblClickOrigin[0]=null,r.dblClickOrigin[1]=null):n.TD===r.dblClickOrigin[0]&&(r.dblClickOrigin[1]=n.TD,clearTimeout(r.dblClickTimeout[1]),r.dblClickTimeout[1]=setTimeout(function(){r.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(t){var r=ns.get(this);r.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var r,n=t.target,o=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,i=ht(o)&&o.row>=0&&o.col>=0,a=t.cancelable&&i&&this.wtSettings.getSetting("isDataViewInstance");if(a){var s=["A","BUTTON","INPUT"];Qk()&&(qV()||$V())&&this.selectedCellWasTouched(n)&&!s.includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}},{key:"callListener",value:function(t,r,n,o){var i=this.wtSettings.getSettingPure(t);i&&i(r,n,o,this.facadeGetter())}},{key:"destroy",value:function(){var t=ns.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const qW=Jut;function Yf(e){return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yf(e)}function Zut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$ut(n.key),n)}}function qut(e,t,r){return t&&AI(e.prototype,t),r&&AI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ut(e){var t=tct(e,"string");return Yf(t)==="symbol"?t:String(t)}function tct(e,t){if(Yf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ect=function(){function e(t,r,n){Zut(this,e),this.offset=t,this.total=r,this.countTH=n}return qut(e,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),e}();const nct=ect;function Gf(e){return Gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gf(e)}function rct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ict(n.key),n)}}function oct(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ict(e){var t=act(e,"string");return Gf(t)==="symbol"?t:String(t)}function act(e,t){if(Gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sct=function(){function e(t,r,n){rct(this,e),this.offset=t,this.total=r,this.countTH=n}return oct(e,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),e}();const lct=sct;var uct=0,Ug=1,Yg=2;function zf(e){return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zf(e)}function cct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hct(n.key),n)}}function fct(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hct(e){var t=dct(e,"string");return zf(t)==="symbol"?t:String(t)}function dct(e,t){if(zf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OI=function(){function e(){cct(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return fct(e,[{key:"setSize",value:function(t){this.currentSize=this.nextSize,this.nextSize=t}},{key:"setOffset",value:function(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}]),e}();function Qf(e){return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(e)}function pct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gct(n.key),n)}}function yct(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gct(e){var t=mct(e,"string");return Qf(t)==="symbol"?t:String(t)}function mct(e,t){if(Qf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vct=function(){function e(){pct(this,e),this.size=new OI,this.workingSpace=uct,this.sharedSize=null}return yct(e,[{key:"setSize",value:function(t){this.size.setSize(t)}},{key:"setOffset",value:function(t){this.size.setOffset(t)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof OI}},{key:"isPlaceOn",value:function(t){return this.workingSpace===t}},{key:"append",value:function(t){this.workingSpace=Ug,t.workingSpace=Yg,this.sharedSize=t.getViewSize()}},{key:"prepend",value:function(t){this.workingSpace=Yg,t.workingSpace=Ug,this.sharedSize=t.getViewSize()}}]),e}();function Kf(e){return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kf(e)}function bct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Act(n.key),n)}}function wct(e,t,r){return t&&RI(e.prototype,t),r&&RI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Act(e){var t=Sct(e,"string");return Kf(t)==="symbol"?t:String(t)}function Sct(e,t){if(Kf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $W=function(){function e(t,r,n){bct(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new vct,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return wct(e,[{key:"setSize",value:function(t){return this.sizeSet.setSize(t),this}},{key:"setOffset",value:function(t){return this.sizeSet.setOffset(t),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}},{key:"getCurrentNode",value:function(){var t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}},{key:"getRenderedChildCount",value:function(){var t=this.rootNode,r=this.sizeSet,n=0;if(this.isSharedViewSet())for(var o=t.firstElementChild;o;){if(o.tagName===this.childNodeType)n+=1;else if(r.isPlaceOn(Ug))break;o=o.nextElementSibling}else n=t.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var t=this.rootNode,r=this.sizeSet,n=this.isSharedViewSet(),o=r.getViewSize(),i=o.nextSize,a=this.getRenderedChildCount();a<i;){var s=this.nodesPool();!n||n&&r.isPlaceOn(Yg)?t.appendChild(s):t.insertBefore(s,t.firstChild),a+=1}for(var l=n&&r.isPlaceOn(Ug);a>i;)t.removeChild(l?t.firstChild:t.lastChild),a-=1}},{key:"render",value:function(){var t=this.rootNode,r=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(Yg)&&(n+=r.sharedSize.nextSize);var o=t.childNodes[n];if(o.tagName!==this.childNodeType){var i=this.nodesPool();t.replaceChild(i,o),o=i}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function ol(e){return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(e)}function Cct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kct(n.key),n)}}function Oct(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kct(e){var t=Rct(e,"string");return ol(t)==="symbol"?t:String(t)}function Rct(e,t){if(ol(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ol(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ect(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oC(e,t)}function oC(e,t){return oC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},oC(e,t)}function Tct(e){var t=Ict();return function(){var r=Gg(e),n;if(t){var o=Gg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pct(this,n)}}function Pct(e,t){if(t&&(ol(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mct(e)}function Mct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ict(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gg(e){return Gg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gg(e)}var tU=function(e){Ect(r,e);var t=Tct(r);function r(){return Cct(this,r),t.apply(this,arguments)}return Oct(r,[{key:"prependView",value:function(n){return this.sizeSet.prepend(n.sizeSet),n.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(n){return this.sizeSet.append(n.sizeSet),n.sizeSet.prepend(this.sizeSet),this}}]),r}($W);function Xf(e){return Xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xf(e)}function xct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dct(n.key),n)}}function jct(e,t,r){return t&&TI(e.prototype,t),r&&TI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dct(e){var t=_ct(e,"string");return Xf(t)==="symbol"?t:String(t)}function _ct(e,t){if(Xf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hct=function(){function e(t){xct(this,e),this.nodeType=t.toUpperCase()}return jct(e,[{key:"setRootDocument",value:function(t){this.rootDocument=t}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function Jf(e){return Jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jf(e)}function Nct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lct(n.key),n)}}function Bct(e,t,r){return t&&PI(e.prototype,t),r&&PI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lct(e){var t=Vct(e,"string");return Jf(t)==="symbol"?t:String(t)}function Vct(e,t){if(Jf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fp=function(){function e(t,r){Nct(this,e),this.nodesPool=typeof t=="string"?new Hct(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Bct(e,[{key:"setTable",value:function(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function il(e){return il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},il(e)}function Fct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uct(n.key),n)}}function Wct(e,t,r){return t&&MI(e.prototype,t),r&&MI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uct(e){var t=Yct(e,"string");return il(t)==="symbol"?t:String(t)}function Yct(e,t){if(il(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(il(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iC(e,t)}function iC(e,t){return iC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},iC(e,t)}function zct(e){var t=Xct();return function(){var r=zg(e),n;if(t){var o=zg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qct(this,n)}}function Qct(e,t){if(t&&(il(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kct(e)}function Kct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zg(e){return zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zg(e)}var Jct=function(e){Gct(r,e);var t=zct(r);function r(){var n;return Fct(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Wct(r,[{key:"obtainOrderView",value:function(n){var o=this,i;return this.orderViews.has(n)?i=this.orderViews.get(n):(i=new tU(n,function(a){return o.nodesPool.obtain(o.sourceRowIndex,a)},this.nodeType),this.orderViews.set(n,i)),i}},{key:"render",value:function(){for(var n=this.table,o=n.rowsToRender,i=n.rowHeaderFunctions,a=n.rowHeadersCount,s=n.rows,l=n.cells,u=0;u<o;u++){var c=this.table.renderedRowToSource(u),f=s.getRenderedNode(u);this.sourceRowIndex=c;var h=this.obtainOrderView(f),p=l.obtainOrderView(f);h.appendView(p).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<a;y++){h.render();var m=h.getCurrentNode();m.className="",m.removeAttribute("style"),i[y](c,m,y)}h.end()}}}]),r}(fp);function al(e){return al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},al(e)}function Zct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function II(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$ct(n.key),n)}}function qct(e,t,r){return t&&II(e.prototype,t),r&&II(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ct(e){var t=tft(e,"string");return al(t)==="symbol"?t:String(t)}function tft(e,t){if(al(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(al(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aC(e,t)}function aC(e,t){return aC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},aC(e,t)}function nft(e){var t=ift();return function(){var r=Qg(e),n;if(t){var o=Qg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rft(this,n)}}function rft(e,t){if(t&&(al(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oft(e)}function oft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ift(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qg(e){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qg(e)}var aft=function(e){eft(r,e);var t=nft(r);function r(n){return Zct(this,r),t.call(this,null,n)}return qct(r,[{key:"adjust",value:function(){var n=this.table,o=n.columnHeadersCount,i=n.rowHeadersCount,a=this.rootNode.firstChild;if(o){for(var s=this.table.columnsToRender,l=s+i,u=0,c=o;u<c;u++){for(a=this.rootNode.childNodes[u],a||(a=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(a)),this.renderedNodes=a.childNodes.length;this.renderedNodes<l;)a.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>l;)a.removeChild(a.lastChild),this.renderedNodes-=1}var f=this.rootNode.childNodes.length;if(f>o)for(var h=o;h<f;h++)this.rootNode.removeChild(this.rootNode.lastChild)}else a&&yr(a)}},{key:"render",value:function(){for(var n=this.table.columnHeadersCount,o=0;o<n;o+=1)for(var i=this.table,a=i.columnHeaderFunctions,s=i.columnsToRender,l=i.rowHeadersCount,u=this.rootNode.childNodes[o],c=-1*l;c<s;c+=1){var f=this.table.renderedColumnToSource(c),h=u.childNodes[c+l];h.className="",h.removeAttribute("style"),a[o](f,h,o)}}}]),r}(fp);function sl(e){return sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sl(e)}function sft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uft(n.key),n)}}function lft(e,t,r){return t&&xI(e.prototype,t),r&&xI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uft(e){var t=cft(e,"string");return sl(t)==="symbol"?t:String(t)}function cft(e,t){if(sl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sC(e,t)}function sC(e,t){return sC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},sC(e,t)}function hft(e){var t=yft();return function(){var r=Kg(e),n;if(t){var o=Kg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dft(this,n)}}function dft(e,t){if(t&&(sl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pft(e)}function pft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kg(e){return Kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Kg(e)}var gft=function(e){fft(r,e);var t=hft(r);function r(n){return sft(this,r),t.call(this,null,n)}return lft(r,[{key:"adjust",value:function(){for(var n=this.table,o=n.columnsToRender,i=n.rowHeadersCount,a=o+i;this.renderedNodes<a;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>a;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var n=this.table,o=n.columnsToRender,i=n.rowHeadersCount,a=0;a<i;a++){var s=this.table.renderedColumnToSource(a),l=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[a].style.width="".concat(l,"px")}for(var u=0;u<o;u++){var c=this.table.renderedColumnToSource(u),f=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[u+i].style.width="".concat(f,"px")}var h=this.rootNode.firstChild;h&&q(h,"rowHeader")}}]),r}(fp);function ll(e){return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(e)}var jI;function mft(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function vft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wft(n.key),n)}}function bft(e,t,r){return t&&DI(e.prototype,t),r&&DI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wft(e){var t=Aft(e,"string");return ll(t)==="symbol"?t:String(t)}function Aft(e,t){if(ll(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ll(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lC(e,t)}function lC(e,t){return lC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},lC(e,t)}function Cft(e){var t=Rft();return function(){var r=Xg(e),n;if(t){var o=Xg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oft(this,n)}}function Oft(e,t){if(t&&(ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kft(e)}function kft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xg(e){return Xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xg(e)}var _I=!1,Eft=function(e){Sft(r,e);var t=Cft(r);function r(n){var o;return vft(this,r),o=t.call(this,"TR",n),o.orderView=new $W(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return bft(r,[{key:"getRenderedNode",value:function(n){return this.orderView.getNode(n)}},{key:"render",value:function(){var n=this.table.rowsToRender;!_I&&n>1e3&&(_I=!0,de(ce(jI||(jI=mft([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(n).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<n;o++)this.orderView.render();this.orderView.end()}}]),r}(fp);function ul(e){return ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ul(e)}function Tft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mft(n.key),n)}}function Pft(e,t,r){return t&&HI(e.prototype,t),r&&HI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mft(e){var t=Ift(e,"string");return ul(t)==="symbol"?t:String(t)}function Ift(e,t){if(ul(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ul(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uC(e,t)}function uC(e,t){return uC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},uC(e,t)}function jft(e){var t=Hft();return function(){var r=Jg(e),n;if(t){var o=Jg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Dft(this,n)}}function Dft(e,t){if(t&&(ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _ft(e)}function _ft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jg(e){return Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jg(e)}var Nft=function(e){xft(r,e);var t=jft(r);function r(){var n;return Tft(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Pft(r,[{key:"obtainOrderView",value:function(n){var o=this,i;return this.orderViews.has(n)?i=this.orderViews.get(n):(i=new tU(n,function(a){return o.nodesPool.obtain(o.sourceRowIndex,a)},this.nodeType),this.orderViews.set(n,i)),i}},{key:"render",value:function(){for(var n=this.table,o=n.rowsToRender,i=n.columnsToRender,a=n.rows,s=n.rowHeaders,l=0;l<o;l++){var u=this.table.renderedRowToSource(l),c=a.getRenderedNode(l);this.sourceRowIndex=u;var f=this.obtainOrderView(c),h=s.obtainOrderView(c);f.prependView(h).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<i;p++){f.render();var y=f.getCurrentNode(),m=this.table.renderedColumnToSource(p);Dt(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(u,m,y)}f.end()}}}]),r}(fp);function Zf(e){return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zf(e)}function Bft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vft(n.key),n)}}function Lft(e,t,r){return t&&NI(e.prototype,t),r&&NI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vft(e){var t=Fft(e,"string");return Zf(t)==="symbol"?t:String(t)}function Fft(e,t){if(Zf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wft=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Bft(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Lft(e,[{key:"setAxisUtils",value:function(t,r){this.rowUtils=t,this.columnUtils=r}},{key:"setViewportSize",value:function(t,r){this.rowsToRender=t,this.columnsToRender=r}},{key:"setFilters",value:function(t,r){this.rowFilter=t,this.columnFilter=r}},{key:"setHeaderContentRenderers",value:function(t,r){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}},{key:"setRenderers",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.rowHeaders,n=t.columnHeaders,o=t.colGroup,i=t.rows,a=t.cells;r.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),this.rowHeaders=r,this.columnHeaders=n,this.colGroup=o,this.rows=i,this.cells=a}},{key:"renderedRowToSource",value:function(t){return this.rowFilter.renderedToSource(t)}},{key:"renderedColumnToSource",value:function(t){return this.columnFilter.renderedToSource(t)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var t=this.rowsToRender,r=this.rows,n=0;n<t;n++){var o=r.getRenderedNode(n);if(o.firstChild){var i=this.renderedRowToSource(n),a=this.rowUtils.getHeight(i);a?o.firstChild.style.height="".concat(a-1,"px"):o.firstChild.style.height=""}}}}]),e}();function qf(e){return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qf(e)}function Uft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gft(n.key),n)}}function Yft(e,t,r){return t&&BI(e.prototype,t),r&&BI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gft(e){var t=zft(e,"string");return qf(t)==="symbol"?t:String(t)}function zft(e,t){if(qf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qft=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;Uft(this,e),this.renderer=new Wft(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new Jct,columnHeaders:new aft(n),colGroup:new gft(o),rows:new Eft(i),cells:new Nft}),this.renderer.setAxisUtils(a,s)}return Yft(e,[{key:"setFilters",value:function(t,r){return this.renderer.setFilters(t,r),this}},{key:"setViewportSize",value:function(t,r){return this.renderer.setViewportSize(t,r),this}},{key:"setHeaderContentRenderers",value:function(t,r){return this.renderer.setHeaderContentRenderers(t,r),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function $f(e){return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(e)}function Kft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jft(n.key),n)}}function Xft(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jft(e){var t=Zft(e,"string");return $f(t)==="symbol"?t:String(t)}function Zft(e,t){if($f(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($f(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qft=function(){function e(t,r){Kft(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return Xft(e,[{key:"getWidth",value:function(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(t){var r=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(t);if(r){var o=r.getStretchedColumnWidth(t,n);o&&(n=o)}return n}},{key:"getHeaderHeight",value:function(t){var r=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return n!==void 0&&(r=r?Math.max(r,n):n),r}},{key:"getHeaderWidth",value:function(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}},{key:"calculateWidths",value:function(){var t=this.wtSettings,r=this.dataAccessObject,n=r.wtTable,o=r.wtViewport,i=r.cloneSource,a=i?i.wtTable.holder:n.holder,s=a.offsetHeight<a.scrollHeight?qe():0,l=t.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-s),l=t.getSetting("onModifyRowHeaderWidth",l),l!=null)for(var u=t.getSetting("rowHeaders").length,c=t.getSetting("defaultColumnWidth"),f=0;f<u;f++){var h=Array.isArray(l)?l[f]:l;h=h??c,this.headerWidths.set(f,h)}}}]),e}();function th(e){return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function $ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eht(n.key),n)}}function tht(e,t,r){return t&&VI(e.prototype,t),r&&VI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eht(e){var t=nht(e,"string");return th(t)==="symbol"?t:String(t)}function nht(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rht=function(){function e(t,r){$ft(this,e),this.dataAccessObject=t,this.wtSettings=r}return tht(e,[{key:"getHeight",value:function(t){var r=this.wtSettings.getSetting("rowHeight",t),n=this.dataAccessObject.wtViewport.oversizedRows[t];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}}]),e}();function eh(e){return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}function oht(e){return sht(e)||aht(e)||eU(e)||iht()}function iht(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aht(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sht(e){if(Array.isArray(e))return cC(e)}function lht(e,t){return fht(e)||cht(e,t)||eU(e,t)||uht()}function uht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eU(e,t){if(e){if(typeof e=="string")return cC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cC(e,t)}}function cC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function fht(e){if(Array.isArray(e))return e}function hht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nU(n.key),n)}}function dht(e,t,r){return t&&FI(e.prototype,t),r&&FI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ar(e,t,r){return t=nU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nU(e){var t=pht(e,"string");return eh(t)==="symbol"?t:String(t)}function pht(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yht=function(){function e(t,r,n,o,i){var a=this;hht(this,e),Ar(this,"wtSettings",null),Ar(this,"domBindings",void 0),Ar(this,"TBODY",null),Ar(this,"THEAD",null),Ar(this,"COLGROUP",null),Ar(this,"hasTableHeight",!0),Ar(this,"hasTableWidth",!0),Ar(this,"isTableVisible",!1),Ar(this,"tableOffset",0),Ar(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,vR(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(s)}),this.rowUtils=new rht(this.dataAccessObject,this.wtSettings),this.columnUtils=new qft(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Qft({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return dht(e,[{key:"is",value:function(t){return this.name===t}},{key:"fixTableDomTree",value:function(){var t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(t){var r=t.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Dt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,t),n.appendChild(t)),n.style.position="relative",n}},{key:"createHider",value:function(t){var r=t.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Dt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,t),n.appendChild(t)),n}},{key:"createHolder",value:function(t){var r=t.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Dt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",r&&r.insertBefore(n,t),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),n.appendChild(t)),n}},{key:"draw",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.wtSettings,n=this.dataAccessObject,o=n.wtOverlays,i=n.wtViewport,a=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),l=r.getSetting("rowHeaders"),u=l.length,c=r.getSetting("columnHeaders"),f=c.length,h=!1,p=t;if(this.isMaster&&(this.holderOffset=Le(this.holder),p=i.createRenderCalculators(p),u&&!r.getSetting("fixedColumnsStart"))){var y=o.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,m!==this.correctHeaderWidth&&(p=!1)}if(this.isMaster&&(h=o.updateStateOfRendering()),p)this.isMaster&&i.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Le(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var v=a>0?this.getFirstRenderedRow():0,w=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new lct(v,a,f),this.columnFilter=new nct(w,s,u);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var A={};this.wtSettings.getSetting("beforeDraw",!0,A),C=A.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(l,c),(this.is(jr)||this.is(ii))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var D;if(this.isMaster&&(D=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(jr))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var E=fe(this.hider),G=fe(this.TABLE);E!==0&&G!==E&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),D!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(jr)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var K=!1;return this.isMaster&&(K=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(K=o.bottomOverlay.resetFixedPosition()||K),K=o.inlineStartOverlay.resetFixedPosition()||K,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),K?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(p),h&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(t){for(var r=this.columnFilter.renderedToSource(t),n=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),i,a,s,l=this.wtSettings.getSetting("columnHeaderHeight")||[];n;)n-=1,i=this.getColumnHeaderHeight(n),a=this.getColumnHeader(r,n),a&&(s=no(a),(!i&&o<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wtSettings,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=t.getSetting("columnHeaders"),i=0,a=o.length;i<a;i++)if(n[i]){if(!r[i]||r[i].childNodes.length===0)return;r[i].childNodes[0].style.height="".concat(n[i],"px")}}},{key:"resetOversizedRows",value:function(){var t=this.wtSettings,r=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(jr))&&!t.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),o=0;o<n;o++){var i=this.rowFilter.renderedToSource(o);r.oversizedRows&&r.oversizedRows[i]&&(r.oversizedRows[i]=void 0)}}},{key:"removeClassFromCells",value:function(t){for(var r=this.TABLE.querySelectorAll(".".concat(t)),n=0,o=r.length;n<o;n++)Bt(r[n],t)}},{key:"refreshSelections",value:function(t){var r=this.wtSettings,n=this.dataAccessObject.selections;if(n){var o=Array.from(n),i=o.length;if(t){for(var a=[],s=0;s<i;s++){for(var l=o[s].settings,u=l.highlightHeaderClassName,c=l.highlightRowClassName,f=l.highlightColumnClassName,h=o[s].classNames,p=h.length,y=0;y<p;y++)a.includes(h[y])||a.push(h[y]);u&&!a.includes(u)&&a.push(u),c&&!a.includes(c)&&a.push(c),f&&!a.includes(f)&&a.push(f)}var m=r.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var v=0;v<m.length;v++)a.push(m[v]);for(var w=a.length,C=0;C<w;C++)this.removeClassFromCells(a[C])}for(var A=0;A<i;A++)o[A].draw(this.facadeGetter(),t)}}},{key:"getCell",value:function(t){var r=t.row,n=t.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",r,n);if(o&&Array.isArray(o)){var i=lht(o,2);r=i[0],n=i[1]}if(this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;var a=this.getRow(r);if(!a&&r>=0)throw new Error("TR was expected to be rendered but is not");var s=a.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(t){var r=null,n=null;if(t<0){var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(t),n=this.THEAD}else{var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceToRendered(t),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}},{key:"getColumnHeader",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getColumnHeaders",value:function(t){var r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach(function(o){var i=o.childNodes[n];i&&r.push(i)}),r}},{key:"getRowHeader",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var n=this.wtSettings.getSetting("rowHeaders").length;if(!(r>=n)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return o==null?void 0:o.childNodes[r]}}}},{key:"getRowHeaders",value:function(t){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var r=[],n=this.wtSettings.getSetting("rowHeaders").length,o=0;o<n;o++){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],a=i==null?void 0:i.childNodes[o];a&&r.push(a)}return r}},{key:"getCoords",value:function(t){var r=t;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=ri(r,["TD","TH"])),r===null)return null;var n=r.parentNode,o=n.parentNode,i=rW(n),a=r.cellIndex;if(Qo(Ea,r,this.wtRootElement)||Qo(ka,r,this.wtRootElement))o.nodeName==="THEAD"&&(i-=o.childNodes.length);else if(Qo(ii,r,this.wtRootElement)||Qo(jr,r,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");i=s-o.childNodes.length+i}else o===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):i=this.rowFilter.renderedToSource(i);return Qo(Ea,r,this.wtRootElement)||Qo(Ra,r,this.wtRootElement)||Qo(ii,r,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(i,a)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var t=this.TBODY.childNodes.length,r=t*this.wtSettings.getSetting("defaultRowHeight"),n=no(this.TBODY)-1,o,i,a,s,l;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;t;)t-=1,a=this.rowFilter.renderedToSource(t),o=this.getRowHeight(a),s=this.getTrForRow(a),l=s.querySelector("th"),l?i=no(l):i=no(s)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<i||o<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[a]=i)}}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"isColumnHeaderRendered",value:function(t){if(t>=0)return!1;var r=this.wtSettings.getSetting("rowHeaders"),n=r.length;return Math.abs(t)<=n}},{key:"isRowHeaderRendered",value:function(t){if(t>=0)return!1;var r=this.wtSettings.getSetting("columnHeaders"),n=r.length;return Math.abs(t)<=n}},{key:"isRowBeforeRenderedRows",value:function(t){var r=this.getFirstRenderedRow();return t<0&&r<=0?!this.isRowHeaderRendered(t):t<r}},{key:"isRowAfterRenderedRows",value:function(t){return t>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(t){var r=this.getFirstRenderedColumn();return t<0&&r<=0?!this.isColumnHeaderRendered(t):t<r}},{key:"isColumnAfterRenderedColumns",value:function(t){return this.columnFilter&&t>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&t>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&t>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(t){return this.rowUtils.getHeight(t)}},{key:"getColumnHeaderHeight",value:function(t){return this.columnUtils.getHeaderHeight(t)}},{key:"getColumnWidth",value:function(t){return this.columnUtils.getWidth(t)}},{key:"getStretchedColumnWidth",value:function(t){return this.columnUtils.getStretchedColumnWidth(t)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return fe(this.TABLE)}},{key:"getHeight",value:function(){return ke(this.TABLE)}},{key:"getTotalWidth",value:function(){var t=fe(this.hider);return t!==0?t:this.getWidth()}},{key:"getTotalHeight",value:function(){var t=ke(this.hider);return t!==0?t:this.getHeight()}},{key:"isVisible",value:function(){return $s(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(t){var r=ge(t)?t():null;return Array.isArray(r)?(r=oht(r),r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}},{key:"_correctRowHeaderWidth",value:function(t){var r=t;return typeof t!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}]),e}();const dc=yht;var ght="stickyRowsBottom",rU={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),r=e-t;return e===0||t===0?-1:r<0?0:r},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Br(rU,"MIXIN_NAME",ght,{writable:!1,enumerable:!1});const oU=rU;var mht="stickyColumnsStart",iU={getFirstRenderedColumn:function(){var e=this.wtSettings.getSetting("totalColumns");return e===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Br(iU,"MIXIN_NAME",mht,{writable:!1,enumerable:!1});const xR=iU;function cl(e){return cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cl(e)}function WI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bht(n.key),n)}}function vht(e,t,r){return t&&WI(e.prototype,t),r&&WI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bht(e){var t=wht(e,"string");return cl(t)==="symbol"?t:String(t)}function wht(e,t){if(cl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fC(e,t)}function fC(e,t){return fC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},fC(e,t)}function Cht(e){var t=Rht();return function(){var r=Zg(e),n;if(t){var o=Zg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oht(this,n)}}function Oht(e,t){if(t&&(cl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kht(e)}function kht(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zg(e){return Zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zg(e)}var jR=function(e){Sht(r,e);var t=Cht(r);function r(n,o,i,a){return Aht(this,r),t.call(this,n,o,i,a,ii)}return vht(r)}(dc);pe(jR,oU);pe(jR,xR);const Eht=jR;var ka="top",jr="bottom",Ra="inline_start",Ea="top_inline_start_corner",ii="bottom_inline_start_corner",Tht=[ka,jr,Ra,Ea,ii],Pht=new Map([[ka,"ht_clone_".concat(ka)],[jr,"ht_clone_".concat(jr)],[Ra,"ht_clone_".concat(Ra," ht_clone_left")],[Ea,"ht_clone_".concat(Ea," ht_clone_top_left_corner")],[ii,"ht_clone_".concat(ii," ht_clone_bottom_left_corner")]]);function nh(e){return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function Mht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aU(n.key),n)}}function Iht(e,t,r){return t&&UI(e.prototype,t),r&&UI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MA(e,t,r){return t=aU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aU(e){var t=xht(e,"string");return nh(t)==="symbol"?t:String(t)}function xht(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jht=function(){function e(t){Mht(this,e),MA(this,"dataAccessObject",void 0),MA(this,"lastScrolledColumnPos",-1),MA(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Iht(e,[{key:"scrollViewport",value:function(t,r,n,o,i){var a=this.scrollViewportHorizontally(t.col,n,i),s=this.scrollViewportVertically(t.row,r,o);return a||s}},{key:"scrollViewportHorizontally",value:function(t,r,n){var o=this.dataAccessObject,i=o.drawn,a=o.totalColumns;if(!i||!Number.isInteger(t)||t<0||t>a)return!1;var s=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),u=r===void 0&&n===void 0,c=this.dataAccessObject,f=c.fixedColumnsStart,h=c.inlineStartOverlay;if(u&&t<f)return!1;var p=!1;return s===-1?p=h.scrollTo(t,u?t>this.lastScrolledColumnPos:r):(u&&(t<s||t>l)||!u)&&(p=h.scrollTo(t,u?t>l:r)),p&&(this.lastScrolledColumnPos=t),p}},{key:"scrollViewportVertically",value:function(t,r,n){var o=this.dataAccessObject,i=o.drawn,a=o.totalRows;if(!i||!Number.isInteger(t)||t<0||t>a)return!1;var s=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),u=r===void 0&&n===void 0,c=this.dataAccessObject,f=c.fixedRowsBottom,h=c.fixedRowsTop,p=c.topOverlay;if(u&&(t<h||t>a-f-1))return!1;var y=!1;return s===-1?y=p.scrollTo(t,u?t>this.lastScrolledRowPos:n):(u&&(t<s||t>l)||!u)&&(y=p.scrollTo(t,u?t>l:n)),y&&(this.lastScrolledRowPos=t),y}},{key:"getFirstVisibleRow",value:function(){var t=this.dataAccessObject,r=t.topOverlay,n=t.wtTable,o=t.wtViewport,i=t.totalRows,a=t.fixedRowsTop,s=t.rootWindow,l=n.getFirstVisibleRow();if(r.mainTableScrollableElement===s){var u=Le(n.wtRootElement),c=no(n.hider),f=no(s),h=jf(s,s);if(u.top+c-f<=h){var p=o.getColumnHeaderHeight();p+=r.sumCellSizes(0,a);for(var y=i;y>0;y--)if(p+=r.sumCellSizes(y-1,y),u.top+c-p<=h){l=y;break}}}return l}},{key:"getLastVisibleRow",value:function(){var t=this.dataAccessObject,r=t.topOverlay,n=t.wtTable,o=t.wtViewport,i=t.totalRows,a=t.rootWindow,s=n.getLastVisibleRow();if(r.mainTableScrollableElement===a){var l=Le(n.wtRootElement),u=jf(a,a);if(l.top>u){for(var c=no(a),f=o.getColumnHeaderHeight(),h=1;h<=i;h++)if(f+=r.sumCellSizes(h-1,h),l.top+f-u>=c){s=h-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var t=this.dataAccessObject,r=t.inlineStartOverlay,n=t.wtTable,o=t.wtViewport,i=t.totalColumns,a=t.rootWindow,s=n.getFirstVisibleColumn();if(r.mainTableScrollableElement===a){var l=Le(n.wtRootElement),u=df(n.hider),c=df(a),f=Math.abs(Ng(a,a));if(l.left+u-c<=f){for(var h=o.getRowHeaderWidth(),p=i;p>0;p--)if(h+=r.sumCellSizes(p-1,p),l.left+u-h<=f){s=p;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var t=this.dataAccessObject,r=t.wtSettings,n=t.inlineStartOverlay,o=t.wtTable,i=t.wtViewport,a=t.totalColumns,s=t.rootWindow,l=o.getLastVisibleColumn();if(n.mainTableScrollableElement===s){var u=r.getSetting("rtlMode"),c=null;if(u){var f=o.TABLE.getBoundingClientRect(),h=this.dataAccessObject.rootWindow.document,p=h.documentElement.offsetWidth;c=Math.abs(f.right-p)}else{var y=Le(o.wtRootElement);c=y.left}var m=Math.abs(Ng(s,s));if(c>m){for(var v=df(s),w=i.getRowHeaderWidth(),C=1;C<=a;C++)if(w+=n.sumCellSizes(C-1,C),c+w-m>=v){l=C-2;break}}}return l}}]),e}();const Dht=jht;function rh(e){return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function _ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sU(n.key),n)}}function Hht(e,t,r){return t&&YI(e.prototype,t),r&&YI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nr(e,t,r){return t=sU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sU(e){var t=Nht(e,"string");return rh(t)==="symbol"?t:String(t)}function Nht(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DR=function(){function e(t,r){_ht(this,e),nr(this,"wtTable",void 0),nr(this,"wtScroll",void 0),nr(this,"wtViewport",void 0),nr(this,"wtOverlays",void 0),nr(this,"selections",void 0),nr(this,"wtEvent",void 0),nr(this,"guid","wt_".concat(yR())),nr(this,"drawInterrupted",!1),nr(this,"drawn",!1),nr(this,"domBindings",void 0),nr(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Dht(this.createScrollDao())}return Hht(e,[{key:"eventManager",get:function(){return new Re(this)}},{key:"findOriginalHeaders",value:function(){var t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,i){mi(i,t[o])}])}}},{key:"createCellCoords",value:function(t,r){return new Wg(t,r,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(t,r,n){return new MR(t,r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!t&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(t),this}},{key:"getCell",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r)return this.wtTable.getCell(t);var n=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<o&&t.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<a&&t.row>=n-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<n&&t.row>=n-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"scrollViewport",value:function(t,r,n,o,i){return t.col<0||t.row<0?!1:this.wtScroll.scrollViewport(t,r,n,o,i)}},{key:"scrollViewportHorizontally",value:function(t,r,n){return t<0?!1:this.wtScroll.scrollViewportHorizontally(t,r,n)}},{key:"scrollViewportVertically",value:function(t,r,n){return t<0?!1:this.wtScroll.scrollViewportVertically(t,r,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selections(){return t.selections},get drawn(){return t.drawn},set drawn(r){t.drawn=r},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function fl(e){return fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(e)}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lU(n.key),n)}}function Bht(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hC(e,t)}function hC(e,t){return hC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},hC(e,t)}function Fht(e){var t=Uht();return function(){var r=qg(e),n;if(t){var o=qg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wht(this,n)}}function Wht(e,t){if(t&&(fl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qy(e)}function Qy(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qg(e){return qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qg(e)}function zI(e,t,r){return t=lU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lU(e){var t=Yht(e,"string");return fl(t)==="symbol"?t:String(t)}function Yht(e,t){if(fl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ght=function(e){Vht(r,e);var t=Fht(r);function r(n,o,i){var a;Lht(this,r),a=t.call(this,n,o),zI(Qy(a),"cloneSource",void 0),zI(Qy(a),"cloneOverlay",void 0);var s=a.wtSettings.getSetting("facade",Qy(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),s,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new qW(s,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return Bht(r)}(DR);function oh(e){return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function zht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uU(n.key),n)}}function Qht(e,t,r){return t&&QI(e.prototype,t),r&&QI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kht(e,t,r){return t=uU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uU(e){var t=Xht(e,"string");return oh(t)==="symbol"?t:String(t)}function Xht(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hp=function(){function e(t,r,n,o,i){zht(this,e),Kht(this,"wtSettings",null),Br(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,s=a.TABLE,l=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=el(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Qht(e,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var r=t!==this.needFullRender;return r&&!this.needFullRender&&this.reset(),r}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=el(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var t=this.wot.wtTable,r=this.domBindings.rootWindow;r.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Df(t.TABLE)}},{key:"getRelativeCellPosition",value:function(t,r,n){if(this.clone.wtTable.holder.contains(t)===!1){de("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),a=r<this.wtSettings.getSetting("fixedRowsTop"),s=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(t),top:t.offsetTop},f=null;return o?f=this.getRelativeCellPositionWithinWindow(a,i,c,u):f=this.getRelativeCellPositionWithinHolder(a,s,i,c,u),f}},{key:"getRelativeStartPosition",value:function(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(t,r,n,o){var i=this.wot.wtTable.wtRootElement.getBoundingClientRect(),a=0,s=0;if(!r)a=o.start;else{var l=i.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(i.left+i.width+qe())),a=l<=0?-1*l:0}if(t){var u=this.clone.wtTable.TABLE.getBoundingClientRect();s=u.top-i.top}else s=o.top;return{start:n.start+a,top:n.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,r,n,o,i){var a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,l=0;if(n||(s=a.horizontal-i.start),r){var u=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();l=c.top*-1+u.top}else t||(l=a.vertical-i.top);return{start:o.start-s,top:o.top-l}}},{key:"makeClone",value:function(){if(Tht.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var t=this.wot.wtTable,r=this.domBindings,n=r.rootDocument,o=r.rootWindow,i=n.createElement("DIV"),a=n.createElement("TABLE"),s=t.wtRootElement.parentNode;i.className="".concat(Pht.get(this.type)," handsontable"),i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,a.className=t.TABLE.className,i.appendChild(a),s.appendChild(i);var l=this.wtSettings.getSetting("preventOverflow");return l===!0||l==="horizontal"&&this.type===ka||l==="vertical"&&this.type===Ra?this.mainTableScrollableElement=o:o.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=Df(t.TABLE),new Ght(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.shouldBeRendered();this.clone&&(this.needFullRender||r)&&this.clone.draw(t),this.needFullRender=r}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=t.style,o=r.style,i=t.parentNode.style;T([n,o,i],function(a){a.width="",a.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function hl(e){return hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(e)}function Ky(e,t,r){return cU()?Ky=Reflect.construct.bind():Ky=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&$g(l,i.prototype),l},Ky.apply(null,arguments)}function Jht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qht(n.key),n)}}function Zht(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qht(e){var t=$ht(e,"string");return hl(t)==="symbol"?t:String(t)}function $ht(e,t){if(hl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$g(e,t)}function $g(e,t){return $g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},$g(e,t)}function edt(e){var t=cU();return function(){var r=tm(e),n;if(t){var o=tm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ndt(this,n)}}function ndt(e,t){if(t&&(hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rdt(e)}function rdt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tm(e)}var odt=function(e){tdt(r,e);var t=edt(r);function r(n,o,i,a,s,l){var u;return Jht(this,r),u=t.call(this,n,o,ii,i,a),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return Zht(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Ky(Eht,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var n=this.wot;if(this.updateTrimmingContainer(),!n.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(i,"px"),o.style.bottom="".concat(a,"px")}else ip(o),this.repositionOverlay();var s=ke(this.clone.wtTable.TABLE),l=fe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),o.style.height="".concat(s,"px"),o.style.width="".concat(l,"px"),!1}},{key:"repositionOverlay",value:function(){var n=this.wot,o=n.wtTable,i=n.wtViewport,a=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,l=0;i.hasVerticalScroll()||(l+=i.getWorkspaceHeight()-o.getTotalHeight()),i.hasVerticalScroll()&&i.hasHorizontalScroll()&&(l+=qe(a)),s.style.bottom="".concat(l,"px")}}]),r}(hp),idt="calculatedColumns",fU={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return e===null?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return e===null?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return e===null?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return e===null?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Br(fU,"MIXIN_NAME",idt,{writable:!1,enumerable:!1});const _R=fU;function dl(e){return dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dl(e)}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sdt(n.key),n)}}function adt(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sdt(e){var t=ldt(e,"string");return dl(t)==="symbol"?t:String(t)}function ldt(e,t){if(dl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function udt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dC(e,t)}function dC(e,t){return dC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},dC(e,t)}function fdt(e){var t=pdt();return function(){var r=em(e),n;if(t){var o=em(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hdt(this,n)}}function hdt(e,t){if(t&&(dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ddt(e)}function ddt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function em(e){return em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},em(e)}var HR=function(e){cdt(r,e);var t=fdt(r);function r(n,o,i,a){return udt(this,r),t.call(this,n,o,i,a,jr)}return adt(r)}(dc);pe(HR,oU);pe(HR,_R);const ydt=HR;function pl(e){return pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pl(e)}function Xy(e,t,r){return dU()?Xy=Reflect.construct.bind():Xy=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&nm(l,i.prototype),l},Xy.apply(null,arguments)}function gdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pU(n.key),n)}}function mdt(e,t,r){return t&&JI(e.prototype,t),r&&JI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nm(e,t)}function nm(e,t){return nm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},nm(e,t)}function bdt(e){var t=dU();return function(){var r=rm(e),n;if(t){var o=rm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wdt(this,n)}}function wdt(e,t){if(t&&(pl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hU(e)}function hU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rm(e){return rm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rm(e)}function Adt(e,t,r){return t=pU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pU(e){var t=Sdt(e,"string");return pl(t)==="symbol"?t:String(t)}function Sdt(e,t){if(pl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cdt=function(e){vdt(r,e);var t=bdt(r);function r(n,o,i,a){var s;return gdt(this,r),s=t.call(this,n,o,jr,i,a),Adt(hU(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return mdt(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Xy(ydt,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var n=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var i=0,a=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===n&&(!a||a!=="vertical")?(i=this.getOverlayOffset(),o.style.bottom="".concat(i,"px")):(i=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var n=this.wot,o=n.wtTable,i=n.wtViewport,a=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,l=0;i.hasVerticalScroll()||(l+=i.getWorkspaceHeight()-o.getTotalHeight()),i.hasVerticalScroll()&&i.hasHorizontalScroll()&&(l+=qe(a)),s.style.bottom="".concat(l,"px")}},{key:"setScrollPosition",value:function(n){var o=this.domBindings.rootWindow,i=!1;return this.mainTableScrollableElement===o?(o.scrollTo(Oa(o),n),i=!0):this.mainTableScrollableElement.scrollTop!==n&&(this.mainTableScrollableElement.scrollTop=n,i=!0),i}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(n,o){for(var i=this.wot,a=i.wtTable,s=i.wtSettings,l=s.getSetting("defaultRowHeight"),u=n,c=0;u<o;){var f=a.getRowHeight(u);c+=f===void 0?l:f,u+=1}return c}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var n=this.wot,o=n.wtTable,i=n.wtViewport,a=this.domBindings,s=a.rootDocument,l=a.rootWindow,u=qe(s),c=this.clone.wtTable.holder.parentNode,f=c.style,h=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||h==="horizontal"){var p=i.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(p-=u),p=Math.min(p,o.wtRootElement.scrollWidth),f.width="".concat(p,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var y=ke(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),f.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var n=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,n.style.width=n.parentNode.style.width,n.style.height=n.parentNode.style.height}},{key:"applyToDOM",value:function(){var n=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var n=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[n]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[n]=""}},{key:"scrollTo",value:function(n,o){var i=this.getTableParentOffset(),a=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=a.wtTable.holder,l=0;o&&s.offsetHeight!==s.clientHeight&&(l=qe(this.domBindings.rootDocument)),o?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),n),i+=l,this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return jf(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var n=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===n&&(!o||o!=="vertical")){var a=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),l=a-s,u=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-u+a,0),i>l&&(i=0)}return i}},{key:"adjustHeaderBordersPosition",value:function(n){var o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==o,a=this.wtSettings.getSetting("columnHeaders"),s=!1;if((i||o===0)&&a.length>0){var l=this.wot.wtTable.holder.parentNode,u=Dt(l,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),n||this.wtSettings.getSetting("totalRows")===0?(q(l,"innerBorderBottom"),s=!u):(Bt(l,"innerBorderBottom"),s=u)}return s}}]),r}(hp),Odt="calculatedRows",yU={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return e===null?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return e===null?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return e===null?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return e===null?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Br(yU,"MIXIN_NAME",Odt,{writable:!1,enumerable:!1});const gU=yU;function yl(e){return yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yl(e)}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rdt(n.key),n)}}function kdt(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rdt(e){var t=Edt(e,"string");return yl(t)==="symbol"?t:String(t)}function Edt(e,t){if(yl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pC(e,t)}function pC(e,t){return pC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},pC(e,t)}function Mdt(e){var t=jdt();return function(){var r=om(e),n;if(t){var o=om(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Idt(this,n)}}function Idt(e,t){if(t&&(yl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xdt(e)}function xdt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function om(e){return om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},om(e)}var NR=function(e){Pdt(r,e);var t=Mdt(r);function r(n,o,i,a){return Tdt(this,r),t.call(this,n,o,i,a,Ra)}return kdt(r)}(dc);pe(NR,gU);pe(NR,xR);const Ddt=NR;function gl(e){return gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(e)}function Jy(e,t,r){return mU()?Jy=Reflect.construct.bind():Jy=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&im(l,i.prototype),l},Jy.apply(null,arguments)}function _dt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ndt(n.key),n)}}function Hdt(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ndt(e){var t=Bdt(e,"string");return gl(t)==="symbol"?t:String(t)}function Bdt(e,t){if(gl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ldt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&im(e,t)}function im(e,t){return im=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},im(e,t)}function Vdt(e){var t=mU();return function(){var r=am(e),n;if(t){var o=am(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fdt(this,n)}}function Fdt(e,t){if(t&&(gl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wdt(e)}function Wdt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function am(e){return am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},am(e)}var Udt=function(e){Ldt(r,e);var t=Vdt(r);function r(n,o,i,a){return _dt(this,r),t.call(this,n,o,Ra,i,a)}return Hdt(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Jy(Ddt,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var n=this.wot.wtTable;if(!this.needFullRender||!n.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode,a=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===o&&(!a||a!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Cv(i,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),ip(i));var l=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),l}},{key:"setScrollPosition",value:function(n){var o=this.domBindings.rootWindow,i=!1;return this.isRtl()&&(n=-n),this.mainTableScrollableElement===o&&o.scrollX!==n?(o.scrollTo(n,tl(o)),i=!0):this.mainTableScrollableElement.scrollLeft!==n&&(this.mainTableScrollableElement.scrollLeft=n,i=!0),i}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(n,o){for(var i=this.wtSettings.getSetting("defaultColumnWidth"),a=n,s=0;a<o;)s+=this.wot.wtTable.getStretchedColumnWidth(a)||i,a+=1;return s}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var n=this.wot.wtTable,o=this.domBindings,i=o.rootDocument,a=o.rootWindow,s=qe(i),l=this.clone.wtTable.holder.parentNode,u=l.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||c==="vertical"){var f=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(f-=s),f=Math.min(f,n.wtRootElement.scrollHeight),u.height="".concat(f,"px")}else u.height="";this.clone.wtTable.holder.style.height=u.height;var h=fe(this.clone.wtTable.TABLE);u.width="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var n,o=this.clone.wtTable.holder,i=this.wot.selections,a=this.facadeGetter(),s=Math.abs((n=i==null?void 0:i.getCell().getBorder(a).cornerCenterPointOffset)!==null&&n!==void 0?n:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var n=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(n,o){var i=this.getTableParentOffset(),a=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=a.wtTable.holder,l=0;if(o){var u=this.wot.wtTable.getColumnWidth(n),c=this.wot.wtViewport.getViewportWidth();u>c&&(o=!1)}return o&&s.offsetWidth!==s.clientWidth&&(l=qe(this.domBindings.rootDocument)),o?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),n),i+=l,this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){var n=this.wtSettings.getSetting("preventOverflow"),o=0;return!n&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(Ng(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var n=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===n&&(!o||o!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var a=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),l=a-s;i>l&&(i=0)}return i}},{key:"adjustHeaderBordersPosition",value:function(n){var o=this.wot.wtTable.holder.parentNode,i=this.wtSettings.getSetting("rowHeaders"),a=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Bt(o,"emptyRows"):q(o,"emptyRows");var l=!1;if(a&&!i.length)q(o,"innerBorderLeft innerBorderInlineStart");else if(!a&&i.length){var u=Dt(o,"innerBorderInlineStart");n?(q(o,"innerBorderLeft innerBorderInlineStart"),l=!u):(Bt(o,"innerBorderLeft innerBorderInlineStart"),l=u)}return l}}]),r}(hp),Ydt="stickyRowsTop",vU={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows");return e===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Br(vU,"MIXIN_NAME",Ydt,{writable:!1,enumerable:!1});const bU=vU;function ml(e){return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ml(e)}function $I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zdt(n.key),n)}}function Gdt(e,t,r){return t&&$I(e.prototype,t),r&&$I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zdt(e){var t=Qdt(e,"string");return ml(t)==="symbol"?t:String(t)}function Qdt(e,t){if(ml(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ml(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yC(e,t)}function yC(e,t){return yC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},yC(e,t)}function Jdt(e){var t=$dt();return function(){var r=sm(e),n;if(t){var o=sm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zdt(this,n)}}function Zdt(e,t){if(t&&(ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qdt(e)}function qdt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $dt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sm(e){return sm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sm(e)}var BR=function(e){Xdt(r,e);var t=Jdt(r);function r(n,o,i,a){return Kdt(this,r),t.call(this,n,o,i,a,Ea)}return Gdt(r)}(dc);pe(BR,bU);pe(BR,xR);const tpt=BR;function vl(e){return vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vl(e)}function Zy(e,t,r){return wU()?Zy=Reflect.construct.bind():Zy=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&lm(l,i.prototype),l},Zy.apply(null,arguments)}function ept(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AU(n.key),n)}}function npt(e,t,r){return t&&tx(e.prototype,t),r&&tx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lm(e,t)}function lm(e,t){return lm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},lm(e,t)}function opt(e){var t=wU();return function(){var r=um(e),n;if(t){var o=um(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ipt(this,n)}}function ipt(e,t){if(t&&(vl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gC(e)}function gC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function um(e){return um=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},um(e)}function ex(e,t,r){return t=AU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AU(e){var t=apt(e,"string");return vl(t)==="symbol"?t:String(t)}function apt(e,t){if(vl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var spt=function(e){rpt(r,e);var t=opt(r);function r(n,o,i,a,s,l){var u;return ept(this,r),u=t.call(this,n,o,Ea,i,a),ex(gC(u),"topOverlay",void 0),ex(gC(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return npt(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Zy(tpt,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var n=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();Cv(n,"".concat(o,"px"),"".concat(i,"px"))}else ip(n);var a=ke(this.clone.wtTable.TABLE),s=fe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(a=0),n.style.height="".concat(a,"px"),n.style.width="".concat(s,"px"),!1}}]),r}(hp);function bl(e){return bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bl(e)}function nx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,upt(n.key),n)}}function lpt(e,t,r){return t&&nx(e.prototype,t),r&&nx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function upt(e){var t=cpt(e,"string");return bl(t)==="symbol"?t:String(t)}function cpt(e,t){if(bl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mC(e,t)}function mC(e,t){return mC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},mC(e,t)}function dpt(e){var t=gpt();return function(){var r=cm(e),n;if(t){var o=cm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ppt(this,n)}}function ppt(e,t){if(t&&(bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ypt(e)}function ypt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cm(e){return cm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cm(e)}var LR=function(e){hpt(r,e);var t=dpt(r);function r(n,o,i,a){return fpt(this,r),t.call(this,n,o,i,a,ka)}return lpt(r)}(dc);pe(LR,bU);pe(LR,_R);const mpt=LR;function wl(e){return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}function qy(e,t,r){return CU()?qy=Reflect.construct.bind():qy=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&fm(l,i.prototype),l},qy.apply(null,arguments)}function vpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OU(n.key),n)}}function bpt(e,t,r){return t&&rx(e.prototype,t),r&&rx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fm(e,t)}function fm(e,t){return fm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},fm(e,t)}function Apt(e){var t=CU();return function(){var r=hm(e),n;if(t){var o=hm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Spt(this,n)}}function Spt(e,t){if(t&&(wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SU(e)}function SU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hm(e){return hm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hm(e)}function Cpt(e,t,r){return t=OU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OU(e){var t=Opt(e,"string");return wl(t)==="symbol"?t:String(t)}function Opt(e,t){if(wl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kpt=function(e){wpt(r,e);var t=Apt(r);function r(n,o,i,a){var s;return vpt(this,r),s=t.call(this,n,o,ka,i,a),Cpt(SU(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return bpt(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return qy(mpt,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var n=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0,s=!1;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable,u=l.hider.getBoundingClientRect(),c=Math.ceil(u.bottom),f=n.offsetHeight;s=c===f,a=this.getOverlayOffset(),Cv(n,"0px","".concat(a,"px"))}else a=this.getScrollPosition(),ip(n);var h=this.adjustHeaderBordersPosition(a,s);return this.adjustElementsSize(),h}},{key:"setScrollPosition",value:function(n){var o=this.domBindings.rootWindow,i=!1;return this.mainTableScrollableElement===o&&o.scrollY!==n?(o.scrollTo(Oa(o),n),i=!0):this.mainTableScrollableElement.scrollTop!==n&&(this.mainTableScrollableElement.scrollTop=n,i=!0),i}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(n,o){for(var i=this.wtSettings.getSetting("defaultRowHeight"),a=n,s=0;a<o;){var l=this.wot.wtTable.getRowHeight(a);s+=l===void 0?i:l,a+=1}return s}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var n=this.wot.wtTable,o=this.domBindings,i=o.rootDocument,a=o.rootWindow,s=qe(i),l=this.clone.wtTable.holder.parentNode,u=l.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||c==="horizontal"){var f=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(f-=s),f=Math.min(f,n.wtRootElement.scrollWidth),u.width="".concat(f,"px")}else u.width="";this.clone.wtTable.holder.style.width=u.width;var h=ke(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),u.height="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var n,o=this.clone.wtTable.holder,i=this.wot.selections,a=this.facadeGetter(),s=Math.abs((n=i==null?void 0:i.getCell().getBorder(a).cornerCenterPointOffset)!==null&&n!==void 0?n:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var n=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var n=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[n]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[n]=""}},{key:"scrollTo",value:function(n,o){var i=this.wot,a=this.wtSettings,s=i.cloneSource?i.cloneSource:i,l=s.wtTable.holder,u=this.getTableParentOffset(),c=0;if(o){var f=this.wot.wtTable.getRowHeight(n),h=this.wot.wtViewport.getViewportHeight();f>h&&(o=!1)}if(o&&l.offsetHeight!==l.clientHeight&&(c=qe(this.domBindings.rootDocument)),o){var p=a.getSetting("fixedRowsBottom"),y=a.getSetting("totalRows");u+=this.sumCellSizes(0,n+1),u-=i.wtViewport.getViewportHeight()-this.sumCellSizes(y-p,y),u+=1}else u+=this.sumCellSizes(a.getSetting("fixedRowsTop"),n);return u+=c,this.setScrollPosition(u)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return jf(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var n=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===n&&(!o||o!=="vertical")){var a=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),l=a-s;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>l&&(i=0)}return i}},{key:"adjustHeaderBordersPosition",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("totalColumns");a?Bt(i,"emptyColumns"):q(i,"emptyColumns");var s=!1;if(!o){var l=this.wtSettings.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=this.wtSettings.getSetting("columnHeaders");if((u||l===0)&&c.length>0){var f=Dt(i,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),n||this.wtSettings.getSetting("totalRows")===0?(q(i,"innerBorderTop"),s=!f):(Bt(i,"innerBorderTop"),s=f)}}return s}}]),r}(hp);function ih(e){return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function Jo(e,t,r){return Rpt()?Jo=Reflect.construct.bind():Jo=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&vC(l,i.prototype),l},Jo.apply(null,arguments)}function Rpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vC(e,t){return vC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},vC(e,t)}function Ept(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ox(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kU(n.key),n)}}function Tpt(e,t,r){return t&&ox(e.prototype,t),r&&ox(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yr(e,t,r){return t=kU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kU(e){var t=Ppt(e,"string");return ih(t)==="symbol"?t:String(t)}function Ppt(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mpt=function(){function e(t,r,n,o,i,a){var s=this;Ept(this,e),Yr(this,"wot",null),Yr(this,"topOverlay",null),Yr(this,"bottomOverlay",null),Yr(this,"inlineStartOverlay",null),Yr(this,"topInlineStartCornerOverlay",null),Yr(this,"bottomInlineStartCornerOverlay",null),Yr(this,"browserLineHeight",void 0),Yr(this,"wtSettings",null),Yr(this,"resizeObserver",new ResizeObserver(function(h){lv(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var l=this.domBindings,u=l.rootDocument,c=l.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=qe(u);var f=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=f?a.holder:Df(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return Tpt(e,[{key:"getOverlays",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&r.push(this.wtTable),r}},{key:"initBrowserLineHeight",value:function(){var t=this.domBindings,r=t.rootWindow,n=t.rootDocument,o=r.getComputedStyle(n.body),i=parseInt(o.lineHeight,10),a=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=i||a}},{key:"initOverlays",value:function(){var t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Jo(kpt,t),this.bottomOverlay=Jo(Cdt,t),this.inlineStartOverlay=Jo(Udt,t),this.topInlineStartCornerOverlay=Jo(spt,t.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Jo(odt,t.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var t=this,r=this.domBindings,n=r.rootDocument,o=r.rootWindow,i=this.topOverlay.mainTableScrollableElement,a=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",function(p){return t.onKeyDown(p)}),this.eventManager.addEventListener(n.documentElement,"keyup",function(){return t.onKeyUp()}),this.eventManager.addEventListener(n,"visibilitychange",function(){return t.onKeyUp()}),this.eventManager.addEventListener(i,"scroll",function(p){return t.onTableScroll(p)},{passive:!0}),i!==a&&this.eventManager.addEventListener(a,"scroll",function(p){return t.onTableScroll(p)},{passive:!0});var s=o.devicePixelRatio&&o.devicePixelRatio>1,l=this.scrollableElement===o,u=this.wtSettings.getSetting("preventWheel"),c={passive:l};(u||s||!zk())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(p){return t.onCloneWheel(p,u)},c);var f=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];f.forEach(function(p){if(p&&p.needFullRender){var y=p.clone.wtTable.holder;t.eventManager.addEventListener(y,"wheel",function(m){return t.onCloneWheel(m,u)},c)}});var h;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(h),h=setTimeout(function(){t.wtSettings.getSetting("onWindowResize")},200)}),l||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(t){var r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(o!==r&&i!==r&&!t.target.contains(o)||n!==r&&i!==r&&!t.target.contains(n))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t,r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=t.target,s=i!==n&&a!==n&&!a.contains(i),l=o!==n&&a!==n&&!a.contains(o);if(!(this.keyPressed&&(s||l))){var u=this.translateMouseWheelToScroll(t);(r||this.scrollableElement!==n&&u)&&t.preventDefault()}}},{key:"onKeyDown",value:function(t){this.keyPressed=rl(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var r=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;t.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);var o=this.scrollVertically(r),i=this.scrollHorizontally(n);return o||i}},{key:"scrollVertically",value:function(t){var r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,r!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(t){var r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,r!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.domBindings.rootWindow,r=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],i=o[0],a=o[1];if(this.horizontalScrolling=r.scrollLeft!==i||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==a||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){r.scrollLeft=i;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=a),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,r=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var t=this.wtTable,r=this.domBindings.rootWindow;r.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=t.holder:this.scrollableElement=Df(t.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.updateLastSpreaderSize();r&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}},{key:"updateLastSpreaderSize",value:function(){var t=this.wtTable.spreader,r=t.clientWidth,n=t.clientHeight,o=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.wot.wtViewport,n=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),a=r.getRowHeaderWidth(),s=r.getColumnHeaderHeight(),l=n.hider.style;if(l.width="".concat(a+this.inlineStartOverlay.sumCellSizes(0,o),"px"),l.height="".concat(s+this.topOverlay.sumCellSizes(0,i)+1,"px"),this.scrollbarSize>0){var u=n.wtRootElement,c=u.scrollHeight,f=u.scrollWidth,h=n.holder,p=h.scrollHeight,y=h.scrollWidth;this.hasScrollbarRight=c<p,this.hasScrollbarBottom=f<y,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>f?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(t){if(!t)return null;var r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return T(r,function(o){o&&o.clone&&o.clone.wtTable.TABLE.contains(t)&&(n=o.clone)}),n}},{key:"syncOverlayTableClassNames",value:function(){var t=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(r,function(n){n&&(n.clone.wtTable.TABLE.className=t.className)})}}]),e}();const Ipt=Mpt;function ah(e){return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function xpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RU(n.key),n)}}function jpt(e,t,r){return t&&ix(e.prototype,t),r&&ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ax(e,t,r){return t=RU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RU(e){var t=Dpt(e,"string");return ah(t)==="symbol"?t:String(t)}function Dpt(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _pt=function(){function e(t){var r=this;xpt(this,e),ax(this,"settings",{}),ax(this,"defaults",Object.freeze(this.getDefaults())),Qt(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return jpt(e,[{key:"getDefaults",value:function(){var t=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return t.getSetting("fixedColumnsStart")>0||t.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return t.getSetting("fixedRowsTop")>0||t.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return t.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(r,n,o){var i=t.getSetting("data",r,n);mi(o,i??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(r){return r},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(r){return r},onBeforeHighlightingColumnHeader:function(r){return r},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(t,r){var n=this;return r===void 0?Qt(t,function(o,i){n.settings[i]=o}):this.settings[t]=r,this}},{key:"getSetting",value:function(t,r,n,o,i){return typeof this.settings[t]=="function"?this.settings[t](r,n,o,i):r!==void 0&&Array.isArray(this.settings[t])?this.settings[t][r]:this.settings[t]}},{key:"getSettingPure",value:function(t){return this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}]),e}();function Al(e){return Al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Al(e)}function Hpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bpt(n.key),n)}}function Npt(e,t,r){return t&&sx(e.prototype,t),r&&sx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bpt(e){var t=Lpt(e,"string");return Al(t)==="symbol"?t:String(t)}function Lpt(e,t){if(Al(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Al(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bC(e,t)}function bC(e,t){return bC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},bC(e,t)}function Fpt(e){var t=Ypt();return function(){var r=dm(e),n;if(t){var o=dm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wpt(this,n)}}function Wpt(e,t){if(t&&(Al(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Upt(e)}function Upt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ypt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dm(e){return dm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dm(e)}var VR=function(e){Vpt(r,e);var t=Fpt(r);function r(n,o,i,a){return Hpt(this,r),t.call(this,n,o,i,a,"master")}return Npt(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var n=el(this.wtRootElement),o=this.domBindings.rootWindow;if(n===o){var i=this.wtSettings.getSetting("preventOverflow");i||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var a=n.parentElement,s=nl(n,"height",o),l=nl(n,"overflow",o),u=this.holder.style,c=n.scrollWidth,f=n.scrollHeight,h=n.getBoundingClientRect(),p=h.width,y=h.height,m=["auto","hidden","scroll"];if(a&&m.includes(l)){var v=n.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",n.nextElementSibling?a.insertBefore(v,n.nextElementSibling):a.appendChild(v);var w=parseInt(vi(v,o).height,10);a.removeChild(v),w===0&&(y=0)}y=Math.min(y,f),u.height=s==="auto"?"auto":"".concat(y,"px"),p=Math.min(p,c),u.width="".concat(p,"px"),u.overflow="",this.hasTableHeight=u.height==="auto"?!0:y>0,this.hasTableWidth=p>0}this.isTableVisible=$s(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var n=this.wtSettings,o=this.dataAccessObject.wtViewport,i="master",a=n.getSetting("columnHeaders"),s=a.length;if(s&&!o.hasOversizedColumnHeadersMarked[i]){for(var l=n.getSetting("rowHeaders"),u=l.length,c=this.getRenderedColumnsCount(),f=0;f<s;f++)for(var h=-1*u;h<c;h++)this.markIfOversizedColumnHeader(h);o.hasOversizedColumnHeadersMarked[i]=!0}}}]),r}(dc);pe(VR,gU);pe(VR,_R);const Gpt=VR;function sh(e){return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function zpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kpt(n.key),n)}}function Qpt(e,t,r){return t&&lx(e.prototype,t),r&&lx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kpt(e){var t=Xpt(e,"string");return sh(t)==="symbol"?t:String(t)}function Xpt(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jpt=function(){function e(t,r,n,o,i){var a=this;zpt(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return Qpt(e,[{key:"getWorkspaceHeight",value:function(){var t=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer,n=0;if(r===this.domBindings.rootWindow)n=t.documentElement.clientHeight;else{var o=ke(r);n=o>0&&r.clientHeight>0?r.clientHeight:1/0}return n}},{key:"getWorkspaceWidth",value:function(){var t=this.wtSettings,r=this.domBindings,n=r.rootDocument,o=r.rootWindow,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,a=n.documentElement.offsetWidth,s=t.getSetting("totalColumns"),l=t.getSetting("preventOverflow"),u=t.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),f=u?c.right-a:c.left,h=a-f,p,y;if(l)return fe(this.wtTable.wtRootElement);if(t.getSetting("freezeOverlays")?p=Math.min(h,a):p=Math.min(this.getContainerFillWidth(),h,a),i===o&&s>0&&this.sumColumnWidths(0,s-1)>p)return n.documentElement.clientWidth;if(i!==o&&(y=nl(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(p,i.clientWidth);var m=t.getSetting("stretchH");return m==="none"||!m?Math.max(p,fe(this.wtTable.TABLE)):p}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,r){for(var n=0,o=t;o<r;)n+=this.wtTable.getColumnWidth(o),o+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.wtTable.holder,r=this.domBindings.rootDocument.createElement("div");r.style.width="100%",r.style.height="1px",t.appendChild(r);var n=r.offsetWidth;return this.containerWidth=n,t.removeChild(r),n}},{key:"getWorkspaceOffset",value:function(){return Le(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ke(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var r=this.getColumnHeaderHeight();return r>0&&(t-=r),t}},{key:"getRowHeaderWidth",value:function(){var t=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var n=0,o=r.length;n<o;n++)this.rowHeaderWidth+=t[n]||t}if(isNaN(this.rowHeaderWidth))if(r.length){var i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,s=r.length;a<s;a++)i?(this.rowHeaderWidth+=fe(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var r=this.getRowHeaderWidth();return r>0?t-r:t}},{key:"createRowsCalculator",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gi,r=this.wtSettings,n=this.wtTable,o,i,a;this.rowHeaderWidth=NaN,r.getSetting("renderAllRows")&&t===Gi?o=1/0:o=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&s>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,l),s+=a,o-=a),u&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),o-=a),n.holder.clientHeight===n.holder.offsetHeight?i=0:i=qe(this.domBindings.rootDocument),new WW({viewportSize:o,scrollOffset:s,totalItems:r.getSetting("totalRows"),itemSizeFn:function(f){return n.getRowHeight(f)},overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),calculationType:t,scrollbarHeight:i})}},{key:"createColumnsCalculator",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gi,r=this.wtSettings,n=this.wtTable,o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var a=r.getSetting("fixedColumnsStart");if(a&&i>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);i+=s,o-=s}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=qe(this.domBindings.rootDocument)),new PR({viewportSize:o,scrollOffset:i,totalItems:r.getSetting("totalColumns"),itemSizeFn:function(l){return n.getColumnWidth(l)},overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:r.getSetting("stretchH"),stretchingItemWidthFn:function(l,u){return r.getSetting("onBeforeStretchingColumnWidth",l,u)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=t;if(r){var n=this.createRowsCalculator(nn),o=this.createColumnsCalculator(nn);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(r=!1)}return r||(this.rowsRenderCalculator=this.createRowsCalculator(Gi),this.columnsRenderCalculator=this.createColumnsCalculator(Gi)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,r}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(nn),this.columnsVisibleCalculator=this.createColumnsCalculator(nn)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){if(!this.rowsVisibleCalculator)return!1;var r=t.startRow,n=t.endRow,o=t.isVisibleInTrimmingContainer;if(r===null&&n===null)return!o;var i=this.rowsRenderCalculator,a=i.startRow,s=i.endRow;return r<a||r===a&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){if(!this.columnsVisibleCalculator)return!1;var r=t.startColumn,n=t.endColumn,o=t.isVisibleInTrimmingContainer;if(r===null&&n===null)return!o;var i=this.columnsRenderCalculator,a=i.startColumn,s=i.endColumn;return r<a||r===a&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Qt(this.hasOversizedColumnHeadersMarked,function(t,r,n){n[r]=void 0})}}]),e}();const Zpt=Jpt;function Sl(e){return Sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sl(e)}function qpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ux(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tyt(n.key),n)}}function $pt(e,t,r){return t&&ux(e.prototype,t),r&&ux(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tyt(e){var t=eyt(e,"string");return Sl(t)==="symbol"?t:String(t)}function eyt(e,t){if(Sl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wC(e,t)}function wC(e,t){return wC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},wC(e,t)}function ryt(e){var t=iyt();return function(){var r=pm(e),n;if(t){var o=pm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oyt(this,n)}}function oyt(e,t){if(t&&(Sl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AC(e)}function AC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pm(e){return pm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pm(e)}var ayt=function(e){nyt(r,e);var t=ryt(r);function r(n,o){var i;qpt(this,r),i=t.call(this,n,new _pt(o));var a=i.wtSettings.getSetting("facade",AC(i));return i.wtTable=new Gpt(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new Zpt(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new qW(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Ipt(AC(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return $pt(r,[{key:"exportSettingsAsClassNames",value:function(){var n=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},i=[],a=[];Qt(o,function(s,l){n.wtSettings.getSetting(l).length&&a.push(s),i.push(s)}),Bt(this.wtTable.wtRootElement.parentNode,i),q(this.wtTable.wtRootElement.parentNode,a)}},{key:"getViewportDao",value:function(){var n=this;return{get wot(){return n},get topOverlayTrimmingContainer(){return n.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return n.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return n.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return n.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return n.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return n.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return n.wtOverlays.topOverlay},get inlineStartOverlay(){return n.wtOverlays.inlineStartOverlay},get bottomOverlay(){return n.wtOverlays.bottomOverlay}}}}]),r}(DR);function lh(e){return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function syt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uyt(n.key),n)}}function lyt(e,t,r){return t&&cx(e.prototype,t),r&&cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uyt(e){var t=cyt(e,"string");return lh(t)==="symbol"?t:String(t)}function cyt(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fyt=function(){function e(t){syt(this,e),t instanceof DR?this._wot=t:this._initFromSettings(t)}return lyt(e,[{key:"_initFromSettings",value:function(t){t.facade=function(r){var n=new e(r);return function(){return n}},this._wot=new ayt(t.table,t)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(t){this._wot.drawn=t}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(t){this._wot.drawInterrupted=t}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(t){this._wot.lastMouseOver=t}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(t){this._wot.momentumScrolling=t}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(t){this._wot.touchApplied=t}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(t){this._wot.eventListeners=t}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(t,r){return this._wot.createCellCoords(t,r)}},{key:"createCellRange",value:function(t,r,n){return this._wot.createCellRange(t,r,n)}},{key:"draw",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(t),this}},{key:"getCell",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(t,r)}},{key:"scrollViewport",value:function(t,r,n,o,i){return this._wot.scrollViewport(t,r,n,o,i)}},{key:"scrollViewportHorizontally",value:function(t,r,n){return this._wot.scrollViewportHorizontally(t,r,n)}},{key:"scrollViewportVertically",value:function(t,r,n){return this._wot.scrollViewportVertically(t,r,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(t,r){return this._wot.wtSettings.update(t,r),this}},{key:"getSetting",value:function(t,r,n,o,i){return this._wot.wtSettings.getSetting(t,r,n,o,i)}},{key:"hasSetting",value:function(t){return this._wot.wtSettings.hasSetting(t)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),hyt=Fe,EU=Kt,dyt=Wd,pyt=Fn,yyt=xd.f,gyt=EU(yyt),myt=EU([].push),fx=function(e){return function(t){for(var r=pyt(t),n=dyt(r),o=n.length,i=0,a=[],s;o>i;)s=n[i++],(!hyt||gyt(r,s))&&myt(a,e?[s,r[s]]:r[s]);return a}},vyt={entries:fx(!0),values:fx(!1)},byt=jt,wyt=vyt.values;byt({target:"Object",stat:!0},{values:function(e){return wyt(e)}});function uh(e){return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function IA(e,t){return Oyt(e)||Cyt(e,t)||Syt(e,t)||Ayt()}function Ayt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Syt(e,t){if(e){if(typeof e=="string")return hx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hx(e,t)}}function hx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Oyt(e){if(Array.isArray(e))return e}function kyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eyt(n.key),n)}}function Ryt(e,t,r){return t&&dx(e.prototype,t),r&&dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eyt(e){var t=Tyt(e,"string");return uh(t)==="symbol"?t:String(t)}function Tyt(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pyt=function(){function e(t,r){kyt(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Ryt(e,[{key:"registerListeners",value:function(){var t=this,r=this.wot.rootDocument.body;this.eventManager.addEventListener(r,"mousedown",function(){return t.onMouseDown()}),this.eventManager.addEventListener(r,"mouseup",function(){return t.onMouseUp()});for(var n=function(a){var s=t.main.childNodes[a];t.eventManager.addEventListener(s,"mouseenter",function(l){return t.onMouseEnter(l,t.main.childNodes[a])})},o=0,i=this.main.childNodes.length;o<i;o++)n(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),gr(t);var n=this,o=this.wot.rootDocument.body,i=r.getBoundingClientRect();r.style.display="none";function a(l){if(l.clientY<Math.floor(i.top)||l.clientY>Math.ceil(i.top+i.height)||l.clientX<Math.floor(i.left)||l.clientX>Math.ceil(i.left+i.width))return!0}function s(l){a(l)&&(n.eventManager.removeEventListener(o,"mousemove",s),r.style.display="block")}this.eventManager.addEventListener(o,"mousemove",s)}},{key:"createBorders",value:function(t){var r=this.wot.rootDocument;this.main=r.createElement("div");var n=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var i=0;i<5;i++){var a=n[i],s=r.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[a]&&this.settings[a].hide&&(s.className+=" hidden"),o=s.style,o.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:t.border.color,o.height=this.settings[a]&&this.settings[a].width?"".concat(this.settings[a].width,"px"):"".concat(t.border.width,"px"),o.width=this.settings[a]&&this.settings[a].width?"".concat(this.settings[a].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),cr()&&this.createMultipleSelectorHandles(),this.disappear();var l=this.wot.wtTable,u=l.bordersHolder;u||(u=r.createElement("div"),u.className="htBorders",l.bordersHolder=u,l.spreader.appendChild(u)),u.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this,r=this.wot.rootDocument;this.selectionHandles={top:r.createElement("DIV"),topHitArea:r.createElement("DIV"),bottom:r.createElement("DIV"),bottomHitArea:r.createElement("DIV")};var n=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var i={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};Qt(i,function(s,l){t.selectionHandles.styles.bottomHitArea[l]=s,t.selectionHandles.styles.topHitArea[l]=s});var a={position:"absolute",height:"".concat(n,"px"),width:"".concat(n,"px"),"border-radius":"".concat(parseInt(n/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Qt(a,function(s,l){t.selectionHandles.styles.bottom[l]=s,t.selectionHandles.styles.top[l]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(t,r){var n=this.wot.selections.createOrGetArea();return!!(n.cellRange&&(t!==n.cellRange.to.row||r!==n.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,r,n,o,i,a){var s=this.wot.wtSettings.getSetting("rtlMode"),l=s?"right":"left",u=this.selectionHandles.styles,c=u.top,f=u.topHitArea,h=u.bottom,p=u.bottomHitArea,y=parseInt(c.borderWidth,10),m=parseInt(c.width,10),v=parseInt(f.width,10),w=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(n-m-1,10),"px"),c[l]="".concat(parseInt(o-m-1,10),"px"),f.top="".concat(parseInt(n-v/4*3,10),"px"),f[l]="".concat(parseInt(o-v/4*3,10),"px");var A=Math.min(parseInt(o+i,10),w-m-y*2),D=Math.min(parseInt(o+i-v/4,10),w-v-y*2);h[l]="".concat(A,"px"),p[l]="".concat(D,"px");var E=Math.min(parseInt(n+a,10),C-m-y*2),G=Math.min(parseInt(n+a-v/4,10),C-v-y*2);h.top="".concat(E,"px"),p.top="".concat(G,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",f.display="block",this.isPartRange(t,r)?(h.display="none",p.display="none"):(h.display="block",p.display="block")):(c.display="none",h.display="none",f.display="none",p.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",f.zIndex="9999"):(c.zIndex="",f.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var r=this.wot,n=r.wtTable,o=r.rootDocument,i=r.rootWindow,a,s,l,u,c,f,h=n.getRenderedRowsCount(),p=0;p<h;p+=1){var y=n.rowFilter.renderedToSource(p);if(y>=t[0]&&y<=t[2]){a=y,c=t[0];break}}for(var m=h-1;m>=0;m-=1){var v=n.rowFilter.renderedToSource(m);if(v>=t[0]&&v<=t[2]){s=v;break}}for(var w=n.getRenderedColumnsCount(),C=0;C<w;C+=1){var A=n.columnFilter.renderedToSource(C);if(A>=t[1]&&A<=t[3]){l=A,f=t[1];break}}for(var D=w-1;D>=0;D-=1){var E=n.columnFilter.renderedToSource(D);if(E>=t[1]&&E<=t[3]){u=E;break}}if(a===void 0||l===void 0){this.disappear();return}var G=n.getCell(this.wot.createCellCoords(a,l)),K=a!==s||l!==u,nt=K?n.getCell(this.wot.createCellCoords(s,u)):G,z=Le(G),X=K?Le(nt):z,Z=Le(n.TABLE),tt=fe(n.TABLE),et=z.top,bt=z.left,yt=this.wot.wtSettings.getSetting("rtlMode"),kt=0,Et=0;if(yt){var P=fe(G),d=i.innerWidth-Z.left-tt;Et=bt+P-X.left,kt=i.innerWidth-bt-P-d-1}else Et=X.left+fe(nt)-bt,kt=bt-Z.left-1;if(this.isEntireColumnSelected(a,s)){var g=this.getDimensionsFromHeader("columns",l,u,c,Z),b=null;if(g){var O=IA(g,3);b=O[0],kt=O[1],Et=O[2]}b&&(G=b)}var R=et-Z.top-1,I=X.top+ke(nt)-et;if(this.isEntireRowSelected(l,u)){var W=this.getDimensionsFromHeader("rows",a,s,f,Z),N=null;if(W){var Q=IA(W,3);N=Q[0],R=Q[1],I=Q[2]}N&&(G=N)}var J=vi(G,i);parseInt(J.borderTopWidth,10)>0&&(R+=1,I=I>0?I-1:0),parseInt(J[yt?"borderRightWidth":"borderLeftWidth"],10)>0&&(kt+=1,Et=Et>0?Et-1:0);var rt=yt?"right":"left";this.topStyle.top="".concat(R,"px"),this.topStyle[rt]="".concat(kt,"px"),this.topStyle.width="".concat(Et,"px"),this.topStyle.display="block",this.startStyle.top="".concat(R,"px"),this.startStyle[rt]="".concat(kt,"px"),this.startStyle.height="".concat(I,"px"),this.startStyle.display="block";var mt=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(R+I-mt,"px"),this.bottomStyle[rt]="".concat(kt,"px"),this.bottomStyle.width="".concat(Et,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(R,"px"),this.endStyle[rt]="".concat(kt+Et-mt,"px"),this.endStyle.height="".concat(I+1,"px"),this.endStyle.display="block";var ut=this.settings.border.cornerVisible;ut=typeof ut=="function"?ut(this.settings.layerLevel):ut;var Ot=this.wot.getSetting("onModifyGetCellCoords",s,u),St=s,Y=u;if(Ot&&Array.isArray(Ot)){var Ft=IA(Ot,4);St=Ft[2],Y=Ft[3]}if(cr()||!ut||this.isPartRange(St,Y))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(R+I+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[rt]="".concat(kt+Et+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Lt=el(n.TABLE),Tt=Lt===i;Tt&&(Lt=o.documentElement);var Vt=parseInt(this.cornerDefaultStyle.width,10)/2,It=parseInt(this.cornerDefaultStyle.height,10)/2;if(u===this.wot.getSetting("totalColumns")-1){var S=Tt?nt.getBoundingClientRect().left:nt.offsetLeft,k=!1,M=0;yt?(M=S-parseInt(this.cornerDefaultStyle.width,10)/2,k=M<0):(M=S+fe(nt)+parseInt(this.cornerDefaultStyle.width,10)/2,k=M>=df(Lt)),k&&(this.cornerStyle[rt]="".concat(Math.floor(kt+Et+this.cornerCenterPointOffset-Vt),"px"),this.cornerStyle[yt?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var L=Tt?nt.getBoundingClientRect().top:nt.offsetTop,j=L+ke(nt)+parseInt(this.cornerDefaultStyle.height,10)/2,V=j>=no(Lt);V&&(this.cornerStyle.top="".concat(Math.floor(R+I+this.cornerCenterPointOffset-It),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}cr()&&this.updateMultipleSelectionHandlesPosition(s,u,R,kt,Et,I)}}},{key:"isEntireColumnSelected",value:function(t,r){return t===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,r){return t===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,r,n,o,i){var a=this.wot.wtTable,s=a.wtRootElement.parentNode,l=null,u=null,c=null,f=null,h=null,p=null,y=null,m=null;switch(t){case"rows":l=function(){return a.getRowHeader.apply(a,arguments)},u=function(){return ke.apply(void 0,arguments)},c="ht__selection--rows",p="top";break;case"columns":l=function(){return a.getColumnHeader.apply(a,arguments)},u=function(){return fe.apply(void 0,arguments)},c="ht__selection--columns",p="left";break}if(s.classList.contains(c)){var v=this.wot.getSetting("columnHeaders").length;if(y=l(r,v-o),m=l(n,v-o),!y||!m)return!1;var w=Le(y),C=Le(m);return y&&m&&(f=w[p]-i[p]-1,h=C[p]+u(m)-w[p]),[y,f,h]}return!1}},{key:"changeBorderStyle",value:function(t,r){var n=this[t].style,o=r[t];!o||o.hide?q(this[t],"hidden"):(Dt(this[t],"hidden")&&Bt(this[t],"hidden"),n.backgroundColor=o.color,(t==="top"||t==="bottom")&&(n.height="".concat(o.width,"px")),(t==="start"||t==="end")&&(n.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var r={width:1,color:"#000"},n=this[t].style;n.backgroundColor=r.color,n.width="".concat(r.width,"px"),n.height="".concat(r.width,"px")}},{key:"toggleHiddenClass",value:function(t,r){this.changeBorderToDefaultStyle(t),r?q(this[t],"hidden"):Bt(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",cr()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Myt=Pyt;function Iyt(e,t){return _yt(e)||Dyt(e,t)||jyt(e,t)||xyt()}function xyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jyt(e,t){if(e){if(typeof e=="string")return px(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return px(e,t)}}function px(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _yt(e){if(Array.isArray(e))return e}function Cl(e){return Cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cl(e)}function Hyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Byt(n.key),n)}}function Nyt(e,t,r){return t&&yx(e.prototype,t),r&&yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Byt(e){var t=Lyt(e,"string");return Cl(t)==="symbol"?t:String(t)}function Lyt(e,t){if(Cl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vyt=function(){function e(t,r){Hyt(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Nyt(e,[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new Myt(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=r,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,r.row,r.col]}},{key:"addClassAtCoords",value:function(t,r,n,o){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a=t.wtTable.getCell(this.settings.createCellCoords(r,n));if(Cl(a)==="object"){var s=o;i&&(s=this.classNameGenerator(a),this.classNames.includes(s)||this.classNames.push(s)),q(a,s)}return this}},{key:"linearClassNameGenerator",value:function(t,r){return function n(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(r===0||i===0)return t;var a=i>=0?i:r,s=t;a-=1;var l=a===0?t:"".concat(t,"-").concat(a);if(Dt(o,l)){var u=a+1;s="".concat(t,"-").concat(u)}else s=n(o,a);return s}}},{key:"draw",value:function(t){if(this.isEmpty()){this.settings.border&&this.getBorder(t).disappear();return}var r=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),o=this.getCorners(),i=Iyt(o,4),a=i[0],s=i[1],l=i[2],u=i[3],c=this.settings,f=c.highlightHeaderClassName,h=c.highlightColumnClassName,p=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,m=c.selectionType,v=m===void 0||["active-header","header"].includes(m);if(v&&s!==null&&u!==null)for(var w=0,C=0;C<n;C+=1){var A=t.wtTable.columnFilter.renderedToSource(C);if(A>=s&&A<=u){var D=t.wtTable.getColumnHeaders(A),E=D.length-1;y&&D.length>1&&(D=[D[E]]);for(var G=0;G<D.length;G+=1){var K=[],nt=D[G];f&&K.push(f),h&&K.push(h),G=y?E:G;var z=t.getSetting("onBeforeHighlightingColumnHeader",A,G,{selectionType:m,columnCursor:w,selectionWidth:u-s+1,classNames:K});z!==A&&(nt=t.wtTable.getColumnHeader(z,G)),q(nt,K)}w+=1}}if(a!==null&&l!==null)for(var X=0,Z=0;Z<r;Z+=1){var tt=t.wtTable.rowFilter.renderedToSource(Z);if(v&&tt>=a&&tt<=l){var et=t.wtTable.getRowHeaders(tt),bt=et.length-1;y&&et.length>1&&(et=[et[bt]]);for(var yt=0;yt<et.length;yt+=1){var kt=[],Et=et[yt];f&&kt.push(f),p&&kt.push(p),yt=y?bt:yt;var P=t.getSetting("onBeforeHighlightingRowHeader",tt,yt,{selectionType:m,rowCursor:X,selectionHeight:l-a+1,classNames:kt});P!==tt&&(Et=t.wtTable.getRowHeader(P,yt)),q(Et,kt)}X+=1}if(s!==null&&u!==null)for(var d=0;d<n;d+=1){var g=t.wtTable.columnFilter.renderedToSource(d);tt>=a&&tt<=l&&g>=s&&g<=u?this.settings.className&&this.addClassAtCoords(t,tt,g,this.settings.className,this.settings.markIntersections):tt>=a&&tt<=l?p&&this.addClassAtCoords(t,tt,g,p):g>=s&&g<=u&&h&&this.addClassAtCoords(t,tt,g,h);var b=t.getSetting("onAfterDrawSelection",tt,g,this.settings.layerLevel);typeof b=="string"&&this.addClassAtCoords(t,tt,g,b)}}t.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(t).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(t){return t.destroy()})}}]),e}();const Fyt=Vyt;function gx(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,s=e.cellCoordsFactory,l=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(t&&l)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(s(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(s(l.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(s(o.row,l.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(l.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(l.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=r||n&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function Wyt(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,l-1)):o.cell||n.setRangeEnd(r)}}var Uyt=new Map([["mousedown",gx],["mouseover",Wyt],["touchstart",gx]]);function mx(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;Uyt.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:kv(e)||e.type==="touchstart",isRightClick:bi(e)})}var TU=new WeakMap,FR=Symbol("rootInstance");function Yyt(e){TU.set(e,!0)}function Gyt(e){return e===FR}function SC(e){return TU.has(e)}function ch(e){return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function jc(e,t){return Kyt(e)||Qyt(e,t)||PU(e,t)||zyt()}function zyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Kyt(e){if(Array.isArray(e))return e}function vx(e){return Zyt(e)||Jyt(e)||PU(e)||Xyt()}function Xyt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PU(e,t){if(e){if(typeof e=="string")return CC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CC(e,t)}}function Jyt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zyt(e){if(Array.isArray(e))return CC(e)}function CC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MU(n.key),n)}}function $yt(e,t,r){return t&&bx(e.prototype,t),r&&bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wx(e,t,r){tgt(e,t),t.set(e,r)}function tgt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vo(e,t,r){return t=MU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MU(e){var t=egt(e,"string");return ch(t)==="symbol"?t:String(t)}function egt(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ax(e,t){var r=IU(e,t,"get");return ngt(e,r)}function ngt(e,t){return t.get?t.get.call(e):t.value}function Sx(e,t,r){var n=IU(e,t,"set");return rgt(e,n,r),r}function IU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function rgt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var xi=new WeakMap,xA=new WeakMap,jA=new WeakMap,ogt=function(){function e(t){qyt(this,e),Vo(this,"instance",void 0),Vo(this,"eventManager",void 0),Vo(this,"settings",void 0),Vo(this,"THEAD",void 0),Vo(this,"TBODY",void 0),Vo(this,"_wt",void 0),Vo(this,"activeWt",void 0),wx(this,xA,{writable:!0,value:0}),wx(this,jA,{writable:!0,value:0}),Vo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Re(this.instance),this.settings=this.instance.getSettings(),xi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return $yt(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}},{key:"getCellAtCoords",value:function(t,r){var n=this._wt.getCell(t,r);return n<0?null:n}},{key:"scrollViewport",value:function(t,r,n,o,i){return this._wt.scrollViewport(t,r,n,o,i)}},{key:"scrollViewportHorizontally",value:function(t,r,n){return this._wt.scrollViewportHorizontally(t,r,n)}},{key:"scrollViewportVertically",value:function(t,r,n){return this._wt.scrollViewportVertically(t,r,n)}},{key:"createElements",value:function(){var t=xi.get(this),r=this.instance,n=r.rootElement,o=r.rootDocument,i=n.getAttribute("style");i&&n.setAttribute("data-originalstyle",i),q(n,"handsontable"),t.table=o.createElement("TABLE"),q(t.table,"htCore"),this.instance.getSettings().tableClassName&&q(t.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var t=this,r=xi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=n.selection,s=i.documentElement;this.eventManager.addEventListener(o,"mousedown",function(l){if(r.selectionMouseDown=!0,!t.isTextSelectionAllowed(l.target)){var u=t.instance.rootWindow;VS(u),l.preventDefault(),u.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){r.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(l){r.selectionMouseDown&&!t.isTextSelectionAllowed(l.target)&&(t.settings.fragmentSelection&&VS(t.instance.rootWindow),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(l){a.isInProgress()&&!l.shiftKey&&a.finish()}),this.eventManager.addEventListener(s,"mouseup",function(l){a.isInProgress()&&kv(l)&&a.finish(),r.mouseDown=!1,(Ov(i.activeElement)||!a.isSelected()&&!a.isSelectedByAnyHeader()&&!o.contains(l.target)&&!bi(l))&&t.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(l){a.isInProgress()&&bi(l)&&(a.finish(),r.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){a.isInProgress()&&a.finish(),r.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(l){var u=l.target,c=l.x||l.clientX,f=l.y||l.clientY,h=l.target;if(!(r.mouseDown||!o||!t.instance.view)){var p=t.instance.view._wt.wtTable.holder;if(h===p){var y=qe(i);if(i.elementFromPoint(c+y,f)!==p||i.elementFromPoint(c,f+y)!==p)return}else for(;h!==s;){if(h===null){if(l.isTargetWebComponent)break;return}if(h===o)return;h=h.parentNode}var m=typeof t.settings.outsideClickDeselects=="function"?t.settings.outsideClickDeselects(u):t.settings.outsideClickDeselects;m?t.instance.deselectCell():t.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(r.table,"selectstart",function(l){t.settings.fragmentSelection||_f(l.target)||l.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(t){var r,n=t.row,o=t.col;return(r=this.instance)._createCellCoords.apply(r,vx(this.translateFromRenderableToVisualIndex(n,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(t,r){var n=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t,o=r>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=t),o===null&&(o=r),[n,o]}},{key:"countRenderableIndexes",value:function(t,r){var n=Math.min(t.getNotTrimmedIndexesLength(),r),o=t.getNearestNotHiddenIndex(n-1,-1);return o===null?0:t.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(t,r){return this.countNotHiddenIndexes(t,r,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(t,r){return this.countNotHiddenIndexes(t,r,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(t,r,n,o){if(isNaN(t)||t<0)return 0;var i=n.getNearestNotHiddenIndex(t,r),a=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(a))return 0;var s=0;return r<0?s=a+1:r>0&&(s=o-a),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var t=this.instance.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(r,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var t=this.instance.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(r,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var t=this.instance.countRows(),r=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>t&&this.instance.countRenderedCols()>r}},{key:"initializeWalkontable",value:function(){var t=this,r=xi.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:r.table,isDataViewInstance:function(){return SC(t.instance)},preventOverflow:function(){return t.settings.preventOverflow},preventWheel:function(){return t.settings.preventWheel},stretchH:function(){return t.settings.stretchH},data:function(l,u){var c;return(c=t.instance).getDataAtCell.apply(c,vx(t.translateFromRenderableToVisualIndex(l,u)))},totalRows:function(){return t.countRenderableRows()},totalColumns:function(){return t.countRenderableColumns()},fixedColumnsStart:function(){return t.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return t.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return t.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return t.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return t.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return t.settings.fixedRowsBottom>0},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var l=[];return t.instance.hasRowHeaders()&&l.push(function(u,c){var f=u>=0?t.instance.rowIndexMapper.getVisualFromRenderableIndex(u):u;t.appendRowHeader(f,c)}),t.instance.runHooks("afterGetRowHeaderRenderers",l),Sx(t,jA,l.length),l},columnHeaders:function(){var l=[];return t.instance.hasColHeaders()&&l.push(function(u,c){var f=u>=0?t.instance.columnIndexMapper.getVisualFromRenderableIndex(u):u;t.appendColHeader(f,c)}),t.instance.runHooks("afterGetColumnHeaderRenderers",l),Sx(t,xA,l.length),l},columnWidth:function(l){var u=t.instance.columnIndexMapper.getVisualFromRenderableIndex(l);return t.instance.getColWidth(u===null?l:u)},rowHeight:function(l){var u=t.instance.rowIndexMapper.getVisualFromRenderableIndex(l);return t.instance.getRowHeight(u===null?l:u)},cellRenderer:function(l,u,c){var f=t.translateFromRenderableToVisualIndex(l,u),h=jc(f,2),p=h[0],y=h[1],m=t.instance.runHooks("modifyGetCellCoords",p,y),v=p,w=y;if(Array.isArray(m)){var C=jc(m,2);v=C[0],w=C[1]}var A=t.instance.getCellMeta(v,w),D=t.instance.colToProp(w),E=t.instance.getDataAtRowProp(v,D);t.instance.hasHook("beforeValueRender")&&(E=t.instance.runHooks("beforeValueRender",E,A)),t.instance.runHooks("beforeRenderer",c,p,y,D,E,A),t.instance.getCellRenderer(A)(t.instance,c,p,y,D,E,A),t.instance.runHooks("afterRenderer",c,p,y,D,E,A)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onWindowResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onContainerElementResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onCellMouseDown:function(l,u,c,f){var h=t.translateFromRenderableToVisualCoords(u),p={row:!1,column:!1,cell:!1};t.instance.listen(),t.activeWt=f,r.mouseDown=!0,t.instance.runHooks("beforeOnCellMouseDown",l,h,c,p),!Yi(l)&&(mx(l,{coords:h,selection:t.instance.selection,controller:p,cellCoordsFactory:function(y,m){return t.instance._createCellCoords(y,m)}}),t.instance.runHooks("afterOnCellMouseDown",l,h,c),t.activeWt=t._wt)},onCellContextMenu:function(l,u,c,f){var h=t.translateFromRenderableToVisualCoords(u);t.activeWt=f,r.mouseDown=!1,t.instance.selection.isInProgress()&&t.instance.selection.finish(),t.instance.runHooks("beforeOnCellContextMenu",l,h,c),!Yi(l)&&(t.instance.runHooks("afterOnCellContextMenu",l,h,c),t.activeWt=t._wt)},onCellMouseOut:function(l,u,c,f){var h=t.translateFromRenderableToVisualCoords(u);t.activeWt=f,t.instance.runHooks("beforeOnCellMouseOut",l,h,c),!Yi(l)&&(t.instance.runHooks("afterOnCellMouseOut",l,h,c),t.activeWt=t._wt)},onCellMouseOver:function(l,u,c,f){var h=t.translateFromRenderableToVisualCoords(u),p={row:!1,column:!1,cell:!1};t.activeWt=f,t.instance.runHooks("beforeOnCellMouseOver",l,h,c,p),!Yi(l)&&(r.mouseDown&&mx(l,{coords:h,selection:t.instance.selection,controller:p,cellCoordsFactory:function(y,m){return t.instance._createCellCoords(y,m)}}),t.instance.runHooks("afterOnCellMouseOver",l,h,c),t.activeWt=t._wt)},onCellMouseUp:function(l,u,c,f){var h=t.translateFromRenderableToVisualCoords(u);t.activeWt=f,t.instance.runHooks("beforeOnCellMouseUp",l,h,c),!(Yi(l)||t.instance.isDestroyed)&&(t.instance.runHooks("afterOnCellMouseUp",l,h,c),t.activeWt=t._wt)},onCellCornerMouseDown:function(l){l.preventDefault(),t.instance.runHooks("afterOnCellCornerMouseDown",l)},onCellCornerDblClick:function(l){l.preventDefault(),t.instance.runHooks("afterOnCellCornerDblClick",l)},beforeDraw:function(l,u){return t.beforeRender(l,u)},onDraw:function(l){return t.afterRender(l)},onScrollVertically:function(){return t.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return t.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return t.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(l,u,c){var f=t.instance.rowIndexMapper,h=f.getVisualFromRenderableIndex(l),p=t.instance.runHooks("beforeHighlightingRowHeader",h,u,c);return f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:function(l,u,c){var f=t.instance.columnIndexMapper,h=f.getVisualFromRenderableIndex(l),p=t.instance.runHooks("beforeHighlightingColumnHeader",h,u,c);return f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:function(l,u,c){var f,h=t.translateFromRenderableToVisualIndex(l,u),p=jc(h,2),y=p[0],m=p[1],v=t.instance.selection.getSelectedRange(),w=v.size();if(w>0){var C=(c??0)+1-w,A=v.peekByIndex(C);f=[A.from.row,A.from.col,A.to.row,A.to.col]}return t.instance.runHooks("afterDrawSelection",y,m,f,c)},onBeforeDrawBorders:function(l,u){var c=jc(l,4),f=c[0],h=c[1],p=c[2],y=c[3],m=[t.instance.rowIndexMapper.getVisualFromRenderableIndex(f),t.instance.columnIndexMapper.getVisualFromRenderableIndex(h),t.instance.rowIndexMapper.getVisualFromRenderableIndex(p),t.instance.columnIndexMapper.getVisualFromRenderableIndex(y)];return t.instance.runHooks("beforeDrawBorders",m,u)},onBeforeTouchScroll:function(){return t.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return t.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(l,u){var c=t.instance.columnIndexMapper.getVisualFromRenderableIndex(u);return t.instance.runHooks("beforeStretchingColumnWidth",l,c)},onModifyRowHeaderWidth:function(l){return t.instance.runHooks("modifyRowHeaderWidth",l)},onModifyGetCellCoords:function(l,u,c){var f=t.instance.rowIndexMapper,h=t.instance.columnIndexMapper,p=u>=0?h.getVisualFromRenderableIndex(u):u,y=l>=0?f.getVisualFromRenderableIndex(l):l,m=t.instance.runHooks("modifyGetCellCoords",y,p,c);if(Array.isArray(m)){var v=jc(m,4),w=v[0],C=v[1],A=v[2],D=v[3];return[w>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(w,1)):w,C>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(C,1)):C,A>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(A,-1)):A,D>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(D,-1)):D]}},viewportRowCalculatorOverride:function(l){var u=t.settings.viewportRowRenderingOffset;if(u==="auto"&&t.settings.fixedRowsTop&&(u=10),u>0||u==="auto"){var c=t.countRenderableRows(),f=l.startRow,h=l.endRow;if(typeof u=="number")l.startRow=Math.max(f-u,0),l.endRow=Math.min(h+u,c-1);else if(u==="auto"){var p=Math.ceil(h/c*12);l.startRow=Math.max(f-p,0),l.endRow=Math.min(h+p,c-1)}}t.instance.runHooks("afterViewportRowCalculatorOverride",l)},viewportColumnCalculatorOverride:function(l){var u=t.settings.viewportColumnRenderingOffset;if(u==="auto"&&t.settings.fixedColumnsStart&&(u=10),u>0||u==="auto"){var c=t.countRenderableColumns(),f=l.startColumn,h=l.endColumn;if(typeof u=="number"&&(l.startColumn=Math.max(f-u,0),l.endColumn=Math.min(h+u,c-1)),u==="auto"){var p=Math.ceil(h/c*6);l.startColumn=Math.max(f-p,0),l.endColumn=Math.min(h+p,c-1)}}t.instance.runHooks("afterViewportColumnCalculatorOverride",l)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var l=t.instance.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||l}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new fyt(n),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,i=this.instance.rootElement.getBoundingClientRect(),a=i.width,s=i.height;this.setLastSize(a,s),this.eventManager.addEventListener(o,"mousedown",function(l){l.target===o&&l.which===3&&l.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(l){l.target===o&&l.which===3&&l.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){t.settings.observeDOMVisibility&&t._wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})}},{key:"isTextSelectionAllowed",value:function(t){if(_f(t))return!0;var r=oi(t,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return xi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var t,r;return(t=(r=this.instance.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())!==null&&t!==void 0?t:!1}},{key:"isCellEdited",value:function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function(t,r){t&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,r)}},{key:"afterRender",value:function(t){t&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(t,r){if(r.firstChild){var n=r.firstChild;if(!Dt(n,"relative")){yr(r),this.appendRowHeader(t,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var o=this.instance,i=o.rootDocument,a=o.getRowHeader,s=i.createElement("div"),l=i.createElement("span");s.className="relative",l.className="rowHeader",this.updateCellHeader(l,t,a),s.appendChild(l),r.appendChild(s)}this.instance.runHooks("afterGetRowHeader",t,r)}},{key:"appendColHeader",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(r.firstChild){var i=r.firstChild;Dt(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),t,n,o):(yr(r),this.appendColHeader(t,r,n,o))}else{var a=this.instance.rootDocument,s=a.createElement("div"),l=a.createElement("span");s.className="relative",l.className="colHeader",this.updateCellHeader(l,t,n,o),s.appendChild(l),r.appendChild(s)}this.instance.runHooks("afterGetColHeader",t,r,o)}},{key:"updateCellHeader",value:function(t,r,n){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=r,a=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(Dt(t,"colHeader")?i=a.wtTable.columnFilter.sourceToRendered(r):Dt(t,"rowHeader")&&(i=a.wtTable.rowFilter.sourceToRendered(r))),i>-1?Ya(t,n(r,o)):(mi(t,""),q(t,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(t){var r=this._wt.wtViewport.getWorkspaceWidth(),n=r-t;return n>0?n:0}},{key:"maximumVisibleElementHeight",value:function(t){var r=this._wt.wtViewport.getWorkspaceHeight(),n=r-t;return n>0?n:0}},{key:"setLastSize",value:function(t,r){var n=xi.get(this),o=[t,r];n.lastWidth=o[0],n.lastHeight=o[1]}},{key:"getLastSize",value:function(){var t=xi.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Ax(this,xA)}},{key:"getRowHeadersCount",value:function(){return Ax(this,jA)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const igt=ogt;function OC(e){return OC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OC(e)}var xU="ABCDEFGHIJKLMNOPQRSTUVWXYZ",kC=xU.length;function Tv(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%kC,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/kC,10);return r}function agt(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(kC,n)*(xU.indexOf(e[r])+1);return t-=1,t}function sgt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(Tv(o)+(n+1));r.push(i)}return r}function lgt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=Tv(o)+(n+1);r.push(i)}return r}function ugt(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function RC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,s){n.push([i+t,s,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function WR(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&zt(e[0])&&(t=uv(e[0]))),t}function jU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function DU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return OC(t)==="object"&&!Array.isArray(t)&&t!==null}))}const cgt=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:WR,createEmptySpreadsheetData:ugt,createSpreadsheetData:sgt,createSpreadsheetObjectData:lgt,dataRowToChangesArray:RC,isArrayOfArrays:jU,isArrayOfObjects:DU,spreadsheetColumnIndex:agt,spreadsheetColumnLabel:Tv},Symbol.toStringTag,{value:"Module"}));function fh(e){return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function fgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dgt(n.key),n)}}function hgt(e,t,r){return t&&Cx(e.prototype,t),r&&Cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dgt(e){var t=pgt(e,"string");return fh(t)==="symbol"?t:String(t)}function pgt(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ygt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];fgt(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return hgt(e,[{key:"modifyRowData",value:function(t){var r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",t)),r!==void 0&&!Number.isInteger(r)?r:this.data[t]}},{key:"getData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,t)}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var r=this,n=[];return T(this.data,function(o,i){var a=r.getAtCell(i,t);n.push(a)}),n}},{key:"getAtRow",value:function(t,r,n){var o=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=r===void 0&&n===void 0,s=null,l=null;if(s=this.modifyRowData(t),Array.isArray(s))l=[],a?s.forEach(function(f,h){l[h]=o.getAtPhysicalCell(t,h,s)}):Ct(r,n,function(f){l[f-r]=o.getAtPhysicalCell(t,f,s)});else if(zt(s)||ge(s))if(i?l=[]:l={},!a||i){var u=0,c=this.countFirstRowKeys()-1;Ct(u,c,function(f){var h=o.colToProp(f);if(f>=(r||u)&&f<=(n||c)&&!Number.isInteger(h)){var p=o.getAtPhysicalCell(t,h,s);i?l.push(p):Ny(l,h,p)}})}else Qt(s,function(f,h){Ny(l,h,o.getAtPhysicalCell(t,h,s))});return l}},{key:"setAtCell",value:function(t,r,n){if(!(t>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=Ca(n);this.hot.runHooks("modifySourceData",t,this.propToCol(r),o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(r)?this.data[t][r]=n:Ny(this.data[t],r,n)}}},{key:"getAtPhysicalCell",value:function(t,r,n){var o=null;if(n&&(typeof r=="string"?o=XV(n,r):typeof r=="function"?o=r(n):o=n[r]),this.hot.hasHook("modifySourceData")){var i=Ca(o);this.hot.runHooks("modifySourceData",t,this.colToProp(r),i,"get"),i.isTouched()&&(o=i.value)}return o}},{key:"getAtCell",value:function(t,r){var n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(r),n)}},{key:"getByRange",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=null,s=null,l=null,u=null;r===null||n===null?(i=!0,a=0,l=this.countRows()-1):(a=Math.min(r.row,n.row),s=Math.min(r.col,n.col),l=Math.max(r.row,n.row),u=Math.max(r.col,n.col));var c=[];return Ct(a,l,function(f){c.push(i?t.getAtRow(f,void 0,void 0,o):t.getAtRow(f,s,u,o))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}},{key:"countFirstRowKeys",value:function(){return WR(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const ggt=ygt;var Ox=Me,mgt=function(e){return e!==void 0&&(Ox(e,"value")||Ox(e,"writable"))},vgt=jt,bgt=Ke,wgt=We,Agt=De,Sgt=mgt,Cgt=Hr,Ogt=$m;function _U(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(Agt(e)===r)return e[t];if(n=Cgt.f(e,t),n)return Sgt(n)?n.value:n.get===void 0?void 0:bgt(n.get,r);if(wgt(o=Ogt(e)))return _U(o,t,r)}vgt({target:"Reflect",stat:!0},{get:_U});var kgt=jt,Rgt=Wt,Egt=Fn,HU=Hr.f,NU=Fe,Tgt=!NU||Rgt(function(){HU(1)});kgt({target:"Object",stat:!0,forced:Tgt,sham:!NU},{getOwnPropertyDescriptor:function(e,t){return HU(Egt(e),t)}});var Pgt="localHooks",BU={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e,t,r,n,o,i,a){if(this._localHooks[e])for(var s=this._localHooks[e].length,l=0;l<s;l++)Bg(this._localHooks[e][l],this,t,r,n,o,i,a)},clearLocalHooks:function(){return this._localHooks={},this}};Br(BU,"MIXIN_NAME",Pgt,{writable:!1,enumerable:!1});const Tn=BU;function hh(e){return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function Mgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xgt(n.key),n)}}function Igt(e,t,r){return t&&kx(e.prototype,t),r&&kx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xgt(e){var t=jgt(e,"string");return hh(t)==="symbol"?t:String(t)}function jgt(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ga=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Mgt(this,e),this.indexedValues=[],this.initValueOrFn=t}return Igt(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(t){var r=this.indexedValues;if(t<r.length)return r[t]}},{key:"setValues",value:function(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(t,r){return t<this.indexedValues.length?(this.indexedValues[t]=r,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ge(this.initValueOrFn)?Ct(r-1,function(n){return t.indexedValues.push(t.initValueOrFn(n))}):Ct(r-1,function(){return t.indexedValues.push(t.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();pe(Ga,Tn);function DA(e){return Ngt(e)||Hgt(e)||_gt(e)||Dgt()}function Dgt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _gt(e,t){if(e){if(typeof e=="string")return EC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EC(e,t)}}function Hgt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ngt(e){if(Array.isArray(e))return EC(e)}function EC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UR(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(DA(e.slice(0,o)),DA(r.map(function(i,a){return ge(n)?n(i,a):n})),DA(o===void 0?[]:e.slice(o)))}function YR(e,t){return Ln(e,function(r,n){return t.includes(n)===!1})}function Ol(e){return Ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ol(e)}function Bgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vgt(n.key),n)}}function Lgt(e,t,r){return t&&Rx(e.prototype,t),r&&Rx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vgt(e){var t=Fgt(e,"string");return Ol(t)==="symbol"?t:String(t)}function Fgt(e,t){if(Ol(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ol(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yf(){return typeof Reflect<"u"&&Reflect.get?yf=Reflect.get.bind():yf=function(e,t,r){var n=Wgt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},yf.apply(this,arguments)}function Wgt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ta(e),e!==null););return e}function Ugt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TC(e,t)}function TC(e,t){return TC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},TC(e,t)}function Ygt(e){var t=Qgt();return function(){var r=Ta(e),n;if(t){var o=Ta(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ggt(this,n)}}function Ggt(e,t){if(t&&(Ol(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zgt(e)}function zgt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qgt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ta(e){return Ta=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ta(e)}var Oi=function(e){Ugt(r,e);var t=Ygt(r);function r(){return Bgt(this,r),t.apply(this,arguments)}return Lgt(r,[{key:"insert",value:function(n,o){this.indexedValues=UR(this.indexedValues,n,o,this.initValueOrFn),yf(Ta(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){this.indexedValues=YR(this.indexedValues,n),yf(Ta(r.prototype),"remove",this).call(this,n)}}]),r}(Ga);function kl(e){return kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kl(e)}function Kgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ex(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jgt(n.key),n)}}function Xgt(e,t,r){return t&&Ex(e.prototype,t),r&&Ex(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jgt(e){var t=Zgt(e,"string");return kl(t)==="symbol"?t:String(t)}function Zgt(e,t){if(kl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qgt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PC(e,t)}function PC(e,t){return PC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},PC(e,t)}function $gt(e){var t=nmt();return function(){var r=ym(e),n;if(t){var o=ym(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tmt(this,n)}}function tmt(e,t){if(t&&(kl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return emt(e)}function emt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ym(e){return ym=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ym(e)}var Pv=function(e){qgt(r,e);var t=$gt(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Kgt(this,r),t.call(this,n)}return Xgt(r,[{key:"getHiddenIndexes",value:function(){return _e(this.getValues(),function(n,o,i){return o&&n.push(i),n},[])}}]),r}(Oi);function _A(e){return amt(e)||imt(e)||omt(e)||rmt()}function rmt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function omt(e,t){if(e){if(typeof e=="string")return MC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MC(e,t)}}function imt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function amt(e){if(Array.isArray(e))return MC(e)}function MC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GR(e,t,r){return[].concat(_A(e.slice(0,t)),_A(r),_A(e.slice(t)))}function dh(e,t){return Ln(e,function(r){return t.includes(r)===!1})}function zR(e,t){return Gt(e,function(r){return r-t.filter(function(n){return n<r}).length})}function QR(e,t){var r=t[0],n=t.length;return Gt(e,function(o){return o>=r?o+n:o})}function Rl(e){return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(e)}function smt(e){return fmt(e)||cmt(e)||umt(e)||lmt()}function lmt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function umt(e,t){if(e){if(typeof e=="string")return IC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IC(e,t)}}function cmt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fmt(e){if(Array.isArray(e))return IC(e)}function IC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VU(n.key),n)}}function dmt(e,t,r){return t&&Tx(e.prototype,t),r&&Tx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qr(){return typeof Reflect<"u"&&Reflect.get?qr=Reflect.get.bind():qr=function(e,t,r){var n=pmt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},qr.apply(this,arguments)}function pmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lr(e),e!==null););return e}function ymt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xC(e,t)}function xC(e,t){return xC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},xC(e,t)}function gmt(e){var t=vmt();return function(){var r=lr(e),n;if(t){var o=lr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mmt(this,n)}}function mmt(e,t){if(t&&(Rl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LU(e)}function LU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lr(e){return lr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lr(e)}function bmt(e,t,r){return t=VU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VU(e){var t=wmt(e,"string");return Rl(t)==="symbol"?t:String(t)}function wmt(e,t){if(Rl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mv=function(e){ymt(r,e);var t=gmt(r);function r(){var n;hmt(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),bmt(LU(n),"orderOfIndexes",[]),n}return dmt(r,[{key:"getValues",value:function(){var n=this;return this.orderOfIndexes.map(function(o){return n.indexedValues[o]})}},{key:"setValues",value:function(n){this.orderOfIndexes=smt(Array(n.length).keys()),qr(lr(r.prototype),"setValues",this).call(this,n)}},{key:"setValueAtIndex",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return n<this.indexedValues.length?(this.indexedValues[n]=o,this.orderOfIndexes.includes(n)===!1&&this.orderOfIndexes.splice(i,0,n),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(n){this.orderOfIndexes=dh(this.orderOfIndexes,[n]),ge(this.initValueOrFn)?qr(lr(r.prototype),"setValueAtIndex",this).call(this,n,this.initValueOrFn(n)):qr(lr(r.prototype),"setValueAtIndex",this).call(this,n,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,qr(lr(r.prototype),"setDefaultValues",this).call(this,n)}},{key:"insert",value:function(n,o){this.indexedValues=UR(this.indexedValues,n,o,this.initValueOrFn),this.orderOfIndexes=QR(this.orderOfIndexes,o),qr(lr(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){this.indexedValues=YR(this.indexedValues,n),this.orderOfIndexes=dh(this.orderOfIndexes,n),this.orderOfIndexes=zR(this.orderOfIndexes,n),qr(lr(r.prototype),"remove",this).call(this,n)}},{key:"getEntries",value:function(){var n=this;return this.orderOfIndexes.map(function(o){return[o,n.getValueAtIndex(o)]})}}]),r}(Ga);function El(e){return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},El(e)}function Amt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Px(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cmt(n.key),n)}}function Smt(e,t,r){return t&&Px(e.prototype,t),r&&Px(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cmt(e){var t=Omt(e,"string");return El(t)==="symbol"?t:String(t)}function Omt(e,t){if(El(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(El(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jC(e,t)}function jC(e,t){return jC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},jC(e,t)}function Rmt(e){var t=Pmt();return function(){var r=gm(e),n;if(t){var o=gm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Emt(this,n)}}function Emt(e,t){if(t&&(El(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tmt(e)}function Tmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gm(e){return gm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gm(e)}var dp=function(e){kmt(r,e);var t=Rmt(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Amt(this,r),t.call(this,n)}return Smt(r,[{key:"getTrimmedIndexes",value:function(){return _e(this.getValues(),function(n,o,i){return o&&n.push(i),n},[])}}]),r}(Oi),Mx=new Map([["indexesSequence",{getListWithInsertedItems:GR,getListWithRemovedItems:dh}],["physicallyIndexed",{getListWithInsertedItems:UR,getListWithRemovedItems:YR}]]),FU=function(e){if(Mx.has(e)===!1)throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return Mx.get(e)};function Tl(e){return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tl(e)}function Mmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xmt(n.key),n)}}function Imt(e,t,r){return t&&Ix(e.prototype,t),r&&Ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xmt(e){var t=jmt(e,"string");return Tl(t)==="symbol"?t:String(t)}function jmt(e,t){if(Tl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gf(){return typeof Reflect<"u"&&Reflect.get?gf=Reflect.get.bind():gf=function(e,t,r){var n=Dmt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},gf.apply(this,arguments)}function Dmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pa(e),e!==null););return e}function _mt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DC(e,t)}function DC(e,t){return DC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},DC(e,t)}function Hmt(e){var t=Lmt();return function(){var r=Pa(e),n;if(t){var o=Pa(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nmt(this,n)}}function Nmt(e,t){if(t&&(Tl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bmt(e)}function Bmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pa(e){return Pa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pa(e)}var WU=function(e){_mt(r,e);var t=Hmt(r);function r(){return Mmt(this,r),t.call(this,function(n){return n})}return Imt(r,[{key:"insert",value:function(n,o){var i=QR(this.indexedValues,o);this.indexedValues=GR(i,n,o),gf(Pa(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){var o=dh(this.indexedValues,n);this.indexedValues=zR(o,n),gf(Pa(r.prototype),"remove",this).call(this,n)}}]),r}(Ga),xx=new Map([["hiding",Pv],["index",Ga],["linkedPhysicalIndexToValue",Mv],["physicalIndexToValue",Oi],["trimming",dp]]);function Vmt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!xx.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(xx.get(e))(t)}function ph(e){return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Fmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Umt(n.key),n)}}function Wmt(e,t,r){return t&&jx(e.prototype,t),r&&jx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Umt(e){var t=Ymt(e,"string");return ph(t)==="symbol"?t:String(t)}function Ymt(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _C=0,KR=function(){function e(){Fmt(this,e),this.collection=new Map}return Wmt(e,[{key:"register",value:function(t,r){var n=this;this.collection.has(t)===!1&&(this.collection.set(t,r),r.addLocalHook("change",function(){return n.runLocalHooks("change",r)}),_C+=1)}},{key:"unregister",value:function(t){var r=this.collection.get(t);ht(r)&&(r.destroy(),this.collection.delete(t),this.runLocalHooks("change",r),_C-=1)}},{key:"unregisterAll",value:function(){var t=this;this.collection.forEach(function(r,n){return t.unregister(n)}),this.collection.clear()}},{key:"get",value:function(t){return he(t)?Array.from(this.collection.values()):this.collection.get(t)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(t){this.collection.forEach(function(r){r.remove(t)})}},{key:"insertToEvery",value:function(t,r){this.collection.forEach(function(n){n.insert(t,r)})}},{key:"initEvery",value:function(t){this.collection.forEach(function(r){r.init(t)})}}]),e}();pe(KR,Tn);function Gmt(){return _C}function Pl(e){return Pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pl(e)}function zmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kmt(n.key),n)}}function Qmt(e,t,r){return t&&Dx(e.prototype,t),r&&Dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kmt(e){var t=Xmt(e,"string");return Pl(t)==="symbol"?t:String(t)}function Xmt(e,t){if(Pl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HC(e,t)}function HC(e,t){return HC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},HC(e,t)}function Zmt(e){var t=tvt();return function(){var r=mm(e),n;if(t){var o=mm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qmt(this,n)}}function qmt(e,t){if(t&&(Pl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $mt(e)}function $mt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mm(e){return mm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mm(e)}var _x=function(e){Jmt(r,e);var t=Zmt(r);function r(n,o){var i;return zmt(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return Qmt(r,[{key:"getMergedValues",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=Gt(this.get(),function(c){return c.getValues()}),i=[],a=ht(o[0])&&o[0].length||0,s=0;s<a;s+=1){for(var l=[],u=0;u<this.getLength();u+=1)l.push(o[u][s]);i.push(l)}return Gt(i,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(n,o){var i=this.getMergedValues(o)[n];return ht(i)?i:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(KR);function yh(e){return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function evt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rvt(n.key),n)}}function nvt(e,t,r){return t&&Hx(e.prototype,t),r&&Hx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rvt(e){var t=ovt(e,"string");return yh(t)==="symbol"?t:String(t)}function ovt(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ivt(e,t,r){avt(e,t),t.set(e,r)}function avt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function svt(e,t,r){var n=UU(e,t,"set");return lvt(e,n,r),r}function lvt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function uvt(e,t){var r=UU(e,t,"get");return cvt(e,r)}function UU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function cvt(e,t){return t.get?t.get.call(e):t.value}var HA=new WeakMap,YU=function(){function e(){evt(this,e),ivt(this,HA,{writable:!0,value:[]})}return nvt(e,[{key:"subscribe",value:function(t){return this.addLocalHook("change",t),this._write(uvt(this,HA)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(t){return t.length>0&&this.runLocalHooks("change",t),this}},{key:"_writeInitialChanges",value:function(t){svt(this,HA,t)}}]),e}();pe(YU,Tn);function Nx(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function gh(e){return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function fvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dvt(n.key),n)}}function hvt(e,t,r){return t&&Bx(e.prototype,t),r&&Bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dvt(e){var t=pvt(e,"string");return gh(t)==="symbol"?t:String(t)}function pvt(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dc(e,t,r){yvt(e,t),t.set(e,r)}function yvt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yn(e,t){var r=GU(e,t,"get");return gvt(e,r)}function gvt(e,t){return t.get?t.get.call(e):t.value}function Zp(e,t,r){var n=GU(e,t,"set");return mvt(e,n,r),r}function GU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function mvt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var qp=new WeakMap,_c=new WeakMap,$p=new WeakMap,ty=new WeakMap,ey=new WeakMap,vvt=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;fvt(this,e),Dc(this,qp,{writable:!0,value:new Set}),Dc(this,_c,{writable:!0,value:[]}),Dc(this,$p,{writable:!0,value:[]}),Dc(this,ty,{writable:!0,value:!1}),Dc(this,ey,{writable:!0,value:!1}),Zp(this,ey,r??!1)}return hvt(e,[{key:"createObserver",value:function(){var t=this,r=new YU;return Yn(this,qp).add(r),r.addLocalHook("unsubscribe",function(){Yn(t,qp).delete(r)}),r._writeInitialChanges(Nx(Yn(this,_c),Yn(this,$p))),r}},{key:"emit",value:function(t){var r=Yn(this,$p);(!Yn(this,ty)||Yn(this,_c).length!==t.length)&&(t.length===0?t=new Array(r.length).fill(Yn(this,ey)):Zp(this,_c,new Array(t.length).fill(Yn(this,ey))),Yn(this,ty)||(Zp(this,ty,!0),r=Yn(this,_c)));var n=Nx(r,t);Yn(this,qp).forEach(function(o){return o._write(n)}),Zp(this,$p,t)}}]),e}();function mh(e){return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}var Lx;function NA(e){return Svt(e)||Avt(e)||wvt(e)||bvt()}function bvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wvt(e,t){if(e){if(typeof e=="string")return NC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NC(e,t)}}function Avt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Svt(e){if(Array.isArray(e))return NC(e)}function NC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cvt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ovt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rvt(n.key),n)}}function kvt(e,t,r){return t&&Vx(e.prototype,t),r&&Vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rvt(e){var t=Evt(e,"string");return mh(t)==="symbol"?t:String(t)}function Evt(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fx=new Set(["getFirstNotHiddenIndex"]),BC=function(){function e(){var t=this;Ovt(this,e),this.indexesSequence=new WU,this.trimmingMapsCollection=new _x(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new _x(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new KR,this.hidingChangesObservable=new vvt({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return kvt(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(t){if(t!=="hiding")throw new Error('Unsupported index map type "'.concat(t,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(t,r,n){return this.registerMap(t,Vmt(r,n))}},{key:"registerMap",value:function(t,r){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error('Map with name "'.concat(t,'" has been already registered.'));r instanceof dp?this.trimmingMapsCollection.register(t,r):r instanceof Pv?this.hidingMapsCollection.register(t,r):this.variousMapsCollection.register(t,r);var n=this.getNumberOfIndexes();return n>0&&r.init(n),r}},{key:"unregisterMap",value:function(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(t){var r=this.notTrimmedIndexesCache[t];return ht(r)?r:null}},{key:"getPhysicalFromRenderableIndex",value:function(t){var r=this.renderablePhysicalIndexesCache[t];return ht(r)?r:null}},{key:"getVisualFromPhysicalIndex",value:function(t){var r=this.fromPhysicalToVisualIndexesCache.get(t);return ht(r)?r:null}},{key:"getVisualFromRenderableIndex",value:function(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}},{key:"getRenderableFromVisualIndex",value:function(t){var r=this.fromVisualToRenderableIndexesCache.get(t);return ht(r)?r:null}},{key:"getFirstNotHiddenIndex",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t-r;Fx.has("getFirstNotHiddenIndex")&&(Fx.delete("getFirstNotHiddenIndex"),de(ce(Lx||(Lx=Cvt([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var i=this.getPhysicalFromVisualIndex(t);return i===null?n===!0&&o!==t-r?this.getFirstNotHiddenIndex(o,-r,!1,o):null:this.isHidden(i)===!1?t:this.getFirstNotHiddenIndex(t+r,r,n,o)}},{key:"getNearestNotHiddenIndex",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(t);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;var i=Array.from(this.fromVisualToRenderableIndexesCache.keys()),a=-1;return r>0?a=i.findIndex(function(s){return s>t}):a=i.reverse().findIndex(function(s){return s<t}),a===-1?n?this.getNearestNotHiddenIndex(t,-r,!1):null:i[a]}},{key:"initToLength",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=NA(new Array(t).keys()),this.notHiddenIndexesCache=NA(new Array(t).keys()),this.suspendOperations(),this.indexesSequence.init(t),this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(t){var r=this.getNumberOfIndexes();if(t<r){var n=NA(Array(this.getNumberOfIndexes()-t).keys()).map(function(o){return o+t});this.removeIndexes(n)}else this.insertIndexes(r,t-r)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(t){this.indexesSequence.setValues(t)}},{key:"getNotTrimmedIndexes",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(r===!0)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter(function(o){return t.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(r===!0)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter(function(o){return t.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(r===!0)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter(function(o){return t.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(t,r){var n=this;typeof t=="number"&&(t=[t]);var o=Gt(t,function(c){return n.getPhysicalFromVisualIndex(c)}),i=this.getNotTrimmedIndexesLength(),a=t.length,s=dh(this.getIndexesSequence(),o),l=i-a;if(r+a<i){var u=s.filter(function(c){return n.isTrimmed(c)===!1})[r];l=s.indexOf(u)}this.setIndexesSequence(GR(s,l,o))}},{key:"isTrimmed",value:function(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}},{key:"isHidden",value:function(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}},{key:"insertIndexes",value:function(t,r){var n=this.getNotTrimmedIndexes()[t],o=ht(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=Gt(new Array(r).fill(o),function(s,l){return s+l});this.suspendOperations(),this.indexesSequence.insert(i,a),this.trimmingMapsCollection.insertToEvery(i,a),this.hidingMapsCollection.insertToEvery(i,a),this.variousMapsCollection.insertToEvery(i,a),this.resumeOperations()}},{key:"removeIndexes",value:function(t){this.suspendOperations(),this.indexesSequence.remove(t),this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}},{key:"updateCache",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(t===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var r=0;r<t;r+=1){var n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var r=0;r<t;r+=1){var n=this.getPhysicalFromRenderableIndex(r),o=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(o,r)}}}]),e}();pe(BC,Tn);var Wx;function Tvt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Pvt(e,t){return Qt(t,function(r,n){he(e[n])&&(e[n]=r)}),e}function zU(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function QU(e){ht(e)&&CR(ce(Wx||(Wx=Tvt(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function Mvt(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var KU=tr("phraseFormatters"),Ivt=KU.register,xvt=KU.getValues;function jvt(e,t){Ivt(e,t)}function Dvt(){return xvt()}jvt("pluralize",Mvt);var XU="ContextMenu:items",Ut=XU,XR="".concat(Ut,".noItems"),Iv="".concat(Ut,".insertRowAbove"),xv="".concat(Ut,".insertRowBelow"),jv="".concat(Ut,".insertColumnOnTheLeft"),Dv="".concat(Ut,".insertColumnOnTheRight"),_v="".concat(Ut,".removeRow"),Hv="".concat(Ut,".removeColumn"),Nv="".concat(Ut,".undo"),Bv="".concat(Ut,".redo"),Lv="".concat(Ut,".readOnly"),Vv="".concat(Ut,".clearColumn"),Fv="".concat(Ut,".copy"),Wv="".concat(Ut,".copyWithHeaders"),Uv="".concat(Ut,".copyWithGroupHeaders"),Yv="".concat(Ut,".copyHeadersOnly"),Gv="".concat(Ut,".cut"),zv="".concat(Ut,".freezeColumn"),Qv="".concat(Ut,".unfreezeColumn"),Kv="".concat(Ut,".mergeCells"),Xv="".concat(Ut,".unmergeCells"),Jv="".concat(Ut,".addComment"),Zv="".concat(Ut,".editComment"),qv="".concat(Ut,".removeComment"),$v="".concat(Ut,".readOnlyComment"),tb="".concat(Ut,".align"),eb="".concat(Ut,".align.left"),nb="".concat(Ut,".align.center"),rb="".concat(Ut,".align.right"),ob="".concat(Ut,".align.justify"),ib="".concat(Ut,".align.top"),ab="".concat(Ut,".align.middle"),sb="".concat(Ut,".align.bottom"),lb="".concat(Ut,".borders"),ub="".concat(Ut,".borders.top"),cb="".concat(Ut,".borders.right"),fb="".concat(Ut,".borders.bottom"),hb="".concat(Ut,".borders.left"),db="".concat(Ut,".borders.remove"),pb="".concat(Ut,".nestedHeaders.insertChildRow"),yb="".concat(Ut,".nestedHeaders.detachFromParent"),gb="".concat(Ut,".hideColumn"),mb="".concat(Ut,".showColumn"),vb="".concat(Ut,".hideRow"),bb="".concat(Ut,".showRow"),vn="Filters:",Ie="".concat(vn,"conditions"),pp="".concat(Ie,".none"),wb="".concat(Ie,".isEmpty"),Ab="".concat(Ie,".isNotEmpty"),Sb="".concat(Ie,".isEqualTo"),Cb="".concat(Ie,".isNotEqualTo"),Ob="".concat(Ie,".beginsWith"),kb="".concat(Ie,".endsWith"),Rb="".concat(Ie,".contains"),Eb="".concat(Ie,".doesNotContain"),_vt="".concat(Ie,".byValue"),Tb="".concat(Ie,".greaterThan"),Pb="".concat(Ie,".greaterThanOrEqualTo"),Mb="".concat(Ie,".lessThan"),Ib="".concat(Ie,".lessThanOrEqualTo"),xb="".concat(Ie,".isBetween"),jb="".concat(Ie,".isNotBetween"),Db="".concat(Ie,".after"),_b="".concat(Ie,".before"),Hb="".concat(Ie,".today"),Nb="".concat(Ie,".tomorrow"),Bb="".concat(Ie,".yesterday"),Lb="".concat(vn,"labels.filterByCondition"),Vb="".concat(vn,"labels.filterByValue"),Fb="".concat(vn,"labels.conjunction"),yp="".concat(vn,"labels.disjunction"),vh="".concat(vn,"values.blankCells"),Wb="".concat(vn,"buttons.selectAll"),Ub="".concat(vn,"buttons.clear"),Yb="".concat(vn,"buttons.ok"),Gb="".concat(vn,"buttons.cancel"),zb="".concat(vn,"buttons.placeholder.search"),Qb="".concat(vn,"buttons.placeholder.value"),Kb="".concat(vn,"buttons.placeholder.secondValue");const Hvt=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:Jv,CONTEXTMENU_ITEMS_ALIGNMENT:tb,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:sb,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:nb,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ob,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:eb,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:ab,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:rb,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:ib,CONTEXTMENU_ITEMS_BORDERS:lb,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:fb,CONTEXTMENU_ITEMS_BORDERS_LEFT:hb,CONTEXTMENU_ITEMS_BORDERS_RIGHT:cb,CONTEXTMENU_ITEMS_BORDERS_TOP:ub,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Vv,CONTEXTMENU_ITEMS_COPY:Fv,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Yv,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Uv,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Wv,CONTEXTMENU_ITEMS_CUT:Gv,CONTEXTMENU_ITEMS_EDIT_COMMENT:Zv,CONTEXTMENU_ITEMS_FREEZE_COLUMN:zv,CONTEXTMENU_ITEMS_HIDE_COLUMN:gb,CONTEXTMENU_ITEMS_HIDE_ROW:vb,CONTEXTMENU_ITEMS_INSERT_LEFT:jv,CONTEXTMENU_ITEMS_INSERT_RIGHT:Dv,CONTEXTMENU_ITEMS_MERGE_CELLS:Kv,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:yb,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:pb,CONTEXTMENU_ITEMS_NO_ITEMS:XR,CONTEXTMENU_ITEMS_READ_ONLY:Lv,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:$v,CONTEXTMENU_ITEMS_REDO:Bv,CONTEXTMENU_ITEMS_REMOVE_BORDERS:db,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Hv,CONTEXTMENU_ITEMS_REMOVE_COMMENT:qv,CONTEXTMENU_ITEMS_REMOVE_ROW:_v,CONTEXTMENU_ITEMS_ROW_ABOVE:Iv,CONTEXTMENU_ITEMS_ROW_BELOW:xv,CONTEXTMENU_ITEMS_SHOW_COLUMN:mb,CONTEXTMENU_ITEMS_SHOW_ROW:bb,CONTEXTMENU_ITEMS_UNDO:Nv,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Qv,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Xv,CONTEXT_MENU_ITEMS_NAMESPACE:XU,FILTERS_BUTTONS_CANCEL:Gb,FILTERS_BUTTONS_CLEAR:Ub,FILTERS_BUTTONS_OK:Yb,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:zb,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Kb,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Qb,FILTERS_BUTTONS_SELECT_ALL:Wb,FILTERS_CONDITIONS_AFTER:Db,FILTERS_CONDITIONS_BEFORE:_b,FILTERS_CONDITIONS_BEGINS_WITH:Ob,FILTERS_CONDITIONS_BETWEEN:xb,FILTERS_CONDITIONS_BY_VALUE:_vt,FILTERS_CONDITIONS_CONTAINS:Rb,FILTERS_CONDITIONS_EMPTY:wb,FILTERS_CONDITIONS_ENDS_WITH:kb,FILTERS_CONDITIONS_EQUAL:Sb,FILTERS_CONDITIONS_GREATER_THAN:Tb,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Pb,FILTERS_CONDITIONS_LESS_THAN:Mb,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Ib,FILTERS_CONDITIONS_NAMESPACE:Ie,FILTERS_CONDITIONS_NONE:pp,FILTERS_CONDITIONS_NOT_BETWEEN:jb,FILTERS_CONDITIONS_NOT_CONTAIN:Eb,FILTERS_CONDITIONS_NOT_EMPTY:Ab,FILTERS_CONDITIONS_NOT_EQUAL:Cb,FILTERS_CONDITIONS_TODAY:Hb,FILTERS_CONDITIONS_TOMORROW:Nb,FILTERS_CONDITIONS_YESTERDAY:Bb,FILTERS_DIVS_FILTER_BY_CONDITION:Lb,FILTERS_DIVS_FILTER_BY_VALUE:Vb,FILTERS_LABELS_CONJUNCTION:Fb,FILTERS_LABELS_DISJUNCTION:yp,FILTERS_NAMESPACE:vn,FILTERS_VALUES_BLANK_CELLS:vh},Symbol.toStringTag,{value:"Module"}));function bh(e){return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}var st;function ct(e,t,r){return t=Nvt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nvt(e){var t=Bvt(e,"string");return bh(t)==="symbol"?t:String(t)}function Bvt(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lvt=(st={languageCode:"en-US"},ct(st,XR,"No available options"),ct(st,Iv,"Insert row above"),ct(st,xv,"Insert row below"),ct(st,jv,"Insert column left"),ct(st,Dv,"Insert column right"),ct(st,_v,["Remove row","Remove rows"]),ct(st,Hv,["Remove column","Remove columns"]),ct(st,Nv,"Undo"),ct(st,Bv,"Redo"),ct(st,Lv,"Read only"),ct(st,Vv,"Clear column"),ct(st,tb,"Alignment"),ct(st,eb,"Left"),ct(st,nb,"Center"),ct(st,rb,"Right"),ct(st,ob,"Justify"),ct(st,ib,"Top"),ct(st,ab,"Middle"),ct(st,sb,"Bottom"),ct(st,zv,"Freeze column"),ct(st,Qv,"Unfreeze column"),ct(st,lb,"Borders"),ct(st,ub,"Top"),ct(st,cb,"Right"),ct(st,fb,"Bottom"),ct(st,hb,"Left"),ct(st,db,"Remove border(s)"),ct(st,Jv,"Add comment"),ct(st,Zv,"Edit comment"),ct(st,qv,"Delete comment"),ct(st,$v,"Read-only comment"),ct(st,Kv,"Merge cells"),ct(st,Xv,"Unmerge cells"),ct(st,Fv,"Copy"),ct(st,Wv,["Copy with header","Copy with headers"]),ct(st,Uv,["Copy with group header","Copy with group headers"]),ct(st,Yv,["Copy header only","Copy headers only"]),ct(st,Gv,"Cut"),ct(st,pb,"Insert child row"),ct(st,yb,"Detach from parent"),ct(st,gb,["Hide column","Hide columns"]),ct(st,mb,["Show column","Show columns"]),ct(st,vb,["Hide row","Hide rows"]),ct(st,bb,["Show row","Show rows"]),ct(st,pp,"None"),ct(st,wb,"Is empty"),ct(st,Ab,"Is not empty"),ct(st,Sb,"Is equal to"),ct(st,Cb,"Is not equal to"),ct(st,Ob,"Begins with"),ct(st,kb,"Ends with"),ct(st,Rb,"Contains"),ct(st,Eb,"Does not contain"),ct(st,Tb,"Greater than"),ct(st,Pb,"Greater than or equal to"),ct(st,Mb,"Less than"),ct(st,Ib,"Less than or equal to"),ct(st,xb,"Is between"),ct(st,jb,"Is not between"),ct(st,Db,"After"),ct(st,_b,"Before"),ct(st,Hb,"Today"),ct(st,Nb,"Tomorrow"),ct(st,Bb,"Yesterday"),ct(st,vh,"Blank cells"),ct(st,Lb,"Filter by condition"),ct(st,Vb,"Filter by value"),ct(st,Fb,"And"),ct(st,yp,"Or"),ct(st,Wb,"Select all"),ct(st,Ub,"Clear"),ct(st,Yb,"OK"),ct(st,Gb,"Cancel"),ct(st,zb,"Search"),ct(st,Qb,"Value"),ct(st,Kb,"Second value"),st);const JU=Lvt;var LC=JU.languageCode,Xb=tr("languagesDictionaries"),Vvt=Xb.register,ZU=Xb.getItem,Fvt=Xb.hasItem,Wvt=Xb.getValues;JR(JU);function JR(e,t){var r=e,n=t;return zt(e)&&(n=e,r=n.languageCode),Uvt(r,n),Vvt(r,on(n)),on(n)}function Uvt(e,t){e!==LC&&Pvt(t,ZU(LC))}function qU(e){return ZR(e)?on(ZU(e)):null}function ZR(e){return Fvt(e)}function Yvt(){return Wvt()}function $U(e,t,r){var n=qU(e);if(n===null)return null;var o=n[t];if(he(o))return null;var i=Gvt(o,r);return Array.isArray(i)?i[0]:i}function Gvt(e,t){var r=e;return T(Dvt(),function(n){r=n(e,t)}),r}function zvt(e){var t=zU(e);return ZR(t)||(t=LC,QU(e)),t}var Qvt=jt,Kvt=Fe,Xvt=JB,Jvt=Fn,Zvt=Hr,qvt=sc;Qvt({target:"Object",stat:!0,sham:!Kvt},{getOwnPropertyDescriptors:function(e){for(var t=Jvt(e),r=Zvt.f,n=Xvt(t),o={},i=0,a,s;n.length>i;)s=r(t,a=n[i++]),s!==void 0&&qvt(o,a,s);return o}});var Jb="active-header",Zb="area",wh="cell",qR="fill",gp="header",$R="custom-selection";function Ml(e){return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(e)}function $vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ux(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eY(n.key),n)}}function tbt(e,t,r){return t&&Ux(e.prototype,t),r&&Ux(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $y(){return typeof Reflect<"u"&&Reflect.get?$y=Reflect.get.bind():$y=function(e,t,r){var n=ebt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},$y.apply(this,arguments)}function ebt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Il(e),e!==null););return e}function nbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VC(e,t)}function VC(e,t){return VC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},VC(e,t)}function rbt(e){var t=ibt();return function(){var r=Il(e),n;if(t){var o=Il(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return obt(this,n)}}function obt(e,t){if(t&&(Ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tY(e)}function tY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ibt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Il(e){return Il=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Il(e)}function abt(e,t,r){return t=eY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eY(e){var t=sbt(e,"string");return Ml(t)==="symbol"?t:String(t)}function sbt(e,t){if(Ml(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ml(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lbt=function(e){nbt(r,e);var t=rbt(r);function r(n,o){var i;return $vt(this,r),i=t.call(this,n,null),abt(tY(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return tbt(r,[{key:"add",value:function(n){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(n):this.visualCellRange.expand(n),this}},{key:"clear",value:function(){return this.visualCellRange=null,$y(Il(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(n){var o=n.from,i=n.to,a=this.getNearestNotHiddenCoords(o,1),s=this.getNearestNotHiddenCoords(i,-1);if(a===null||s===null)return null;if(a.row>s.row||a.col>s.col){var l=this.settings.type==="header"||this.settings.type==="active-header";if(!l)return null;a=o,s=i}return this.settings.createCellRange(a,a,s)}},{key:"getNearestNotHiddenCoords",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,a=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),n.row,o);if(a===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),n.col,i);return s===null?null:this.settings.createCellCoords(a,s)}},{key:"getNearestNotHiddenIndex",value:function(n,o,i){if(o<0)return o;var a=n.getNearestNotHiddenIndex(o,i),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&a===null?-1:a}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var n=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return n===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(n.from,n.to),this}},{key:"syncWith",value:function(n){var o=n.getVerticalDirection()==="N-S"?1:-1,i=n.getHorizontalDirection()==="W-E"?1:-1,a=this.getNearestNotHiddenCoords(n.from.clone().normalize(),o,i);if(a!==null&&n.overlaps(a)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(s)}return n.setHighlight(a),this}return n.setHighlight(n.from),this}},{key:"getCorners",value:function(){var n=this.cellRange,o=n.from,i=n.to,a=o.row===null||i.row===null,s=o.col===null||i.col===null,l=this.settings.createCellCoords(a?null:Math.min(o.row,i.row),s?null:Math.min(o.col,i.col)),u=this.settings.createCellCoords(a?null:Math.max(o.row,i.row),s?null:Math.max(o.col,i.col));return[l.row,l.col,u.row,u.col]}},{key:"getVisualCorners",value:function(){var n=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[n.row,n.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(n,o){var i=this.settings.visualToRenderableCoords(n),a=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(i,i,a)}}]),r}(Fyt);const pc=lbt;function Ah(e){return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}var ubt=["activeHeaderClassName"];function Yx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Gx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yx(Object(r),!0).forEach(function(n){cbt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cbt(e,t,r){return t=fbt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fbt(e){var t=hbt(e,"string");return Ah(t)==="symbol"?t:String(t)}function hbt(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dbt(e,t){if(e==null)return{};var r=pbt(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pbt(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function ybt(e){var t=e.activeHeaderClassName,r=dbt(e,ubt),n=new pc(Gx(Gx({highlightHeaderClassName:t},r),{},{selectionType:Jb}));return n}function Sh(e){return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}var gbt=["layerLevel","areaCornerVisible"];function zx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Qx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zx(Object(r),!0).forEach(function(n){mbt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mbt(e,t,r){return t=vbt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vbt(e){var t=bbt(e,"string");return Sh(t)==="symbol"?t:String(t)}function bbt(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wbt(e,t){if(e==null)return{};var r=Abt(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Abt(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Sbt(e){var t=e.layerLevel,r=e.areaCornerVisible,n=wbt(e,gbt),o=new pc(Qx(Qx({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:Zb}));return o}function Ch(e){return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}var Cbt=["cellCornerVisible"];function Kx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Xx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kx(Object(r),!0).forEach(function(n){Obt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Obt(e,t,r){return t=kbt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kbt(e){var t=Rbt(e,"string");return Ch(t)==="symbol"?t:String(t)}function Rbt(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ebt(e,t){if(e==null)return{};var r=Tbt(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Tbt(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Pbt(e){var t=e.cellCornerVisible,r=Ebt(e,Cbt),n=new pc(Xx(Xx({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:wh}));return n}function Oh(e){return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}var Mbt=["border","visualCellRange"];function Jx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function BA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jx(Object(r),!0).forEach(function(n){Ibt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ibt(e,t,r){return t=xbt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xbt(e){var t=jbt(e,"string");return Oh(t)==="symbol"?t:String(t)}function jbt(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dbt(e,t){if(e==null)return{};var r=_bt(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _bt(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Hbt(e){var t=e.border,r=e.visualCellRange,n=Dbt(e,Mbt),o=new pc(BA(BA(BA({},t),n),{},{selectionType:$R}),r);return o}var Zx=Fe,Nbt=Kt,Bbt=Ke,Lbt=Wt,LA=Wd,Vbt=Vd,Fbt=xd,Wbt=En,Ubt=Dd,rs=Object.assign,qx=Object.defineProperty,Ybt=Nbt([].concat),Gbt=!rs||Lbt(function(){if(Zx&&rs({b:1},rs(qx({},"a",{enumerable:!0,get:function(){qx(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),rs({},e)[r]!=7||LA(rs({},t)).join("")!=n})?function(e,t){for(var r=Wbt(e),n=arguments.length,o=1,i=Vbt.f,a=Fbt.f;n>o;)for(var s=Ubt(arguments[o++]),l=i?Ybt(LA(s),i(s)):LA(s),u=l.length,c=0,f;u>c;)f=l[c++],(!Zx||Bbt(a,s,f))&&(r[f]=s[f]);return r}:rs,zbt=jt,$x=Gbt;zbt({target:"Object",stat:!0,arity:2,forced:Object.assign!==$x},{assign:$x});function kh(e){return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}function tj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ej(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tj(Object(r),!0).forEach(function(n){Qbt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qbt(e,t,r){return t=Kbt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kbt(e){var t=Xbt(e,"string");return kh(t)==="symbol"?t:String(t)}function Xbt(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jbt(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function Zbt(e){var t=Object.assign({},(Jbt(e),e)),r=new pc(ej(ej({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:qR}));return r}function Rh(e){return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}var qbt=["headerClassName","rowClassName","columnClassName"];function nj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nj(Object(r),!0).forEach(function(n){$bt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $bt(e,t,r){return t=twt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function twt(e){var t=ewt(e,"string");return Rh(t)==="symbol"?t:String(t)}function ewt(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nwt(e,t){if(e==null)return{};var r=rwt(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rwt(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function owt(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=nwt(e,qbt),i=new pc(rj(rj({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:gp}));return i}function Eh(e){return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function oj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function iwt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oj(Object(r),!0).forEach(function(n){awt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function awt(e,t,r){return t=swt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function swt(e){var t=lwt(e,"string");return Eh(t)==="symbol"?t:String(t)}function lwt(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nY=tr("highlight/types"),yc=nY.register,uwt=nY.getItem;yc(Jb,ybt);yc(Zb,Sbt);yc(wh,Pbt);yc($R,Hbt);yc(qR,Zbt);yc(gp,owt);function os(e,t){return uwt(e)(iwt({type:e},t))}function Th(e){return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function Fo(e){return dwt(e)||hwt(e)||fwt(e)||cwt()}function cwt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fwt(e,t){if(e){if(typeof e=="string")return FC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FC(e,t)}}function hwt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dwt(e){if(Array.isArray(e))return FC(e)}function FC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ij(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Hc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ij(Object(r),!0).forEach(function(n){pwt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ij(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pwt(e,t,r){return t=rY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ywt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rY(n.key),n)}}function gwt(e,t,r){return t&&aj(e.prototype,t),r&&aj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rY(e){var t=mwt(e,"string");return Th(t)==="symbol"?t:String(t)}function mwt(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vwt=function(e){function t(r){ywt(this,t),this.options=r,this.layerLevel=0,this.cell=os(wh,r),this.fill=os(qR,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return gwt(t,[{key:"isEnabledFor",value:function(r,n){var o=r;r===wh&&(o="current");var i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(o)}},{key:"useLayerLevel",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=r,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var r=this.layerLevel,n;return this.areas.has(r)?n=this.areas.get(r):(n=os(Zb,Hc({layerLevel:r},this.options)),this.areas.set(r,n)),n}},{key:"getAreas",value:function(){return Fo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var r=this.layerLevel,n;return this.headers.has(r)?n=this.headers.get(r):(n=os(gp,Hc({},this.options)),this.headers.set(r,n)),n}},{key:"getHeaders",value:function(){return Fo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var r=this.layerLevel,n;return this.activeHeaders.has(r)?n=this.activeHeaders.get(r):(n=os(Jb,Hc({},this.options)),this.activeHeaders.set(r,n)),n}},{key:"getActiveHeaders",value:function(){return Fo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Fo(this.customSelections.values())}},{key:"addCustomSelection",value:function(r){this.customSelections.push(os($R,Hc(Hc({},this.options),r)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),T(this.areas.values(),function(r){return void r.clear()}),T(this.headers.values(),function(r){return void r.clear()}),T(this.activeHeaders.values(),function(r){return void r.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Fo(this.areas.values()),Fo(this.headers.values()),Fo(this.activeHeaders.values()),Fo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const bwt=vwt;function Ph(e){return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}function wwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Swt(n.key),n)}}function Awt(e,t,r){return t&&sj(e.prototype,t),r&&sj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Swt(e){var t=Cwt(e,"string");return Ph(t)==="symbol"?t:String(t)}function Cwt(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Owt=function(e){function t(r){wwt(this,t),this.ranges=[],this.createCellRange=r}return Awt(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(r){return this.clear(),this.ranges.push(this.createCellRange(r)),this}},{key:"add",value:function(r){return this.ranges.push(this.createCellRange(r)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(r){return this.ranges.some(function(n){return n.includes(r)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=this.size()+r-1,o;return n>=0&&(o=this.ranges[n]),o}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const kwt=Owt;function Mh(e){return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function Rwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Twt(n.key),n)}}function Ewt(e,t,r){return t&&lj(e.prototype,t),r&&lj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Twt(e){var t=Pwt(e,"string");return Mh(t)==="symbol"?t:String(t)}function Pwt(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oY=function(){function e(t,r){Rwt(this,e),this.range=t,this.options=r}return Ewt(e,[{key:"transformStart",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(t,r),i=this.range.current().highlight,a=this.options.visualToRenderableCoords(i),s=a.row,l=a.col,u=i,c=0,f=0;if(this.runLocalHooks("beforeTransformStart",o),s!==null&&l!==null){var h=this.options.countRows(),p=this.options.countCols(),y=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),v=this.options.minSpareCols(),w=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+t>h-1?n&&m>0&&!(y&&s>=h-y-1)?(this.runLocalHooks("insertRowRequire",h),h=this.options.countRows()):C&&(o.row=1-h,o.col=l+o.col===p-1?1-p:1):C&&s+o.row<0&&l+o.col>=0&&(o.row=h-1,o.col=l+o.col===0?p-1:-1),l+o.col>p-1?n&&v>0?(this.runLocalHooks("insertColRequire",p),p=this.options.countCols()):w&&(o.row=s+o.row===h-1?1-h:1,o.col=1-p):w&&l+o.col<0&&s+o.row>=0&&(o.row=s+o.row===0?h-1:-1,o.col=p-1);var A=this.options.createCellCoords(s+o.row,l+o.col);c=0,f=0,A.row<0?(c=-1,A.row=0):A.row>0&&A.row>=h&&(c=1,A.row=h-1),A.col<0?(f=-1,A.col=0):A.col>0&&A.col>=p&&(f=1,A.col=p-1),u=this.options.renderableToVisualCoords(A)}return this.runLocalHooks("afterTransformStart",u,c,f),u}},{key:"transformEnd",value:function(t,r){var n=this.options.createCellCoords(t,r),o=this.range.current(),i=o.to,a=0,s=0;this.runLocalHooks("beforeTransformEnd",n);var l=this.options.visualToRenderableCoords(o.highlight),u=l.row,c=l.col;if(u!==null&&c!==null){var f=this.options.countRows(),h=this.options.countCols(),p=this.options.visualToRenderableCoords(o.to),y=p.row,m=p.col,v=this.options.createCellCoords(y+n.row,m+n.col);a=0,s=0,v.row<0?(a=-1,v.row=0):v.row>0&&v.row>=f&&(a=1,v.row=f-1),v.col<0?(s=-1,v.col=0):v.col>0&&v.col>=h&&(s=1,v.col=h-1),i=this.options.renderableToVisualCoords(v)}return this.runLocalHooks("afterTransformEnd",i,a,s),i}}]),e}();pe(oY,Tn);const Mwt=oY;function iY(e,t){return Dwt(e)||jwt(e,t)||xwt(e,t)||Iwt()}function Iwt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xwt(e,t){if(e){if(typeof e=="string")return uj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uj(e,t)}}function uj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jwt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Dwt(e){if(Array.isArray(e))return e}function WC(e){return WC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WC(e)}var qb=0,$b=1,aY=2,tE=3,_wt=[tE,aY],Hwt=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],VA=Symbol("root"),cj=Symbol("child");function xl(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:VA;if(t!==VA&&t!==cj)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===VA,o=qb;if(r){var i=e[0];if(e.length===0)o=$b;else if(n&&i instanceof MR)o=tE;else if(n&&Array.isArray(i))o=xl(i,cj);else if(e.length>=2&&e.length<=4){var a=!e.some(function(s,l){return!Hwt[l].includes(WC(s))});a&&(o=aY)}}return o}function Ih(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!_wt.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===tE,s=a?i.from.row:i[0],l=a?i.from.col:i[1],u=a?i.to.row:i[2],c=a?i.to.col:i[3];if(typeof o=="function"&&(typeof l=="string"&&(l=o(l)),typeof c=="string"&&(c=o(c))),he(u)&&(u=s),he(c)&&(c=l),!n){var f=s,h=l,p=u,y=c;s=Math.min(f,p),l=Math.min(h,y),u=Math.max(f,p),c=Math.max(h,y)}return[s,l,u,c]}}function Nwt(e){var t=xl(e);if(t===qb||t===$b)return[];var r=Ih(t),n=new Set;T(e,function(a){var s=r(a),l=iY(s,4),u=l[1],c=l[3],f=Math.max(u,0),h=c-f+1;T(Array.from(new Array(h),function(p,y){return f+y}),function(p){n.has(p)||n.add(p)})});var o=Array.from(n).sort(function(a,s){return a-s}),i=_e(o,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return i}function Bwt(e){var t=xl(e);if(t===qb||t===$b)return[];var r=Ih(t),n=new Set;T(e,function(a){var s=r(a),l=iY(s,3),u=l[0],c=l[2],f=Math.max(u,0),h=c-f+1;T(Array.from(new Array(h),function(p,y){return f+y}),function(p){n.has(p)||n.add(p)})});var o=Array.from(n).sort(function(a,s){return a-s}),i=_e(o,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return i}function Wo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function xh(e){return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}var fj;function hj(e,t){return Wwt(e)||Fwt(e,t)||Vwt(e,t)||Lwt()}function Lwt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vwt(e,t){if(e){if(typeof e=="string")return dj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dj(e,t)}}function dj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fwt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Wwt(e){if(Array.isArray(e))return e}function Uwt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ywt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zwt(n.key),n)}}function Gwt(e,t,r){return t&&pj(e.prototype,t),r&&pj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zwt(e){var t=Qwt(e,"string");return xh(t)==="symbol"?t:String(t)}function Qwt(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sY=function(){function e(t,r){var n=this;Ywt(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new kwt(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new bwt({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(o,i){return n.tableProps.isDisabledCellSelection(o,i)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,i){return n.tableProps.createCellCoords(o,i)},createCellRange:function(o,i,a){return n.tableProps.createCellRange(o,i,a)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Mwt(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,i){return n.tableProps.createCellCoords(o,i)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Gwt(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",i=he(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=t.row<0,s=t.col<0,l=a&&s,u=t.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),u),(!o||o&&!i&&he(r))&&this.selectedRange.clear(),this.selectedRange.add(u),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&a&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,r){this.setRangeStart(t,r,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){var r=t.clone();this.runLocalHooks("beforeSetRangeEnd",r),this.begin();var n=this.selectedRange.current();this.settings.selectionMode!=="single"&&n.setTo(this.tableProps.createCellCoords(r.row,r.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(wh,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(T(this.highlight.getAreas(),function(y){return void y.clear()}),T(this.highlight.getHeaders(),function(y){return void y.clear()}),T(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(o);var i=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(i.clear(),a.clear(),s.clear(),this.highlight.isEnabledFor(Zb,n.highlight)&&(this.isMultiple()||o>=1)&&(i.add(n.from).add(n.to).commit(),o===1)){var l=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(gp,n.highlight)){var u=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,f=n;if((u||c)&&(f=n.clone()),u&&(f.from.row=-1),c&&(f.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&f.from.normalize(),a.add(f.from).commit()):a.add(f.from).add(f.to).commit(),this.isEntireRowSelected()){var h=this.tableProps.countCols()===n.getWidth();h&&s.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var p=this.tableProps.countRows()===n.getHeight();p&&s.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=Ca(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(t,r,n))}},{key:"transformEnd",value:function(t,r){this.setRangeEnd(this.transformation.transformEnd(t,r))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&this.isEntireRowSelected(t)}},{key:"isEntireRowSelected",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return t===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(t)}},{key:"isEntireColumnSelected",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return t===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return Number.isInteger(t)&&t!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!t&&!r&&(n===0||o===0))){var i=this.tableProps.createCellCoords(r?-1:0,t?-1:0),a=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(i),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(a),this.finish()}}},{key:"selectCells",value:function(t){var r=this,n=xl(t);if(n===$b)return!1;if(n===qb)throw new Error(ce(fj||(fj=Uwt([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=Ih(n,{propToCol:function(l){return r.tableProps.propToCol(l)},keepDirection:!0}),i=this.tableProps.countRows(),a=this.tableProps.countCols(),s=!t.some(function(l){var u=o(l),c=hj(u,4),f=c[0],h=c[1],p=c[2],y=c[3],m=Wo(f,i)&&Wo(h,a)&&Wo(p,i)&&Wo(y,a);return!m});return s&&(this.clear(),T(t,function(l){var u=o(l),c=hj(u,4),f=c[0],h=c[1],p=c[2],y=c[3];r.setRangeStartOnly(r.tableProps.createCellCoords(f,h),!1),r.setRangeEnd(r.tableProps.createCellCoords(p,y)),r.finish()})),s}},{key:"selectColumns",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof t=="string"?this.tableProps.propToCol(t):t,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=this.tableProps.countCols(),s=this.tableProps.countRows(),l=Wo(o,a)&&Wo(i,a);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,o)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,i)),this.finish()),l}},{key:"selectRows",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),i=this.tableProps.countCols(),a=Wo(t,o)&&Wo(r,o);return a&&(this.setRangeStartOnly(this.tableProps.createCellCoords(t,n)),this.setRangeEnd(this.tableProps.createCellCoords(r,i-1)),this.finish()),a}},{key:"refresh",value:function(){var t=this.highlight.getCustomSelections();if(t.forEach(function(l){l.commit()}),!!this.isSelected()){var r=this.highlight.getCell(),n=this.getLayerLevel();r.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var i=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();i.commit(),a.commit(),s.commit()}this.highlight.useLayerLevel(n)}}}]),e}();pe(sY,Tn);const Kwt=sY;var Xwt=jt,lY=Yd,Jwt=Hr.f,Zwt=Va,yj=Ue,qwt=Nk,$wt=Rn,tAt=Bk,gj=lY("".startsWith),eAt=lY("".slice),nAt=Math.min,uY=tAt("startsWith"),rAt=!uY&&!!function(){var e=Jwt(String.prototype,"startsWith");return e&&!e.writable}();Xwt({target:"String",proto:!0,forced:!rAt&&!uY},{startsWith:function(e){var t=yj($wt(this));qwt(e);var r=Zwt(nAt(arguments.length>1?arguments[1]:void 0,t.length)),n=yj(e);return gj?gj(t,n,r):eAt(t,r,r+n.length)===n}});var mj=/^(\r\n|\n\r|\r|\n)/,oAt=/^[^\t\r\n]+/,vj=/^\t/;function iAt(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(vj))e=e.replace(vj,""),r+=1,t[n][r]="";else if(e.match(mj))e=e.replace(mj,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,s=!0;s;){var l=e.slice(0,1);l==='"'&&(a+=1),i+=l,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(s=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(c){return new Array(Math.floor(c.length/2)).fill('"').join("")})}else{var u=e.match(oAt);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function mf(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function FA(e){return uAt(e)||lAt(e)||sAt(e)||aAt()}function aAt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sAt(e,t){if(e){if(typeof e=="string")return UC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UC(e,t)}}function lAt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uAt(e){if(Array.isArray(e))return UC(e)}function UC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jl(e){return jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jl(e)}function cAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hAt(n.key),n)}}function fAt(e,t,r){return t&&bj(e.prototype,t),r&&bj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hAt(e){var t=dAt(e,"string");return jl(t)==="symbol"?t:String(t)}function dAt(e,t){if(jl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pAt=function(){function e(t,r,n){cAt(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return fAt(e,[{key:"createMap",value:function(){var t=this.getSchema();if(typeof t>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var r=this.tableMeta.columns,n;if(this.colToPropCache=[],this.propToColCache=new Map,r){var o=0,i=0,a=!1;if(typeof r=="function"){var s=uv(t);o=s>0?s:this.countFirstRowKeys(),a=!0}else{var l=this.tableMeta.maxCols;o=Math.min(l,r.length)}for(n=0;n<o;n++){var u=a?r(n):r[n];if(zt(u)){if(typeof u.data<"u"){var c=a?i:n;this.colToPropCache[c]=u.data,this.propToColCache.set(u.data,c)}i+=1}}}else this.recursiveDuckColumns(t)}},{key:"countFirstRowKeys",value:function(){return WR(this.dataSource)}},{key:"recursiveDuckColumns",value:function(t,r,n){var o=this,i=r,a=n,s;return typeof i>"u"&&(i=0,a=""),jl(t)==="object"&&!Array.isArray(t)&&Qt(t,function(l,u){l===null?(s=a+u,o.colToPropCache.push(s),o.propToColCache.set(s,i),i+=1):i=o.recursiveDuckColumns(l,i,"".concat(u,"."))}),i}},{key:"colToProp",value:function(t){if(Number.isInteger(t)===!1)return t;var r=this.instance.toPhysicalColumn(t);return r===null?t:this.colToPropCache&&ht(this.colToPropCache[r])?this.colToPropCache[r]:r}},{key:"propToCol",value:function(t){var r=this.propToColCache.get(t);if(ht(r))return this.instance.toVisualColumn(r);var n=this.instance.toVisualColumn(t);return n===null?t:n}},{key:"getSchema",value:function(){var t=this.tableMeta.dataSchema;return t?typeof t=="function"?t():t:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?qs(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,s=a===void 0?"above":a,l=this.instance.countSourceRows(),u=l,c=0,f=t;(typeof f!="number"||f>=l)&&(f=l),f<this.instance.countRows()&&(u=this.instance.toPhysicalRow(f));var h=this.instance.runHooks("beforeCreateRow",f,n,i);if(h===!1||u===null)return{delta:0};for(var p=this.tableMeta.maxRows,y=this.getSchema().length,m=[],v=function(){var C=null;r.instance.dataType==="array"?r.tableMeta.dataSchema?C=on(r.getSchema()):(C=[],Ct(y-1,function(){return C.push(null)})):r.instance.dataType==="function"?C=r.tableMeta.dataSchema(f+c):(C={},$d(C,r.getSchema())),m.push(C),c+=1};c<n&&l+c<p;)v();this.instance.rowIndexMapper.insertIndexes(f,c),s==="below"&&(u=Math.min(u+1,l)),this.spliceData(u,0,m);var w=this.instance.toVisualRow(u);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(t==null?this.metaManager.createRow(null,c):i!=="auto"&&this.metaManager.createRow(u,n)),this.instance.runHooks("afterCreateRow",w,c,i),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:u}}},{key:"createCol",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=n.source,i=n.mode,a=i===void 0?"start":i;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,l=this.tableMeta.maxCols,u=this.instance.countSourceCols(),c=t;(typeof c!="number"||c>=u)&&(c=u);var f=this.instance.runHooks("beforeCreateCol",c,r,o);if(f===!1)return{delta:0};var h=u;c<this.instance.countCols()&&(h=this.instance.toPhysicalColumn(c));var p=this.instance.countSourceRows(),y=this.instance.countCols(),m=0,v=h;a==="end"&&(v=Math.min(v+1,u));for(var w=v;m<r&&y<l;){if(typeof c!="number"||c>=y)if(p>0)for(var C=0;C<p;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var A=0;A<p;A++)s[A].splice(v,0,null);m+=1,v+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(c,m),m>0&&(t==null?this.metaManager.createColumn(null,m):o!=="auto"&&this.metaManager.createColumn(w,r));var D=this.instance.toVisualColumn(w);return this.instance.runHooks("afterCreateCol",D,m,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:w}}},{key:"removeRow",value:function(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(t)?t:-n,a=this.visualRowsToPhysical(i,n),s=this.instance.countSourceRows();i=(s+i)%s;var l=this.instance.runHooks("beforeRemoveRow",i,a.length,a,o);if(l===!1)return!1;var u=a.length;if(this.filterData(i,u,a),i<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(a);var c=ht(this.tableMeta.columns)||ht(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var f=a.slice(0).sort(function(h,p){return p-h});return f.forEach(function(h){r.metaManager.removeRow(h,1)}),this.instance.runHooks("afterRemoveRow",i,u,a,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof t!="number"?-r:t;o=(this.instance.countCols()+o)%this.instance.countCols();var i=this.visualColumnsToPhysical(o,r),a=i.slice(0).sort(function(w,C){return C-w}),s=this.instance.runHooks("beforeRemoveCol",o,r,i,n);if(s===!1)return!1;for(var l=!0,u=a.length,c=this.dataSource,f=0;f<u;f++)l&&i[0]!==i[f]-f&&(l=!1);if(l)for(var h=0,p=this.instance.countSourceRows();h<p;h++)c[h].splice(i[0],r),h===0&&this.metaManager.removeColumn(i[0],r);else for(var y=0,m=this.instance.countSourceRows();y<m;y++)for(var v=0;v<u;v++)c[y].splice(a[v],1),y===0&&this.metaManager.removeColumn(a[v],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(i),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,r,i,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(t,r,n){for(var o=this.instance.getDataAtCol(t),i=o.slice(r,r+n),a=o.slice(r+n),s=arguments.length,l=new Array(s>3?s-3:0),u=3;u<s;u++)l[u-3]=arguments[u];bS(l,a);for(var c=0;c<n;)l.push(null),c+=1;return zV(l),this.instance.populateFromArray(r,t,l,null,null,"spliceCol"),i}},{key:"spliceRow",value:function(t,r,n){for(var o=this.instance.getSourceDataAtRow(t),i=o.slice(r,r+n),a=o.slice(r+n),s=arguments.length,l=new Array(s>3?s-3:0),u=3;u<s;u++)l[u-3]=arguments[u];bS(l,a);for(var c=0;c<n;)l.push(null),c+=1;return this.instance.populateFromArray(t,r,[l],null,null,"spliceRow"),i}},{key:"spliceData",value:function(t,r,n){var o=this,i=this.instance.runHooks("beforeDataSplice",t,r,n);if(i!==!1){var a=[].concat(FA(this.dataSource.slice(0,t)),FA(n),FA(this.dataSource.slice(t)));this.dataSource.length=0,a.forEach(function(s){return o.dataSource.push(s)})}}},{key:"filterData",value:function(t,r,n){var o=this.instance.runHooks("filterData",t,r,n);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(i,a){return n.indexOf(a)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(t,r){var n=this.instance.toPhysicalRow(t),o=this.dataSource[n],i=this.instance.runHooks("modifyRowData",n);o=isNaN(i)?i:o;var a=null;if(o&&o.hasOwnProperty&&Te(o,r))a=o[r];else if(typeof r=="string"&&r.indexOf(".")>-1){var s=r.split("."),l=o;if(!l)return null;for(var u=0,c=s.length;u<c;u++)if(l=l[s[u]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var f=Ca(a);this.instance.runHooks("modifyData",n,this.propToCol(r),f,"get"),f.isTouched()&&(a=f.value)}return a}},{key:"getCopyable",value:function(t,r){return this.instance.getCellMeta(t,this.propToCol(r)).copyable?this.get(t,r):""}},{key:"set",value:function(t,r,n){var o=this.instance.toPhysicalRow(t),i=n,a=this.dataSource[o],s=this.instance.runHooks("modifyRowData",o);if(a=isNaN(s)?s:a,this.instance.hasHook("modifyData")){var l=Ca(i);this.instance.runHooks("modifyData",o,this.propToCol(r),l,"set"),l.isTouched()&&(i=l.value)}if(a&&a.hasOwnProperty&&Te(a,r))a[r]=i;else if(typeof r=="string"&&r.indexOf(".")>-1){var u=r.split("."),c=a,f=0,h;for(f=0,h=u.length-1;f<h;f++)typeof c[u[f]]>"u"&&(c[u[f]]={}),c=c[u[f]];c[u[f]]=i}else typeof r=="function"?r(this.dataSource.slice(o,o+1)[0],i):a[r]=i}},{key:"visualRowsToPhysical",value:function(t,r){for(var n=this.instance.countSourceRows(),o=[],i=(n+t)%n,a=r,s;i<n&&a;)s=this.instance.toPhysicalRow(i),o.push(s),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(t,r){for(var n=this.instance.countCols(),o=[],i=(n+t)%n,a=r;i<n&&a;){var s=this.instance.toPhysicalColumn(i);o.push(s),a-=1,i+=1}return o}},{key:"clear",value:function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var r=0;r<this.instance.countCols();r++)this.set(t,this.colToProp(r),"")}},{key:"getLength",value:function(){var t=this.tableMeta.maxRows,r;t<0||t===0?r=0:r=t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}},{key:"getAll",value:function(){var t={row:0,col:0},r={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-r.row===0&&!this.instance.countSourceRows()?[]:this.getRange(t,r,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,r,n){var o=[],i,a,s,l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];var c=n===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(l-1,0),Math.max(t.row,r.row)),h=Math.min(Math.max(u-1,0),Math.max(t.col,r.col));for(i=Math.min(t.row,r.row);i<=f;i++){s=[];var p=i>=0?this.instance.toPhysicalRow(i):i;for(a=Math.min(t.col,r.col);a<=h&&p!==null;a++)s.push(c.call(this,i,this.colToProp(a)));p!==null&&o.push(s)}return o}},{key:"getText",value:function(t,r){return mf(this.getRange(t,r,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,r){return mf(this.getRange(t,r,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const yAt=pAt;var mp=tr("cellTypes"),gAt=mp.register,mAt=mp.getItem,cY=mp.hasItem,vAt=mp.getNames;mp.getValues;function eE(e){if(!cY(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return mAt(e)}function ir(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Sn(e,n),o&&Pr(e,o),i&&Is(e,i),gAt(e,t)}function bAt(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!Te(t,e)}function tw(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?eE(t.type):t.type;if(e._automaticallyAssignedMetaProps&&Qt(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!zt(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};Qt(n,function(i,a){if(bAt(a,r)){var s;o[a]=i,(s=e._automaticallyAssignedMetaProps)===null||s===void 0||s.add(a)}}),Ve(e,o)}}function wAt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Ho(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function tg(e){return Number.isInteger(e)&&e>=0}function eg(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function ny(e){return e==null}function YC(e){return YC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YC(e)}const fY=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(e){var t,r,n;for(t=0,r=this.countRows();t<r;t++)if(n=this.getDataAtCell(t,e),Qe(n)===!1)return!1;return!0},isEmptyRow:function(e){var t,r,n,o;for(t=0,r=this.countCols();t<r;t++)if(n=this.getDataAtCell(e,t),Qe(n)===!1)return YC(n)==="object"?(o=this.getCellMeta(e,t),Gk(this.getSchema()[o.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function jh(e){return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function wj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Aj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wj(Object(r),!0).forEach(function(n){AAt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AAt(e,t,r){return t=dY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dY(n.key),n)}}function hY(e,t,r){return t&&Sj(e.prototype,t),r&&Sj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dY(e){var t=SAt(e,"string");return jh(t)==="symbol"?t:String(t)}function SAt(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CAt(){return hY(function e(){pY(this,e)})}var OAt=function(){function e(t){pY(this,e),this.metaCtor=CAt(),this.meta=this.metaCtor.prototype,Ve(this.meta,fY()),this.meta.instance=t}return hY(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){var r;Ve(this.meta,t),tw(this.meta,Aj(Aj({},t),{},{type:(r=t.type)!==null&&r!==void 0?r:this.meta.type}),t)}}]),e}();function Dh(e){return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function kAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EAt(n.key),n)}}function RAt(e,t,r){return t&&Cj(e.prototype,t),r&&Cj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EAt(e){var t=TAt(e,"string");return Dh(t)==="symbol"?t:String(t)}function TAt(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PAt=function(){function e(t){kAt(this,e);var r=t.getMetaConstructor();this.meta=new r}return RAt(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){Ve(this.meta,t),tw(this.meta,t,t)}}]),e}();function _h(e){return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function Oj(e){return jAt(e)||xAt(e)||IAt(e)||MAt()}function MAt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IAt(e,t){if(e){if(typeof e=="string")return GC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GC(e,t)}}function xAt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jAt(e){if(Array.isArray(e))return GC(e)}function GC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HAt(n.key),n)}}function _At(e,t,r){return t&&kj(e.prototype,t),r&&kj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HAt(e){var t=NAt(e,"string");return _h(t)==="symbol"?t:String(t)}function NAt(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zC=function(e){function t(r){DAt(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return _At(t,[{key:"obtain",value:function(r){eg(function(){return tg(r)},"Expecting an unsigned number.");var n=this._getStorageIndexByKey(r),o;if(n>=0)o=this.data[n],o===void 0&&(o=this.valueFactory(r),this.data[n]=o);else if(o=this.valueFactory(r),this.holes.size>0){var i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=o,this.index[r]=i}else this.data.push(o),this.index[r]=this.data.length-1;return o}},{key:"insert",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;eg(function(){return tg(r)||ny(r)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],i=this.data.length,a=0;a<n;a++)o.push(i+a),this.data.push(void 0);var s=ny(r)?this.index.length:r;this.index=[].concat(Oj(this.index.slice(0,s)),o,Oj(this.index.slice(s)))}},{key:"remove",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;eg(function(){return tg(r)||ny(r)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(ny(r)?this.index.length-n:r,n),i=0;i<o.length;i++){var a=o[i];typeof a=="number"&&this.holes.add(a)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var r=this;return Ln(this.data,function(n,o){return!r.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var r=[],n=0;n<this.data.length;n++){var o=this._getKeyByStorageIndex(n);o!==-1&&r.push([o,this.data[n]])}var i=0;return{next:function(){if(i<r.length){var a=r[i];return i+=1,{value:a,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(r){return this.index.length>r?this.index[r]:-1}},{key:"_getKeyByStorageIndex",value:function(r){return this.index.indexOf(r)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Hh(e){return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function BAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VAt(n.key),n)}}function LAt(e,t,r){return t&&Rj(e.prototype,t),r&&Rj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VAt(e){var t=FAt(e,"string");return Hh(t)==="symbol"?t:String(t)}function FAt(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WAt=["data","width"],UAt=function(){function e(t){var r=this;BAt(this,e),this.globalMeta=t,this.metas=new zC(function(){return r._createMeta()})}return LAt(e,[{key:"updateMeta",value:function(t,r){var n=this.getMeta(t);Ve(n,r),tw(n,r)}},{key:"createColumn",value:function(t,r){this.metas.insert(t,r)}},{key:"removeColumn",value:function(t,r){this.metas.remove(t,r)}},{key:"getMeta",value:function(t){return this.metas.obtain(t)}},{key:"getMetaConstructor",value:function(t){return this.metas.obtain(t).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return wAt(this.globalMeta.getMetaConstructor(),WAt).prototype}}]),e}();function Nh(e){return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function YAt(e){return KAt(e)||QAt(e)||zAt(e)||GAt()}function GAt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zAt(e,t){if(e){if(typeof e=="string")return QC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QC(e,t)}}function QAt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KAt(e){if(Array.isArray(e))return QC(e)}function QC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ej(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZAt(n.key),n)}}function JAt(e,t,r){return t&&Ej(e.prototype,t),r&&Ej(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZAt(e){var t=qAt(e,"string");return Nh(t)==="symbol"?t:String(t)}function qAt(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $At=function(){function e(t){var r=this;XAt(this,e),this.columnMeta=t,this.metas=new zC(function(){return r._createRow()})}return JAt(e,[{key:"updateMeta",value:function(t,r,n){var o=this.getMeta(t,r);Ve(o,n),tw(o,n)}},{key:"createRow",value:function(t,r){this.metas.insert(t,r)}},{key:"createColumn",value:function(t,r){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(t,r)}},{key:"removeRow",value:function(t,r){this.metas.remove(t,r)}},{key:"removeColumn",value:function(t,r){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(t,r)}},{key:"getMeta",value:function(t,r,n){var o=this.metas.obtain(t).obtain(r);return n===void 0?o:o[n]}},{key:"setMeta",value:function(t,r,n,o){var i,a=this.metas.obtain(t).obtain(r);(i=a._automaticallyAssignedMetaProps)===null||i===void 0||i.delete(n),a[n]=o}},{key:"removeMeta",value:function(t,r,n){var o=this.metas.obtain(t).obtain(r);delete o[n]}},{key:"getMetas",value:function(){for(var t=[],r=Array.from(this.metas.values()),n=0;n<r.length;n++)t.push.apply(t,YAt(r[n].values()));return t}},{key:"getMetasAtRow",value:function(t){eg(function(){return tg(t)},"Expecting an unsigned number.");var r=new Map(this.metas);return r.has(t)?Array.from(r.get(t).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var t=this;return new zC(function(r){return t._createMeta(r)})}},{key:"_createMeta",value:function(t){var r=this.columnMeta.getMetaConstructor(t);return new r}}]),e}();function Bh(e){return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}function t0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n0t(n.key),n)}}function e0t(e,t,r){return t&&Tj(e.prototype,t),r&&Tj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n0t(e){var t=r0t(e,"string");return Bh(t)==="symbol"?t:String(t)}function r0t(e,t){if(Bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yY=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];t0t(this,e),this.hot=t,this.globalMeta=new OAt(t),this.tableMeta=new PAt(this.globalMeta),this.columnMeta=new UAt(this.globalMeta),this.cellMeta=new $At(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return e0t(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(t){this.globalMeta.updateMeta(t)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(t){this.tableMeta.updateMeta(t)}},{key:"getColumnMeta",value:function(t){return this.columnMeta.getMeta(t)}},{key:"updateColumnMeta",value:function(t,r){this.columnMeta.updateMeta(t,r)}},{key:"getCellMeta",value:function(t,r,n){var o=n.visualRow,i=n.visualColumn,a=this.cellMeta.getMeta(t,r);return a.visualRow=o,a.visualCol=i,a.row=t,a.col=r,this.runLocalHooks("afterGetCellMeta",a),a}},{key:"getCellMetaKeyValue",value:function(t,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,r,n)}},{key:"setCellMeta",value:function(t,r,n,o){this.cellMeta.setMeta(t,r,n,o)}},{key:"updateCellMeta",value:function(t,r,n){this.cellMeta.updateMeta(t,r,n)}},{key:"removeCellMeta",value:function(t,r,n){this.cellMeta.removeMeta(t,r,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(t){return this.cellMeta.getMetasAtRow(t)}},{key:"createRow",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(t,r)}},{key:"removeRow",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(t,r)}},{key:"createColumn",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(t,r),this.columnMeta.createColumn(t,r)}},{key:"removeColumn",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(t,r),this.columnMeta.removeColumn(t,r)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();pe(yY,Tn);function vm(e){return vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vm(e)}function Pj(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,c=n.firstRun,f=kn(s),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":ge(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(f),e,c,l);var p=new yAt(o,e,u);if(t(p),vm(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var y=p.getSchema();e=[];var m,v=0,w=0;for(v=0,w=h.startRows;v<w;v++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)m=on(y),e.push(m);else if(o.dataType==="array")m=on(y[0]),e.push(m);else{m=[];for(var C=0,A=h.startCols;C<A;C++)m.push(null);e.push(m)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(vm(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,p.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=p.colToProp.bind(p),a.propToCol=p.propToCol.bind(p),a.countCachedColumns=p.countCachedColumns.bind(p),r(p),o.runHooks("after".concat(f),e,c,l),c||(o.runHooks("afterChange",null,s),o.render())}function Lh(e){return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function o0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a0t(n.key),n)}}function i0t(e,t,r){return t&&Mj(e.prototype,t),r&&Mj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a0t(e){var t=s0t(e,"string");return Lh(t)==="symbol"?t:String(t)}function s0t(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l0t=function(){function e(t){var r=this;o0t(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),gt.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return i0t(e,[{key:"extendCellMeta",value:function(t){var r,n=t.row,o=t.col;if(!((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(o))){var i=t.visualRow,a=t.visualCol,s=this.metaManager.hot,l=s.colToProp(a);t.prop=l,s.runHooks("beforeGetCellMeta",i,a,t);var u=Te(t,"type")?t.type:null,c=ge(t.cells)?t.cells(n,o,l):null;if(u)if(c){var f;c.type=(f=c.type)!==null&&f!==void 0?f:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,o,c),s.runHooks("afterGetCellMeta",i,a,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(o)}}}]),e}();function Vh(e){return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}function u0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ij(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f0t(n.key),n)}}function c0t(e,t,r){return t&&Ij(e.prototype,t),r&&Ij(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f0t(e){var t=h0t(e,"string");return Vh(t)==="symbol"?t:String(t)}function h0t(e,t){if(Vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d0t=function(){function e(t){u0t(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(r){var n=this.metaManager.hot.isRtl();if(n&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(r,n,o){if(!o)throw new Error("The `".concat(r,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return c0t(e,[{key:"extendMetaProps",value:function(){var t=this;this.propDescriptors.forEach(function(r,n){var o=r.target,i=r.onChange,a=i===void 0?function(){}:i,s=typeof o=="string",l=s?o:n,u="_".concat(l);t.metaManager.globalMeta.meta[u]=t.metaManager.globalMeta.meta[l],t.installPropWatcher(n,u,a),s&&t.installPropWatcher(o,u,a)})}},{key:"installPropWatcher",value:function(t,r,n){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get:function(){return this[r]},set:function(i){var a=!o.usageTracker.has(t);o.usageTracker.add(t),n.call(o,t,i,a),this[r]=i},enumerable:!0,configurable:!0})}}]),e}(),xj=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ry=function(e){return e.map(function(t){var r=t.toLowerCase();return xj.has(r)?xj.get(r):r}).sort().join("+")},p0t=function(e){return e.split("+")},jj=function(e){return e.toLowerCase()},Dj;function y0t(e){return v0t(e)||m0t(e)||gY(e)||g0t()}function g0t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function v0t(e){if(Array.isArray(e))return KC(e)}function b0t(e,t){return S0t(e)||A0t(e,t)||gY(e,t)||w0t()}function w0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gY(e,t){if(e){if(typeof e=="string")return KC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KC(e,t)}}function KC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A0t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function S0t(e){if(Array.isArray(e))return e}function C0t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var O0t=function(e){var t=Ev({errorIdExists:function(l){return'The "'.concat(l,'" shortcut is already registered in the "').concat(e,'" context.')}}),r=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=l.keys,c=l.callback,f=l.group,h=l.runOnlyIf,p=h===void 0?function(){return!0}:h,y=l.captureCtrl,m=y===void 0?!1:y,v=l.preventDefault,w=v===void 0?!0:v,C=l.stopPropagation,A=C===void 0?!1:C,D=l.relativeToGroup,E=l.position;if(he(f))throw new Error("You need to define the shortcut's group.");if(ge(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(ce(Dj||(Dj=C0t([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var G={callback:c,group:f,runOnlyIf:p,captureCtrl:m,preventDefault:w,stopPropagation:A};if(ht(D)){var K=[D,E];G.relativeToGroup=K[0],G.position=K[1]}u.forEach(function(nt){var z=ry(nt),X=t.hasItem(z);if(X){var Z=t.getItem(z),tt=Z.findIndex(function(et){return et.group===D});tt!==-1?E==="before"?tt-=1:tt+=1:tt=Z.length,Z.splice(tt,0,G)}else t.addItem(z,[G])})},n=function(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(function(c){Qt(u,function(f,h){Object.prototype.hasOwnProperty.call(c,h)===!1&&(c[h]=u[h])}),r(c)})},o=function(l){var u=ry(l);t.removeItem(u)},i=function(l){var u=t.getItems();u.forEach(function(c){var f=b0t(c,2),h=f[0],p=f[1],y=p.filter(function(m){return m.group!==l});y.length===0?o(p0t(h)):(p.length=0,p.push.apply(p,y0t(y)))})},a=function(l){var u=ry(l),c=t.getItem(u);return ht(c)?c.slice():[]},s=function(l){var u=ry(l);return t.hasItem(u)};return{addShortcut:r,addShortcuts:n,getShortcuts:a,hasShortcut:s,removeShortcutsByKeys:o,removeShortcutsByGroup:i}};function k0t(){var e=new Set;return{press:function(t){e.add(t)},release:function(t){e.delete(t)},releaseAll:function(){e.clear()},isPressed:function(t){return e.has(t)}}}var R0t=["meta","alt","shift","control"],Nc=k0t();function E0t(e,t,r,n,o){var i=function(h){return R0t.includes(h)},a=function(h){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return h.altKey&&y.push("alt"),p&&(h.ctrlKey||h.metaKey)?y.push("control/meta"):(h.ctrlKey&&y.push("control"),h.metaKey&&y.push("meta")),h.shiftKey&&y.push("shift"),y},s=function(h){if(t(h)!==!1){var p=r(h);if(!(h.keyCode===229||p===!1||Yi(h))){var y=jj(h.key),m=[];i(y)?Nc.press(y):m=a(h);var v=[y].concat(m),w=o(h,v);!w&&(Tg()&&m.includes("meta")||!Tg()&&m.includes("control"))&&o(h,[y].concat(a(h,!0))),n(h)}}},l=function(h){if(t(h)!==!1){var p=jj(h.key);i(p)!==!1&&Nc.release(p)}},u=function(){Nc.releaseAll()},c=function(){for(var h=e;h;)h.document.documentElement.addEventListener("keydown",s),h.document.documentElement.addEventListener("keyup",l),h.document.documentElement.addEventListener("blur",u),h=xf(h)},f=function(){for(var h=e;h;)h.document.documentElement.removeEventListener("keydown",s),h.document.documentElement.removeEventListener("keyup",l),h.document.documentElement.removeEventListener("blur",u),h=xf(h)};return{mount:c,unmount:f,isPressed:function(h){return Nc.isPressed(h)},releasePressedKeys:function(){return Nc.releaseAll()}}}var T0t=function(e){var t=e.ownerWindow,r=e.handleEvent,n=e.beforeKeyDown,o=e.afterKeyDown,i=Ev({errorIdExists:function(p){return'The "'.concat(p,'" context name is already registered.')}}),a="grid",s=function(p){var y=O0t(p);return i.addItem(p,y),y},l=function(){return a},u=function(p){return i.getItem(p)},c=function(p){a=p},f=!1,h=E0t(t,r,n,o,function(p,y){var m=u(l()),v=!1;if(!m.hasShortcut(y))return v;for(var w=m.getShortcuts(y),C=0;C<w.length;C++){var A=w[C],D=A.callback,E=A.runOnlyIf,G=A.preventDefault,K=A.stopPropagation,nt=A.captureCtrl;if(E(p)!==!1&&(f=nt,v=D(p,y)===!1,f=!1,G&&p.preventDefault(),K&&p.stopPropagation(),v))break}return v});return h.mount(),{addContext:s,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:function(){return!f&&(h.isPressed("control")||h.isPressed("meta"))},releasePressedKeys:function(){return h.releasePressedKeys()},destroy:function(){return h.unmount()}}},_j,Hj;function wn(e){return wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wn(e)}function Nj(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Sr(e,t){return I0t(e)||M0t(e,t)||mY(e,t)||P0t()}function P0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M0t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function I0t(e){if(Array.isArray(e))return e}function is(e){return D0t(e)||j0t(e)||mY(e)||x0t()}function x0t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mY(e,t){if(e){if(typeof e=="string")return XC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XC(e,t)}}function j0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function D0t(e){if(Array.isArray(e))return XC(e)}function XC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _0t="gridDefault",WA=null,oy=new Set;function nE(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,s=new Re(a),l,u,c,f,h=!0;Gyt(o)&&Yyt(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var p=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",y=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=zvt(t.language);var m=new yY(a,t,[l0t,d0t]),v=m.getTableMeta(),w=m.getGlobalMeta(),C=Ev();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),SC(this)&&tW(t.licenseKey,e),this.guid="ht_".concat(yR()),this.columnIndexMapper=new BC,this.rowIndexMapper=new BC,u=new ggt(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var A=function(d){var g=d.row,b=d.col;return a._createCellCoords(g>=0?a.rowIndexMapper.getRenderableFromVisualIndex(g):g,b>=0?a.columnIndexMapper.getRenderableFromVisualIndex(b):b)},D=function(d){var g=d.row,b=d.col;return a._createCellCoords(g>=0?a.rowIndexMapper.getVisualFromRenderableIndex(g):g,b>=0?a.columnIndexMapper.getVisualFromRenderableIndex(b):b)},E=new Kwt(v,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(d){return l.propToCol(d)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(d,g){return a._createCellCoords(d,g)},createCellRange:function(d,g,b){return a._createCellRange(d,g,b)},visualToRenderableCoords:A,renderableToVisualCoords:D,isDisabledCellSelection:function(d,g){return a.getCellMeta(d,g).disableVisualSelection}});this.selection=E;var G=function(d){var g=d.hiddenIndexesChanged;g&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("beforeSetRangeStart",function(d){n.runHooks("beforeSetRangeStart",d)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(d){n.runHooks("beforeSetRangeStartOnly",d)}),this.selection.addLocalHook("beforeSetRangeEnd",function(d){n.runHooks("beforeSetRangeEnd",d),d.row<0&&(d.row=n.view._wt.wtTable.getFirstVisibleRow()),d.col<0&&(d.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(d){var g=Ca(!1),b=n.selection.getSelectedRange(),O=b.current(),R=O.from,I=O.to,W=b.size()-1;n.runHooks("afterSelection",R.row,R.col,I.row,I.col,g,W),n.runHooks("afterSelectionByProp",R.row,a.colToProp(R.col),I.row,a.colToProp(I.col),g,W);var N=n.selection.isSelectedByAnyHeader(),Q=n.selection.selectedRange.current(),J=!0;i&&(J=!1),g.isTouched()&&(J=!g.value);var rt=n.selection.isSelectedByRowHeader(),mt=n.selection.isSelectedByColumnHeader();J!==!1&&(N?rt?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(d.row)):mt&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(d.col)):Q&&!n.selection.isMultiple()?n.view.scrollViewport(A(Q.from)):n.view.scrollViewport(A(d))),rt&&mt?q(n.rootElement,["ht__selection--rows","ht__selection--columns"]):rt?(Bt(n.rootElement,"ht__selection--columns"),q(n.rootElement,"ht__selection--rows")):mt?(Bt(n.rootElement,"ht__selection--rows"),q(n.rootElement,"ht__selection--columns")):Bt(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(d){var g=d.length-1,b=d[g],O=b.from,R=b.to;n.runHooks("afterSelectionEnd",O.row,O.col,R.row,R.col,g),n.runHooks("afterSelectionEndByProp",O.row,a.colToProp(O.col),R.row,a.colToProp(R.col),g)}),this.selection.addLocalHook("afterIsMultipleSelection",function(d){var g=n.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=g)}),this.selection.addLocalHook("beforeModifyTransformStart",function(d){n.runHooks("modifyTransformStart",d)}),this.selection.addLocalHook("afterModifyTransformStart",function(d,g,b){n.runHooks("afterModifyTransformStart",d,g,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(d){n.runHooks("modifyTransformEnd",d)}),this.selection.addLocalHook("afterModifyTransformEnd",function(d,g,b){n.runHooks("afterModifyTransformEnd",d,g,b)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),n._refreshBorders(),Bt(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(d){n.alter("insert_row_above",d,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(d){n.alter("insert_col_start",d,1,"auto")}),c={alter:function(d,g){var b,O,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,I=arguments.length>3?arguments[3]:void 0,W=arguments.length>4?arguments[4]:void 0,N=function(Yt){if(Yt.length===0)return[];var qt=is(Yt);qt.sort(function(Nt,Pt){var oe=Sr(Nt,1),xe=oe[0],te=Sr(Pt,1),ue=te[0];return xe===ue?0:xe>ue?1:-1});var Ht=_e(qt,function(Nt,Pt){var oe=Sr(Pt,2),xe=oe[0],te=oe[1],ue=Nt[Nt.length-1],Xe=Sr(ue,2),be=Xe[0],Ce=Xe[1],ie=be+Ce;if(xe<=ie){var kp=Math.max(te-(ie-xe),0);ue[1]+=kp}else Nt.push([xe,te]);return Nt},[qt[0]]);return Ht};switch(d){case"insert_row":oy.has(d)||(oy.add(d),de(ce(_j||(_j=Nj(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),d)));case"insert_row_below":case"insert_row_above":var Q=a.countSourceRows();if(v.maxRows===Q)return;var J=d==="insert_row_below"?"below":"above";g=(b=g)!==null&&b!==void 0?b:d==="insert_row"||J==="below"?Q:0;var rt=l.createRow(g,R,{source:I,mode:J}),mt=rt.delta,ut=rt.startPhysicalIndex;if(mt){var Ot=E.selectedRange.current(),St=Ot==null?void 0:Ot.from,Y=St==null?void 0:St.row,Ft=a.toVisualRow(ut);if(E.isSelectedByCorner())a.selectAll();else if(ht(Y)&&Y>=Ft){var Lt=Ot.to,Tt=Lt.row,Vt=Lt.col,It=St.col;E.isSelectedByRowHeader()&&(It=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(a._createCellCoords(Y+mt,It),!0),E.setRangeEnd(a._createCellCoords(Tt+mt,Vt))}else a._refreshBorders()}break;case"insert_col":oy.has(d)||(oy.add(d),de(ce(Hj||(Hj=Nj(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),d)));case"insert_col_start":case"insert_col_end":var S=d==="insert_col_end"?"end":"start";g=(O=g)!==null&&O!==void 0?O:d==="insert_col"||S==="end"?a.countSourceCols():0;var k=l.createCol(g,R,{source:I,mode:S}),M=k.delta,L=k.startPhysicalIndex;if(M){if(Array.isArray(v.colHeaders)){var j=[a.toVisualColumn(L),0];j.length+=M,Array.prototype.splice.apply(v.colHeaders,j)}var V=E.selectedRange.current(),_=V==null?void 0:V.from,H=_==null?void 0:_.col,F=a.toVisualColumn(L);if(E.isSelectedByCorner())a.selectAll();else if(ht(H)&&H>=F){var B=V.to,U=B.row,it=B.col,vt=_.row;E.isSelectedByColumnHeader()&&(vt=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(a._createCellCoords(vt,H+M),!0),E.setRangeEnd(a._createCellCoords(U,it+M))}else a._refreshBorders()}break;case"remove_row":var Rt=function(Yt){var qt=0;T(Yt,function(Ht){var Nt=Sr(Ht,2),Pt=Nt[0],oe=Nt[1],xe=Qe(Pt)?a.countRows()-1:Math.max(Pt-qt,0);Number.isInteger(Pt)&&(Pt=Math.max(Pt-qt,0));var te=l.removeRow(Pt,oe,I);if(te){var ue=a.countRows(),Xe=v.fixedRowsTop;Xe>=xe+1&&(v.fixedRowsTop-=Math.min(oe,Xe-xe));var be=v.fixedRowsBottom;be&&xe>=ue-be&&(v.fixedRowsBottom-=Math.min(oe,be)),qt+=oe}})};Array.isArray(g)?Rt(N(g)):Rt([[g,R]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var _t=function(Yt){var qt=0;T(Yt,function(Ht){var Nt=Sr(Ht,2),Pt=Nt[0],oe=Nt[1],xe=Qe(Pt)?a.countCols()-1:Math.max(Pt-qt,0),te=a.toPhysicalColumn(xe);Number.isInteger(Pt)&&(Pt=Math.max(Pt-qt,0));var ue=l.removeCol(Pt,oe,I);if(ue){var Xe=v.fixedColumnsStart;Xe>=xe+1&&(v.fixedColumnsStart-=Math.min(oe,Xe-xe)),Array.isArray(v.colHeaders)&&(typeof te>"u"&&(te=-1),v.colHeaders.splice(te,oe)),qt+=oe}})};Array.isArray(g)?_t(N(g)):_t([[g,R]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(d,'"'))}W||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var d=v.minRows,g=v.minSpareRows,b=v.minCols,O=v.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&E.deselect(),d){var R=a.countRows();R<d&&l.createRow(R,d-R,{source:"auto"})}if(g){var I=a.countEmptyRows(!0);if(I<g){var W=g-I,N=Math.min(W,v.maxRows-a.countSourceRows());l.createRow(a.countRows(),N,{source:"auto"})}}{var Q;(b||O)&&(Q=a.countEmptyCols(!0));var J=a.countCols();if(b&&!v.columns&&J<b){var rt=b-J;Q+=rt,l.createCol(J,rt,{source:"auto"})}if(O&&!v.columns&&a.dataType==="array"&&Q<O){J=a.countCols();var mt=O-Q,ut=Math.min(mt,v.maxCols-J);l.createCol(J,ut,{source:"auto"})}}if(E.isSelected()){var Ot=a.countRows(),St=a.countCols();T(E.selectedRange,function(Y){var Ft=!1,Lt=Y.from.row,Tt=Y.from.col,Vt=Y.to.row,It=Y.to.col;Lt>Ot-1?(Lt=Ot-1,Ft=!0,Vt>Lt&&(Vt=Lt)):Vt>Ot-1&&(Vt=Ot-1,Ft=!0,Lt>Vt&&(Lt=Vt)),Tt>St-1?(Tt=St-1,Ft=!0,It>Tt&&(It=Tt)):It>St-1&&(It=St-1,Ft=!0,Tt>It&&(Tt=It)),Ft&&a.selectCell(Lt,Tt,Vt,It)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(d,g,b,O,R,I,W){var N,Q,J,rt,mt=[],ut={},Ot=[],St=d.row,Y=d.col;if(Q=g.length,Q===0)return!1;var Ft=0,Lt=0;switch(zt(b)&&(Ft=b.col-Y+1,Lt=b.row-St+1),R){case"shift_down":var Tt=lf(g),Vt=Tt.length,It=Math.max(Vt,Ft),S=a.getData().slice(St),k=lf(S).slice(Y,Y+It);for(J=0;J<It;J+=1)if(J<Vt){for(N=0,Q=Tt[J].length;N<Lt-Q;N+=1)Tt[J].push(Tt[J][N%Q]);J<k.length?Ot.push(Tt[J].concat(k[J])):Ot.push(Tt[J].concat(new Array(S.length).fill(null)))}else Ot.push(Tt[J%Vt].concat(k[J]));a.populateFromArray(St,Y,lf(Ot));break;case"shift_right":var M=g.length,L=Math.max(M,Lt),j=a.getData().slice(St).map(function(be){return be.slice(Y)});for(N=0;N<L;N+=1)if(N<M){for(J=0,rt=g[N].length;J<Ft-rt;J+=1)g[N].push(g[N][J%rt]);if(N<j.length)for(var V=0;V<j[N].length;V+=1)g[N].push(j[N][V]);else{var _;(_=g[N]).push.apply(_,is(new Array(j[0].length).fill(null)))}}else g.push(g[N%Q].slice(0,L).concat(j[N]));a.populateFromArray(St,Y,g);break;case"overwrite":default:ut.row=d.row,ut.col=d.col;var H={row:b&&d?b.row-d.row+1:1,col:b&&d?b.col-d.col+1:1},F=0,B=0,U=!0,it,vt=function(be){var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ie=g[be%g.length];return Ce!==null?ie[Ce%ie.length]:ie},Rt=g.length,_t=b?b.row-d.row+1:0;for(b?Q=_t:Q=Math.max(Rt,_t),N=0;N<Q&&!(b&&ut.row>b.row&&_t>Rt||!v.allowInsertRow&&ut.row>a.countRows()-1||ut.row>=v.maxRows);N++){var Yt=N-F,qt=vt(Yt).length,Ht=b?b.col-d.col+1:0;if(b?rt=Ht:rt=Math.max(qt,Ht),ut.col=d.col,it=a.getCellMeta(ut.row,ut.col),(O==="CopyPaste.paste"||O==="Autofill.fill")&&it.skipRowOnPaste){F+=1,ut.row+=1,Q+=1;continue}for(B=0,J=0;J<rt&&!(b&&ut.col>b.col&&Ht>qt||!v.allowInsertColumn&&ut.col>a.countCols()-1||ut.col>=v.maxCols);J++){if(it=a.getCellMeta(ut.row,ut.col),(O==="CopyPaste.paste"||O==="Autofill.fill")&&it.skipColumnOnPaste){B+=1,ut.col+=1,rt+=1;continue}if(it.readOnly&&O!=="UndoRedo.undo"){ut.col+=1;continue}var Nt=J-B,Pt=vt(Yt,Nt),oe=a.getDataAtCell(ut.row,ut.col),xe={row:Yt,col:Nt};if(O==="Autofill.fill"){var te=a.runHooks("beforeAutofillInsidePopulate",xe,I,g,W,{},H);te&&(Pt=he(te.value)?Pt:te.value)}if(Pt!==null&&wn(Pt)==="object")if(Array.isArray(Pt)&&oe===null&&(oe=[]),oe===null||wn(oe)!=="object")U=!1;else{var ue=qs(Array.isArray(oe)?oe:oe[0]||oe),Xe=qs(Array.isArray(Pt)?Pt:Pt[0]||Pt);Gk(ue,Xe)||Array.isArray(ue)&&Array.isArray(Xe)?Pt=on(Pt):U=!1}else oe!==null&&wn(oe)==="object"&&(U=!1);U&&mt.push([ut.row,ut.col,Pt]),U=!0,ut.col+=1}ut.row+=1}a.setDataAtCell(mt,null,null,O||"populateFromArray");break}}};function K(d){var g=zU(d);ZR(g)?(a.runHooks("beforeLanguageChange",g),w.language=g,a.runHooks("afterLanguageChange",g)):QU(d)}function nt(d,g){var b=d==="className"?a.rootElement:a.table;if(h)q(b,g);else{var O=[],R=[];w[d]&&(O=Array.isArray(w[d])?w[d]:AS(w[d])),g&&(R=Array.isArray(g)?g:AS(g));var I=wS(O,R),W=wS(R,O);I.length&&Bt(b,I),W.length&&q(b,W)}w[d]=g}this.init=function(){u.setData(v.data),a.runHooks("beforeInit"),(cr()||Kk())&&q(a.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new igt(this),f=cst.getInstance(a,v,E),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&cW(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),wn(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function z(){var d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function X(d){var g=d.replace(",",".");return isNaN(parseFloat(g))===!1?parseFloat(g):d}function Z(d,g,b){if(d.length){var O=a.getActiveEditor(),R=a.runHooks("beforeChange",d,g||"edit"),I=!0;if(R===!1){O&&O.cancelChanges();return}var W=new z;W.onQueueEmpty=function(St){O&&I&&O.cancelChanges(),b(St)};for(var N=d.length-1;N>=0;N--)if(d[N]===null)d.splice(N,1);else{var Q=Sr(d[N],4),J=Q[0],rt=Q[1],mt=Q[3],ut=l.propToCol(rt),Ot=a.getCellMeta(J,ut);Ot.type==="numeric"&&typeof mt=="string"&&jW(mt)&&(d[N][3]=X(mt)),a.getCellValidator(Ot)&&(W.addValidatorToQueue(),a.validateCell(d[N][3],Ot,function(St,Y){return function(Ft){if(typeof Ft!="boolean")throw new Error("Validation error: result is not boolean");if(Ft===!1&&Y.allowInvalid===!1){I=!1,d.splice(St,1),Y.valid=!0;var Lt=a.getCell(Y.visualRow,Y.visualCol);Lt!==null&&Bt(Lt,v.invalidCellClassName)}W.removeValidatorFormQueue()}}(N,Ot),g))}W.checkIfQueueIsEmpty()}}function tt(d,g){var b=d.length-1;if(!(b<0)){for(;b>=0;b--){var O=!1;if(d[b]===null){d.splice(b,1);continue}if(!((d[b][2]===null||d[b][2]===void 0)&&(d[b][3]===null||d[b][3]===void 0))){if(v.allowInsertRow)for(;d[b][0]>a.countRows()-1;){var R=l.createRow(void 0,void 0,{source:g}),I=R.delta;if(I===0){O=!0;break}}if(a.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;l.propToCol(d[b][1])>a.countCols()-1;){var W=l.createCol(void 0,void 0,{source:g}),N=W.delta;if(N===0){O=!0;break}}O||l.set(d[b][0],d[b][1],d[b][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",d,g),f.lockEditor(),a._refreshBorders(null),f.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",d,g||"edit");var Q=a.getActiveEditor();Q&&ht(Q.refreshValue)&&Q.refreshValue()}}this._createCellCoords=function(d,g){return a.view._wt.createCellCoords(d,g)},this._createCellRange=function(d,g,b){return a.view._wt.createCellRange(d,g,b)},this.validateCell=function(d,g,b,O){var R=a.getCellValidator(g);function I(W){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!N||g.hidden===!0){b(W);return}var Q=g.visualCol,J=g.visualRow,rt=a.getCell(J,Q,!0);if(rt&&rt.nodeName!=="TH"){var mt=a.rowIndexMapper.getRenderableFromVisualIndex(J),ut=a.columnIndexMapper.getRenderableFromVisualIndex(Q);a.view._wt.getSetting("cellRenderer",mt,ut,rt)}b(W)}$F(R)&&(R=function(W){return function(N,Q){Q(W.test(N))}}(R)),ge(R)?(d=a.runHooks("beforeValidate",d,g.visualRow,g.prop,O),a._registerImmediate(function(){R.call(g,d,function(W){a&&(W=a.runHooks("afterValidate",W,d,g.visualRow,g.prop,O),g.valid=W,I(W),a.runHooks("postAfterValidate",W,d,g.visualRow,g.prop,O))})})):a._registerImmediate(function(){g.valid=!0,I(g.valid,!1)})};function et(d,g,b){return Array.isArray(d)?d:[[d,g,b]]}this.setDataAtCell=function(d,g,b,O){var R=et(d,g,b),I=[],W=O,N,Q,J;for(N=0,Q=R.length;N<Q;N++){if(wn(R[N])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[N][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[N][1]>=this.countCols()?J=R[N][1]:J=l.colToProp(R[N][1]),I.push([R[N][0],J,u.getAtCell(this.toPhysicalRow(R[N][0]),R[N][1]),R[N][2]])}!W&&wn(d)==="object"&&(W=g),a.runHooks("afterSetDataAtCell",I,W),Z(I,W,function(){tt(I,W)})},this.setDataAtRowProp=function(d,g,b,O){var R=et(d,g,b),I=[],W=O,N,Q;for(N=0,Q=R.length;N<Q;N++)I.push([R[N][0],R[N][1],u.getAtCell(this.toPhysicalRow(R[N][0]),R[N][1]),R[N][2]]);!W&&wn(d)==="object"&&(W=g),a.runHooks("afterSetDataAtRowProp",I,W),Z(I,W,function(){tt(I,W)})},this.listen=function(){a&&!a.isListening()&&(WA=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(WA=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return WA===a.guid},this.destroyEditor=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(d,g)},this.populateFromArray=function(d,g,b,O,R,I,W,N,Q){if(!(wn(b)==="object"&&wn(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var J=typeof O=="number"?a._createCellCoords(O,R):null;return c.populateFromArray(a._createCellCoords(d,g),b,J,I,W,N,Q)},this.spliceCol=function(d,g,b){for(var O,R=arguments.length,I=new Array(R>3?R-3:0),W=3;W<R;W++)I[W-3]=arguments[W];return(O=l).spliceCol.apply(O,[d,g,b].concat(I))},this.spliceRow=function(d,g,b){for(var O,R=arguments.length,I=new Array(R>3?R-3:0),W=3;W<R;W++)I[W-3]=arguments[W];return(O=l).spliceRow.apply(O,[d,g,b].concat(I))},this.getSelected=function(){if(E.isSelected())return Gt(E.getSelectedRange(),function(d){var g=d.from,b=d.to;return[g.row,g.col,b.row,b.col]})},this.getSelectedLast=function(){var d=this.getSelected(),g;return d&&d.length>0&&(g=d[d.length-1]),g},this.getSelectedRange=function(){if(E.isSelected())return Array.from(E.getSelectedRange())},this.getSelectedRangeLast=function(){var d=this.getSelectedRange(),g;return d&&d.length>0&&(g=d[d.length-1]),g},this.emptySelectedCells=function(d){var g=this;if(!(!E.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];T(E.getSelectedRange(),function(O){var R=O.getTopStartCorner(),I=O.getBottomEndCorner();Ct(R.row,I.row,function(W){Ct(R.col,I.col,function(N){g.getCellMeta(W,N).readOnly||b.push([W,N,null])})})}),b.length>0&&this.setDataAtCell(b,d)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(d){this.suspendRender();var g=d();return this.resumeRender(),g},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(g,0),(!this.isExecutionSuspended()&&g===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=d();return this.resumeExecution(g),b},this.batch=function(d){this.suspendRender(),this.suspendExecution();var g=d();return this.resumeExecution(),this.resumeRender(),g},this.refreshDimensions=function(){if(a.view){var d=a.view.getLastSize(),g=d.width,b=d.height,O=a.rootElement.getBoundingClientRect(),R=O.width,I=O.height,W=R!==g||I!==b,N=a.runHooks("beforeRefreshDimensions",{width:g,height:b},{width:R,height:I},W)===!1;N||((W||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(R,I),a.render()),a.runHooks("afterRefreshDimensions",{width:g,height:b},{width:R,height:I},W))}},this.updateData=function(d,g){var b=this;Pj(d,function(O){l=O},function(O){l=O,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"updateData",source:g,metaManager:m,firstRun:h})},this.loadData=function(d,g){Pj(d,function(b){l=b},function(){m.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"loadData",source:g,metaManager:m,firstRun:h})},this.getInitialColumnCount=function(){var d=v.columns,g=0;if(Array.isArray(d))g=d.length;else if(ge(d))if(a.dataType==="array")for(var b=this.countSourceCols(),O=0;O<b;O+=1)d(O)&&(g+=1);else(a.dataType==="object"||a.dataType==="function")&&(g=l.colToPropCache.length);else if(ht(v.dataSchema)){var R=l.getSchema();g=Array.isArray(R)?R.length:uv(R)}else g=this.countSourceCols();return g},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,g,b,O){return he(d)?l.getAll():l.getRange(a._createCellCoords(d,g),a._createCellCoords(b,O),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,g,b,O){return l.getCopyableText(a._createCellCoords(d,g),a._createCellCoords(b,O))},this.getCopyableData=function(d,g){return l.getCopyable(d,l.colToProp(g))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),O=!1,R,I;if(ht(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ht(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ht(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in d)R==="data"||(R==="language"?K(d.language):R==="className"?nt("className",d.className):R==="tableClassName"&&a.table?(nt("tableClassName",d.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):gt.getSingleton().isRegistered(R)||gt.getSingleton().isDeprecated(R)?(ge(d[R])||Array.isArray(d[R]))&&(d[R].initialHook=!0,a.addHook(R,d[R])):!g&&Te(d,R)&&(w[R]=d[R]));d.data===void 0&&v.data===void 0?b(null,"updateSettings"):d.data!==void 0?b(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),a.initIndexMappers());var W=a.countCols(),N=v.columns;if(N&&ge(N)&&(O=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&m.clearCache(),W>0)for(R=0,I=0;R<W;R++){if(N){var Q=O?N(R):N[I];Q&&m.updateColumnMeta(I,Q)}I+=1}ht(d.cell)&&Qt(d.cell,function(St){a.setCellMetaObject(St.row,St.col,St)}),a.runHooks("afterCellMetaReset");var J=a.rootElement.style.height;J!==""&&(J=parseInt(a.rootElement.style.height,10));var rt=d.height;if(ge(rt)&&(rt=rt()),g){var mt=a.rootElement.getAttribute("style");mt&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(rt===null){var ut=a.rootElement.getAttribute("data-initialstyle");ut&&(ut.indexOf("height")>-1||ut.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",ut):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else rt!==void 0&&(a.rootElement.style.height=isNaN(rt)?"".concat(rt):"".concat(rt,"px"),a.rootElement.style.overflow="hidden");if(typeof d.width<"u"){var Ot=d.width;ge(Ot)&&(Ot=Ot()),a.rootElement.style.width=isNaN(Ot)?"".concat(Ot):"".concat(Ot,"px")}g||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,f.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!g&&a.view&&(J===""||rt===""||rt===void 0)&&J!==rt&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var d=a.getSelectedLast();if(v.getValue){if(ge(v.getValue))return v.getValue.call(a);if(d)return a.getData()[d[0][0]][v.getValue]}else if(d)return a.getDataAtCell(d[0],d[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,g,b,O,R){c.alter(d,g,b,O,R)},this.getCell=function(d,g){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=g,R=d;if(g>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(g)))return null;O=this.columnIndexMapper.getRenderableFromVisualIndex(g)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return R===null||O===null?null:a.view.getCellAtCoords(a._createCellCoords(R,O),b)},this.getCoords=function(d){var g=this.view._wt.wtTable.getCoords(d);if(g===null)return null;var b=g.row,O=g.col,R=b,I=O;return b>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(b)),O>=0&&(I=this.columnIndexMapper.getVisualFromRenderableIndex(O)),a._createCellCoords(R,I)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=function(d){return n.rowIndexMapper.getVisualFromPhysicalIndex(d)},this.toVisualColumn=function(d){return n.columnIndexMapper.getVisualFromPhysicalIndex(d)},this.toPhysicalRow=function(d){return n.rowIndexMapper.getPhysicalFromVisualIndex(d)},this.toPhysicalColumn=function(d){return n.columnIndexMapper.getPhysicalFromVisualIndex(d)},this.getDataAtCell=function(d,g){return l.get(d,l.colToProp(g))},this.getDataAtRowProp=function(d,g){return l.get(d,g)},this.getDataAtCol=function(d){for(var g=[],b=l.getRange(a._createCellCoords(0,d),a._createCellCoords(v.data.length-1,d),l.DESTINATION_RENDERER),O=0;O<b.length;O+=1)for(var R=0;R<b[O].length;R+=1)g.push(b[O][R]);return g},this.getDataAtProp=function(d){for(var g=[],b=l.getRange(a._createCellCoords(0,l.propToCol(d)),a._createCellCoords(v.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER),O=0;O<b.length;O+=1)for(var R=0;R<b[O].length;R+=1)g.push(b[O][R]);return g},this.getSourceData=function(d,g,b,O){var R;return d===void 0?R=u.getData():R=u.getByRange(a._createCellCoords(d,g),a._createCellCoords(b,O)),R},this.getSourceDataArray=function(d,g,b,O){var R;return d===void 0?R=u.getData(!0):R=u.getByRange(a._createCellCoords(d,g),a._createCellCoords(b,O),!0),R},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,g,b,O){var R=et(d,g,b),I=this.hasHook("afterSetSourceDataAtCell"),W=[];I&&T(R,function(Q){var J=Sr(Q,3),rt=J[0],mt=J[1],ut=J[2];W.push([rt,mt,u.getAtCell(rt,mt),ut])}),T(R,function(Q){var J=Sr(Q,3),rt=J[0],mt=J[1],ut=J[2];u.setAtCell(rt,mt,ut)}),I&&this.runHooks("afterSetSourceDataAtCell",W,O),this.render();var N=a.getActiveEditor();N&&ht(N.refreshValue)&&N.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,g){return u.getAtCell(d,g)},this.getDataAtRow=function(d){var g=l.getRange(a._createCellCoords(d,0),a._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER);return g[0]||[]},this.getDataType=function(d,g,b,O){var R=this,I=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,g,b,O],W=I[0],N=I[1],Q=I[2],J=I[3],rt=null,mt=null;Q===void 0&&(Q=W),J===void 0&&(J=N);var ut="mixed";return Ct(Math.max(Math.min(W,Q),0),Math.max(W,Q),function(Ot){var St=!0;return Ct(Math.max(Math.min(N,J),0),Math.max(N,J),function(Y){var Ft=R.getCellMeta(Ot,Y);return mt=Ft.type,rt?St=rt===mt:rt=mt,St}),ut=St?mt:"mixed",St}),ut},this.removeCellMeta=function(d,g,b){var O=[this.toPhysicalRow(d),this.toPhysicalColumn(g)],R=O[0],I=O[1],W=m.getCellMetaKeyValue(R,I,b),N=a.runHooks("beforeRemoveCellMeta",d,g,b,W);N!==!1&&(m.removeCellMeta(R,I,b),a.runHooks("afterRemoveCellMeta",d,g,b,W)),W=null},this.spliceCellsMeta=function(d){for(var g=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,O=arguments.length,R=new Array(O>2?O-2:0),I=2;I<O;I++)R[I-2]=arguments[I];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&m.removeRow(this.toPhysicalRow(d),b),R.length>0&&T(R.reverse(),function(W){m.createRow(g.toPhysicalRow(d)),T(W,function(N,Q){return g.setCellMetaObject(d,Q,N)})}),a.render()},this.setCellMetaObject=function(d,g,b){var O=this;wn(b)==="object"&&Qt(b,function(R,I){O.setCellMeta(d,g,I,R)})},this.setCellMeta=function(d,g,b,O){var R=a.runHooks("beforeSetCellMeta",d,g,b,O);if(R!==!1){var I=d,W=g;d<this.countRows()&&(I=this.toPhysicalRow(d)),g<this.countCols()&&(W=this.toPhysicalColumn(g)),m.setCellMeta(I,W,b,O),a.runHooks("afterSetCellMeta",d,g,b,O)}},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(d,g){var b=this.toPhysicalRow(d),O=this.toPhysicalColumn(g);return b===null&&(b=d),O===null&&(O=g),m.getCellMeta(b,O,{visualRow:d,visualColumn:g})},this.getCellMetaAtRow=function(d){return m.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||v.columns)},this.getCellRenderer=function(d,g){var b=typeof d=="number"?a.getCellMeta(d,g).renderer:d.renderer;return typeof b=="string"?Fg(b):he(b)?Fg("text"):b},this.getCellEditor=function(d,g){var b=typeof d=="number"?a.getCellMeta(d,g).editor:d.editor;return typeof b=="string"?Lg(b):he(b)?Lg("text"):b},this.getCellValidator=function(d,g){var b=typeof d=="number"?a.getCellMeta(d,g).validator:d.validator;return typeof b=="string"?TR(b):b},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,g){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(g,d)},this.validateColumns=function(d,g){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(g,void 0,d)},this._validateCells=function(d,g,b){var O=new z;d&&(O.onQueueEmpty=d);for(var R=a.countRows()-1;R>=0;){if(g!==void 0&&g.indexOf(R)===-1){R-=1;continue}for(var I=a.countCols()-1;I>=0;){if(b!==void 0&&b.indexOf(I)===-1){I-=1;continue}O.addValidatorToQueue(),a.validateCell(a.getDataAtCell(R,I),a.getCellMeta(R,I),function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&(O.valid=!1),O.removeValidatorFormQueue()},"validateCells"),I-=1}R-=1}O.checkIfQueueIsEmpty()},this.getRowHeader=function(d){var g=v.rowHeaders,b=d;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(g=[],Ct(a.countRows()-1,function(O){g.push(a.getRowHeader(O))})):Array.isArray(g)&&g[b]!==void 0?g=g[b]:ge(g)?g=g(b):g&&typeof g!="string"&&typeof g!="number"&&(g=b+1),g},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(var d=0,g=a.countCols();d<g;d++)if(a.getColHeader(d))return!0;return!1},this.getColHeader=function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",d);if(b===void 0){for(var O=[],R=a.countCols(),I=0;I<R;I++)O.push(a.getColHeader(I));return O}var W=v.colHeaders,N=function(rt){for(var mt=[],ut=a.countCols(),Ot=0;Ot<ut;Ot++)ge(v.columns)&&v.columns(Ot)&&mt.push(Ot);return mt[rt]},Q=a.toPhysicalColumn(b),J=N(Q);return v.colHeaders===!1?W=null:v.columns&&ge(v.columns)&&v.columns(J)&&v.columns(J).title?W=v.columns(J).title:v.columns&&v.columns[Q]&&v.columns[Q].title?W=v.columns[Q].title:Array.isArray(v.colHeaders)&&v.colHeaders[Q]!==void 0?W=v.colHeaders[Q]:ge(v.colHeaders)?W=v.colHeaders(Q):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(W=Tv(b)),W=a.runHooks("modifyColumnHeaderValue",W,d,g),W},this._getColWidthFromSettings=function(d){var g;if(d>=0){var b=a.getCellMeta(0,d);g=b.width}if((g===void 0||g===v.width)&&(g=v.colWidths),g!=null){switch(wn(g)){case"object":g=g[d];break;case"function":g=g(d);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getColWidth=function(d){var g=a._getColWidthFromSettings(d);return g=a.runHooks("modifyColWidth",g,d),g===void 0&&(g=PR.DEFAULT_WIDTH),g},this._getRowHeightFromSettings=function(d){var g=v.rowHeights;if(g!=null){switch(wn(g)){case"object":g=g[d];break;case"function":g=g(d);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getRowHeight=function(d){var g=a._getRowHeightFromSettings(d);return g=a.runHooks("modifyRowHeight",g,d),g},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var d=v.maxCols,g=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,g)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return Vg(a.countRows()-1,function(b){if(a.isEmptyRow(b))g+=1;else if(d===!0)return!1}),g},this.countEmptyCols=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return Vg(a.countCols()-1,function(b){if(a.isEmptyCol(b))g+=1;else if(d===!0)return!1}),g},this.isEmptyRow=function(d){return v.isEmptyRow.call(a,d)},this.isEmptyCol=function(d){return v.isEmptyCol.call(a,d)},this.selectCell=function(d,g,b,O){var R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return he(d)||he(g)?!1:this.selectCells([[d,g,b,O]],R,I)},this.selectCells=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g===!1&&(i=!0);var O=E.selectCells(d);return O&&b&&a.listen(),i=!1,O},this.selectColumns=function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;return E.selectColumns(d,g)},this.selectRows=function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;return E.selectRows(d,g)},this.deselectCell=function(){E.deselect()},this.selectAll=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,g=d&&this.hasRowHeaders(),b=d&&this.hasColHeaders();i=!0,E.selectAll(g,b),i=!1};var bt=function(d,g){return d.getNearestNotHiddenIndex(g,1,!0)};this.scrollViewportTo=function(d,g){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=!b,W=!O,N=d,Q=g;if(R){var J=Number.isInteger(d),rt=Number.isInteger(g),mt=J?bt(this.rowIndexMapper,d):void 0,ut=rt?bt(this.columnIndexMapper,g):void 0;if(mt===null||ut===null)return!1;N=J?a.rowIndexMapper.getRenderableFromVisualIndex(mt):void 0,Q=rt?a.columnIndexMapper.getRenderableFromVisualIndex(ut):void 0}var Ot=Number.isInteger(N),St=Number.isInteger(Q);return Ot&&St?a.view.scrollViewport(a._createCellCoords(N,Q),I,O,b,W):Ot&&St===!1?a.view.scrollViewportVertically(N,I,b):St&&Ot===!1?a.view.scrollViewportHorizontally(Q,O,W):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),m.clearCache(),SC(a)){var d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}yr(a.rootElement),s.destroy(),f&&f.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),C.getItems().forEach(function(g){var b=Sr(g,2),O=b[1];O.destroy()}),C.clear(),a.runHooks("afterDestroy")},!0),gt.getSingleton().destroy(a),Qt(a,function(g,b,O){ge(g)?O[b]=yt(b):b!=="guid"&&(O[b]=null)}),a.isDestroyed=!0,l&&l.destroy(),a.rowIndexMapper=null,a.columnIndexMapper=null,l=null,c=null,E=null,f=null,a=null};function yt(d){return function(){throw new Error('The "'.concat(d,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(d){var g=kn(d);return g==="UndoRedo"?this.undoRedo:C.getItem(g)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(d)},this.getInstance=function(){return a},this.addHook=function(d,g){gt.getSingleton().add(d,g,a)},this.hasHook=function(d){return gt.getSingleton().has(d,a)||gt.getSingleton().has(d)},this.addHookOnce=function(d,g){gt.getSingleton().once(d,g,a)},this.removeHook=function(d,g){gt.getSingleton().remove(d,g,a)},this.runHooks=function(d,g,b,O,R,I,W){return gt.getSingleton().run(a,d,g,b,O,R,I,W)},this.getTranslatedPhrase=function(d,g){return $U(v.language,d,g)},this.toHTML=function(){return QS(n)},this.toTableElement=function(){var d=n.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",QS(n)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=d;typeof b=="function"&&(b=setTimeout(b,g)),this.timeouts.push(b)},this._clearTimeouts=function(){T(this.timeouts,function(d){clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){T(this.immediates,function(d){clearImmediate(d)})},this._refreshBorders=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(d),a.view.render(),g&&E.isSelected()&&f.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var kt=T0t({handleEvent:function(d){var g=a.isListening(),b=(d==null?void 0:d.key)!==void 0;return g&&b},beforeKeyDown:function(d){return n.runHooks("beforeKeyDown",d)},afterKeyDown:function(d){n.isDestroyed||a.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(d){d.ctrlKey===!1&&d.metaKey===!1&&kt.releasePressedKeys()}),this.getShortcutManager=function(){return kt};var Et=kt.addContext("grid"),P={runOnlyIf:function(){return ht(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:_0t};kt.setActiveContextName("grid"),Et.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var d=a.getSelectedRange(),g=d[d.length-1].highlight,b=g.row,O=g.col,R=a.getDataAtCell(b,O),I=new Map,W=0;W<d.length;W++)d[W].forAll(function(N,Q){if(N>=0&&Q>=0&&(N!==b||Q!==O)){var J=a.getCellMeta(N,Q),rt=J.readOnly;rt||I.set("".concat(N,"x").concat(Q),[N,Q,R])}});a.setDataAtCell(Array.from(I.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){E.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){E.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var d=a.getSelectedRangeLast(),g=d.from,b=d.to,O=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);E.setRangeStart(g.clone()),E.setRangeEnd(a._createCellCoords(O,b.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){E.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){E.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var d=a.getSelectedRangeLast(),g=d.from,b=d.to,O=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);E.setRangeStart(g.clone()),E.setRangeEnd(a._createCellCoords(O,b.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){E.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var d,g=a.getSelectedRangeLast().highlight.row,b=(d=a.columnIndexMapper).getNearestNotHiddenIndex.apply(d,is(a.isRtl()?[a.countCols()-1,-1]:[0,1]));E.setRangeStart(a._createCellCoords(g,b))}},{keys:[["ArrowLeft","Shift"]],callback:function(){E.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var d,g=a.getSelectedRangeLast(),b=g.from,O=g.to,R=(d=a.columnIndexMapper).getNearestNotHiddenIndex.apply(d,is(a.isRtl()?[a.countCols()-1,-1]:[0,1]));E.setRangeStart(b.clone()),E.setRangeEnd(a._createCellCoords(O.row,R))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){E.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var d,g=a.getSelectedRangeLast().highlight.row,b=(d=a.columnIndexMapper).getNearestNotHiddenIndex.apply(d,is(a.isRtl()?[0,1]:[a.countCols()-1,-1]));E.setRangeStart(a._createCellCoords(g,b))}},{keys:[["ArrowRight","Shift"]],callback:function(){E.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var d,g=a.getSelectedRangeLast(),b=g.from,O=g.to,R=(d=a.columnIndexMapper).getNearestNotHiddenIndex.apply(d,is(a.isRtl()?[0,1]:[a.countCols()-1,-1]));E.setRangeStart(b.clone()),E.setRangeEnd(a._createCellCoords(O.row,R))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var d=parseInt(a.getSettings().fixedColumnsStart,10),g=a.getSelectedRangeLast().highlight.row,b=a.columnIndexMapper.getNearestNotHiddenIndex(d,1);E.setRangeStart(a._createCellCoords(g,b))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){E.setRangeEnd(a._createCellCoords(E.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var d=parseInt(a.getSettings().fixedRowsTop,10),g=parseInt(a.getSettings().fixedColumnsStart,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(d,1),O=a.columnIndexMapper.getNearestNotHiddenIndex(g,1);E.setRangeStart(a._createCellCoords(b,O))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){E.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){E.setRangeEnd(a._createCellCoords(E.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var d=parseInt(a.getSettings().fixedRowsBottom,10),g=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-d-1,-1),b=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);E.setRangeStart(a._createCellCoords(g,b))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){E.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var d=a.getSelectedRangeLast(),g=d.to,b=Math.max(g.row-a.countVisibleRows(),0),O=a.rowIndexMapper.getNearestNotHiddenIndex(b,1);if(O!==null){var R=a._createCellCoords(O,g.col),I=g.row-a.view.getFirstFullyVisibleRow(),W=Math.max(R.row-I,0);E.setRangeEnd(R),a.scrollViewportTo(W)}}},{keys:[["PageDown"]],callback:function(){E.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var d=a.getSelectedRangeLast(),g=d.to,b=Math.min(g.row+a.countVisibleRows(),a.countRows()-1),O=a.rowIndexMapper.getNearestNotHiddenIndex(b,-1);if(O!==null){var R=a._createCellCoords(O,g.col),I=g.row-a.view.getFirstFullyVisibleRow(),W=Math.min(R.row-I,a.countRows()-1);E.setRangeEnd(R),a.scrollViewportTo(W)}}},{keys:[["Tab"]],callback:function(d){var g=typeof v.tabMoves=="function"?v.tabMoves(d):v.tabMoves;E.transformStart(g.row,g.col,!0)}},{keys:[["Shift","Tab"]],callback:function(d){var g=typeof v.tabMoves=="function"?v.tabMoves(d):v.tabMoves;E.transformStart(-g.row,-g.col)}}],P),ER().forEach(function(d){var g=lp(d);C.addItem(d,new g(n))}),gt.getSingleton().run(a,"construct")}var H0t="hooksRefRegisterer",vY={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;T(this._hooksStorage[e]||[],function(r){t.hot.removeHook(e,r)})},clearHooks:function(){var e=this;Qt(this._hooksStorage,function(t,r){return e.removeHooksByKey(r)}),this._hooksStorage={}}};Br(vY,"MIXIN_NAME",H0t,{writable:!1,enumerable:!1});const N0t=vY;function Dl(e){return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dl(e)}function B0t(e,t){return W0t(e)||F0t(e,t)||V0t(e,t)||L0t()}function L0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V0t(e,t){if(e){if(typeof e=="string")return Bj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bj(e,t)}}function Bj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function F0t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function W0t(e){if(Array.isArray(e))return e}function U0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JC(e,t)}function JC(e,t){return JC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},JC(e,t)}function Y0t(e){var t=Q0t();return function(){var r=bm(e),n;if(t){var o=bm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return G0t(this,n)}}function G0t(e,t){if(t&&(Dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z0t(e)}function z0t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q0t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bm(e){return bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bm(e)}function Lj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K0t(n.key),n)}}function Fj(e,t,r){return t&&Vj(e.prototype,t),r&&Vj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K0t(e){var t=X0t(e,"string");return Dl(t)==="symbol"?t:String(t)}function X0t(e,t){if(Dl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J0t="base",$e=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),ZC="baseEditor",gc=function(){function e(t){Lj(this,e),this.hot=t,this.instance=t,this.state=$e.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return Fj(e,[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,r,n,o,i,a){this.TD=o,this.row=t,this.col=r,this.prop=n,this.originalValue=i,this.cellProperties=a,this.state=$e.VIRGIN}},{key:"extend",value:function(){return function(t){U0t(n,t);var r=Y0t(n);function n(){return Lj(this,n),r.apply(this,arguments)}return Fj(n)}(this.constructor)}},{key:"saveValue",value:function(t,r){var n=this,o,i,a,s;if(r){var l=this.hot.getSelectedLast();o=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),a=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else{var u=[this.row,this.col,null,null];o=u[0],i=u[1],a=u[2],s=u[3]}var c=this.hot.runHooks("modifyGetCellCoords",o,i);if(Array.isArray(c)){var f=B0t(c,2);o=f[0],i=f[1]}var h=this.hot.getShortcutManager(),p=h.getContext("editor"),y={runOnlyIf:function(){return ht(n.hot.getSelected())},group:ZC};this.isInFullEditMode()&&p.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.hot.selection.transformStart(0,-1*n.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.hot.selection.transformStart(0,n.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(o,i,t,a,s,"edit")}},{key:"beginEditing",value:function(t,r){if(this.state===$e.VIRGIN){var n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,i)),this.state=$e.EDITING,this.isInFullEditMode()){var a=typeof t=="string"?t:Pe(this.originalValue);this.setValue(a)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,r,n){var o=this,i;if(n){var a=this._closeCallback;this._closeCallback=function(c){a&&a(c),n(c),o.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),l=s.getContext("editor");if(l.removeShortcutsByGroup(ZC),l.removeShortcutsByGroup(Rv),this.state===$e.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===$e.EDITING){if(t){this.cancelChanges(),this.hot.view.render();return}var u=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof u=="string"?String.prototype.trim.call(u||""):u]]:i=[[u]],this.state=$e.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){o.state=$e.FINISHED,o.discardEditor(c)}):(this.state=$e.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=$e.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){if(this.state===$e.FINISHED)if(t===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=$e.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=$e.VIRGIN,this._fireCallbacks(!0);var r=this.hot.getShortcutManager();r.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===$e.WAITING}},{key:"getEditedCellRect",value:function(){var t,r=this.getEditedCell();if(r){var n=this.hot.view._wt,o=n.wtOverlays,i=n.wtViewport,a=this.hot.rootWindow,s=Le(r),l=fe(r),u=Le(this.hot.rootElement),c=fe(this.hot.rootElement),f=o.topOverlay.holder,h=o.inlineStartOverlay.holder,p=f!==a?f.scrollTop:0,y=h!==a?h.scrollLeft:0,m=a.innerWidth-u.left-c,v=(t=o.getParentOverlay(r))!==null&&t!==void 0?t:this.hot.view._wt,w=v.wtTable,C=w.name,A=["master","inline_start"].includes(C)?p:0,D=["master","top","bottom"].includes(C)?y:0,E=s.top===u.top?0:1,G=s.top-u.top-E-A,K=0;this.hot.isRtl()?K=a.innerWidth-s.left-l-m-1+D:K=s.left-u.left-1-D,["top","top_inline_start_corner"].includes(C)&&(G+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(K+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var nt=this.hot.hasColHeaders(),z=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),X=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Z=this.hot.rowIndexMapper.getRenderableIndexesLength(),tt=Z-this.hot.view._wt.getSetting("fixedRowsBottom");(nt&&z<=0||z===tt)&&(G+=1),X<=0&&(K+=1);var et=i.rowsRenderCalculator.startPosition,bt=i.columnsRenderCalculator.startPosition,yt=Math.abs(o.inlineStartOverlay.getScrollPosition()),kt=o.topOverlay.getScrollPosition(),Et=qe(this.hot.rootDocument),P=r.offsetTop+et-kt,d=0;if(this.hot.isRtl()){var g=r.offsetLeft;g>=0?d=w.getWidth()-r.offsetLeft:d=Math.abs(g),d+=bt-yt-l}else d=r.offsetLeft+bt-yt;var b=vi(this.TD,this.hot.rootWindow),O=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",R=parseInt(b[O],10)>0?0:1,I=parseInt(b.borderTopWidth,10)>0?0:1,W=fe(r)+R,N=ke(r)+I,Q=sW(f)?Et:0,J=lW(h)?Et:0,rt=this.hot.view.maximumVisibleElementWidth(d)-Q+R,mt=Math.max(this.hot.view.maximumVisibleElementHeight(P)-J+I,23);return{top:G,start:K,height:N,maxHeight:mt,width:W,maxWidth:rt}}}},{key:"getEditedCellsLayerClass",value:function(){var t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}],[{key:"EDITOR_TYPE",get:function(){return J0t}}]),e}();pe(gc,N0t);function Z0t(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(h,p,y){h.addEventListener(p,y,!1)},a=function(h,p,y){h.removeEventListener(p,y,!1)},s=function(h){var p,y;h?/^[a-zA-Z \.,\\\/\|0-9]$/.test(h)||(h="."):h="",n.textContent!==void 0?n.textContent=t.value+h:n.data=t.value+h,o.style.position="absolute",o.style.fontSize=f(t).fontSize,o.style.fontFamily=f(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),p=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>p?t.style.width=e.minWidth+"px":p>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=p+"px",y=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>y?t.style.height=e.minHeight+"px":e.maxHeight<y?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=y+"px"},l=function(){window.setTimeout(s,0)},u=function(h){if(h&&h.minHeight)if(h.minHeight=="inherit")e.minHeight=t.clientHeight;else{var p=parseInt(h.minHeight);isNaN(p)||(e.minHeight=p)}if(h&&h.maxHeight)if(h.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var y=parseInt(h.maxHeight);isNaN(y)||(e.maxHeight=y)}if(h&&h.minWidth)if(h.minWidth=="inherit")e.minWidth=t.clientWidth;else{var m=parseInt(h.minWidth);isNaN(m)||(e.minWidth=m)}if(h&&h.maxWidth)if(h.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var v=parseInt(h.maxWidth);isNaN(v)||(e.maxWidth=v)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},c=function(h,p,y){t=h,u(p),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),y&&(i(t,"change",s),i(t,"cut",l),i(t,"paste",l),i(t,"drop",l),i(t,"keydown",l),i(t,"focus",s),i(t,"compositionstart",l),i(t,"compositionupdate",l),i(t,"compositionend",l)),s()};function f(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(h,p,y){c(h,p,y)},unObserve:function(){a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)},resize:s}}function Wj(e,t){for(var r=bR(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var s=n[a];a!==0&&(i+=n[a-1].length+1);var l=i+s.length;if(e==="home"?o=i:e==="end"&&(o=l),r<=l)break}op(t,o)}function _l(e){return _l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_l(e)}function Uj(e,t){return eSt(e)||tSt(e,t)||$0t(e,t)||q0t()}function q0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $0t(e,t){if(e){if(typeof e=="string")return Yj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yj(e,t)}}function Yj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tSt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function eSt(e){if(Array.isArray(e))return e}function nSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oSt(n.key),n)}}function rSt(e,t,r){return t&&Gj(e.prototype,t),r&&Gj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oSt(e){var t=iSt(e,"string");return _l(t)==="symbol"?t:String(t)}function iSt(e,t){if(_l(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_l(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vf(){return typeof Reflect<"u"&&Reflect.get?vf=Reflect.get.bind():vf=function(e,t,r){var n=aSt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},vf.apply(this,arguments)}function aSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ma(e),e!==null););return e}function sSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qC(e,t)}function qC(e,t){return qC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},qC(e,t)}function lSt(e){var t=cSt();return function(){var r=Ma(e),n;if(t){var o=Ma(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uSt(this,n)}}function uSt(e,t){if(t&&(_l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bY(e)}function bY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ma(e){return Ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ma(e)}var fSt="ht_editor_visible",iy="ht_editor_hidden",zj="textEditor",hSt="text",za=function(e){sSt(r,e);var t=lSt(r);function r(n){var o;return nSt(this,r),o=t.call(this,n),o.eventManager=new Re(bY(o)),o.autoResize=Z0t(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return rSt(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(n){this.TEXTAREA.value=n}},{key:"open",value:function(){var n=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(i){return n.onAfterDocumentKeyDown(i)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(n,o,i,a,s,l){var u=this.state;if(vf(Ma(r.prototype),"prepare",this).call(this,n,o,i,a,s,l),!l.readOnly){this.refreshDimensions(!0);var c=l.allowInvalid,f=l.fragmentSelection;c&&(this.TEXTAREA.value=""),u!==$e.FINISHED&&this.hideEditableElement();var h=!f;h&&!cr()&&this.focus()}}},{key:"beginEditing",value:function(n,o){this.state===$e.VIRGIN&&(this.TEXTAREA.value="",vf(Ma(r.prototype),"beginEditing",this).call(this,n,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),op(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var n=this.hot.rootDocument;this.TEXTAREA=n.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=n.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),Dt(this.TEXTAREA_PARENT,this.layerClass)&&Bt(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,iy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(nF()||eF())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Bt(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,iy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var n=this.TEXTAREA_PARENT.childNodes,o=!1;Ct(n.length-1,function(i){var a=n[i];if(Dt(a,"handsontableEditor"))return o=!0,!1}),Dt(this.TEXTAREA_PARENT,iy)&&Bt(this.TEXTAREA_PARENT,iy),o?(this.layerClass=fSt,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var n=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(n,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==$e.EDITING&&!n)){if(this.TD=this.getEditedCell(),!this.TD){n||this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,s=o.width,l=o.maxWidth,u=o.height,c=o.maxHeight;this.textareaParentStyle.top="".concat(i,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),this.showEditableElement();var f=vi(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=f.fontSize,this.TEXTAREA.style.fontFamily=f.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var h=vi(this.TEXTAREA),p=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),y=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),m=s-p,v=u-y,w=l-p,C=c-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,w),minHeight:Math.min(v,C),maxWidth:w,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var n=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),Qk()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return n.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return n.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return n.refreshDimensions()}),this.addHook("afterColumnResize",function(){n.refreshDimensions(),n.focus()}),this.addHook("afterRowResize",function(){n.refreshDimensions(),n.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var n=this,o=this.hot.getShortcutManager(),i=o.getContext("editor"),a={runOnlyIf:function(){return ht(n.hot.getSelected())},group:zj},s=function(){n.hot.rootDocument.execCommand("insertText",!1,`
`)};i.addShortcuts([{keys:[["Tab"]],callback:function(l){var u=n.hot.getSettings(),c=typeof u.tabMoves=="function"?u.tabMoves(l):u.tabMoves;n.hot.selection.transformStart(c.row,c.col,!0)}},{keys:[["Shift","Tab"]],callback:function(l){var u=n.hot.getSettings(),c=typeof u.tabMoves=="function"?u.tabMoves(l):u.tabMoves;n.hot.selection.transformStart(-c.row,-c.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(l){return!n.hot.selection.isMultiple()&&!l.altKey},relativeToGroup:pf,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!n.hot.selection.isMultiple()},relativeToGroup:pf,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:pf,position:"before"},{keys:[["PageUp"]],callback:function(){n.hot.selection.transformStart(-n.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){n.hot.selection.transformStart(n.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(l,u){var c=Uj(u,1),f=c[0];Wj(f,n.TEXTAREA)}},{keys:[["End"]],callback:function(l,u){var c=Uj(u,1),f=c[0];Wj(f,n.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){n.hot._registerTimeout(function(){n.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){n.hot._registerTimeout(function(){n.autoResize.resize()},10)}}],a)}},{key:"unregisterShortcuts",value:function(){var n=this.hot.getShortcutManager(),o=n.getContext("editor");o.removeShortcutsByGroup(Rv),o.removeShortcutsByGroup(zj),o.removeShortcutsByGroup(ZC)}},{key:"onAfterDocumentKeyDown",value:function(n){var o=[wt.ARROW_UP,wt.ARROW_RIGHT,wt.ARROW_DOWN,wt.ARROW_LEFT];o.indexOf(n.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(n.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return hSt}}]),r}(gc),dSt="base";function vp(e,t,r,n,o,i,a){var s=[],l=[];a.className&&q(t,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!i&&a.placeholder&&s.push(a.placeholderCellClassName),Bt(t,l),q(t,s)}vp.RENDERER_TYPE=dSt;var pSt="text";function ki(e,t,r,n,o,i,a){vp.apply(this,[e,t,r,n,o,i,a]);var s=i;if(!s&&a.placeholder&&(s=a.placeholder),s=Pe(s),a.trimWhitespace&&(s=s.trim()),a.rendererTemplate){yr(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else mi(t,s)}ki.RENDERER_TYPE=pSt;var ySt="text",wY={CELL_TYPE:ySt,editor:za,renderer:ki};ir(wY);xt.editors={BaseEditor:gc};function xt(e,t){var r=new nE(e,t||{},FR);return r.init(),r}xt.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new nE(e,t,FR)};xt.DefaultSettings=fY();xt.hooks=gt.getSingleton();xt.CellCoords=Wg;xt.CellRange=MR;xt.packageName="handsontable";xt.buildDate="22/03/2023 14:42:41";xt.version="12.3.2";xt.languages={dictionaryKeys:Hvt,getLanguageDictionary:qU,getLanguagesDictionaries:Yvt,registerLanguageDictionary:JR,getTranslatedPhrase:$U};var Ls=Symbol("unassigned"),gSt="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function wm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function AY(e){var t=xt.hooks.getRegistered(),r={};Object.assign(r,xt.DefaultSettings);for(var n in r)r[n]={default:Ls};for(var o=0;o<t.length;o++)r[t[o]]={default:Ls};return r.settings={default:Ls},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function SY(e){var t={},r=e.settings;if(r!==Ls)for(var n in r)wm(r,n)&&r[n]!==Ls&&(t[n]=r[n]);for(var o in e)wm(e,o)&&o!=="settings"&&e[o]!==Ls&&(t[o]=e[o]);return t}function Qj(e,t){var r=SY(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)wm(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!Kj(t[a],n[a]))&&(i[a]=n[a]);for(var s in o)wm(o,s)&&s!=="id"&&s!=="settings"&&o[s]!==void 0&&(!(t&&s!=="data")||!Kj(t[s],o[s]))&&(i[s]=o[s]);return i}function Kj(e,t){return JSON.stringify(e)===JSON.stringify(t)}var mSt="12.3.2",rE=G1({name:"HotTable",props:AY("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var t=Qj(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||t===void 0||(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(gSt),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=Qj(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=GG(new xt.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t=this.hotInstance.getSourceData(),r=[],n=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),i=this.hotInstance.isColumnModificationAllowed(),a=0;if(t&&t.length!==o&&t.length<o)for(var s=t.length;s<o;s++)r.push(s);if(i){var l;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),t&&t[0]&&((l=t[0])===null||l===void 0?void 0:l.length)!==a&&t[0].length<a)for(var u=t[0].length;u<a;u++)n.push(u)}this.hotInstance.batch(function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(o-1,t.length-o),i&&t.length!==0&&(n.length>0?e.hotInstance.columnIndexMapper.removeIndexes(n):e.hotInstance.columnIndexMapper.insertIndexes(a-1,t[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:mSt}),vSt=["id"];function bSt(e,t,r,n,o,i){return Zc(),qc("div",{id:e.id},[zG(e.$slots,"default")],8,vSt)}rE.render=bSt;rE.__file="src/HotTable.vue";function Xj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wSt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xj(Object(r),!0).forEach(function(n){ASt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ASt(e,t,r){return t=CSt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SSt(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CSt(e){var t=SSt(e,"string");return typeof t=="symbol"?t:String(t)}var OSt=G1({name:"HotColumn",props:AY("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=SY(this.$props),t=wSt({},e);e.renderer&&(t.renderer=e.renderer),e.editor&&(t.editor=e.editor),this.columnsCache.set(this,t)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});OSt.__file="src/HotColumn.vue";function kSt(e,t){return`${e}-${t}`}(()=>{if(!window.matchMedia)return{value:js(null)};const e=js(window.matchMedia("(prefers-color-scheme: dark)").matches);return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>e.value=t.matches),{value:e}})();const RSt={create(){return PB("xlsx.worker.js").defaults(()=>new Worker(new URL(""+new URL(""+new URL("xlsx.worker-gJL9H9vI.js",import.meta.url).href,import.meta.url).href,self.location),{type:"module"}))}},ESt={create(){return PB("sheet.worker.js").defaults(()=>new Worker(new URL(""+new URL(""+new URL("sheet.worker-esG01WD_.js",import.meta.url).href,import.meta.url).href,self.location),{type:"module"}))}};var TSt=jt,PSt=Wt,MSt=Gm.f,ISt=PSt(function(){return!Object.getOwnPropertyNames(1)});TSt({target:"Object",stat:!0,forced:ISt},{getOwnPropertyNames:MSt});function Hl(e){return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function xSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DSt(n.key),n)}}function jSt(e,t,r){return t&&Jj(e.prototype,t),r&&Jj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DSt(e){var t=_St(e,"string");return Hl(t)==="symbol"?t:String(t)}function _St(e,t){if(Hl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ar(){return typeof Reflect<"u"&&Reflect.get?ar=Reflect.get.bind():ar=function(e,t,r){var n=HSt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ar.apply(this,arguments)}function HSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_n(e),e!==null););return e}function NSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$C(e,t)}function $C(e,t){return $C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},$C(e,t)}function BSt(e){var t=FSt();return function(){var r=_n(e),n;if(t){var o=_n(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LSt(this,n)}}function LSt(e,t){if(t&&(Hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VSt(e)}function VSt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _n(e){return _n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_n(e)}var Zj="handsontableEditor",WSt="handsontable",oE=function(e){NSt(r,e);var t=BSt(r);function r(){return xSt(this,r),t.apply(this,arguments)}return jSt(r,[{key:"open",value:function(){ar(_n(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),op(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),ar(_n(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(n,o,i,a,s,l){ar(_n(r.prototype),"prepare",this).call(this,n,o,i,a,s,l);var u=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(f,h){var p=this.getSourceData(h.row,h.col);p!==void 0&&u.setValue(p),u.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ve(c,l.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(n,o){var i=this.hot.getSettings().onBeginEditing;i&&i()===!1||ar(_n(r.prototype),"beginEditing",this).call(this,n,o)}},{key:"createElements",value:function(){ar(_n(r.prototype),"createElements",this).call(this);var n=this.hot.rootDocument.createElement("DIV");n.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(n),this.htContainer=n,this.assignHooks()}},{key:"finishEditing",value:function(n,o,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var a=this.htEditor.getInstance().getValue();a!==void 0&&this.setValue(a)}ar(_n(r.prototype),"finishEditing",this).call(this,n,o,i)}},{key:"assignHooks",value:function(){var n=this;this.hot.addHook("afterDestroy",function(){n.htEditor&&n.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var n=this,o=this.hot.getShortcutManager(),i=o.getContext("editor");ar(_n(r.prototype),"registerShortcuts",this).call(this);var a={group:Zj,relativeToGroup:Rv,position:"before"},s=function(l,u){var c=n.htEditor.getInstance();if(l!==void 0&&(l<0||c.flipped&&l>c.countRows()-1?c.deselectCell():c.selectCell(l,0),c.getData().length))return u.preventDefault(),gr(u),n.hot.listen(),n.TEXTAREA.focus(),!1};i.addShortcuts([{keys:[["ArrowUp"]],callback:function(l){var u=n.htEditor.getInstance(),c,f;return!u.getSelectedLast()&&u.flipped?c=u.countRows()-1:u.getSelectedLast()&&(u.flipped?(f=u.getSelectedLast()[0],c=Math.max(0,f-1)):(f=u.getSelectedLast()[0],c=f-1)),s(c,l)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(l){var u=n.htEditor.getInstance(),c,f;if(!u.getSelectedLast()&&!u.flipped)c=0;else if(u.getSelectedLast()){if(u.flipped)c=u.getSelectedLast()[0]+1;else if(!u.flipped){var h=u.countRows()-1;f=u.getSelectedLast()[0],c=Math.min(h,f+1)}}return s(c,l)},preventDefault:!1}],a)}},{key:"unregisterShortcuts",value:function(){ar(_n(r.prototype),"unregisterShortcuts",this).call(this);var n=this.hot.getShortcutManager(),o=n.getContext("editor");o.removeShortcutsByGroup(Zj)}}],[{key:"EDITOR_TYPE",get:function(){return WSt}}]),r}(za);function Nl(e){return Nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nl(e)}function USt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CY(n.key),n)}}function YSt(e,t,r){return t&&qj(e.prototype,t),r&&qj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qi(){return typeof Reflect<"u"&&Reflect.get?Qi=Reflect.get.bind():Qi=function(e,t,r){var n=GSt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Qi.apply(this,arguments)}function GSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ro(e),e!==null););return e}function zSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tO(e,t)}function tO(e,t){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},tO(e,t)}function QSt(e){var t=XSt();return function(){var r=ro(e),n;if(t){var o=ro(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KSt(this,n)}}function KSt(e,t){if(t&&(Nl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eO(e)}function eO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ro(e){return ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ro(e)}function JSt(e,t,r){return t=CY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CY(e){var t=ZSt(e,"string");return Nl(t)==="symbol"?t:String(t)}function ZSt(e,t){if(Nl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UA=new WeakMap,qSt="autocomplete",iE=function(e){zSt(r,e);var t=QSt(r);function r(n){var o;return USt(this,r),o=t.call(this,n),JSt(eO(o),"sortByRelevance",function(i,a,s){var l=[],u=[],c=i.length,f=a.length,h,p,y,m;if(c===0){for(y=0;y<f;y++)u.push(y);return u}for(y=0;y<f;y++){if(p=_S(Pe(a[y])),s)m=p.indexOf(i);else{var v=this.cellProperties.locale;m=p.toLocaleLowerCase(v).indexOf(i.toLocaleLowerCase(v))}m!==-1&&(h=p.length-m-c,l.push({baseIndex:y,index:m,charsLeft:h,value:p}))}for(l.sort(function(w,C){if(C.index===-1)return-1;if(w.index===-1)return 1;if(w.index<C.index)return-1;if(C.index<w.index)return 1;if(w.index===C.index){if(w.charsLeft<C.charsLeft)return-1;if(w.charsLeft>C.charsLeft)return 1}return 0}),y=0,f=l.length;y<f;y++)u.push(l[y].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],UA.set(eO(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return YSt(r,[{key:"getValue",value:function(){var n=this,o=this.rawChoices.find(function(i){var a=n.stripValueIfNeeded(i);return a===n.TEXTAREA.value});return ht(o)?o:this.TEXTAREA.value}},{key:"createElements",value:function(){Qi(ro(r.prototype),"createElements",this).call(this),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var n=this,o=UA.get(this);Qi(ro(r.prototype),"open",this).call(this);var i=this.htEditor.getInstance(),a=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=qe();s===0&&o.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(l){return n.onBeforeKeyDown(l)}),i.updateSettings({colWidths:a?[fe(this.TEXTAREA)-2]:void 0,width:a?fe(this.TEXTAREA)+s:void 0,renderer:function(l,u,c,f,h,p,y){ki(l,u,c,f,h,p,y);var m=n.cellProperties,v=m.filteringCaseSensitive,w=m.allowHtml,C=m.locale,A=n.query,D=Pe(p),E,G;D&&!w&&(E=v===!0?D.indexOf(A):D.toLocaleLowerCase(C).indexOf(A.toLocaleLowerCase(C)),E!==-1&&(G=D.substr(E,A.length),D=D.replace(G,"<strong>".concat(G,"</strong>")))),u.innerHTML=D},autoColumnSize:!0}),o.skipOne&&(o.skipOne=!1),this.hot._registerTimeout(function(){n.queryChoices(n.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Qi(ro(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(n){Qi(ro(r.prototype),"discardEditor",this).call(this,n),this.hot.view.render()}},{key:"queryChoices",value:function(n){var o=this,i=this.cellProperties.source;this.query=n,typeof i=="function"?i.call(this.cellProperties,n,function(a){o.rawChoices=a,o.updateChoicesList(o.stripValuesIfNeeded(a))}):Array.isArray(i)?(this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(n){var o=bR(this.TEXTAREA),i=iW(this.TEXTAREA),a=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,l=null,u=null,c=n;a&&(l=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var f=Array.isArray(l)?l.length:0;if(s===!1)f&&(u=l[0]);else{for(var h=[],p=0,y=c.length;p<y&&!(a&&f<=p);p++)f?h.push(c[l[p]]):h.push(c[p]);u=0,c=h}this.strippedChoices=c,this.htEditor.loadData(lf([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(u),this.hot.listen(),op(this.TEXTAREA,o,o===i?void 0:i)}},{key:"flipDropdownIfNeeded",value:function(){var n=el(this.hot.view._wt.wtTable.TABLE),o=n===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(o||!o&&(i||i==="horizontal"))return!1;var a=Le(this.TEXTAREA),s=ke(this.TEXTAREA),l=this.getDropdownHeight(),u=n.scrollTop,c=ke(this.hot.view._wt.wtTable.THEAD),f=Le(n),h=a.top-f.top-c+u,p=n.scrollHeight-h-c-s,y=l>p&&h>p;return y?this.flipDropdown(l):this.unflipDropdown(),this.limitDropdownIfNeeded(y?h:p,l),y}},{key:"limitDropdownIfNeeded",value:function(n,o){if(o>n){var i=0,a=0,s=0,l=null;do s=this.htEditor.getRowHeight(a)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=s,a+=1;while(i<n);l=i-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+o-l,"px")),this.setDropdownHeight(i-s)}}},{key:"flipDropdown",value:function(n){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="".concat(-n,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var n=this.htEditor.rootElement.style;n.position="absolute",n.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var n=this.htEditor.getColWidth(0)+qe(this.hot.rootDocument)+2,o=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:o?void 0:n}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(n){this.htEditor.updateSettings({height:n})}},{key:"highlightBestMatchingChoice",value:function(n){typeof n=="number"?this.htEditor.selectCell(n,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var n=this.htEditor.getInstance().getRowHeight(0)||23,o=this.cellProperties.visibleRows;return this.strippedChoices.length>=o?o*n:this.strippedChoices.length*n+8}},{key:"stripValueIfNeeded",value:function(n){return this.stripValuesIfNeeded([n])[0]}},{key:"stripValuesIfNeeded",value:function(n){var o=this.cellProperties.allowHtml,i=Gt(n,function(s){return Pe(s)}),a=Gt(i,function(s){return o?s:_S(s)});return a}},{key:"allowKeyEventPropagation",value:function(n){var o=this.htEditor.getSelectedRangeLast(),i={row:o?o.from.row:-1},a=!1;return n===wt.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(a=!0),n===wt.ARROW_UP&&i.row>-1&&(a=!0),a}},{key:"onBeforeKeyDown",value:function(n){var o=this,i=UA.get(this);if(i.skipOne=!1,SW(n.keyCode)||n.keyCode===wt.BACKSPACE||n.keyCode===wt.DELETE||n.keyCode===wt.INSERT){var a=10;if(n.keyCode===wt.C&&(n.ctrlKey||n.metaKey))return;this.isOpened()||(a+=10),this.htEditor&&this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value),i.skipOne=!0},a)}}}],[{key:"EDITOR_TYPE",get:function(){return qSt}}]),r}(oE);function Bl(e){return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(e)}function $St(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eCt(n.key),n)}}function tCt(e,t,r){return t&&$j(e.prototype,t),r&&$j(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eCt(e){var t=nCt(e,"string");return Bl(t)==="symbol"?t:String(t)}function nCt(e,t){if(Bl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},nO(e,t)}function oCt(e){var t=sCt();return function(){var r=Am(e),n;if(t){var o=Am(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iCt(this,n)}}function iCt(e,t){if(t&&(Bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aCt(e)}function aCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Am(e){return Am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Am(e)}var lCt="checkbox",OY=function(e){rCt(r,e);var t=oCt(r);function r(){return $St(this,r),t.apply(this,arguments)}return tCt(r,[{key:"beginEditing",value:function(n,o){if(o&&o.type==="mouseup"){var i=this.TD.querySelector('input[type="checkbox"]');Dt(i,"htBadValue")||i.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return lCt}}]),r}(gc),rO={},uCt={get exports(){return rO},set exports(e){rO=e}};const cCt=sz(Vit);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=cCt}catch{}e.exports=n(o)}})(W0,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,s=function(P,d,g,b){o?P.addEventListener(d,g,!!b):P.attachEvent("on"+d,g)},l=function(P,d,g,b){o?P.removeEventListener(d,g,!!b):P.detachEvent("on"+d,g)},u=function(P){return P.trim?P.trim():P.replace(/^\s+|\s+$/g,"")},c=function(P,d){return(" "+P.className+" ").indexOf(" "+d+" ")!==-1},f=function(P,d){c(P,d)||(P.className=P.className===""?d:P.className+" "+d)},h=function(P,d){P.className=u((" "+P.className+" ").replace(" "+d+" "," "))},p=function(P){return/Array/.test(Object.prototype.toString.call(P))},y=function(P){return/Date/.test(Object.prototype.toString.call(P))&&!isNaN(P.getTime())},m=function(P){var d=P.getDay();return d===0||d===6},v=function(P){return P%4===0&&P%100!==0||P%400===0},w=function(P,d){return[31,v(P)?29:28,31,30,31,30,31,31,30,31,30,31][d]},C=function(P){y(P)&&P.setHours(0,0,0,0)},A=function(P,d){return P.getTime()===d.getTime()},D=function(P,d,g){var b,O;for(b in d)O=P[b]!==void 0,O&&typeof d[b]=="object"&&d[b]!==null&&d[b].nodeName===void 0?y(d[b])?g&&(P[b]=new Date(d[b].getTime())):p(d[b])?g&&(P[b]=d[b].slice(0)):P[b]=D({},d[b],g):(g||!O)&&(P[b]=d[b]);return P},E=function(P,d,g){var b;i.createEvent?(b=i.createEvent("HTMLEvents"),b.initEvent(d,!0,!1),b=D(b,g),P.dispatchEvent(b)):i.createEventObject&&(b=i.createEventObject(),b=D(b,g),P.fireEvent("on"+d,b))},G=function(P){return P.month<0&&(P.year-=Math.ceil(Math.abs(P.month)/12),P.month+=12),P.month>11&&(P.year+=Math.floor(Math.abs(P.month)/12),P.month-=12),P},K={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},nt=function(P,d,g){for(d+=P.firstDay;d>=7;)d-=7;return g?P.i18n.weekdaysShort[d]:P.i18n.weekdays[d]},z=function(P){var d=[],g="false";if(P.isEmpty)if(P.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),P.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return P.isDisabled&&d.push("is-disabled"),P.isToday&&d.push("is-today"),P.isSelected&&(d.push("is-selected"),g="true"),P.hasEvent&&d.push("has-event"),P.isInRange&&d.push("is-inrange"),P.isStartRange&&d.push("is-startrange"),P.isEndRange&&d.push("is-endrange"),'<td data-day="'+P.day+'" class="'+d.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+P.year+'" data-pika-month="'+P.month+'" data-pika-day="'+P.day+'">'+P.day+"</button></td>"},X=function(P,d){P.setHours(0,0,0,0);var g=P.getDate(),b=P.getDay(),O=d,R=O-1,I=7,W=function(mt){return(mt+I-1)%I};P.setDate(g+R-W(b));var N=new Date(P.getFullYear(),0,O),Q=24*60*60*1e3,J=(P.getTime()-N.getTime())/Q,rt=1+Math.round((J-R+W(N.getDay()))/I);return rt},Z=function(P,d,g,b){var O=new Date(g,d,P),R=n?r(O).isoWeek():X(O,b);return'<td class="pika-week">'+R+"</td>"},tt=function(P,d,g,b){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(b?" is-selected":"")+'">'+(d?P.reverse():P).join("")+"</tr>"},et=function(P){return"<tbody>"+P.join("")+"</tbody>"},bt=function(P){var d,g=[];for(P.showWeekNumber&&g.push("<th></th>"),d=0;d<7;d++)g.push('<th scope="col"><abbr title="'+nt(P,d)+'">'+nt(P,d,!0)+"</abbr></th>");return"<thead><tr>"+(P.isRTL?g.reverse():g).join("")+"</tr></thead>"},yt=function(P,d,g,b,O,R){var I,W,N,Q=P._o,J=g===Q.minYear,rt=g===Q.maxYear,mt='<div id="'+R+'" class="pika-title" role="heading" aria-live="assertive">',ut,Ot,St=!0,Y=!0;for(N=[],I=0;I<12;I++)N.push('<option value="'+(g===O?I-d:12+I-d)+'"'+(I===b?' selected="selected"':"")+(J&&I<Q.minMonth||rt&&I>Q.maxMonth?' disabled="disabled"':"")+">"+Q.i18n.months[I]+"</option>");for(ut='<div class="pika-label">'+Q.i18n.months[b]+'<select class="pika-select pika-select-month" tabindex="-1">'+N.join("")+"</select></div>",p(Q.yearRange)?(I=Q.yearRange[0],W=Q.yearRange[1]+1):(I=g-Q.yearRange,W=1+g+Q.yearRange),N=[];I<W&&I<=Q.maxYear;I++)I>=Q.minYear&&N.push('<option value="'+I+'"'+(I===g?' selected="selected"':"")+">"+I+"</option>");return Ot='<div class="pika-label">'+g+Q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+N.join("")+"</select></div>",Q.showMonthAfterYear?mt+=Ot+ut:mt+=ut+Ot,J&&(b===0||Q.minMonth>=b)&&(St=!1),rt&&(b===11||Q.maxMonth<=b)&&(Y=!1),d===0&&(mt+='<button class="pika-prev'+(St?"":" is-disabled")+'" type="button">'+Q.i18n.previousMonth+"</button>"),d===P._o.numberOfMonths-1&&(mt+='<button class="pika-next'+(Y?"":" is-disabled")+'" type="button">'+Q.i18n.nextMonth+"</button>"),mt+="</div>"},kt=function(P,d,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+bt(P)+et(d)+"</table>"},Et=function(P){var d=this,g=d.config(P);d._onMouseDown=function(O){if(d._v){O=O||window.event;var R=O.target||O.srcElement;if(R)if(c(R,"is-disabled")||(c(R,"pika-button")&&!c(R,"is-empty")&&!c(R.parentNode,"is-disabled")?(d.setDate(new Date(R.getAttribute("data-pika-year"),R.getAttribute("data-pika-month"),R.getAttribute("data-pika-day"))),g.bound&&a(function(){d.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):c(R,"pika-prev")?d.prevMonth():c(R,"pika-next")&&d.nextMonth()),c(R,"pika-select"))d._c=!0;else if(O.preventDefault)O.preventDefault();else return O.returnValue=!1,!1}},d._onChange=function(O){O=O||window.event;var R=O.target||O.srcElement;R&&(c(R,"pika-select-month")?d.gotoMonth(R.value):c(R,"pika-select-year")&&d.gotoYear(R.value))},d._onKeyChange=function(O){if(O=O||window.event,d.isVisible())switch(O.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(n){var O=r(g.field.value,g.format,g.formatStrict);return O&&O.isValid()?O.toDate():null}else return new Date(Date.parse(g.field.value))},d._onInputChange=function(O){var R;O.firedBy!==d&&(R=d._parseFieldValue(),y(R)&&d.setDate(R),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var O=i.activeElement;do if(c(O,"pika-single"))return;while(O=O.parentNode);d._c||(d._b=a(function(){d.hide()},50)),d._c=!1},d._onClick=function(O){O=O||window.event;var R=O.target||O.srcElement,I=R;if(R){!o&&c(R,"pika-select")&&(R.onchange||(R.setAttribute("onchange","return;"),s(R,"change",d._onChange)));do if(c(I,"pika-single")||I===g.trigger)return;while(I=I.parentNode);d._v&&R!==g.trigger&&I!==g.trigger&&d.hide()}},d.el=i.createElement("div"),d.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),s(d.el,"mousedown",d._onMouseDown,!0),s(d.el,"touchend",d._onMouseDown,!0),s(d.el,"change",d._onChange),g.keyboardInput&&s(i,"keydown",d._onKeyChange),g.field&&(g.container?g.container.appendChild(d.el):g.bound?i.body.appendChild(d.el):g.field.parentNode.insertBefore(d.el,g.field.nextSibling),s(g.field,"change",d._onInputChange),g.defaultDate||(g.defaultDate=d._parseFieldValue(),g.setDefaultDate=!0));var b=g.defaultDate;y(b)?g.setDefaultDate?d.setDate(b,!0):d.gotoDate(b):d.gotoDate(new Date),g.bound?(this.hide(),d.el.className+=" is-bound",s(g.trigger,"click",d._onInputClick),s(g.trigger,"focus",d._onInputFocus),s(g.trigger,"blur",d._onInputBlur)):this.show()};return Et.prototype={config:function(P){this._o||(this._o=D({},K,!0));var d=D(this._o,P,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var g=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=g>4?4:g,y(d.minDate)||(d.minDate=!1),y(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),p(d.yearRange)){var b=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||b,d.yearRange[1]=parseInt(d.yearRange[1],10)||b}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||K.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(P){return P=P||this._o.format,y(this._d)?this._o.toString?this._o.toString(this._d,P):n?r(this._d).format(P):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(P,d){n&&r.isMoment(P)&&this.setDate(P.toDate(),d)},getDate:function(){return y(this._d)?new Date(this._d.getTime()):null},setDate:function(P,d){if(!P)return this._d=null,this._o.field&&(this._o.field.value="",E(this._o.field,"change",{firedBy:this})),this.draw();if(typeof P=="string"&&(P=new Date(Date.parse(P))),!!y(P)){var g=this._o.minDate,b=this._o.maxDate;y(g)&&P<g?P=g:y(b)&&P>b&&(P=b),this._d=new Date(P.getTime()),C(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),E(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(P){var d=!0;if(y(P)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),b=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),O=P.getTime();b.setMonth(b.getMonth()+1),b.setDate(b.getDate()-1),d=O<g.getTime()||b.getTime()<O}d&&(this.calendars=[{month:P.getMonth(),year:P.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(P,d){var g=this.getDate()||new Date,b=parseInt(d)*24*60*60*1e3,O;P==="add"?O=new Date(g.valueOf()+b):P==="subtract"&&(O=new Date(g.valueOf()-b)),this.setDate(O)},adjustCalendars:function(){this.calendars[0]=G(this.calendars[0]);for(var P=1;P<this._o.numberOfMonths;P++)this.calendars[P]=G({month:this.calendars[0].month+P,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(P){isNaN(P)||(this.calendars[0].month=parseInt(P,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(P){isNaN(P)||(this.calendars[0].year=parseInt(P,10),this.adjustCalendars())},setMinDate:function(P){P instanceof Date?(C(P),this._o.minDate=P,this._o.minYear=P.getFullYear(),this._o.minMonth=P.getMonth()):(this._o.minDate=K.minDate,this._o.minYear=K.minYear,this._o.minMonth=K.minMonth,this._o.startRange=K.startRange),this.draw()},setMaxDate:function(P){P instanceof Date?(C(P),this._o.maxDate=P,this._o.maxYear=P.getFullYear(),this._o.maxMonth=P.getMonth()):(this._o.maxDate=K.maxDate,this._o.maxYear=K.maxYear,this._o.maxMonth=K.maxMonth,this._o.endRange=K.endRange),this.draw()},setStartRange:function(P){this._o.startRange=P},setEndRange:function(P){this._o.endRange=P},draw:function(P){if(!(!this._v&&!P)){var d=this._o,g=d.minYear,b=d.maxYear,O=d.minMonth,R=d.maxMonth,I="",W;this._y<=g&&(this._y=g,!isNaN(O)&&this._m<O&&(this._m=O)),this._y>=b&&(this._y=b,!isNaN(R)&&this._m>R&&(this._m=R));for(var N=0;N<d.numberOfMonths;N++)W="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),I+='<div class="pika-lendar">'+yt(this,N,this.calendars[N].year,this.calendars[N].month,this.calendars[0].year,W)+this.render(this.calendars[N].year,this.calendars[N].month,W)+"</div>";this.el.innerHTML=I,d.bound&&d.field.type!=="hidden"&&a(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var P,d,g,b,O,R,I,W,N,Q,J,rt;if(!this._o.container){if(this.el.style.position="absolute",P=this._o.trigger,d=P,g=this.el.offsetWidth,b=this.el.offsetHeight,O=window.innerWidth||i.documentElement.clientWidth,R=window.innerHeight||i.documentElement.clientHeight,I=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,J=!0,rt=!0,typeof P.getBoundingClientRect=="function")Q=P.getBoundingClientRect(),W=Q.left+window.pageXOffset,N=Q.bottom+window.pageYOffset;else for(W=d.offsetLeft,N=d.offsetTop+d.offsetHeight;d=d.offsetParent;)W+=d.offsetLeft,N+=d.offsetTop;(this._o.reposition&&W+g>O||this._o.position.indexOf("right")>-1&&W-g+P.offsetWidth>0)&&(W=W-g+P.offsetWidth,J=!1),(this._o.reposition&&N+b>R+I||this._o.position.indexOf("top")>-1&&N-b-P.offsetHeight>0)&&(N=N-b-P.offsetHeight,rt=!1),this.el.style.left=W+"px",this.el.style.top=N+"px",f(this.el,J?"left-aligned":"right-aligned"),f(this.el,rt?"bottom-aligned":"top-aligned"),h(this.el,J?"right-aligned":"left-aligned"),h(this.el,rt?"top-aligned":"bottom-aligned")}},render:function(P,d,g){var b=this._o,O=new Date,R=w(P,d),I=new Date(P,d,1).getDay(),W=[],N=[];C(O),b.firstDay>0&&(I-=b.firstDay,I<0&&(I+=7));for(var Q=d===0?11:d-1,J=d===11?0:d+1,rt=d===0?P-1:P,mt=d===11?P+1:P,ut=w(rt,Q),Ot=R+I,St=Ot;St>7;)St-=7;Ot+=7-St;for(var Y=!1,Ft=0,Lt=0;Ft<Ot;Ft++){var Tt=new Date(P,d,1+(Ft-I)),Vt=y(this._d)?A(Tt,this._d):!1,It=A(Tt,O),S=b.events.indexOf(Tt.toDateString())!==-1,k=Ft<I||Ft>=R+I,M=1+(Ft-I),L=d,j=P,V=b.startRange&&A(b.startRange,Tt),_=b.endRange&&A(b.endRange,Tt),H=b.startRange&&b.endRange&&b.startRange<Tt&&Tt<b.endRange,F=b.minDate&&Tt<b.minDate||b.maxDate&&Tt>b.maxDate||b.disableWeekends&&m(Tt)||b.disableDayFn&&b.disableDayFn(Tt);k&&(Ft<I?(M=ut+M,L=Q,j=rt):(M=M-R,L=J,j=mt));var B={day:M,month:L,year:j,hasEvent:S,isSelected:Vt,isToday:It,isDisabled:F,isEmpty:k,isStartRange:V,isEndRange:_,isInRange:H,showDaysInNextAndPreviousMonths:b.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:b.enableSelectionDaysInNextAndPreviousMonths};b.pickWholeWeek&&Vt&&(Y=!0),N.push(z(B)),++Lt===7&&(b.showWeekNumber&&N.unshift(Z(Ft-I,d,P,b.firstWeekOfYearMinDays)),W.push(tt(N,b.isRTL,b.pickWholeWeek,Y)),N=[],Lt=0,Y=!1)}return kt(b,W,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var P=this._v;P!==!1&&(this._o.bound&&l(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),f(this.el,"is-hidden"),this._v=!1,P!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var P=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),P.keyboardInput&&l(i,"keydown",this._onKeyChange),P.field&&(l(P.field,"change",this._onInputChange),P.bound&&(l(P.trigger,"click",this._onInputClick),l(P.trigger,"focus",this._onInputFocus),l(P.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Et})})(uCt);const tD=rO;function Ll(e){return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}function fCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dCt(n.key),n)}}function hCt(e,t,r){return t&&eD(e.prototype,t),r&&eD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dCt(e){var t=pCt(e,"string");return Ll(t)==="symbol"?t:String(t)}function pCt(e,t){if(Ll(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ll(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $r(){return typeof Reflect<"u"&&Reflect.get?$r=Reflect.get.bind():$r=function(e,t,r){var n=yCt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},$r.apply(this,arguments)}function yCt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ur(e),e!==null););return e}function gCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},oO(e,t)}function mCt(e){var t=wCt();return function(){var r=ur(e),n;if(t){var o=ur(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vCt(this,n)}}function vCt(e,t){if(t&&(Ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bCt(e)}function bCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ur(e){return ur=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ur(e)}var kY="date",nD="dateEditor",RY=function(e){gCt(r,e);var t=mCt(r);function r(n){var o;return fCt(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return hCt(r,[{key:"init",value:function(){var n=this;if(typeof $!="function")throw new Error("You need to include moment.js to your project.");if(typeof tD!="function")throw new Error("You need to include Pikaday to your project.");$r(ur(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){n.parentDestroyed=!0,n.destroyElements()})}},{key:"createElements",value:function(){$r(ur(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var n=new Re(this);n.addEventListener(this.datePicker,"mousedown",function(o){return o.stopPropagation()})}},{key:"destroyElements",value:function(){var n=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),n&&n.removeChild(this.datePicker)}},{key:"prepare",value:function(n,o,i,a,s,l){$r(ur(r.prototype),"prepare",this).call(this,n,o,i,a,s,l)}},{key:"open",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=this.hot.getShortcutManager(),i=o.getContext("editor");$r(ur(r.prototype),"open",this).call(this),this.showDatepicker(n),i.addShortcut({keys:[["Enter"]],callback:function(a){a.stopPropagation()},group:nD})}},{key:"close",value:function(){var n,o=this;this._opened=!1,(n=this.$datePicker)!==null&&n!==void 0&&n.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){o.instance._refreshBorders()});var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(nD),$r(ur(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n){var i=this.originalValue;i!==void 0&&this.setValue(i)}$r(ur(r.prototype),"finishEditing",this).call(this,n,o)}},{key:"showDatepicker",value:function(n){var o=this.TD.getBoundingClientRect(),i=this.cellProperties.dateFormat||this.defaultDateFormat,a=this.instance.view.isMouseDown(),s=n?OR(n.keyCode):!1,l;this.datePicker.style.display="block",this.$datePicker=new tD(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+ke(this.TD),"px");var u=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?u=o.right-fe(this.datePicker):u=o.left,this.datePickerStyle.left="".concat(u,"px"),this.originalValue?(l=this.originalValue,$(l,i,!0).isValid()&&this.$datePicker.setMoment($(l,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!a&&this.setValue("")):this.cellProperties.defaultDate?(l=this.cellProperties.defaultDate,$(l,i,!0).isValid()&&this.$datePicker.setMoment($(l,i),!0),!s&&!a&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var n=this,o=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&$d(i,this.cellProperties.datePickerConfig);var a=i.onSelect,s=i.onClose;return i.field=o,i.trigger=o,i.container=this.datePicker,i.bound=!1,i.format=i.format||this.defaultDateFormat,i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=function(l){var u=l;isNaN(u.getTime())||(u=$(u).format(n.cellProperties.dateFormat||n.defaultDateFormat)),n.setValue(u),n.hideDatepicker(),a&&a()},i.onClose=function(){n.parentDestroyed||n.finishEditing(!1),s&&s()},i}}],[{key:"EDITOR_TYPE",get:function(){return kY}}]),r}(za);function Vl(e){return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(e)}function ACt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CCt(n.key),n)}}function SCt(e,t,r){return t&&rD(e.prototype,t),r&&rD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CCt(e){var t=OCt(e,"string");return Vl(t)==="symbol"?t:String(t)}function OCt(e,t){if(Vl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ng(){return typeof Reflect<"u"&&Reflect.get?ng=Reflect.get.bind():ng=function(e,t,r){var n=kCt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ng.apply(this,arguments)}function kCt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fl(e),e!==null););return e}function RCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iO(e,t)}function iO(e,t){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},iO(e,t)}function ECt(e){var t=MCt();return function(){var r=Fl(e),n;if(t){var o=Fl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return TCt(this,n)}}function TCt(e,t){if(t&&(Vl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PCt(e)}function PCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fl(e){return Fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fl(e)}var ICt="dropdown",aE=function(e){RCt(r,e);var t=ECt(r);function r(){return ACt(this,r),t.apply(this,arguments)}return SCt(r,[{key:"prepare",value:function(n,o,i,a,s,l){ng(Fl(r.prototype),"prepare",this).call(this,n,o,i,a,s,l),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return ICt}}]),r}(iE);gt.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===aE&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Wl(e){return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function xCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DCt(n.key),n)}}function jCt(e,t,r){return t&&oD(e.prototype,t),r&&oD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DCt(e){var t=_Ct(e,"string");return Wl(t)==="symbol"?t:String(t)}function _Ct(e,t){if(Wl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},aO(e,t)}function NCt(e){var t=VCt();return function(){var r=Sm(e),n;if(t){var o=Sm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return BCt(this,n)}}function BCt(e,t){if(t&&(Wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LCt(e)}function LCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sm(e){return Sm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sm(e)}var FCt="numeric",EY=function(e){HCt(r,e);var t=NCt(r);function r(){return xCt(this,r),t.apply(this,arguments)}return jCt(r,null,[{key:"EDITOR_TYPE",get:function(){return FCt}}]),r}(za);function Ul(e){return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(e)}function WCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YCt(n.key),n)}}function UCt(e,t,r){return t&&iD(e.prototype,t),r&&iD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YCt(e){var t=GCt(e,"string");return Ul(t)==="symbol"?t:String(t)}function GCt(e,t){if(Ul(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ul(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rg(){return typeof Reflect<"u"&&Reflect.get?rg=Reflect.get.bind():rg=function(e,t,r){var n=zCt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},rg.apply(this,arguments)}function zCt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yl(e),e!==null););return e}function QCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}function sO(e,t){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},sO(e,t)}function KCt(e){var t=ZCt();return function(){var r=Yl(e),n;if(t){var o=Yl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return XCt(this,n)}}function XCt(e,t){if(t&&(Ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JCt(e)}function JCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yl(e){return Yl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yl(e)}var qCt="password",TY=function(e){QCt(r,e);var t=KCt(r);function r(){return WCt(this,r),t.apply(this,arguments)}return UCt(r,[{key:"createElements",value:function(){rg(Yl(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,yr(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return qCt}}]),r}(za);function Ia(e){return Ia=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ia(e)}function $Ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eOt(n.key),n)}}function tOt(e,t,r){return t&&aD(e.prototype,t),r&&aD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eOt(e){var t=nOt(e,"string");return Ia(t)==="symbol"?t:String(t)}function nOt(e,t){if(Ia(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ia(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function og(){return typeof Reflect<"u"&&Reflect.get?og=Reflect.get.bind():og=function(e,t,r){var n=rOt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},og.apply(this,arguments)}function rOt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gl(e),e!==null););return e}function oOt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},lO(e,t)}function iOt(e){var t=lOt();return function(){var r=Gl(e),n;if(t){var o=Gl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aOt(this,n)}}function aOt(e,t){if(t&&(Ia(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sOt(e)}function sOt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gl(e){return Gl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gl(e)}var YA="ht_editor_visible",sD="selectEditor",uOt="select",cOt=function(e){oOt(r,e);var t=iOt(r);function r(){return $Ct(this,r),t.apply(this,arguments)}return tOt(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),q(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(n){this.select.value=n}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var n=this.hot.getShortcutManager();n.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Dt(this.select,YA)&&Bt(this.select,YA),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var n=this;this.addHook("afterScrollHorizontally",function(){return n.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return n.refreshDimensions()}),this.addHook("afterColumnResize",function(){return n.refreshDimensions()}),this.addHook("afterRowResize",function(){return n.refreshDimensions()})}},{key:"prepare",value:function(n,o,i,a,s,l){var u=this;og(Gl(r.prototype),"prepare",this).call(this,n,o,i,a,s,l);var c=this.cellProperties.selectOptions,f;typeof c=="function"?f=this.prepareOptions(c(this.row,this.col,this.prop)):f=this.prepareOptions(c),yr(this.select),Qt(f,function(h,p){var y=u.hot.rootDocument.createElement("OPTION");y.value=p,Ya(y,h),u.select.appendChild(y)})}},{key:"prepareOptions",value:function(n){var o={};if(Array.isArray(n))for(var i=0,a=n.length;i<a;i++)o[n[i]]=n[i];else Ia(n)==="object"&&(o=n);return o}},{key:"refreshValue",value:function(){var n=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=n,this.setValue(n),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===$e.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var n=this.getEditedCellRect(),o=n.top,i=n.start,a=n.width,s=n.height,l=this.select.style;l.height="".concat(s,"px"),l.width="".concat(a,"px"),l.top="".concat(o,"px"),l[this.hot.isRtl()?"right":"left"]="".concat(i,"px"),l.margin="0px",q(this.select,YA)}}},{key:"registerShortcuts",value:function(){var n=this,o=this.hot.getShortcutManager(),i=o.getContext("editor"),a={group:sD};this.isInFullEditMode()!==!1&&i.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var s=n.select.selectedIndex-1;s>=0&&(n.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var s=n.select.selectedIndex+1;s<=n.select.length-1&&(n.select[s].selected=!0)}}],a)}},{key:"unregisterShortcuts",value:function(){var n=this.hot.getShortcutManager(),o=n.getContext("editor");o.removeShortcutsByGroup(sD)}}],[{key:"EDITOR_TYPE",get:function(){return uOt}}]),r}(gc);function zl(e){return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(e)}function fOt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dOt(n.key),n)}}function hOt(e,t,r){return t&&lD(e.prototype,t),r&&lD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dOt(e){var t=pOt(e,"string");return zl(t)==="symbol"?t:String(t)}function pOt(e,t){if(zl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ig(){return typeof Reflect<"u"&&Reflect.get?ig=Reflect.get.bind():ig=function(e,t,r){var n=yOt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ig.apply(this,arguments)}function yOt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ql(e),e!==null););return e}function gOt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},uO(e,t)}function mOt(e){var t=wOt();return function(){var r=Ql(e),n;if(t){var o=Ql(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vOt(this,n)}}function vOt(e,t){if(t&&(zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bOt(e)}function bOt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ql(e){return Ql=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ql(e)}var AOt="time",PY=function(e){gOt(r,e);var t=mOt(r);function r(){return fOt(this,r),t.apply(this,arguments)}return hOt(r,[{key:"prepare",value:function(n,o,i,a,s,l){ig(Ql(r.prototype),"prepare",this).call(this,n,o,i,a,s,l),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return AOt}}]),r}(za);function SOt(){Sn(gc),Sn(iE),Sn(OY),Sn(RY),Sn(aE),Sn(oE),Sn(EY),Sn(TY),Sn(cOt),Sn(za),Sn(PY)}var COt="html";function sE(e,t,r,n,o,i,a){vp.apply(this,[e,t,r,n,o,i,a]),Ya(t,i??"",!1)}sE.RENDERER_TYPE=COt;var OOt="autocomplete";function mc(e,t,r,n,o,i,a){var s=e.rootDocument,l=a.allowHtml?sE:ki,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode("")),l.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(s.createTextNode("")),t.insertBefore(u,t.firstChild),q(t,"htAutocomplete"),!e.acArrowListener){var c=new Re(e);e.acArrowListener=function(f){Dt(f.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},c.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){c.destroy()})}}mc.RENDERER_TYPE=OOt;var uD=new WeakMap,cD=new WeakMap,kOt="htBadValue",Kl="data-row",Xl="data-col",ROt="checkboxRenderer",MY="checkbox";gt.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,s=t.prop;if(o===MY){if(n){var l=n.value,u=n.property,c=r;if(l)c=typeof l=="function"?l(i,a,s,r):l;else if(u){var f=this.getDataAtRowProp(i,u);c=f!==null?f:r}e=c}return e}});function lE(e,t,r,n,o,i,a){var s=e.rootDocument;vp.apply(this,[e,t,r,n,o,i,a]),EOt(e);var l=TOt(s),u=a.label,c=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),yr(t),i===a.checkedTemplate||Pe(i).toLocaleLowerCase(a.locale)===Pe(a.checkedTemplate).toLocaleLowerCase(a.locale)?l.checked=!0:i===a.uncheckedTemplate||Pe(i).toLocaleLowerCase(a.locale)===Pe(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?l.checked=!1:Qe(i)?q(l,"noValue"):(l.style.display="none",q(l,kOt),c=!0),l.setAttribute(Kl,r),l.setAttribute(Xl,n),!c&&u){var f="";if(u.value)f=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);f=h!==null?h:""}var p=POt(s,f,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(p),t.appendChild(l)):(p.appendChild(l),l=p):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(l),t.appendChild(p)):(p.insertBefore(l,p.firstChild),l=p))}(!u||u&&!u.separated)&&t.appendChild(l),c&&t.appendChild(s.createTextNode("#bad-value#")),uD.has(e)||(uD.set(e,!0),y());function y(){var w=e.getShortcutManager(),C=w.getContext("grid"),A={group:ROt};C.addShortcuts([{keys:[["space"]],callback:function(){return m(),!v()}},{keys:[["enter"]],callback:function(){return m(),!v()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return m(!0),!v()},relativeToGroup:pf,position:"before"}],A)}function m(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=e.getSelectedRange();if(C)for(var A=0;A<C.length;A++){for(var D=C[A].getTopStartCorner(),E=D.row,G=D.col,K=C[A].getBottomEndCorner(),nt=K.row,z=K.col,X=[],Z=E;Z<=nt;Z+=1)for(var tt=G;tt<=z;tt+=1){var et=e.getCellMeta(Z,tt);if(et.type!=="checkbox")return;if(et.readOnly!==!0){typeof et.checkedTemplate>"u"&&(et.checkedTemplate=!0),typeof et.uncheckedTemplate>"u"&&(et.uncheckedTemplate=!1);var bt=e.getDataAtCell(Z,tt);w===!1?[et.checkedTemplate,et.checkedTemplate.toString()].includes(bt)?X.push([Z,tt,et.uncheckedTemplate]):[et.uncheckedTemplate,et.uncheckedTemplate.toString(),null,void 0].includes(bt)&&X.push([Z,tt,et.checkedTemplate]):X.push([Z,tt,et.uncheckedTemplate])}}X.length>0&&e.setDataAtCell(X)}}function v(){var w=e.getSelectedRange();if(w){for(var C=0;C<w.length;C++)for(var A=w[C].getTopStartCorner(),D=w[C].getBottomEndCorner(),E=A.row;E<=D.row;E++)for(var G=A.col;G<=D.col;G++){var K=e.getCellMeta(E,G);if(K.type!=="checkbox")return!1;var nt=e.getCell(E,G);if(nt==null)return!0;var z=nt.querySelectorAll("input[type=checkbox]");if(z.length>0&&!K.readOnly)return!0}return!1}}}lE.RENDERER_TYPE=MY;function EOt(e){var t=cD.get(e);if(!t){var r=e.rootElement;t=new Re(e),t.addEventListener(r,"click",function(n){return IOt(n,e)}),t.addEventListener(r,"mouseup",function(n){return MOt(n,e)}),t.addEventListener(r,"change",function(n){return xOt(n,e)}),cD.set(e,t)}return t}function TOt(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function POt(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function MOt(e,t){var r=e.target;uE(r)&&(!r.hasAttribute(Kl)||!r.hasAttribute(Xl)||setTimeout(t.listen,10))}function IOt(e,t){var r=e.target;if(uE(r)&&!(!r.hasAttribute(Kl)||!r.hasAttribute(Xl))){var n=parseInt(r.getAttribute(Kl),10),o=parseInt(r.getAttribute(Xl),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function xOt(e,t){var r=e.target;if(uE(r)&&!(!r.hasAttribute(Kl)||!r.hasAttribute(Xl))){var n=parseInt(r.getAttribute(Kl),10),o=parseInt(r.getAttribute(Xl),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function uE(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var cO={},jOt={get exports(){return cO},set exports(e){cO=e}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,c){if(!o[u]){if(!n[u]){var f=typeof Ep=="function"&&Ep;if(!c&&f)return f(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var p=o[u]={exports:{}};n[u][0].call(p.exports,function(y){return a(n[u][1][y]||y)},p,p.exports,r,n,o,i)}return o[u].exports}for(var s=typeof Ep=="function"&&Ep,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(r,n,o){(function(i){var a,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",h=1e14,p=14,y=9007199254740991,m=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,w=1e9;function C(z){var X=0|z;return 0<z||z===X?X:X-1}function A(z){for(var X,Z,tt=1,et=z.length,bt=z[0]+"";tt<et;){for(X=z[tt++]+"",Z=p-X.length;Z--;X="0"+X);bt+=X}for(et=bt.length;bt.charCodeAt(--et)===48;);return bt.slice(0,et+1||1)}function D(z,X){var Z,tt,et=z.c,bt=X.c,yt=z.s,kt=X.s,Et=z.e,P=X.e;if(!yt||!kt)return null;if(Z=et&&!et[0],tt=bt&&!bt[0],Z||tt)return Z?tt?0:-kt:yt;if(yt!=kt)return yt;if(Z=yt<0,tt=Et==P,!et||!bt)return tt?0:!et^Z?1:-1;if(!tt)return P<Et^Z?1:-1;for(kt=(Et=et.length)<(P=bt.length)?Et:P,yt=0;yt<kt;yt++)if(et[yt]!=bt[yt])return et[yt]>bt[yt]^Z?1:-1;return Et==P?0:P<Et^Z?1:-1}function E(z,X,Z,tt){if(z<X||Z<z||z!==(z<0?l(z):u(z)))throw Error(c+(tt||"Argument")+(typeof z=="number"?z<X||Z<z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(z))}function G(z){var X=z.c.length-1;return C(z.e/p)==X&&z.c[X]%2!=0}function K(z,X){return(1<z.length?z.charAt(0)+"."+z.slice(1):z)+(X<0?"e":"e+")+X}function nt(z,X,Z){var tt,et;if(X<0){for(et=Z+".";++X;et+=Z);z=et+z}else if(++X>(tt=z.length)){for(et=Z,X-=tt;--X;et+=Z);z+=et}else X<tt&&(z=z.slice(0,X)+"."+z.slice(X));return z}(a=function z(X){var Z,tt,et,bt,yt,kt,Et,P,d,g,b=Y.prototype={constructor:Y,toString:null,valueOf:null},O=new Y(1),R=20,I=4,W=-7,N=21,Q=-1e7,J=1e7,rt=!1,mt=1,ut=0,Ot={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},St="0123456789abcdefghijklmnopqrstuvwxyz";function Y(S,k){var M,L,j,V,_,H,F,B,U=this;if(!(U instanceof Y))return new Y(S,k);if(k==null){if(S instanceof Y)return U.s=S.s,U.e=S.e,void(U.c=(S=S.c)?S.slice():S);if((H=typeof S=="number")&&0*S==0){if(U.s=1/S<0?(S=-S,-1):1,S===~~S){for(V=0,_=S;10<=_;_/=10,V++);return U.e=V,void(U.c=[S])}B=String(S)}else{if(B=String(S),!s.test(B))return et(U,B,H);U.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}-1<(V=B.indexOf("."))&&(B=B.replace(".","")),0<(_=B.search(/e/i))?(V<0&&(V=_),V+=+B.slice(_+1),B=B.substring(0,_)):V<0&&(V=B.length)}else{if(E(k,2,St.length,"Base"),B=String(S),k==10)return Vt(U=new Y(S instanceof Y?S:B),R+U.e+1,I);if(H=typeof S=="number"){if(0*S!=0)return et(U,B,H,k);if(U.s=1/S<0?(B=B.slice(1),-1):1,Y.DEBUG&&15<B.replace(/^0\.0*|\./,"").length)throw Error(f+S);H=!1}else U.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(M=St.slice(0,k),V=_=0,F=B.length;_<F;_++)if(M.indexOf(L=B.charAt(_))<0){if(L=="."){if(V<_){V=F;continue}}else if(!j&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){j=!0,_=-1,V=0;continue}return et(U,String(S),H,k)}-1<(V=(B=tt(B,k,10,U.s)).indexOf("."))?B=B.replace(".",""):V=B.length}for(_=0;B.charCodeAt(_)===48;_++);for(F=B.length;B.charCodeAt(--F)===48;);if(B=B.slice(_,++F)){if(F-=_,H&&Y.DEBUG&&15<F&&(y<S||S!==u(S)))throw Error(f+U.s*S);if(J<(V=V-_-1))U.c=U.e=null;else if(V<Q)U.c=[U.e=0];else{if(U.e=V,U.c=[],_=(V+1)%p,V<0&&(_+=p),_<F){for(_&&U.c.push(+B.slice(0,_)),F-=p;_<F;)U.c.push(+B.slice(_,_+=p));B=B.slice(_),_=p-B.length}else _-=F;for(;_--;B+="0");U.c.push(+B)}}else U.c=[U.e=0]}function Ft(S,k,M,L){var j,V,_,H,F;if(M==null?M=I:E(M,0,8),!S.c)return S.toString();if(j=S.c[0],_=S.e,k==null)F=A(S.c),F=L==1||L==2&&(_<=W||N<=_)?K(F,_):nt(F,_,"0");else if(V=(S=Vt(new Y(S),k,M)).e,H=(F=A(S.c)).length,L==1||L==2&&(k<=V||V<=W)){for(;H<k;F+="0",H++);F=K(F,V)}else if(k-=_,F=nt(F,V,"0"),H<V+1){if(0<--k)for(F+=".";k--;F+="0");}else if(0<(k+=V-H))for(V+1==H&&(F+=".");k--;F+="0");return S.s<0&&j?"-"+F:F}function Lt(S,k){for(var M,L=1,j=new Y(S[0]);L<S.length;L++){if(!(M=new Y(S[L])).s){j=M;break}k.call(j,M)&&(j=M)}return j}function Tt(S,k,M){for(var L=1,j=k.length;!k[--j];k.pop());for(j=k[0];10<=j;j/=10,L++);return(M=L+M*p-1)>J?S.c=S.e=null:S.c=M<Q?[S.e=0]:(S.e=M,k),S}function Vt(S,k,M,L){var j,V,_,H,F,B,U,it=S.c,vt=m;if(it){t:{for(j=1,H=it[0];10<=H;H/=10,j++);if((V=k-j)<0)V+=p,_=k,U=(F=it[B=0])/vt[j-_-1]%10|0;else if((B=l((V+1)/p))>=it.length){if(!L)break t;for(;it.length<=B;it.push(0));F=U=0,_=(V%=p)-p+(j=1)}else{for(F=H=it[B],j=1;10<=H;H/=10,j++);U=(_=(V%=p)-p+j)<0?0:F/vt[j-_-1]%10|0}if(L=L||k<0||it[B+1]!=null||(_<0?F:F%vt[j-_-1]),L=M<4?(U||L)&&(M==0||M==(S.s<0?3:2)):5<U||U==5&&(M==4||L||M==6&&(0<V?0<_?F/vt[j-_]:0:it[B-1])%10&1||M==(S.s<0?8:7)),k<1||!it[0])return it.length=0,L?(k-=S.e+1,it[0]=vt[(p-k%p)%p],S.e=-k||0):it[0]=S.e=0,S;if(V==0?(it.length=B,H=1,B--):(it.length=B+1,H=vt[p-V],it[B]=0<_?u(F/vt[j-_]%vt[_])*H:0),L)for(;;){if(B==0){for(V=1,_=it[0];10<=_;_/=10,V++);for(_=it[0]+=H,H=1;10<=_;_/=10,H++);V!=H&&(S.e++,it[0]==h&&(it[0]=1));break}if(it[B]+=H,it[B]!=h)break;it[B--]=0,H=1}for(V=it.length;it[--V]===0;it.pop());}S.e>J?S.c=S.e=null:S.e<Q&&(S.c=[S.e=0])}return S}function It(S){var k,M=S.e;return M===null?S.toString():(k=A(S.c),k=M<=W||N<=M?K(k,M):nt(k,M,"0"),S.s<0?"-"+k:k)}return Y.clone=z,Y.ROUND_UP=0,Y.ROUND_DOWN=1,Y.ROUND_CEIL=2,Y.ROUND_FLOOR=3,Y.ROUND_HALF_UP=4,Y.ROUND_HALF_DOWN=5,Y.ROUND_HALF_EVEN=6,Y.ROUND_HALF_CEIL=7,Y.ROUND_HALF_FLOOR=8,Y.EUCLID=9,Y.config=Y.set=function(S){var k,M;if(S!=null){if(typeof S!="object")throw Error(c+"Object expected: "+S);if(S.hasOwnProperty(k="DECIMAL_PLACES")&&(E(M=S[k],0,w,k),R=M),S.hasOwnProperty(k="ROUNDING_MODE")&&(E(M=S[k],0,8,k),I=M),S.hasOwnProperty(k="EXPONENTIAL_AT")&&((M=S[k])&&M.pop?(E(M[0],-w,0,k),E(M[1],0,w,k),W=M[0],N=M[1]):(E(M,-w,w,k),W=-(N=M<0?-M:M))),S.hasOwnProperty(k="RANGE"))if((M=S[k])&&M.pop)E(M[0],-w,-1,k),E(M[1],1,w,k),Q=M[0],J=M[1];else{if(E(M,-w,w,k),!M)throw Error(c+k+" cannot be zero: "+M);Q=-(J=M<0?-M:M)}if(S.hasOwnProperty(k="CRYPTO")){if((M=S[k])!==!!M)throw Error(c+k+" not true or false: "+M);if(M){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw rt=!M,Error(c+"crypto unavailable");rt=M}else rt=M}if(S.hasOwnProperty(k="MODULO_MODE")&&(E(M=S[k],0,9,k),mt=M),S.hasOwnProperty(k="POW_PRECISION")&&(E(M=S[k],0,w,k),ut=M),S.hasOwnProperty(k="FORMAT")){if(typeof(M=S[k])!="object")throw Error(c+k+" not an object: "+M);Ot=M}if(S.hasOwnProperty(k="ALPHABET")){if(typeof(M=S[k])!="string"||/^.$|[+-.\s]|(.).*\1/.test(M))throw Error(c+k+" invalid: "+M);St=M}}return{DECIMAL_PLACES:R,ROUNDING_MODE:I,EXPONENTIAL_AT:[W,N],RANGE:[Q,J],CRYPTO:rt,MODULO_MODE:mt,POW_PRECISION:ut,FORMAT:Ot,ALPHABET:St}},Y.isBigNumber=function(S){return S instanceof Y||S&&S._isBigNumber===!0||!1},Y.maximum=Y.max=function(){return Lt(arguments,b.lt)},Y.minimum=Y.min=function(){return Lt(arguments,b.gt)},Y.random=(bt=9007199254740992,yt=Math.random()*bt&2097151?function(){return u(Math.random()*bt)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(S){var k,M,L,j,V,_=0,H=[],F=new Y(O);if(S==null?S=R:E(S,0,w),j=l(S/p),rt)if(crypto.getRandomValues){for(k=crypto.getRandomValues(new Uint32Array(j*=2));_<j;)9e15<=(V=131072*k[_]+(k[_+1]>>>11))?(M=crypto.getRandomValues(new Uint32Array(2)),k[_]=M[0],k[_+1]=M[1]):(H.push(V%1e14),_+=2);_=j/2}else{if(!crypto.randomBytes)throw rt=!1,Error(c+"crypto unavailable");for(k=crypto.randomBytes(j*=7);_<j;)9e15<=(V=281474976710656*(31&k[_])+1099511627776*k[_+1]+4294967296*k[_+2]+16777216*k[_+3]+(k[_+4]<<16)+(k[_+5]<<8)+k[_+6])?crypto.randomBytes(7).copy(k,_):(H.push(V%1e14),_+=7);_=j/7}if(!rt)for(;_<j;)(V=yt())<9e15&&(H[_++]=V%1e14);for(j=H[--_],S%=p,j&&S&&(V=m[p-S],H[_]=u(j/V)*V);H[_]===0;H.pop(),_--);if(_<0)H=[L=0];else{for(L=-1;H[0]===0;H.splice(0,1),L-=p);for(_=1,V=H[0];10<=V;V/=10,_++);_<p&&(L-=p-_)}return F.e=L,F.c=H,F}),Y.sum=function(){for(var S=1,k=arguments,M=new Y(k[0]);S<k.length;)M=M.plus(k[S++]);return M},tt=function(){var S="0123456789";function k(M,L,j,V){for(var _,H,F=[0],B=0,U=M.length;B<U;){for(H=F.length;H--;F[H]*=L);for(F[0]+=V.indexOf(M.charAt(B++)),_=0;_<F.length;_++)F[_]>j-1&&(F[_+1]==null&&(F[_+1]=0),F[_+1]+=F[_]/j|0,F[_]%=j)}return F.reverse()}return function(M,L,j,V,_){var H,F,B,U,it,vt,Rt,_t,Yt=M.indexOf("."),qt=R,Ht=I;for(0<=Yt&&(U=ut,ut=0,M=M.replace(".",""),vt=(_t=new Y(L)).pow(M.length-Yt),ut=U,_t.c=k(nt(A(vt.c),vt.e,"0"),10,j,S),_t.e=_t.c.length),B=U=(Rt=k(M,L,j,_?(H=St,S):(H=S,St))).length;Rt[--U]==0;Rt.pop());if(!Rt[0])return H.charAt(0);if(Yt<0?--B:(vt.c=Rt,vt.e=B,vt.s=V,Rt=(vt=Z(vt,_t,qt,Ht,j)).c,it=vt.r,B=vt.e),Yt=Rt[F=B+qt+1],U=j/2,it=it||F<0||Rt[F+1]!=null,it=Ht<4?(Yt!=null||it)&&(Ht==0||Ht==(vt.s<0?3:2)):U<Yt||Yt==U&&(Ht==4||it||Ht==6&&1&Rt[F-1]||Ht==(vt.s<0?8:7)),F<1||!Rt[0])M=it?nt(H.charAt(1),-qt,H.charAt(0)):H.charAt(0);else{if(Rt.length=F,it)for(--j;++Rt[--F]>j;)Rt[F]=0,F||(++B,Rt=[1].concat(Rt));for(U=Rt.length;!Rt[--U];);for(Yt=0,M="";Yt<=U;M+=H.charAt(Rt[Yt++]));M=nt(M,B,H.charAt(0))}return M}}(),Z=function(){function S(L,j,V){var _,H,F,B,U=0,it=L.length,vt=j%v,Rt=j/v|0;for(L=L.slice();it--;)U=((H=vt*(F=L[it]%v)+(_=Rt*F+(B=L[it]/v|0)*vt)%v*v+U)/V|0)+(_/v|0)+Rt*B,L[it]=H%V;return U&&(L=[U].concat(L)),L}function k(L,j,V,_){var H,F;if(V!=_)F=_<V?1:-1;else for(H=F=0;H<V;H++)if(L[H]!=j[H]){F=L[H]>j[H]?1:-1;break}return F}function M(L,j,V,_){for(var H=0;V--;)L[V]-=H,H=L[V]<j[V]?1:0,L[V]=H*_+L[V]-j[V];for(;!L[0]&&1<L.length;L.splice(0,1));}return function(L,j,V,_,H){var F,B,U,it,vt,Rt,_t,Yt,qt,Ht,Nt,Pt,oe,xe,te,ue,Xe,be=L.s==j.s?1:-1,Ce=L.c,ie=j.c;if(!(Ce&&Ce[0]&&ie&&ie[0]))return new Y(L.s&&j.s&&(Ce?!ie||Ce[0]!=ie[0]:ie)?Ce&&Ce[0]==0||!ie?0*be:be/0:NaN);for(qt=(Yt=new Y(be)).c=[],be=V+(B=L.e-j.e)+1,H||(H=h,B=C(L.e/p)-C(j.e/p),be=be/p|0),U=0;ie[U]==(Ce[U]||0);U++);if(ie[U]>(Ce[U]||0)&&B--,be<0)qt.push(1),it=!0;else{for(xe=Ce.length,ue=ie.length,be+=2,1<(vt=u(H/(ie[U=0]+1)))&&(ie=S(ie,vt,H),Ce=S(Ce,vt,H),ue=ie.length,xe=Ce.length),oe=ue,Nt=(Ht=Ce.slice(0,ue)).length;Nt<ue;Ht[Nt++]=0);Xe=ie.slice(),Xe=[0].concat(Xe),te=ie[0],ie[1]>=H/2&&te++;do{if(vt=0,(F=k(ie,Ht,ue,Nt))<0){if(Pt=Ht[0],ue!=Nt&&(Pt=Pt*H+(Ht[1]||0)),1<(vt=u(Pt/te)))for(H<=vt&&(vt=H-1),_t=(Rt=S(ie,vt,H)).length,Nt=Ht.length;k(Rt,Ht,_t,Nt)==1;)vt--,M(Rt,ue<_t?Xe:ie,_t,H),_t=Rt.length,F=1;else vt==0&&(F=vt=1),_t=(Rt=ie.slice()).length;if(_t<Nt&&(Rt=[0].concat(Rt)),M(Ht,Rt,Nt,H),Nt=Ht.length,F==-1)for(;k(ie,Ht,ue,Nt)<1;)vt++,M(Ht,ue<Nt?Xe:ie,Nt,H),Nt=Ht.length}else F===0&&(vt++,Ht=[0]);qt[U++]=vt,Ht[0]?Ht[Nt++]=Ce[oe]||0:(Ht=[Ce[oe]],Nt=1)}while((oe++<xe||Ht[0]!=null)&&be--);it=Ht[0]!=null,qt[0]||qt.splice(0,1)}if(H==h){for(U=1,be=qt[0];10<=be;be/=10,U++);Vt(Yt,V+(Yt.e=U+B*p-1)+1,_,it)}else Yt.e=B,Yt.r=+it;return Yt}}(),kt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Et=/^([^.]+)\.$/,P=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,et=function(S,k,M,L){var j,V=M?k:k.replace(g,"");if(d.test(V))S.s=isNaN(V)?null:V<0?-1:1,S.c=S.e=null;else{if(!M&&(V=V.replace(kt,function(_,H,F){return j=(F=F.toLowerCase())=="x"?16:F=="b"?2:8,L&&L!=j?_:H}),L&&(j=L,V=V.replace(Et,"$1").replace(P,"0.$1")),k!=V))return new Y(V,j);if(Y.DEBUG)throw Error(c+"Not a"+(L?" base "+L:"")+" number: "+k);S.c=S.e=S.s=null}},b.absoluteValue=b.abs=function(){var S=new Y(this);return S.s<0&&(S.s=1),S},b.comparedTo=function(S,k){return D(this,new Y(S,k))},b.decimalPlaces=b.dp=function(S,k){var M,L,j;if(S!=null)return E(S,0,w),k==null?k=I:E(k,0,8),Vt(new Y(this),S+this.e+1,k);if(!(M=this.c))return null;if(L=((j=M.length-1)-C(this.e/p))*p,j=M[j])for(;j%10==0;j/=10,L--);return L<0&&(L=0),L},b.dividedBy=b.div=function(S,k){return Z(this,new Y(S,k),R,I)},b.dividedToIntegerBy=b.idiv=function(S,k){return Z(this,new Y(S,k),0,1)},b.exponentiatedBy=b.pow=function(S,k){var M,L,j,V,_,H,F,B,U=this;if((S=new Y(S)).c&&!S.isInteger())throw Error(c+"Exponent not an integer: "+It(S));if(k!=null&&(k=new Y(k)),_=14<S.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!S.c||!S.c[0])return B=new Y(Math.pow(+It(U),_?2-G(S):+It(S))),k?B.mod(k):B;if(H=S.s<0,k){if(k.c?!k.c[0]:!k.s)return new Y(NaN);(L=!H&&U.isInteger()&&k.isInteger())&&(U=U.mod(k))}else{if(9<S.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||_&&24e7<=U.c[1]:U.c[0]<8e13||_&&U.c[0]<=9999975e7)))return V=U.s<0&&G(S)?-0:0,-1<U.e&&(V=1/V),new Y(H?1/V:V);ut&&(V=l(ut/p+2))}for(F=_?(M=new Y(.5),H&&(S.s=1),G(S)):(j=Math.abs(+It(S)))%2,B=new Y(O);;){if(F){if(!(B=B.times(U)).c)break;V?B.c.length>V&&(B.c.length=V):L&&(B=B.mod(k))}if(j){if((j=u(j/2))===0)break;F=j%2}else if(Vt(S=S.times(M),S.e+1,1),14<S.e)F=G(S);else{if((j=+It(S))==0)break;F=j%2}U=U.times(U),V?U.c&&U.c.length>V&&(U.c.length=V):L&&(U=U.mod(k))}return L?B:(H&&(B=O.div(B)),k?B.mod(k):V?Vt(B,ut,I,void 0):B)},b.integerValue=function(S){var k=new Y(this);return S==null?S=I:E(S,0,8),Vt(k,k.e+1,S)},b.isEqualTo=b.eq=function(S,k){return D(this,new Y(S,k))===0},b.isFinite=function(){return!!this.c},b.isGreaterThan=b.gt=function(S,k){return 0<D(this,new Y(S,k))},b.isGreaterThanOrEqualTo=b.gte=function(S,k){return(k=D(this,new Y(S,k)))===1||k===0},b.isInteger=function(){return!!this.c&&C(this.e/p)>this.c.length-2},b.isLessThan=b.lt=function(S,k){return D(this,new Y(S,k))<0},b.isLessThanOrEqualTo=b.lte=function(S,k){return(k=D(this,new Y(S,k)))===-1||k===0},b.isNaN=function(){return!this.s},b.isNegative=function(){return this.s<0},b.isPositive=function(){return 0<this.s},b.isZero=function(){return!!this.c&&this.c[0]==0},b.minus=function(S,k){var M,L,j,V,_=this,H=_.s;if(k=(S=new Y(S,k)).s,!H||!k)return new Y(NaN);if(H!=k)return S.s=-k,_.plus(S);var F=_.e/p,B=S.e/p,U=_.c,it=S.c;if(!F||!B){if(!U||!it)return U?(S.s=-k,S):new Y(it?_:NaN);if(!U[0]||!it[0])return it[0]?(S.s=-k,S):new Y(U[0]?_:I==3?-0:0)}if(F=C(F),B=C(B),U=U.slice(),H=F-B){for((j=(V=H<0)?(H=-H,U):(B=F,it)).reverse(),k=H;k--;j.push(0));j.reverse()}else for(L=(V=(H=U.length)<(k=it.length))?H:k,H=k=0;k<L;k++)if(U[k]!=it[k]){V=U[k]<it[k];break}if(V&&(j=U,U=it,it=j,S.s=-S.s),0<(k=(L=it.length)-(M=U.length)))for(;k--;U[M++]=0);for(k=h-1;H<L;){if(U[--L]<it[L]){for(M=L;M&&!U[--M];U[M]=k);--U[M],U[L]+=h}U[L]-=it[L]}for(;U[0]==0;U.splice(0,1),--B);return U[0]?Tt(S,U,B):(S.s=I==3?-1:1,S.c=[S.e=0],S)},b.modulo=b.mod=function(S,k){var M,L,j=this;return S=new Y(S,k),!j.c||!S.s||S.c&&!S.c[0]?new Y(NaN):!S.c||j.c&&!j.c[0]?new Y(j):(mt==9?(L=S.s,S.s=1,M=Z(j,S,0,3),S.s=L,M.s*=L):M=Z(j,S,0,mt),(S=j.minus(M.times(S))).c[0]||mt!=1||(S.s=j.s),S)},b.multipliedBy=b.times=function(S,k){var M,L,j,V,_,H,F,B,U,it,vt,Rt,_t,Yt,qt,Ht=this,Nt=Ht.c,Pt=(S=new Y(S,k)).c;if(!(Nt&&Pt&&Nt[0]&&Pt[0]))return!Ht.s||!S.s||Nt&&!Nt[0]&&!Pt||Pt&&!Pt[0]&&!Nt?S.c=S.e=S.s=null:(S.s*=Ht.s,Nt&&Pt?(S.c=[0],S.e=0):S.c=S.e=null),S;for(L=C(Ht.e/p)+C(S.e/p),S.s*=Ht.s,(F=Nt.length)<(it=Pt.length)&&(_t=Nt,Nt=Pt,Pt=_t,j=F,F=it,it=j),j=F+it,_t=[];j--;_t.push(0));for(Yt=h,qt=v,j=it;0<=--j;){for(M=0,vt=Pt[j]%qt,Rt=Pt[j]/qt|0,V=j+(_=F);j<V;)M=((B=vt*(B=Nt[--_]%qt)+(H=Rt*B+(U=Nt[_]/qt|0)*vt)%qt*qt+_t[V]+M)/Yt|0)+(H/qt|0)+Rt*U,_t[V--]=B%Yt;_t[V]=M}return M?++L:_t.splice(0,1),Tt(S,_t,L)},b.negated=function(){var S=new Y(this);return S.s=-S.s||null,S},b.plus=function(S,k){var M,L=this,j=L.s;if(k=(S=new Y(S,k)).s,!j||!k)return new Y(NaN);if(j!=k)return S.s=-k,L.minus(S);var V=L.e/p,_=S.e/p,H=L.c,F=S.c;if(!V||!_){if(!H||!F)return new Y(j/0);if(!H[0]||!F[0])return F[0]?S:new Y(H[0]?L:0*j)}if(V=C(V),_=C(_),H=H.slice(),j=V-_){for((M=0<j?(_=V,F):(j=-j,H)).reverse();j--;M.push(0));M.reverse()}for((j=H.length)-(k=F.length)<0&&(M=F,F=H,H=M,k=j),j=0;k;)j=(H[--k]=H[k]+F[k]+j)/h|0,H[k]=h===H[k]?0:H[k]%h;return j&&(H=[j].concat(H),++_),Tt(S,H,_)},b.precision=b.sd=function(S,k){var M,L,j;if(S!=null&&S!==!!S)return E(S,1,w),k==null?k=I:E(k,0,8),Vt(new Y(this),S,k);if(!(M=this.c))return null;if(L=(j=M.length-1)*p+1,j=M[j]){for(;j%10==0;j/=10,L--);for(j=M[0];10<=j;j/=10,L++);}return S&&this.e+1>L&&(L=this.e+1),L},b.shiftedBy=function(S){return E(S,-y,y),this.times("1e"+S)},b.squareRoot=b.sqrt=function(){var S,k,M,L,j,V=this,_=V.c,H=V.s,F=V.e,B=R+4,U=new Y("0.5");if(H!==1||!_||!_[0])return new Y(!H||H<0&&(!_||_[0])?NaN:_?V:1/0);if((M=(H=Math.sqrt(+It(V)))==0||H==1/0?(((k=A(_)).length+F)%2==0&&(k+="0"),H=Math.sqrt(+k),F=C((F+1)/2)-(F<0||F%2),new Y(k=H==1/0?"1e"+F:(k=H.toExponential()).slice(0,k.indexOf("e")+1)+F)):new Y(H+"")).c[0]){for((H=(F=M.e)+B)<3&&(H=0);;)if(j=M,M=U.times(j.plus(Z(V,j,B,1))),A(j.c).slice(0,H)===(k=A(M.c)).slice(0,H)){if(M.e<F&&--H,(k=k.slice(H-3,H+1))!="9999"&&(L||k!="4999")){+k&&(+k.slice(1)||k.charAt(0)!="5")||(Vt(M,M.e+R+2,1),S=!M.times(M).eq(V));break}if(!L&&(Vt(j,j.e+R+2,0),j.times(j).eq(V))){M=j;break}B+=4,H+=4,L=1}}return Vt(M,M.e+R+1,I,S)},b.toExponential=function(S,k){return S!=null&&(E(S,0,w),S++),Ft(this,S,k,1)},b.toFixed=function(S,k){return S!=null&&(E(S,0,w),S=S+this.e+1),Ft(this,S,k)},b.toFormat=function(S,k,M){var L;if(M==null)S!=null&&k&&typeof k=="object"?(M=k,k=null):S&&typeof S=="object"?(M=S,S=k=null):M=Ot;else if(typeof M!="object")throw Error(c+"Argument not an object: "+M);if(L=this.toFixed(S,k),this.c){var j,V=L.split("."),_=+M.groupSize,H=+M.secondaryGroupSize,F=M.groupSeparator||"",B=V[0],U=V[1],it=this.s<0,vt=it?B.slice(1):B,Rt=vt.length;if(H&&(j=_,_=H,Rt-=H=j),0<_&&0<Rt){for(j=Rt%_||_,B=vt.substr(0,j);j<Rt;j+=_)B+=F+vt.substr(j,_);0<H&&(B+=F+vt.slice(j)),it&&(B="-"+B)}L=U?B+(M.decimalSeparator||"")+((H=+M.fractionGroupSize)?U.replace(new RegExp("\\d{"+H+"}\\B","g"),"$&"+(M.fractionGroupSeparator||"")):U):B}return(M.prefix||"")+L+(M.suffix||"")},b.toFraction=function(S){var k,M,L,j,V,_,H,F,B,U,it,vt,Rt=this,_t=Rt.c;if(S!=null&&(!(H=new Y(S)).isInteger()&&(H.c||H.s!==1)||H.lt(O)))throw Error(c+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+It(H));if(!_t)return new Y(Rt);for(k=new Y(O),B=M=new Y(O),L=F=new Y(O),vt=A(_t),V=k.e=vt.length-Rt.e-1,k.c[0]=m[(_=V%p)<0?p+_:_],S=!S||0<H.comparedTo(k)?0<V?k:B:H,_=J,J=1/0,H=new Y(vt),F.c[0]=0;U=Z(H,k,0,1),(j=M.plus(U.times(L))).comparedTo(S)!=1;)M=L,L=j,B=F.plus(U.times(j=B)),F=j,k=H.minus(U.times(j=k)),H=j;return j=Z(S.minus(M),L,0,1),F=F.plus(j.times(B)),M=M.plus(j.times(L)),F.s=B.s=Rt.s,it=Z(B,L,V*=2,I).minus(Rt).abs().comparedTo(Z(F,M,V,I).minus(Rt).abs())<1?[B,L]:[F,M],J=_,it},b.toNumber=function(){return+It(this)},b.toPrecision=function(S,k){return S!=null&&E(S,1,w),Ft(this,S,k,2)},b.toString=function(S){var k,M=this,L=M.s,j=M.e;return j===null?L?(k="Infinity",L<0&&(k="-"+k)):k="NaN":(k=S==null?j<=W||N<=j?K(A(M.c),j):nt(A(M.c),j,"0"):S===10?nt(A((M=Vt(new Y(M),R+j+1,I)).c),M.e,"0"):(E(S,2,St.length,"Base"),tt(nt(A(M.c),j,"0"),10,S,L,!0)),L<0&&M.c[0]&&(k="-"+k)),k},b.valueOf=b.toJSON=function(){return It(this)},b._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(b[Symbol.toStringTag]="BigNumber",b[Symbol.for("nodejs.util.inspect.custom")]=b.valueOf),X!=null&&Y.set(X),Y}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(C,A){return function(D){if(Array.isArray(D))return D}(C)||function(D,E){var G=[],K=!0,nt=!1,z=void 0;try{for(var X,Z=D[Symbol.iterator]();!(K=(X=Z.next()).done)&&(G.push(X.value),!E||G.length!==E);K=!0);}catch(tt){nt=!0,z=tt}finally{try{K||Z.return==null||Z.return()}finally{if(nt)throw z}}return G}(C,A)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(C){var A=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},D=2<arguments.length?arguments[2]:void 0;if(typeof A=="string"&&(A=l.parseFormat(A)),!s.validateFormat(A))return"ERROR: invalid format";var E=A.prefix||"",G=A.postfix||"",K=function(nt,z,X){switch(z.output){case"currency":return z=w(z,a.currentCurrencyDefaultFormat()),function(St,Y,Ft){var Lt=Ft.currentCurrency(),Tt=Object.assign({},f,Y),Vt=void 0,It="",S=!!Tt.totalLength||!!Tt.forceAverage||Tt.average,k=Y.currencyPosition||Lt.position,M=Y.currencySymbol||Lt.symbol;Tt.spaceSeparated&&(It=" "),k==="infix"&&(Vt=It+M+It);var L=v({instance:St,providedFormat:Y,state:Ft,decimalSeparator:Vt});return k==="prefix"&&(L=St._value<0&&Tt.negative==="sign"?"-".concat(It).concat(M).concat(L.slice(1)):M+It+L),k&&k!=="postfix"||(L=L+(It=S?"":It)+M),L}(nt,z,a);case"percent":return z=w(z,a.currentPercentageDefaultFormat()),function(St,Y,Ft,Lt){var Tt=Y.prefixSymbol,Vt=v({instance:Lt(100*St._value),providedFormat:Y,state:Ft}),It=Object.assign({},f,Y);return Tt?"%".concat(It.spaceSeparated?" ":"").concat(Vt):"".concat(Vt).concat(It.spaceSeparated?" ":"","%")}(nt,z,a,X);case"byte":return z=w(z,a.currentByteDefaultFormat()),O=nt,I=a,W=X,N=(R=z).base||"binary",Q=c[N],J=p(O._value,Q.suffixes,Q.scale),rt=J.value,mt=J.suffix,ut=v({instance:W(rt),providedFormat:R,state:I,defaults:I.currentByteDefaultFormat()}),Ot=I.currentAbbreviations(),"".concat(ut).concat(Ot.spaced?" ":"").concat(mt);case"time":return z=w(z,a.currentTimeDefaultFormat()),P=nt,d=Math.floor(P._value/60/60),g=Math.floor((P._value-60*d*60)/60),b=Math.round(P._value-60*d*60-60*g),"".concat(d,":").concat(g<10?"0":"").concat(g,":").concat(b<10?"0":"").concat(b);case"ordinal":return z=w(z,a.currentOrdinalDefaultFormat()),Z=nt,tt=z,bt=(et=a).currentOrdinal(),yt=Object.assign({},f,tt),kt=v({instance:Z,providedFormat:tt,state:et}),Et=bt(Z._value),"".concat(kt).concat(yt.spaceSeparated?" ":"").concat(Et);case"number":default:return v({instance:nt,providedFormat:z,numbro:X})}var Z,tt,et,bt,yt,kt,Et,P,d,g,b,O,R,I,W,N,Q,J,rt,mt,ut,Ot}(C,A,D);return K=(K=E+K)+G}function p(C,A,D){var E=A[0],G=Math.abs(C);if(D<=G){for(var K=1;K<A.length;++K){var nt=Math.pow(D,K),z=Math.pow(D,K+1);if(nt<=G&&G<z){E=A[K],C/=nt;break}}E===A[0]&&(C/=Math.pow(D,A.length-1),E=A[A.length-1])}return{value:C,suffix:E}}function y(C){for(var A="",D=0;D<C;D++)A+="0";return A}function m(C,A){return C.toString().indexOf("e")!==-1?function(D,E){var G=D.toString(),K=i(G.split("e"),2),nt=K[0],z=K[1],X=i(nt.split("."),2),Z=X[0],tt=X[1],et=tt===void 0?"":tt;if(0<+z)G=Z+et+y(z-et.length);else{var bt=".";bt=+Z<0?"-0".concat(bt):"0".concat(bt);var yt=(y(-z-1)+Math.abs(Z)+et).substr(0,E);yt.length<E&&(yt+=y(E-yt.length)),G=bt+yt}return 0<+z&&0<E&&(G+=".".concat(y(E))),G}(C,A):(Math.round(+"".concat(C,"e+").concat(A))/Math.pow(10,A)).toFixed(A)}function v(C){var A=C.instance,D=C.providedFormat,E=C.state,G=E===void 0?a:E,K=C.decimalSeparator,nt=C.defaults,z=nt===void 0?G.currentDefaults():nt,X=A._value;if(X===0&&G.hasZeroFormat())return G.getZeroFormat();if(!isFinite(X))return X.toString();var Z,tt,et,bt,yt,kt,Et,P,d=Object.assign({},f,z,D),g=d.totalLength,b=g?0:d.characteristic,O=d.optionalCharacteristic,R=d.forceAverage,I=!!g||!!R||d.average,W=g?-1:I&&D.mantissa===void 0?0:d.mantissa,N=!g&&(D.optionalMantissa===void 0?W===-1:d.optionalMantissa),Q=d.trimMantissa,J=d.thousandSeparated,rt=d.spaceSeparated,mt=d.negative,ut=d.forceSign,Ot=d.exponential,St="";if(I){var Y=function(S){var k=S.value,M=S.forceAverage,L=S.abbreviations,j=S.spaceSeparated,V=j!==void 0&&j,_=S.totalLength,H=_===void 0?0:_,F="",B=Math.abs(k),U=-1;if(B>=Math.pow(10,12)&&!M||M==="trillion"?(F=L.trillion,k/=Math.pow(10,12)):B<Math.pow(10,12)&&B>=Math.pow(10,9)&&!M||M==="billion"?(F=L.billion,k/=Math.pow(10,9)):B<Math.pow(10,9)&&B>=Math.pow(10,6)&&!M||M==="million"?(F=L.million,k/=Math.pow(10,6)):(B<Math.pow(10,6)&&B>=Math.pow(10,3)&&!M||M==="thousand")&&(F=L.thousand,k/=Math.pow(10,3)),F&&(F=(V?" ":"")+F),H){var it=k.toString().split(".")[0];U=Math.max(H-it.length,0)}return{value:k,abbreviation:F,mantissaPrecision:U}}({value:X,forceAverage:R,abbreviations:G.currentAbbreviations(),spaceSeparated:rt,totalLength:g});X=Y.value,St+=Y.abbreviation,g&&(W=Y.mantissaPrecision)}if(Ot){var Ft=(tt=(Z={value:X,characteristicPrecision:b}).value,et=Z.characteristicPrecision,bt=et===void 0?0:et,yt=i(tt.toExponential().split("e"),2),kt=yt[0],Et=yt[1],P=+kt,bt&&1<bt&&(P*=Math.pow(10,bt-1),Et=0<=(Et=+Et-(bt-1))?"+".concat(Et):Et),{value:P,abbreviation:"e".concat(Et)});X=Ft.value,St=Ft.abbreviation+St}var Lt,Tt,Vt,It=function(S,k,M,L,j){if(L===-1)return S;var V=m(k,L),_=i(V.toString().split("."),2),H=_[0],F=_[1],B=F===void 0?"":F;if(B.match(/^0+$/)&&(M||j))return H;var U=B.match(/0+$/);return j&&U?"".concat(H,".").concat(B.toString().slice(0,U.index)):V.toString()}(X.toString(),X,N,W,Q);return It=function(S,k,M,L,j){var V=L.currentDelimiters(),_=V.thousands;j=j||V.decimal;var H=V.thousandsSize||3,F=S.toString(),B=F.split(".")[0],U=F.split(".")[1];return M&&(k<0&&(B=B.slice(1)),function(it,vt){for(var Rt=[],_t=0,Yt=it;0<Yt;Yt--)_t===vt&&(Rt.unshift(Yt),_t=0),_t++;return Rt}(B.length,H).forEach(function(it,vt){B=B.slice(0,it+vt)+_+B.slice(it+vt)}),k<0&&(B="-".concat(B))),F=U?B+j+U:B}(It=function(S,k,M,L){var j=S,V=i(j.toString().split("."),2),_=V[0],H=V[1];if(_.match(/^-?0$/)&&M)return H?"".concat(_.replace("0",""),".").concat(H):_.replace("0","");if(_.length<L)for(var F=L-_.length,B=0;B<F;B++)j="0".concat(j);return j.toString()}(It,0,O,b),X,J,G,K),(I||Ot)&&(It=It+St),(ut||X<0)&&(Lt=It,Vt=mt,It=(Tt=X)===0?Lt:+Lt==0?Lt.replace("-",""):0<Tt?"+".concat(Lt):Vt==="sign"?Lt:"(".concat(Lt.replace("-",""),")")),It}function w(C,A){if(!C)return A;var D=Object.keys(C);return D.length===1&&D[0]==="output"?A:C}n.exports=function(C){return{format:function(){for(var A=arguments.length,D=new Array(A),E=0;E<A;E++)D[E]=arguments[E];return h.apply(void 0,D.concat([C]))},getByteUnit:function(){for(var A=arguments.length,D=new Array(A),E=0;E<A;E++)D[E]=arguments[E];return(function(G){var K=c.general;return p(G._value,K.suffixes,K.scale).suffix}).apply(void 0,D.concat([C]))},getBinaryByteUnit:function(){for(var A=arguments.length,D=new Array(A),E=0;E<A;E++)D[E]=arguments[E];return(function(G){var K=c.binary;return p(G._value,K.suffixes,K.scale).suffix}).apply(void 0,D.concat([C]))},getDecimalByteUnit:function(){for(var A=arguments.length,D=new Array(A),E=0;E<A;E++)D[E]=arguments[E];return(function(G){var K=c.decimal;return p(G._value,K.suffixes,K.scale).suffix}).apply(void 0,D.concat([C]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),s=r("./parsing"),l={},u=void 0,c={},f=null,h={};function p(m){u=m}function y(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return y().currency},l.currentAbbreviations=function(){return y().abbreviations},l.currentDelimiters=function(){return y().delimiters},l.currentOrdinal=function(){return y().ordinal},l.currentDefaults=function(){return Object.assign({},y().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().timeFormat)},l.setDefaults=function(m){m=s.parseFormat(m),a.validateFormat(m)&&(h=m)},l.getZeroFormat=function(){return f},l.setZeroFormat=function(m){return f=typeof m=="string"?m:null},l.hasZeroFormat=function(){return f!==null},l.languageData=function(m){if(m){if(c[m])return c[m];throw new Error('Unknown tag "'.concat(m,'"'))}return y()},l.registerLanguage=function(m){var v=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(m))throw new Error("Invalid language data");c[m.languageTag]=m,v&&p(m.languageTag)},l.setLanguage=function(m){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!c[m]){var w=m.split("-")[0],C=Object.keys(c).find(function(A){return A.split("-")[0]===w});return c[C]?void p(C):void p(v)}p(m)},l.registerLanguage(i),u=i.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return s=i,void a.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(s,l,u){var c=new i(s._value),f=l;return u.isNumbro(l)&&(f=l._value),f=new i(f),s._value=c.minus(f).toNumber(),s}n.exports=function(s){return{add:function(l,u){return f=u,h=s,p=new i((c=l)._value),y=f,h.isNumbro(f)&&(y=f._value),y=new i(y),c._value=p.plus(y).toNumber(),c;var c,f,h,p,y},subtract:function(l,u){return a(l,u,s)},multiply:function(l,u){return f=u,h=s,p=new i((c=l)._value),y=f,h.isNumbro(f)&&(y=f._value),y=new i(y),c._value=p.times(y).toNumber(),c;var c,f,h,p,y},divide:function(l,u){return f=u,h=s,p=new i((c=l)._value),y=f,h.isNumbro(f)&&(y=f._value),y=new i(y),c._value=p.dividedBy(y).toNumber(),c;var c,f,h,p,y},set:function(l,u){return c=l,h=f=u,s.isNumbro(f)&&(h=f._value),c._value=h,c;var c,f,h},difference:function(l,u){return c=u,a(h=(f=s)(l._value),c,f),Math.abs(h._value);var c,f,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(v,w){for(var C=0;C<w.length;C++){var A=w[C];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(v,A.key,A)}}var a=r("./globalState"),s=r("./validating"),l=r("./loading")(m),u=r("./unformatting"),c=r("./formatting")(m),f=r("./manipulating")(m),h=r("./parsing"),p=function(){function v(A){(function(D,E){if(!(D instanceof E))throw new TypeError("Cannot call a class as a function")})(this,v),this._value=A}var w,C;return w=v,(C=[{key:"clone",value:function(){return m(this._value)}},{key:"format",value:function(){var A=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,A)}},{key:"formatCurrency",value:function(A){return typeof A=="string"&&(A=h.parseFormat(A)),(A=c.formatOrDefault(A,a.currentCurrencyDefaultFormat())).output="currency",c.format(this,A)}},{key:"formatTime",value:function(){var A=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return A.output="time",c.format(this,A)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(A){return f.difference(this,A)}},{key:"add",value:function(A){return f.add(this,A)}},{key:"subtract",value:function(A){return f.subtract(this,A)}},{key:"multiply",value:function(A){return f.multiply(this,A)}},{key:"divide",value:function(A){return f.divide(this,A)}},{key:"set",value:function(A){return f.set(this,y(A))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,C),v}();function y(v){var w=v;return m.isNumbro(v)?w=v._value:typeof v=="string"?w=m.unformat(v):isNaN(v)&&(w=NaN),w}function m(v){return new p(y(v))}m.version="2.1.2",m.isNumbro=function(v){return v instanceof p},m.language=a.currentLanguage,m.registerLanguage=a.registerLanguage,m.setLanguage=a.setLanguage,m.languages=a.languages,m.languageData=a.languageData,m.zeroFormat=a.setZeroFormat,m.defaultFormat=a.currentDefaults,m.setDefaults=a.setDefaults,m.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,m.validate=s.validate,m.loadLanguagesInNode=l.loadLanguagesInNode,m.unformat=u.unformat,n.exports=m},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,s,l,u,c,f,h,p,y,m,v,w,C,A,D,E,G,K,nt,z,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(s=X,i=(l=(a=i).match(/^{([^}]*)}/))?(s.prefix=l[1],a.slice(l[0].length)):a,c=X,function(Z,tt){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(tt.output="byte",tt.base="general"):Z.indexOf("b")!==-1?(tt.output="byte",tt.base="binary"):Z.indexOf("d")!==-1?(tt.output="byte",tt.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(tt.output="ordinal"):tt.output="time";tt.output="percent"}else tt.output="currency"}(i=(f=(u=i).match(/{([^}]*)}$/))?(c.postfix=f[1],u.slice(0,-f[0].length)):u,X),h=X,(p=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+p[0]),y=X,(m=i.split(".")[0].match(/0+/))&&(y.characteristic=m[0].length),function(Z,tt){if(Z.indexOf(".")!==-1){var et=Z.split(".")[0];tt.optionalCharacteristic=et.indexOf("0")===-1}}(i,X),v=X,i.indexOf("a")!==-1&&(v.average=!0),C=X,(w=i).indexOf("K")!==-1?C.forceAverage="thousand":w.indexOf("M")!==-1?C.forceAverage="million":w.indexOf("B")!==-1?C.forceAverage="billion":w.indexOf("T")!==-1&&(C.forceAverage="trillion"),function(Z,tt){var et=Z.split(".")[1];if(et){var bt=et.match(/0+/);bt&&(tt.mantissa=bt[0].length)}}(i,X),D=X,(A=i).match(/\[\.]/)?D.optionalMantissa=!0:A.match(/\./)&&(D.optionalMantissa=!1),E=X,i.indexOf(",")!==-1&&(E.thousandSeparated=!0),G=X,i.indexOf(" ")!==-1&&(G.spaceSeparated=!0),nt=X,(K=i).match(/^\+?\([^)]*\)$/)&&(nt.negative="parenthesis"),K.match(/^\+?-/)&&(nt.negative="sign"),z=X,i.match(/^\+/)&&(z.forceSign=!0),X)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",f=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,p=5<arguments.length?arguments[5]:void 0,y=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function m(v,w){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",A=3<arguments.length?arguments[3]:void 0,D=4<arguments.length?arguments[4]:void 0,E=5<arguments.length?arguments[5]:void 0,G=6<arguments.length?arguments[6]:void 0;if(!isNaN(+v))return+v;var K="",nt=v.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(nt!==v)return-1*m(nt,w,C,A,D,E,G);for(var z=0;z<i.length;z++){var X=i[z];if((K=v.replace(X.key,""))!==v)return m(K,w,C,A,D,E,G)*X.factor}if((K=v.replace("%",""))!==v)return m(K,w,C,A,D,E,G)/100;var Z=parseFloat(v);if(!isNaN(Z)){var tt=A(Z);if(tt&&tt!=="."&&(K=v.replace(new RegExp("".concat(a(tt),"$")),""))!==v)return m(K,w,C,A,D,E,G);var et={};Object.keys(E).forEach(function(g){et[E[g]]=g});for(var bt=Object.keys(et).sort().reverse(),yt=bt.length,kt=0;kt<yt;kt++){var Et=bt[kt],P=et[Et];if((K=v.replace(Et,""))!==v){var d=void 0;switch(P){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return m(K,w,C,A,D,E,G)*d}}}}(function(m,v){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=m.replace(w,"");return C=(C=C.replace(new RegExp("([0-9])".concat(a(v.thousands),"([0-9])"),"g"),"$1$2")).replace(v.decimal,".")}(l,u,c),u,c,f,h,p,y)}n.exports={unformat:function(l,u){var c,f,h,p=r("./globalState"),y=p.currentDelimiters(),m=p.currentCurrency().symbol,v=p.currentOrdinal(),w=p.getZeroFormat(),C=p.currentAbbreviations(),A=void 0;if(typeof l=="string")A=function(D,E){if(!D.indexOf(":")||E.thousands===":")return!1;var G=D.split(":");if(G.length!==3)return!1;var K=+G[0],nt=+G[1],z=+G[2];return!isNaN(K)&&!isNaN(nt)&&!isNaN(z)}(l,y)?(c=l.split(":"),f=+c[0],h=+c[1],+c[2]+60*h+3600*f):s(l,y,m,v,w,C,u);else{if(typeof l!="number")return;A=l}if(A!==void 0)return A}}},{"./globalState":4}],10:[function(r,n,o){function i(y){return function(m){if(Array.isArray(m)){for(var v=0,w=new Array(m.length);v<m.length;v++)w[v]=m[v];return w}}(y)||function(m){if(Symbol.iterator in Object(m)||Object.prototype.toString.call(m)==="[object Arguments]")return Array.from(m)}(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(y){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(y)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(y,m){return m.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(y){return y.output==="byte"}},characteristic:{type:"number",restriction:function(y){return 0<=y},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(y){return 0<=y},message:"value must be positive"},{restriction:function(y,m){return!m.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(y){return 0<=y},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(y,m){return m.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(y){return y.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(y){return!!s.unformat(y)}function h(y,m,v){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],C=Object.keys(y).map(function(A){if(!m[A])return console.error("".concat(v," Invalid key: ").concat(A)),!1;var D=y[A],E=m[A];if(typeof E=="string"&&(E={type:E}),E.type==="format"){if(!h(D,u,"[Validate ".concat(A,"]"),!0))return!1}else if(a(D)!==E.type)return console.error("".concat(v," ").concat(A,' type mismatched: "').concat(E.type,'" expected, "').concat(a(D),'" provided')),!1;if(E.restrictions&&E.restrictions.length)for(var G=E.restrictions.length,K=0;K<G;K++){var nt=E.restrictions[K],z=nt.restriction,X=nt.message;if(!z(D,y))return console.error("".concat(v," ").concat(A," invalid value: ").concat(X)),!1}return E.restriction&&!E.restriction(D,y)?(console.error("".concat(v," ").concat(A," invalid value: ").concat(E.message)),!1):E.validValues&&E.validValues.indexOf(D)===-1?(console.error("".concat(v," ").concat(A," invalid value: must be among ").concat(JSON.stringify(E.validValues),', "').concat(D,'" provided')),!1):!(E.children&&!h(D,E.children,"[Validate ".concat(A,"]")))});return w||C.push.apply(C,i(Object.keys(m).map(function(A){var D=m[A];if(typeof D=="string"&&(D={type:D}),D.mandatory){var E=D.mandatory;if(typeof E=="function"&&(E=E(y)),E&&y[A]===void 0)return console.error("".concat(v,' Missing mandatory key "').concat(A,'"')),!1}return!0}))),C.reduce(function(A,D){return A&&D},!0)}function p(y){return h(y,u,"[Validate format]")}n.exports={validate:function(y,m){var v=f(y),w=p(m);return v&&w},validateFormat:p,validateInput:f,validateLanguage:function(y){return h(y,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(jOt);const ji=cO;var DOt="numeric";function cE(e,t,r,n,o,i,a){var s=i;if(Nn(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(typeof u<"u"&&!ji.languages()[u]){var p=u.replace("-",""),y=ji.allLanguages?ji.allLanguages[u]:ji[p];y&&ji.registerLanguage(y)}ji.setLanguage(u),s=ji(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}ki(e,t,r,n,o,s,a)}cE.RENDERER_TYPE=DOt;var _Ot="password";function fE(e,t,r,n,o,i,a){ki.apply(this,[e,t,r,n,o,i,a]);var s=a.hashLength||t.innerHTML.length,l=a.hashSymbol||"*",u="";Ct(s-1,function(){u+=l}),Ya(t,u)}fE.RENDERER_TYPE=_Ot;var HOt="time";function hE(e,t,r,n,o,i,a){ki.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}hE.RENDERER_TYPE=HOt;function NOt(){Pr(mc),Pr(vp),Pr(lE),Pr(sE),Pr(cE),Pr(fE),Pr(ki),Pr(hE)}var BOt="autocomplete";function ew(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,fD(r,t)):fD(r,t)(this.source):t(!0)}ew.VALIDATOR_TYPE=BOt;function fD(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var LOt=Object.is||function(e,t){return e===t?e!==0||1/e===1/t:e!=e&&t!=t},VOt=Ke,FOt=iv,WOt=De,UOt=mr,YOt=Rn,hD=LOt,dD=Ue,GOt=Na,zOt=av;FOt("search",function(e,t,r){return[function(n){var o=YOt(this),i=UOt(n)?void 0:GOt(n,e);return i?VOt(i,n,o):new RegExp(n)[e](dD(o))},function(n){var o=WOt(this),i=dD(n),a=r(t,o,i);if(a.done)return a.value;var s=o.lastIndex;hD(s,0)||(o.lastIndex=0);var l=zOt(o,i);return hD(o.lastIndex,s)||(o.lastIndex=s),l===null?-1:l.index}]});function IY(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const QOt=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:IY},Symbol.toStringTag,{value:"Module"}));var KOt="date";function dE(e,t){var r=EW(kY,this.instance),n=e,o=!0;n==null&&(n="");var i=$(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=$(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var s=XOt(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),o=!0}else o=!1;t(o)}dE.VALIDATOR_TYPE=KOt;function XOt(e,t){var r=$(IY(e)),n=$(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var JOt="numeric";function pE(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:Nn(e))}pE.VALIDATOR_TYPE=JOt;var ZOt=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],qOt="time";function yE(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=$(o,ZOt,!0).isValid()?$(o):$(o,r),s=a.isValid(),l=$(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=a.format(r),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),n=!0}else n=!1;t(n)}yE.VALIDATOR_TYPE=qOt;function $Ot(){Is(ew),Is(dE),Is(pE),Is(yE)}var t1t="autocomplete",e1t={CELL_TYPE:t1t,editor:iE,renderer:mc,validator:ew},n1t="checkbox",r1t={CELL_TYPE:n1t,editor:OY,renderer:lE},o1t="date",i1t={CELL_TYPE:o1t,editor:RY,renderer:mc,validator:dE},a1t="dropdown",s1t={CELL_TYPE:a1t,editor:aE,renderer:mc,validator:ew},l1t="handsontable",u1t={CELL_TYPE:l1t,editor:oE,renderer:mc},c1t="numeric",f1t={CELL_TYPE:c1t,editor:EY,renderer:cE,validator:pE,dataType:"number"},h1t="password",d1t={CELL_TYPE:h1t,editor:TY,renderer:fE,copyable:!1},p1t="time",y1t={CELL_TYPE:p1t,editor:PY,renderer:hE,validator:yE};function g1t(){ir(e1t),ir(r1t),ir(i1t),ir(s1t),ir(u1t),ir(f1t),ir(d1t),ir(wY),ir(y1t)}var m1t=tv,v1t=gW;m1t("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},v1t);function Fh(e){return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function b1t(e,t){return C1t(e)||S1t(e,t)||A1t(e,t)||w1t()}function w1t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A1t(e,t){if(e){if(typeof e=="string")return pD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pD(e,t)}}function pD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S1t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function C1t(e){if(Array.isArray(e))return e}function O1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R1t(n.key),n)}}function k1t(e,t,r){return t&&yD(e.prototype,t),r&&yD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R1t(e){var t=E1t(e,"string");return Fh(t)==="symbol"?t:String(t)}function E1t(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T1t(e,t){P1t(e,t),t.add(e)}function P1t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M1t(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var gD=new Map([["plugin",zlt],["cell-type",cY],["editor",RW],["renderer",VW],["validator",FW]]),I1t="base",Di=new WeakMap,GA=[],Cr=null,mD=new WeakSet,re=function(){function e(t){var r=this;O1t(this,e),T1t(this,mD),Br(this,"hot",t,{writable:!1}),Di.set(this,{hooks:{}}),Cr=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return k1t(e,[{key:"init",value:function(){var t=this;this.pluginName=this.hot.getPluginName(this);var r=this.constructor.PLUGIN_DEPS,n=Array.isArray(r)?r:[];if(n.length>0){var o=[];if(n.forEach(function(l){var u=l.split(":"),c=b1t(u,2),f=c[0],h=c[1];if(!gD.has(f))throw new Error('Unknown plugin dependency type "'.concat(f,'" was found.'));gD.get(f)(h)||o.push(" - ".concat(h," (").concat(f,")"))}),o.length>0){var i=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");GA.push(i)}}Cr||(Cr=ER()),Cr.indexOf("UndoRedo")>=0&&Cr.splice(Cr.indexOf("UndoRedo"),1),Cr.indexOf(this.pluginName)>=0&&Cr.splice(Cr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){t.isEnabled&&t.isEnabled()&&t.enablePlugin()});var a=Cr.length===0;if(a){if(GA.length>0){var s=["".concat(GA.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,r){Di.get(this).hooks[t]=Di.get(this).hooks[t]||[];var n=Di.get(this).hooks[t];this.hot.addHook(t,r),n.push(r),Di.get(this).hooks[t]=n}},{key:"removeHooks",value:function(t){var r=this;T(Di.get(this).hooks[t]||[],function(n){r.hot.removeHook(t,n)})}},{key:"clearHooks",value:function(){var t=this,r=Di.get(this).hooks;Qt(r,function(n,o){return t.removeHooks(o)}),r.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){T(this.pluginsInitializedCallbacks,function(t){return t()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(t){var r=M1t(this,mD,x1t).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(t))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Qt(this,function(r,n){n!=="hot"&&(t[n]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return I1t}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function x1t(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function Wh(e){return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function j1t(e,t){return N1t(e)||H1t(e,t)||_1t(e,t)||D1t()}function D1t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _1t(e,t){if(e){if(typeof e=="string")return vD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vD(e,t)}}function vD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function H1t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function N1t(e){if(Array.isArray(e))return e}function B1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V1t(n.key),n)}}function L1t(e,t,r){return t&&bD(e.prototype,t),r&&bD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V1t(e){var t=F1t(e,"string");return Wh(t)==="symbol"?t:String(t)}function F1t(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var W1t=function(){function e(t){B1t(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return L1t(e,[{key:"addRow",value:function(t,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){var r=this.hot.getColHeader(0);if(r!=null){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(t,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(t)!==null&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),T(this.rows,function(r){t(r.row,ke(r.table)-1)})}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),T(this.columns,function(r){var n=r.table.getBoundingClientRect(),o=n.width;t(r.col,Math.ceil(o))})}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,r){this.settings||(this.settings={}),this.settings[t]=r}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1)),this.samples.forEach(function(n){T(n.strings,function(o){r.appendChild(t.createColElement(o.col))})}),r}},{key:"createRow",value:function(t){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,i),o.appendChild(i)),this.samples.forEach(function(a){T(a.strings,function(s){var l=s.col,u=r.hot.getCellMeta(t,l);u.col=l,u.row=t;var c=r.hot.getCellRenderer(u),f=n.createElement("td");f.setAttribute("ghost-table",1),c(r.hot,f,t,l,r.hot.colToProp(l),s.value,u),o.appendChild(f)})}),o}},{key:"appendColumnHeadersRow",value:function(){var t=this,r=this.hot.rootDocument,n=r.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var i=r.createElement("th");o.push([-1,i]),n.appendChild(i)}this.samples.forEach(function(a){T(a.strings,function(s){var l=s.col,u=r.createElement("th");o.push([l,u]),n.appendChild(u)})}),this.table.tHead.appendChild(n),T(o,function(a){var s=j1t(a,2),l=s[0],u=s[1];t.hot.view.appendColHeader(l,u)})}},{key:"createCol",value:function(t){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment();return this.samples.forEach(function(i){T(i.strings,function(a){var s=a.row,l=r.hot.getCellMeta(s,t);l.col=t,l.row=s;var u=r.hot.getCellRenderer(l),c=n.createElement("td"),f=n.createElement("tr");c.setAttribute("ghost-table",1),u(r.hot,c,s,t,r.hot.colToProp(t),a.value,l),f.appendChild(c),o.appendChild(f)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var r=this.hot.rootDocument.createElement("col");return r.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(t),"px"),r}},{key:"createTable",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=this.hot.rootDocument,n=r.createDocumentFragment(),o=r.createElement("table"),i=r.createElement("thead"),a=r.createElement("tbody"),s=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&o.appendChild(s),this.isHorizontal()&&(l.appendChild(u),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&a.appendChild(l),o.appendChild(a),q(o,t),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:a,colGroup:s,tr:l,th:u}}},{key:"createContainer",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=this.hot.rootDocument,n=r.createDocumentFragment(),o=r.createElement("div"),i="htGhostTable htAutoSize ".concat(t.trim());return q(o,i),n.appendChild(o),{fragment:n,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const gE=W1t;function Uh(e){return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function U1t(e,t,r){return t=xY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xY(n.key),n)}}function G1t(e,t,r){return t&&wD(e.prototype,t),r&&wD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xY(e){var t=z1t(e,"string");return Uh(t)==="symbol"?t:String(t)}function z1t(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q1t=function(){function e(t){Y1t(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return G1t(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,r){return this.generateSamples("row",r,t)}},{key:"generateColumnSamples",value:function(t,r){return this.generateSamples("col",r,t)}},{key:"generateSamples",value:function(t,r,n){var o=this,i=new Map,a=typeof n=="number"?{from:n,to:n}:n,s=a.from,l=a.to;return Ct(s,l,function(u){var c=o.generateSample(t,r,u);i.set(u,c)}),i}},{key:"generateSample",value:function(t,r,n){var o=this;if(t!=="row"&&t!=="col")throw new Error("Unsupported sample type");var i=new Map,a=t==="row"?"col":"row",s=[];return Ct(r.from,r.to,function(l){var u=t==="row"?o.dataFactory(n,l):o.dataFactory(l,n),c=u.value,f=u.bundleSeed,h=typeof f=="string"&&f.length>0,p;h?p=f:zt(c)?p="".concat(Object.keys(c).length):Array.isArray(c)?p="".concat(c.length):p="".concat(Pe(c).length),i.has(p)||i.set(p,{needed:o.getSampleCount(),strings:[]});var y=i.get(p);if(y.needed){var m=s.indexOf(c)>-1;(!m||o.allowDuplicates||h)&&(y.strings.push(U1t({value:c},a,l)),s.push(c),y.needed-=1)}}),i}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const jY=Q1t;function Jl(e){return Jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jl(e)}function AD(e,t){return Z1t(e)||J1t(e,t)||X1t(e,t)||K1t()}function K1t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X1t(e,t){if(e){if(typeof e=="string")return SD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SD(e,t)}}function SD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J1t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Z1t(e){if(Array.isArray(e))return e}function q1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tkt(n.key),n)}}function $1t(e,t,r){return t&&CD(e.prototype,t),r&&CD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tkt(e){var t=ekt(e,"string");return Jl(t)==="symbol"?t:String(t)}function ekt(e,t){if(Jl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ki(){return typeof Reflect<"u"&&Reflect.get?Ki=Reflect.get.bind():Ki=function(e,t,r){var n=nkt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Ki.apply(this,arguments)}function nkt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=oo(e),e!==null););return e}function rkt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},fO(e,t)}function okt(e){var t=akt();return function(){var r=oo(e),n;if(t){var o=oo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ikt(this,n)}}function ikt(e,t){if(t&&(Jl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DY(e)}function DY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function akt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oo(e){return oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oo(e)}gt.getSingleton().register("modifyAutoColumnSizeSeed");var Bc="autoColumnSize",skt=10,zA=new WeakMap,lkt="autoColumnSize",ukt=function(e){rkt(r,e);var t=okt(r);function r(n){var o;return q1t(this,r),o=t.call(this,n),zA.set(DY(o),{cachedColumnHeaders:[]}),o.ghostTable=new gE(o.hot),o.samplesGenerator=new jY(function(i,a){var s=o.hot.getCellMeta(i,a),l="";s.spanned||(l=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Oi,o.hot.columnIndexMapper.registerMap(lkt,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,s){return o.onBeforeColumnResize(i,a,s)}),o}return $1t(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Bc]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[Bc];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.addHook("beforeChangeRender",function(i){return n.onBeforeChange(i)}),this.addHook("afterFormulasValuesUpdate",function(i){return n.onAfterFormulasValuesUpdate(i)}),this.addHook("beforeViewRender",function(i){return n.onBeforeViewRender(i)}),this.addHook("modifyColWidth",function(i,a){return n.getColumnWidth(a,i)}),this.addHook("afterInit",function(){return n.onAfterInit()}),Ki(oo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var n=this.findColumnsWhereHeaderWasChanged();n.length&&(this.clearCache(n),this.calculateVisibleColumnsWidth()),Ki(oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=this;Ki(oo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,i,a){return n.onBeforeColumnResize(o,i,a)})}},{key:"calculateVisibleColumnsWidth",value:function(){var n=this.hot.countRows();if(n){var o=this.hot.renderCall,i=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn();i===-1||a===-1||this.calculateColumnsWidth({from:i,to:a},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof o=="number"?{from:o,to:o}:o,l=typeof i=="number"?{from:i,to:i}:i;Ct(s.from,s.to,function(u){var c=n.hot.toPhysicalColumn(u);if(c===null&&(c=u),a||n.columnWidthsMap.getValueAtIndex(c)===null&&!n.hot._getColWidthFromSettings(c)){var f=n.samplesGenerator.generateColumnSamples(u,l);T(f,function(h){var p=AD(h,2),y=p[0],m=p[1];return n.ghostTable.addColumn(y,m)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){n.ghostTable.getWidths(function(u,c){var f=n.hot.toPhysicalColumn(u);n.columnWidthsMap.setValueAtIndex(f,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=0,a=this.hot.countCols()-1,s=null;this.inProgress=!0;var l=function c(){if(!n.hot){Tf(s),n.inProgress=!1;return}n.calculateColumnsWidth({from:i,to:Math.min(i+r.CALCULATION_STEP,a)},o),i=i+r.CALCULATION_STEP+1,i<a?s=lv(c):(Tf(s),n.inProgress=!1,n.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();this.firstCalculation&&u>=0&&(this.calculateColumnsWidth({from:0,to:u},o),this.firstCalculation=!1,i=u+1),i<a?l():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings()[Bc],o=n&&Te(n,"samplingRatio")?n.samplingRatio:void 0,i=n&&Te(n,"allowSampleDuplicates")?n.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var n=this.hot.getSettings()[Bc],o=r.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return zt(n)&&(o=n.syncLimit,gR(o)?o=kR(i,o):o>>=0),Math.min(o,i)}},{key:"getColumnWidth",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=o;return a===void 0&&(a=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(n)),i&&typeof a=="number"&&(a=Math.max(a,PR.DEFAULT_WIDTH))),a}},{key:"getFirstVisibleColumn",value:function(){var n=this.hot.view._wt;if(n.wtViewport.columnsVisibleCalculator){var o=n.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(n.wtViewport.columnsRenderCalculator){var i=n.wtTable.getFirstRenderedColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}return-1}},{key:"getLastVisibleColumn",value:function(){var n=this.hot.view._wt;if(n.wtViewport.columnsVisibleCalculator){var o=n.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(n.wtViewport.columnsRenderCalculator){var i=n.wtTable.getLastRenderedColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var n=this.hot.getColHeader(),o=zA.get(this),i=o.cachedColumnHeaders,a=_e(n,function(s,l,u){var c=i.length;return(c-1<u||i[u]!==l)&&s.push(u),c-1<u?i.push(l):i[u]=l,s},[]);return a}},{key:"clearCache",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){T(o,function(i){n.columnWidthsMap.setValueAtIndex(i,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Ln(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(n){return n===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){n.hot&&n.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(n){var o=this,i=Gt(n,function(a){var s=AD(a,2),l=s[1];return o.hot.toPhysicalColumn(o.hot.propToCol(l))});this.clearCache(Array.from(new Set(i)))}},{key:"onBeforeColumnResize",value:function(n,o,i){var a=n;return i&&(this.calculateColumnsWidth(o,void 0,!0),a=this.getColumnWidth(o,void 0,!1)),a}},{key:"onAfterInit",value:function(){zA.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(n){var o=Ln(n,function(a){var s;return ht((s=a.address)===null||s===void 0?void 0:s.col)}),i=Gt(o,function(a){return a.address.col});this.clearCache(Array.from(new Set(i)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Ki(oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Bc}},{key:"PLUGIN_PRIORITY",get:function(){return skt}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(re),Xi={horizontal:"horizontal",vertical:"vertical"};function ckt(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],s=t.row-e.row,l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],c=0;c<l;c++){var f=parseInt(r[0][c],10),h=parseInt(r[o-1][c],10),p=(n==="down"?h-f:f-h)/(o-1)||0;u.push(p)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var y=0;y<s;y++){var m=parseInt(r[y][0],10),v=parseInt(r[y][i-1],10),w=(n==="right"?v-m:m-v)/(i-1)||0;a.push([w])}return a}function fkt(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function hkt(e){var t={};return e===!0?(t.directions=Object.keys(Xi),t.autoInsertRow=!0):zt(e)?(ht(e.autoInsertRow)?e.direction===Xi.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ht(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Xi)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function Zl(e){return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zl(e)}function dkt(e){return gkt(e)||ykt(e)||_Y(e)||pkt()}function pkt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ykt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gkt(e){if(Array.isArray(e))return hO(e)}function mkt(e,t){return wkt(e)||bkt(e,t)||_Y(e,t)||vkt()}function vkt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Y(e,t){if(e){if(typeof e=="string")return hO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hO(e,t)}}function hO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bkt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function wkt(e){if(Array.isArray(e))return e}function Akt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ckt(n.key),n)}}function Skt(e,t,r){return t&&OD(e.prototype,t),r&&OD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ckt(e){var t=Okt(e,"string");return Zl(t)==="symbol"?t:String(t)}function Okt(e,t){if(Zl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ji(){return typeof Reflect<"u"&&Reflect.get?Ji=Reflect.get.bind():Ji=function(e,t,r){var n=kkt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Ji.apply(this,arguments)}function kkt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=io(e),e!==null););return e}function Rkt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dO(e,t)}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},dO(e,t)}function Ekt(e){var t=Pkt();return function(){var r=io(e),n;if(t){var o=io(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tkt(this,n)}}function Tkt(e,t){if(t&&(Zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HY(e)}function HY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pkt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function io(e){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},io(e)}gt.getSingleton().register("modifyAutofillRange");gt.getSingleton().register("beforeAutofill");gt.getSingleton().register("afterAutofill");var kD="autofill",Mkt=20,Ikt=["fillHandle"],xkt="insert_row_below",jkt=200,Dkt=function(e){Rkt(r,e);var t=Ekt(r);function r(n){var o;return Akt(this,r),o=t.call(this,n),o.eventManager=new Re(HY(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return Skt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(o){return n.onAfterCellCornerMouseDown(o)}),this.addHook("afterOnCellCornerDblClick",function(o){return n.onCellCornerDblClick(o)}),this.addHook("beforeOnCellMouseOver",function(o,i){return n.onBeforeCellMouseOver(i)}),Ji(io(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ji(io(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Ji(io(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var n=this,o=this.hot.getSelectedRangeLast(),i=o.getTopStartCorner(),a=i.row,s=i.col,l=o.getBottomEndCorner(),u=l.row,c=l.col,f=this.hot.runHooks("modifyCopyableRange",[{startRow:a,startCol:s,endRow:u,endCol:c}]),h=[],p=[],y=[];return T(f,function(m){for(var v=m.startRow;v<=m.endRow;v+=1)h.indexOf(v)===-1&&h.push(v);for(var w=m.startCol;w<=m.endCol;w+=1)p.indexOf(w)===-1&&p.push(w)}),T(h,function(m){var v=[];T(p,function(w){v.push(n.hot.getCopyableData(m,w))}),y.push(v)}),y}},{key:"fillIn",value:function(){var n=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var o=this.hot.selection.highlight.getFill().getVisualCorners(),i=mkt(o,4),a=i[0],s=i[1],l=i[2],u=i[3],c=this.hot.getSelectedRangeLast(),f=c.getTopStartCorner(),h=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var p=[f.row,f.col,h.row,h.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(f.row,a),Math.min(f.col,s),Math.max(h.row,l),Math.max(h.col,u)],p),m=fkt(p,y,function(Et,P){return n.hot._createCellCoords(Et,P)}),v=m.directionOfDrag,w=m.startOfDragCoords,C=m.endOfDragCoords;if(w&&w.row>-1&&w.col>-1){var A=this.getSelectionData(),D=c.clone(),E=this.hot._createCellRange(w,w,C),G=this.hot.runHooks("beforeAutofill",A,D,E,v);if(G===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var K=ckt(w,C,A,v),nt=G,z=G;if(["up","left"].indexOf(v)>-1&&!(z.length===1&&z[0].length===0))if(nt=[],v==="up")for(var X=C.row-w.row+1,Z=X%z.length,tt=0;tt<X;tt++)nt.push(z[(tt+(z.length-Z))%z.length]);else for(var et=C.col-w.col+1,bt=et%z[0].length,yt=0;yt<z.length;yt++){nt.push([]);for(var kt=0;kt<et;kt++)nt[yt].push(z[yt][(kt+(z[yt].length-bt))%z[yt].length])}this.hot.populateFromArray(w.row,w.col,nt,C.row,C.col,"".concat(this.pluginName,".fill"),null,v,K),this.setSelection(y),this.hot.runHooks("afterAutofill",nt,D,E,v),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(n){return n.row<0&&(n.row=0),n.col<0&&(n.col=0),n}},{key:"getCoordsOfDragAndDropBorders",value:function(n){var o=this.hot.getSelectedRangeLast(),i=o.getBottomEndCorner(),a=n;if(this.directions.includes(Xi.vertical)&&this.directions.includes(Xi.horizontal)){var s=o.getTopStartCorner();(i.col<=n.col||s.col>=n.col)&&(a=this.hot._createCellCoords(i.row,n.col)),(i.row<n.row||s.row>n.row)&&(a=this.hot._createCellCoords(n.row,i.col))}else if(this.directions.includes(Xi.vertical))a=this.hot._createCellCoords(n.row,i.col);else if(this.directions.includes(Xi.horizontal))a=this.hot._createCellCoords(i.row,n.col);else return;return this.reduceSelectionAreaIfNeeded(a)}},{key:"showBorder",value:function(n){var o=this.getCoordsOfDragAndDropBorders(n);o&&this.redrawBorders(o)}},{key:"addRow",value:function(){var n=this;this.hot._registerTimeout(function(){n.hot.alter(xkt,void 0,1,"".concat(n.pluginName,".fill")),n.addingStarted=!1},jkt)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var n=this.hot.getSelectedLast(),o=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();n[2]<i-1&&o[2]===i-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(n){for(var o=this.hot.getData(),i=this.hot.countRows(),a,s=n[2]+1;s<i;s++){for(var l=n[1];l<=n[3];l++){var u=o[s][l];if(u)return-1}var c=o[s][n[1]-1],f=o[s][n[3]+1];(c||f)&&(a=s)}return a}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(n,o){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(n[0],n[1])).add(this.hot._createCellCoords(o,n[3])).commit()}},{key:"setSelection",value:function(n){var o;(o=this.hot).selectCell.apply(o,dkt(Gt(n,function(i){return Math.max(i,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var n=this.hot.getSelectedLast(),o=this.getIndexOfLastAdjacentFilledInRow(n);return o===-1||o===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(n,o),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(n){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(n).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(n){var o=this.hot.rootDocument.documentElement,i=Le(this.hot.table).top-(this.hot.rootWindow.pageYOffset||o.scrollTop)+ke(this.hot.table),a=Le(this.hot.table).left-(this.hot.rootWindow.pageXOffset||o.scrollLeft)+fe(this.hot.table);return n.clientY>i&&n.clientX<=a}},{key:"registerEvents",value:function(){var n=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mouseup",function(){return n.onMouseUp()}),this.eventManager.addEventListener(o,"mousemove",function(i){return n.onMouseMove(i)})}},{key:"onCellCornerDblClick",value:function(){var n=this.selectAdjacent();n&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(n){var o=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&o?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var n=hkt(this.hot.getSettings().fillHandle);this.directions=n.directions,this.autoInsertRow=n.autoInsertRow}},{key:"destroy",value:function(){Ji(io(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return kD}},{key:"PLUGIN_PRIORITY",get:function(){return Mkt}},{key:"SETTING_KEYS",get:function(){return[kD].concat(Ikt)}}]),r}(re);function ql(e){return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function _kt(e,t){return Lkt(e)||Bkt(e,t)||Nkt(e,t)||Hkt()}function Hkt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nkt(e,t){if(e){if(typeof e=="string")return RD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RD(e,t)}}function RD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bkt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Lkt(e){if(Array.isArray(e))return e}function Vkt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ED(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wkt(n.key),n)}}function Fkt(e,t,r){return t&&ED(e.prototype,t),r&&ED(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wkt(e){var t=Ukt(e,"string");return ql(t)==="symbol"?t:String(t)}function Ukt(e,t){if(ql(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ql(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vs(){return typeof Reflect<"u"&&Reflect.get?Vs=Reflect.get.bind():Vs=function(e,t,r){var n=Ykt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Vs.apply(this,arguments)}function Ykt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ai(e),e!==null););return e}function Gkt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pO(e,t)}function pO(e,t){return pO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},pO(e,t)}function zkt(e){var t=Xkt();return function(){var r=ai(e),n;if(t){var o=ai(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qkt(this,n)}}function Qkt(e,t){if(t&&(ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kkt(e)}function Kkt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xkt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ai(e){return ai=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ai(e)}var ay="autoRowSize",Jkt=40,Zkt="autoRowSize",qkt=function(e){Gkt(r,e);var t=zkt(r);function r(n){var o;return Vkt(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new gE(o.hot),o.samplesGenerator=new jY(function(i,a){var s;return i>=0?s=o.hot.getDataAtCell(i,a):i===-1&&(s=o.hot.getColHeader(a)),{value:s}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Oi,o.hot.rowIndexMapper.registerMap(Zkt,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,s){return o.onBeforeRowResize(i,a,s)}),o}return Fkt(r,[{key:"isEnabled",value:function(){var n=this.hot.getSettings()[ay];return n===!0||zt(n)}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.addHook("beforeChangeRender",function(o){return n.onBeforeChange(o)}),this.addHook("beforeColumnResize",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(o){return n.onBeforeViewRender(o)}),this.addHook("modifyRowHeight",function(o,i){return n.getRowHeight(i,o)}),this.addHook("modifyColumnHeaderHeight",function(){return n.getColumnHeaderHeight()}),Vs(ai(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=this;this.headerHeight=null,Vs(ai(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(o,i,a){return n.onBeforeRowResize(o,i,a)})}},{key:"calculateRowsHeight",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof o=="number"?{from:o,to:o}:o,l=typeof i=="number"?{from:i,to:i}:i;if(this.hot.getColHeader(0)!==null){var u=this.samplesGenerator.generateRowSamples(-1,l);this.ghostTable.addColumnHeadersRow(u.get(-1))}Ct(s.from,s.to,function(c){if(a||n.rowHeightsMap.getValueAtIndex(c)===null){var f=n.samplesGenerator.generateRowSamples(c,l);T(f,function(h){var p=_kt(h,2),y=p[0],m=p[1];return n.ghostTable.addRow(y,m)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){n.ghostTable.getHeights(function(c,f){c<0?n.headerHeight=f:n.rowHeightsMap.setValueAtIndex(n.hot.toPhysicalRow(c),f)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=0,a=this.hot.countRows()-1,s=null;this.inProgress=!0;var l=function c(){if(!n.hot){Tf(s),n.inProgress=!1;return}n.calculateRowsHeight({from:i,to:Math.min(i+r.CALCULATION_STEP,a)},o),i=i+r.CALCULATION_STEP+1,i<a?s=lv(c):(Tf(s),n.inProgress=!1,n.hot.view.adjustElementsSize(!0),n.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&n.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},u=this.getSyncCalculationLimit();this.firstCalculation&&u>=0&&(this.calculateRowsHeight({from:0,to:u},o),this.firstCalculation=!1,i=u+1),i<a?l():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings()[ay],o=n&&Te(n,"samplingRatio")?n.samplingRatio:void 0,i=n&&Te(n,"allowSampleDuplicates")?n.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}},{key:"recalculateAllRowsHeight",value:function(){$s(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var n=this.hot.getSettings()[ay],o=r.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return zt(n)&&(o=n.syncLimit,gR(o)?o=kR(i,o):o>>=0),Math.min(o,i)}},{key:"getRowHeight",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,i=n<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(n)),a=o;return i!==null&&i>(o||0)&&(a=i),a}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var n=this.hot.view._wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getFirstVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var n=this.hot.view._wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getLastVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(n){var o=this,i=typeof n=="number"?{from:n,to:n}:n,a=i.from,s=i.to;this.hot.batchExecution(function(){Ct(Math.min(a,s),Math.max(a,s),function(l){o.rowHeightsMap.setValueAtIndex(l,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Ln(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(n){return n===null}).length}},{key:"onBeforeViewRender",value:function(){var n=this.hot.renderCall,o=this.hot.getSettings().fixedRowsBottom,i=this.getFirstVisibleRow(),a=this.getLastVisibleRow();if(!(i===-1||a===-1)){if(this.calculateRowsHeight({from:i,to:a},void 0,n),o){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-o,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(n,o){this.clearCacheByRange({from:n,to:o}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(n,o,i){var a=n;return i&&(this.calculateRowsHeight(o,void 0,!0),a=this.getRowHeight(o)),a}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){n.hot&&n.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(n){var o=null;n.length===1?o=n[0][0]:n.length>1&&(o={from:n[0][0],to:n[n.length-1][0]}),o!==null&&this.clearCacheByRange(o)}},{key:"destroy",value:function(){this.ghostTable.clean(),Vs(ai(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ay}},{key:"PLUGIN_PRIORITY",get:function(){return Jkt}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(re);function $l(e){return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$l(e)}function $kt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eRt(n.key),n)}}function tRt(e,t,r){return t&&TD(e.prototype,t),r&&TD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eRt(e){var t=nRt(e,"string");return $l(t)==="symbol"?t:String(t)}function nRt(e,t){if($l(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($l(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bf(){return typeof Reflect<"u"&&Reflect.get?bf=Reflect.get.bind():bf=function(e,t,r){var n=rRt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},bf.apply(this,arguments)}function rRt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xa(e),e!==null););return e}function oRt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},yO(e,t)}function iRt(e){var t=lRt();return function(){var r=xa(e),n;if(t){var o=xa(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aRt(this,n)}}function aRt(e,t){if(t&&($l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sRt(e)}function sRt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lRt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xa(e){return xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xa(e)}var NY=FU("physicallyIndexed"),uRt=NY.getListWithInsertedItems,cRt=NY.getListWithRemovedItems,fRt=function(e){oRt(r,e);var t=iRt(r);function r(){return $kt(this,r),t.call(this,function(n){return n})}return tRt(r,[{key:"insert",value:function(n,o){var i=QR(this.indexedValues,o);this.indexedValues=uRt(i,n,o,this.initValueOrFn),bf(xa(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){var o=cRt(this.indexedValues,n);this.indexedValues=zR(o,n),bf(xa(r.prototype),"remove",this).call(this,n)}}]),r}(Ga);const hRt=fRt;function tu(e){return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function dRt(e){return mRt(e)||gRt(e)||yRt(e)||pRt()}function pRt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yRt(e,t){if(e){if(typeof e=="string")return gO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gO(e,t)}}function gRt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mRt(e){if(Array.isArray(e))return gO(e)}function gO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vRt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wRt(n.key),n)}}function bRt(e,t,r){return t&&PD(e.prototype,t),r&&PD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wRt(e){var t=ARt(e,"string");return tu(t)==="symbol"?t:String(t)}function ARt(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wf(){return typeof Reflect<"u"&&Reflect.get?wf=Reflect.get.bind():wf=function(e,t,r){var n=SRt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},wf.apply(this,arguments)}function SRt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ja(e),e!==null););return e}function CRt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mO(e,t)}function mO(e,t){return mO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},mO(e,t)}function ORt(e){var t=ERt();return function(){var r=ja(e),n;if(t){var o=ja(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kRt(this,n)}}function kRt(e,t){if(t&&(tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RRt(e)}function RRt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ERt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ja(e){return ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ja(e)}var BY=FU("physicallyIndexed"),TRt=BY.getListWithInsertedItems,PRt=BY.getListWithRemovedItems,MRt=function(e){CRt(r,e);var t=ORt(r);function r(){return vRt(this,r),t.call(this,function(n){return n})}return bRt(r,[{key:"insert",value:function(n,o){var i=this;this.indexedValues=TRt(this.indexedValues,n,o,function(a,s){return i.getNextValue(s)}),wf(ja(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){this.indexedValues=PRt(this.indexedValues,n),wf(ja(r.prototype),"remove",this).call(this,n)}},{key:"getNextValue",value:function(n){return Math.max.apply(Math,dRt(this.getValues()))+1+n}}]),r}(Ga);const IRt=MRt;function eu(e){return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function xRt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DRt(n.key),n)}}function jRt(e,t,r){return t&&MD(e.prototype,t),r&&MD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DRt(e){var t=_Rt(e,"string");return eu(t)==="symbol"?t:String(t)}function _Rt(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fs(){return typeof Reflect<"u"&&Reflect.get?Fs=Reflect.get.bind():Fs=function(e,t,r){var n=HRt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Fs.apply(this,arguments)}function HRt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=si(e),e!==null););return e}function NRt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vO(e,t)}function vO(e,t){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},vO(e,t)}function BRt(e){var t=FRt();return function(){var r=si(e),n;if(t){var o=si(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LRt(this,n)}}function LRt(e,t){if(t&&(eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VRt(e)}function VRt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FRt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function si(e){return si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},si(e)}var QA="bindRowsWithHeaders",WRt=210,URt="loose",YRt=new Map([["loose",hRt],["strict",IRt]]),GRt=function(e){NRt(r,e);var t=BRt(r);function r(n){var o;return xRt(this,r),o=t.call(this,n),o.headerIndexes=null,o}return jRt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[QA]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[QA];typeof o!="string"&&(o=URt);var i=YRt.get(o);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new i),this.addHook("modifyRowHeader",function(a){return n.onModifyRowHeader(a)}),Fs(si(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Fs(si(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}},{key:"destroy",value:function(){Fs(si(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return QA}},{key:"PLUGIN_PRIORITY",get:function(){return WRt}}]),r}(re);function nu(e){return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function ID(e){return XRt(e)||KRt(e)||QRt(e)||zRt()}function zRt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QRt(e,t){if(e){if(typeof e=="string")return bO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bO(e,t)}}function KRt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XRt(e){if(Array.isArray(e))return bO(e)}function bO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JRt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LY(n.key),n)}}function ZRt(e,t,r){return t&&xD(e.prototype,t),r&&xD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zi(){return typeof Reflect<"u"&&Reflect.get?Zi=Reflect.get.bind():Zi=function(e,t,r){var n=qRt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Zi.apply(this,arguments)}function qRt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ao(e),e!==null););return e}function $Rt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wO(e,t)}function wO(e,t){return wO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},wO(e,t)}function tEt(e){var t=nEt();return function(){var r=ao(e),n;if(t){var o=ao(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eEt(this,n)}}function eEt(e,t){if(t&&(nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Es(e)}function Es(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nEt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ao(e){return ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ao(e)}function rEt(e,t,r){oEt(e,t),t.set(e,r)}function oEt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KA(e,t,r){return t=LY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LY(e){var t=iEt(e,"string");return nu(t)==="symbol"?t:String(t)}function iEt(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jD(e,t){var r=VY(e,t,"get");return aEt(e,r)}function aEt(e,t){return t.get?t.get.call(e):t.value}function XA(e,t,r){var n=VY(e,t,"set");return sEt(e,n,r),r}function VY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function sEt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var JA="collapsibleColumns",lEt=290,uEt=["nestedHeaders"],as="collapsibleIndicator",DD=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),ss=new WeakMap,cEt=function(e){$Rt(r,e);var t=tEt(r);function r(){var n;JRt(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),KA(Es(n),"nestedHeadersPlugin",null),KA(Es(n),"eventManager",new Re(Es(n))),KA(Es(n),"headerStateManager",null),rEt(Es(n),ss,{writable:!0,value:null}),n}return ZRt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[JA]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings(),i=o.nestedHeaders;i||de("You need to configure the Nested Headers plugin in order to use collapsible headers."),XA(this,ss,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return n.onInit()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.addHook("afterGetColHeader",function(){return n.onAfterGetColHeader.apply(n,arguments)}),this.addHook("beforeOnCellMouseDown",function(a,s,l){return n.onBeforeOnCellMouseDown(a,s,l)}),Zi(ao(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var n=this.hot.getSettings(),o=n.collapsibleColumns;typeof o=="boolean"?this.headerStateManager.mapState(function(i){return{collapsible:i.origColspan>1}}):Array.isArray(o)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(o))}Zi(ao(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),XA(this,ss,null),this.nestedHeadersPlugin=null,this.clearButtons(),Zi(ao(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var n=this.hot.view._wt.getSetting("columnHeaders").length,o=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(l){l&&l.parentNode.removeChild(l)};Ct(0,n-1,function(l){var u=o.childNodes[l],c=i.childNodes[l],f=a?a.childNodes[l]:null;Ct(0,u.childNodes.length-1,function(h){var p=u.childNodes[h].querySelector(".".concat(as));s(p),c&&c.childNodes[h]&&(p=c.childNodes[h].querySelector(".".concat(as)),s(p)),a&&f&&f.childNodes[h]&&(p=f.childNodes[h].querySelector(".".concat(as)),s(p))})})}}},{key:"expandSection",value:function(n){this.toggleCollapsibleSection([n],"expand")}},{key:"collapseSection",value:function(n){this.toggleCollapsibleSection([n],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(n){var o=this,i=this.headerStateManager.mapNodes(function(a){var s=a.collapsible,l=a.origColspan,u=a.headerLevel,c=a.columnIndex,f=a.isCollapsed;if(s===!0&&l>1&&(f&&n==="expand"||!f&&n==="collapse"))return{row:o.headerStateManager.levelToRowCoords(u),col:c}});this.toggleCollapsibleSection(i,n)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(n,o){var i=this;if(!DD.has(o))throw new Error("Unsupported action is passed (".concat(o,")."));if(Array.isArray(n)){var a=Ln(n,function(m){var v=m.row;return v<0}),s=a.length>0;T(a,function(m){var v,w=m.row,C=m.col,A=(v=i.headerStateManager.getHeaderSettings(w,C))!==null&&v!==void 0?v:{},D=A.collapsible,E=A.isCollapsed;if(!D||E&&o==="collapse"||!E&&o==="expand")return s=!1,!1});var l=[],u=[];s&&T(a,function(m){var v=m.row,w=m.col,C=i.headerStateManager.triggerNodeModification(o,v,w),A=C.colspanCompensation,D=C.affectedColumns,E=C.rollbackModification;A>0&&(u.push.apply(u,ID(D)),l.push(E))});var c=this.getCollapsedColumns(),f=[];o==="collapse"?f=Yk([].concat(ID(c),u)):o==="expand"&&(f=Ln(c,function(m){return!u.includes(m)}));var h=DD.get(o),p=this.hot.runHooks(h.beforeHook,c,f,s);if(p===!1){T(l,function(m){m()});return}this.hot.batchExecution(function(){T(u,function(m){jD(i,ss).setValueAtIndex(i.hot.toPhysicalColumn(m),h.hideColumn)})},!0);var y=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(h.afterHook,c,f,s,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return jD(this,ss).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(n,o,i){var a,s=(a=this.headerStateManager.getHeaderSettings(i,n))!==null&&a!==void 0?a:{},l=s.collapsible,u=s.origColspan,c=s.isCollapsed,f=l&&u>1&&n>=this.hot.getSettings().fixedColumnsStart,h=o.querySelector(".".concat(as));if(f)h||(h=this.hot.rootDocument.createElement("div"),q(h,as),o.querySelector("div:first-child").appendChild(h)),Bt(h,["collapsed","expanded"]),c?(q(h,"collapsed"),mi(h,"+")):(q(h,"expanded"),mi(h,"-"));else{var p;(p=h)===null||p===void 0||p.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(n,o){Dt(n.target,as)&&(Dt(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([o],"collapse")):Dt(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([o],"expand")),gr(n))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(n,o){o||this.updatePlugin()}},{key:"destroy",value:function(){XA(this,ss,null),Zi(ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return JA}},{key:"PLUGIN_PRIORITY",get:function(){return lEt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[JA].concat(uEt)}}]),r}(re);function Yh(e){return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}function _D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function fEt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_D(Object(r),!0).forEach(function(n){hEt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_D(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hEt(e,t,r){return t=FY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HD(e,t){return gEt(e)||yEt(e,t)||pEt(e,t)||dEt()}function dEt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pEt(e,t){if(e){if(typeof e=="string")return ND(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ND(e,t)}}function ND(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yEt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function gEt(e){if(Array.isArray(e))return e}function mEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FY(n.key),n)}}function vEt(e,t,r){return t&&BD(e.prototype,t),r&&BD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FY(e){var t=bEt(e,"string");return Yh(t)==="symbol"?t:String(t)}function bEt(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wEt=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],AEt=!1,SEt=!0,CEt=!0,OEt=function(){function e(t,r){mEt(this,e),this.hot=t,this.sortingStates=new Mv,this.sortEmptyCells=AEt,this.indicator=SEt,this.headerAction=CEt,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return vEt(e,[{key:"updateAllColumnsProperties",value:function(t){var r=this;zt(t)&&Qt(t,function(n,o){wEt.includes(o)&&(r[o]=n)})}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getSortOrderOfColumn",value:function(t){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))===null||r===void 0?void 0:r.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex(function(r){var n=HD(r,1),o=n[0];return o===t})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(t){return zt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}},{key:"getSortStates",value:function(){var t=this;if(this.sortingStates===null)return[];var r=this.sortingStates.getEntries();return r.map(function(n){var o=HD(n,2),i=o[0],a=o[1];return fEt({column:t.hot.toVisualColumn(i)},a)})}},{key:"getColumnSortState",value:function(t){var r=this.getSortOrderOfColumn(t);if(ht(r))return{column:t,sortOrder:r}}},{key:"setSortStates",value:function(t){this.sortingStates.clear();for(var r=0;r<t.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[r].column),{sortOrder:t[r].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Cm="asc",Om="desc",kEt="colHeader";function REt(e){if(zt(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Cm,Om].includes(r)}function EEt(e){if(e.some(function(r){return REt(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function LD(e){if(e!==Om)return e===Cm?Om:Cm}function VD(e){var t=e.querySelector(".".concat(kEt));return t}function FD(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function AO(e,t,r){return e===-1&&t>=0&&bi(r)===!1}var TEt="ascending",PEt="descending",WY="indicatorDisabled",UY="columnSorting",YY="sortAction",GY=new Map([[Cm,TEt],[Om,PEt]]);function MEt(e,t,r,n){var o=[UY];if(n&&o.push(YY),r===!1)return o.push(WY),o;var i=e.getSortOrderOfColumn(t);return ht(i)&&o.push(GY.get(i)),o}function IEt(){return Array.from(GY.values()).concat(YY,WY,UY)}function zY(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Dr:Qe(o)?Qe(i)?Dr:a&&e==="asc"?Ge:ze:Qe(i)?a&&e==="asc"?ze:Ge:isNaN(o)&&!isNaN(i)?e==="asc"?ze:Ge:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?Ge:ze:o>i?e==="asc"?ze:Ge:Dr}}var QY="default";function xEt(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),s=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Dr;if(s){if(Qe(n))return e==="asc"?Ge:ze;if(Qe(o))return e==="asc"?ze:Ge}return isNaN(i)?ze:isNaN(a)?Ge:i<a?e==="asc"?Ge:ze:i>a?e==="asc"?ze:Ge:Dr}}var jEt="numeric";function DEt(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,s){var l=Qe(a),u=Qe(s),c=l?o:a,f=u?o:s,h=c===o||c===n,p=f===o||f===n;if(i===!1){if(l&&u===!1)return ze;if(l===!1&&u)return Ge}return h===!1&&p?e==="asc"?Ge:ze:h&&p===!1?e==="asc"?ze:Ge:h===!1&&p===!1?zY(e,t,r)(a,s):c===o&&f===n?e==="asc"?Ge:ze:c===n&&f===o?e==="asc"?ze:Ge:Dr}}var _Et="checkbox";function HEt(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Dr;if(Qe(n))return Qe(o)?Dr:i&&e==="asc"?Ge:ze;if(Qe(o))return i&&e==="asc"?ze:Ge;var a=t.dateFormat,s=$(n,a),l=$(o,a);return s.isValid()?l.isValid()?l.isAfter(s)?e==="asc"?Ge:ze:l.isBefore(s)?e==="asc"?ze:Ge:Dr:Ge:ze}}var NEt="date",mE=tr("sorting.compareFunctionFactory"),nw=mE.register,WD=mE.getItem,BEt=mE.hasItem,KY=tr("sorting.mainSortComparator"),XY=KY.register,LEt=KY.getItem;function JY(e){return BEt(e)?WD(e):WD(QY)}nw(jEt,xEt);nw(_Et,DEt);nw(NEt,HEt);nw(QY,zY);var Dr=0,Ge=-1,ze=1;function VEt(e,t){for(var r=LEt(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function UD(e){return YEt(e)||UEt(e)||WEt(e)||FEt()}function FEt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WEt(e,t){if(e){if(typeof e=="string")return YD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YD(e,t)}}function YD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UEt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YEt(e){if(Array.isArray(e))return e}function GEt(e,t){return function(r,n){var o=UD(r),i=o.slice(1),a=UD(n),s=a.slice(1);return function(l){var u=e[l],c=t[l],f=i[l],h=s[l],p=c.columnSorting,y=p.compareFunctionFactory?p.compareFunctionFactory:JY(c.type),m=y(u,c,p)(f,h);return m}(0)}}function ru(e){return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}var zEt=["column"],QEt=["column"];function ls(e){return ZEt(e)||JEt(e)||XEt(e)||KEt()}function KEt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XEt(e,t){if(e){if(typeof e=="string")return SO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SO(e,t)}}function JEt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZEt(e){if(Array.isArray(e))return SO(e)}function SO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GD(Object(r),!0).forEach(function(n){qEt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qEt(e,t,r){return t=ZY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QD(e,t){if(e==null)return{};var r=$Et(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $Et(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function tTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZY(n.key),n)}}function eTt(e,t,r){return t&&KD(e.prototype,t),r&&KD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZY(e){var t=nTt(e,"string");return ru(t)==="symbol"?t:String(t)}function nTt(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qi(){return typeof Reflect<"u"&&Reflect.get?qi=Reflect.get.bind():qi=function(e,t,r){var n=rTt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},qi.apply(this,arguments)}function rTt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=so(e),e!==null););return e}function oTt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CO(e,t)}function CO(e,t){return CO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},CO(e,t)}function iTt(e){var t=lTt();return function(){var r=so(e),n;if(t){var o=so(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aTt(this,n)}}function aTt(e,t){if(t&&(ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sTt(e)}function sTt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lTt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function so(e){return so=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},so(e)}var OO="columnSorting",uTt=50,XD="append",cTt="replace";XY(OO,GEt);gt.getSingleton().register("beforeColumnSort");gt.getSingleton().register("afterColumnSort");var qY=function(e){oTt(r,e);var t=iTt(r);function r(n){var o;return tTt(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=OO,o.indexesSequenceCache=null,o}return eTt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.columnStatesManager=new OEt(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Oi(function(o){var i=n.hot.toVisualColumn(o);return i===null&&(i=o),n.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(o,i){return n.onAfterGetColHeader(o,i)}),this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("afterOnCellMouseDown",function(o,i){return n.onAfterOnCellMouseDown(o,i)}),this.addHook("afterInit",function(){return n.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.hot.view&&this.loadOrSortBySettings(),qi(so(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=this,o=function(i,a){var s=VD(a);FD(i,a)===!1||s===null||n.updateHeaderClasses(s)};this.hot.addHook("afterGetColHeader",o),this.hot.addHookOnce("afterViewRender",function(){n.hot.removeHook("afterGetColHeader",o)}),this.hot.batchExecution(function(){n.indexesSequenceCache!==null&&(n.hot.rowIndexMapper.setIndexesSequence(n.indexesSequenceCache.getValues()),n.hot.rowIndexMapper.unregisterMap(n.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,qi(so(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(n){var o=this.getSortConfig(),i=this.getNormalizedSortConfigs(n),a=this.areValidSortConfigs(i),s=this.hot.runHooks("beforeColumnSort",o,i,a);s!==!1&&(o.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new WU),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),a&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",o,a?i:o,a),a&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(n){return ht(n)?this.columnStatesManager.getColumnSortState(n):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(n){var o=this.getNormalizedSortConfigs(n);this.areValidSortConfigs(o)&&this.columnStatesManager.setSortStates(o)}},{key:"getNormalizedSortConfigs",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(n)?n.slice(0,1):[n]}},{key:"areValidSortConfigs",value:function(n){var o=this.hot.countCols();return EEt(n)&&n.every(function(i){var a=i.column;return a<=o&&a>=0})}},{key:"saveAllSortSettings",value:function(n){var o=this,i=this.columnStatesManager.getAllColumnsProperties(),a=function(s){var l=s.column,u=QD(s,zEt);return zD({column:o.hot.toPhysicalColumn(l)},u)};i.initialConfig=Gt(n,a),this.hot.runHooks("persistentStateSave","columnSorting",i)}},{key:"getAllSavedSortSettings",value:function(){var n=this,o={};this.hot.runHooks("persistentStateLoad","columnSorting",o);var i=o.value,a=function(s){var l=s.column,u=QD(s,QEt);return zD({column:n.hot.toVisualColumn(l)},u)};return ht(i)&&Array.isArray(i.initialConfig)&&(i.initialConfig=Gt(i.initialConfig,a)),i}},{key:"getColumnNextConfig",value:function(n){var o=this.columnStatesManager.getSortOrderOfColumn(n);if(ht(o)){var i=LD(o);return ht(i)?{column:n,sortOrder:i}:void 0}var a=this.hot.countCols();if(Number.isInteger(n)&&n>=0&&n<a)return{column:n,sortOrder:LD()}}},{key:"getNextSortConfig",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XD,i=this.columnStatesManager.getIndexOfColumnInSortQueue(n),a=i!==-1,s=this.getSortConfig(),l=this.getColumnNextConfig(n);if(a){if(he(l))return[].concat(ls(s.slice(0,i)),ls(s.slice(i+1)));if(o===XD)return[].concat(ls(s.slice(0,i)),ls(s.slice(i+1)),[l]);if(o===cTt)return[].concat(ls(s.slice(0,i)),[l],ls(s.slice(i+1)))}return ht(l)?s.concat(l):s}},{key:"getPluginColumnConfig",value:function(n){if(zt(n)){var o=n[this.pluginKey];if(zt(o))return o}return{}}},{key:"getMergedPluginSettings",value:function(n){var o=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),a=this.hot.getCellMeta(0,n),s=Object.getPrototypeOf(a);return Array.isArray(s.columns)?Object.assign(i,o,this.getPluginColumnConfig(s.columns[n])):ge(s.columns)?Object.assign(i,o,this.getPluginColumnConfig(s.columns(n))):Object.assign(i,o)}},{key:"getFirstCellSettings",value:function(n){var o=this.hot.getCellMeta(0,n),i=Object.create(o);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(n)),i}},{key:"getNumberOfRowsToSort",value:function(n){var o=this.hot.getSettings();return o.maxRows<=n?o.maxRows:n-o.minSpareRows}},{key:"sortByPresetSortStates",value:function(n){var o=this;if(n.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var i=[],a=this.hot.countRows(),s=function(y){return Gt(n,function(m){return o.hot.getDataAtCell(y,m.column)})},l=0;l<this.getNumberOfRowsToSort(a);l+=1)i.push([this.hot.toPhysicalRow(l)].concat(s(l)));var u=Gt(i,function(y){return y[0]});VEt(i,this.pluginKey,Gt(n,function(y){return y.sortOrder}),Gt(n,function(y){return o.getFirstCellSettings(y.column)}));for(var c=i.length;c<a;c+=1)i.push([c].concat(s(c)));var f=Gt(i,function(y){return y[0]}),h=new Map(Gt(u,function(y,m){return[y,f[m]]})),p=Gt(this.hot.rowIndexMapper.getIndexesSequence(),function(y){return h.has(y)?h.get(y):y});this.hot.rowIndexMapper.setIndexesSequence(p)}},{key:"loadOrSortBySettings",value:function(){var n=this.getAllSavedSortSettings();if(zt(n))this.sortBySettings(n);else{var o=this.hot.getSettings()[this.pluginKey];this.sortBySettings(o)}}},{key:"sortBySettings",value:function(n){if(zt(n)){this.columnStatesManager.updateAllColumnsProperties(n);var o=n.initialConfig;(Array.isArray(o)||zt(o))&&this.sort(o)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(n,o){var i=VD(o);if(!(FD(n,o)===!1||i===null)){var a=this.getFirstCellSettings(n)[this.pluginKey],s=a.indicator,l=a.headerAction;this.updateHeaderClasses(i,this.columnStatesManager,n,s,l)}}},{key:"updateHeaderClasses",value:function(n){if(Bt(n,IEt()),this.enabled!==!1){for(var o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];q(n,MEt.apply(void 0,i))}}},{key:"onUpdateSettings",value:function(n){qi(so(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ht(n[this.pluginKey])&&this.sortBySettings(n[this.pluginKey])}},{key:"onAfterLoadData",value:function(n){n===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(n,o){var i=this.getFirstCellSettings(o)[this.pluginKey],a=i.headerAction;return a&&n.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i,a){AO(o.row,o.col,n)!==!1&&this.wasClickableHeaderClicked(n,o.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(a.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(n,o){AO(o.row,o.col,n)!==!1&&this.wasClickableHeaderClicked(n,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(o.col)),this.sort(this.getColumnNextConfig(o.col)))}},{key:"destroy",value:function(){var n;(n=this.columnStatesManager)===null||n===void 0||n.destroy(),qi(so(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return OO}},{key:"PLUGIN_PRIORITY",get:function(){return uTt}}]),r}(re),fTt=jt,vE=Kt,hTt=Ci,dTt=lV,pTt=aF,JD=Wt,yTt=RangeError,$Y=String,t2=Math.floor,kO=vE(pTt),ZD=vE("".slice),Lc=vE(1 .toFixed),xs=function(e,t,r){return t===0?r:t%2===1?xs(e,t-1,r*e):xs(e*e,t/2,r)},gTt=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},us=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=t2(o/1e7)},ZA=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=t2(n/t),n=n%t*1e7},qD=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=$Y(e[t]);r=r===""?n:r+kO("0",7-n.length)+n}return r},mTt=JD(function(){return Lc(8e-5,3)!=="0.000"||Lc(.9,0)!=="1"||Lc(1.255,2)!=="1.25"||Lc(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!JD(function(){Lc({})});fTt({target:"Number",proto:!0,forced:mTt},{toFixed:function(e){var t=dTt(this),r=hTt(e),n=[0,0,0,0,0,0],o="",i="0",a,s,l,u;if(r<0||r>20)throw yTt("Incorrect fraction digits");if(t!=t)return"NaN";if(t<=-1e21||t>=1e21)return $Y(t);if(t<0&&(o="-",t=-t),t>1e-21)if(a=gTt(t*xs(2,69,1))-69,s=a<0?t*xs(2,-a,1):t/xs(2,a,1),s*=4503599627370496,a=52-a,a>0){for(us(n,0,s),l=r;l>=7;)us(n,1e7,0),l-=7;for(us(n,xs(10,l,1),0),l=a-1;l>=23;)ZA(n,1<<23),l-=23;ZA(n,1<<l),us(n,1,1),ZA(n,2),i=qD(n)}else us(n,0,s),us(n,1<<-a,0),i=qD(n)+kO("0",r);return r>0?(u=i.length,i=o+(u<=r?"0."+kO("0",r-u)+i:ZD(i,0,u-r)+"."+ZD(i,u-r))):i=o+i,i}});function Gh(e){return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function vTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wTt(n.key),n)}}function bTt(e,t,r){return t&&$D(e.prototype,t),r&&$D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wTt(e){var t=ATt(e,"string");return Gh(t)==="symbol"?t:String(t)}function ATt(e,t){if(Gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var STt=function(){function e(t,r){vTt(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return bTt(e,[{key:"getEndpoint",value:function(t){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var r=this,n=[],o=t;if(!o&&typeof this.settings=="function"){this.settingsType="function";return}return o||(o=this.settings),T(o,function(i){var a={};r.assignSetting(i,a,"ranges",[[0,r.hot.countRows()-1]]),r.assignSetting(i,a,"reversedRowCoords",!1),r.assignSetting(i,a,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),r.assignSetting(i,a,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),r.assignSetting(i,a,"sourceColumn",i.destinationColumn),r.assignSetting(i,a,"type","sum"),r.assignSetting(i,a,"forceNumeric",!1),r.assignSetting(i,a,"suppressDataTypeErrors",!0),r.assignSetting(i,a,"suppressDataTypeErrors",!0),r.assignSetting(i,a,"customFunction",null),r.assignSetting(i,a,"readOnly",!0),r.assignSetting(i,a,"roundFloat",!1),n.push(a)}),n}},{key:"assignSetting",value:function(t,r,n,o){if(n==="ranges"&&t[n]===void 0){r[n]=o;return}else if(n==="ranges"&&t[n].length===0)return;if(t[n]===void 0){if(o instanceof Error)throw o;r[n]=o}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-t[n]-1:r[n]=t[n]}},{key:"resetSetupBeforeStructureAlteration",value:function(t,r,n){if(this.settingsType==="function"){var o=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();T(i,function(a){o==="row"&&a.destinationRow>=r&&(t==="insert_row"?a.alterRowOffset=n:t==="remove_row"&&(a.alterRowOffset=-1*n)),o==="col"&&a.destinationColumn>=r&&(t==="insert_col"?a.alterColumnOffset=n:t==="remove_col"&&(a.alterColumnOffset=-1*n))}),this.resetAllEndpoints(i,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,r,n,o,i){var a=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var l=function y(){return a.hot.removeHook("beforeViewRender",y),a.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",l);return}var u=t.indexOf("row")>-1?"row":"col",c=t.indexOf("remove")>-1?-1:1,f=this.getAllEndpoints(),h=t.indexOf("move_row")===0,p=r;T(f,function(y){u==="row"&&y.destinationRow>=p&&(y.alterRowOffset=c*n),u==="col"&&y.destinationColumn>=p&&(y.alterColumnOffset=c*n)}),this.resetAllEndpoints(f,!h),h?T(f,function(y){a.extendEndpointRanges(y,p,o[0],o.length),a.recreatePhysicalRanges(y),a.clearOffsetInformation(y)}):T(f,function(y){a.shiftEndpointCoordinates(y,p)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,r,n,o){T(t.ranges,function(i){i[1]&&(r>=i[0]&&r<=i[1]?n>i[1]?i[1]+=o:n<i[0]&&(i[0]-=o):n>=i[0]&&n<=i[1]&&(i[1]-=o,r<=i[0]&&(i[0]+=1,i[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(t){var r=this,n=t.ranges,o=[],i=[];T(n,function(a){var s=[];if(a[1])for(var l=a[0];l<=a[1];l++)s.push(r.hot.toPhysicalRow(l));else s.push(r.hot.toPhysicalRow(a[0]));i.push(s)}),T(i,function(a){var s=[];T(a,function(l,u){u===0?s.push(l):a[u]!==a[u-1]+1&&(s.push(a[u-1]),o.push(s),s=[],s.push(l)),u===a.length-1&&(s.push(l),o.push(s))})}),t.ranges=o}},{key:"shiftEndpointCoordinates",value:function(t,r){t.alterRowOffset&&t.alterRowOffset!==0?(t.destinationRow+=t.alterRowOffset||0,T(t.ranges,function(n){T(n,function(o,i){o>=r&&(n[i]+=t.alterRowOffset||0)})})):t.alterColumnOffset&&t.alterColumnOffset!==0&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.some(function(i){var a=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+a>=t.hot.countRows()||i.destinationColumn+s>=t.hot.countCols()});o||(this.cellsToSetCache=[],T(r,function(i){t.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var t=this;this.cellsToSetCache=[],T(this.getAllEndpoints(),function(r){t.currentEndpoint=r,t.plugin.calculate(r),t.setEndpointValue(r,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var r=this,n=[];this.cellsToSetCache=[],T(t,function(o,i,a){"".concat(o[2]||"")!=="".concat(o[3])&&T(r.getAllEndpoints(),function(s,l){r.hot.propToCol(a[i][1])===s.sourceColumn&&n.indexOf(l)===-1&&n.push(l)})}),T(n,function(o){r.refreshEndpoint(r.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=t.alterRowOffset||0,o=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(r?n:0)),this.hot.toVisualColumn(t.destinationColumn+(r?o:0)),""])}},{key:"setEndpointValue",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var i=this.hot.toVisualRow(t.destinationRow);if(i!==null){var a=this.hot.getCellMeta(i,t.destinationColumn);(r==="init"||a.readOnly!==t.readOnly)&&(a.readOnly=t.readOnly,a.className="columnSummaryResult")}t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),n?this.hot.setDataAtCell(o,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){de("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const CTt=STt;function qA(e){return e==null||isNaN(e)}function ou(e){return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}var t_;function OTt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function kTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function e_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ETt(n.key),n)}}function RTt(e,t,r){return t&&e_(e.prototype,t),r&&e_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ETt(e){var t=TTt(e,"string");return ou(t)==="symbol"?t:String(t)}function TTt(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ag(){return typeof Reflect<"u"&&Reflect.get?ag=Reflect.get.bind():ag=function(e,t,r){var n=PTt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ag.apply(this,arguments)}function PTt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=iu(e),e!==null););return e}function MTt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RO(e,t)}function RO(e,t){return RO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},RO(e,t)}function ITt(e){var t=DTt();return function(){var r=iu(e),n;if(t){var o=iu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xTt(this,n)}}function xTt(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jTt(e)}function jTt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DTt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iu(e){return iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},iu(e)}var $A="columnSummary",_Tt=220,HTt=function(e){MTt(r,e);var t=ITt(r);function r(n){var o;return kTt(this,r),o=t.call(this,n),o.endpoints=null,o}return RTt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$A]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings()[$A],this.endpoints=new CTt(this,this.settings),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeCreateRow",function(o,i,a){return n.endpoints.resetSetupBeforeStructureAlteration("insert_row",o,i,null,a)}),this.addHook("beforeCreateCol",function(o,i,a){return n.endpoints.resetSetupBeforeStructureAlteration("insert_col",o,i,null,a)}),this.addHook("beforeRemoveRow",function(){for(var o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(o=n.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_row"].concat(a))}),this.addHook("beforeRemoveCol",function(){for(var o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(o=n.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_col"].concat(a))}),this.addHook("afterCreateRow",function(o,i,a){return n.endpoints.resetSetupAfterStructureAlteration("insert_row",o,i,null,a)}),this.addHook("afterCreateCol",function(o,i,a){return n.endpoints.resetSetupAfterStructureAlteration("insert_col",o,i,null,a)}),this.addHook("afterRemoveRow",function(){for(var o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(o=n.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_row"].concat(a))}),this.addHook("afterRemoveCol",function(){for(var o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(o=n.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_col"].concat(a))}),this.addHook("afterRowMove",function(){return n.onAfterRowMove.apply(n,arguments)}),ag(iu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(n){switch(n.type.toLowerCase()){case"sum":n.result=this.calculateSum(n);break;case"min":n.result=this.calculateMinMax(n,n.type);break;case"max":n.result=this.calculateMinMax(n,n.type);break;case"count":n.result=this.countEntries(n);break;case"average":n.result=this.calculateAverage(n);break;case"custom":n.result=n.customFunction.call(this,n);break}}},{key:"calculateSum",value:function(n){var o=this,i=0;return Qt(n.ranges,function(a){i+=o.getPartialSum(a,n.sourceColumn)}),i}},{key:"getPartialSum",value:function(n,o){var i=0,a=n[1]||n[0],s=null,l=0;do{if(s=this.getCellValue(a,o),s=qA(s)?null:s,s!==null){var u=("".concat(s).split(".")[1]||[]).length||1;u>l&&(l=u)}i+=s||0,a-=1}while(a>=n[0]);return Math.round(i*Math.pow(10,l))/Math.pow(10,l)}},{key:"calculateMinMax",value:function(n,o){var i=this,a=null;return Qt(n.ranges,function(s){var l=i.getPartialMinMax(s,n.sourceColumn,o);if(a===null&&l!==null&&(a=l),l!==null)switch(o){case"min":a=Math.min(a,l);break;case"max":a=Math.max(a,l);break}}),a===null?"Not enough data":a}},{key:"getPartialMinMax",value:function(n,o,i){var a=null,s=n[1]||n[0],l;do{if(l=this.getCellValue(s,o),l=qA(l)?null:l,a===null)a=l;else if(l!==null)switch(i){case"min":a=Math.min(a,l);break;case"max":a=Math.max(a,l);break}s-=1}while(s>=n[0]);return a}},{key:"countEmpty",value:function(n,o){var i,a=0,s=n[1]||n[0];do i=this.getCellValue(s,o),i=qA(i)?null:i,i===null&&(a+=1),s-=1;while(s>=n[0]);return a}},{key:"countEntries",value:function(n){var o=this,i=0,a=n.ranges;return Qt(a,function(s){var l=s[1]===void 0?1:s[1]-s[0]+1,u=o.countEmpty(s,n.sourceColumn);i+=l,i-=u}),i}},{key:"calculateAverage",value:function(n){var o=this.calculateSum(n),i=this.countEntries(n);return o/i}},{key:"getCellValue",value:function(n,o){var i=this.hot.toVisualRow(n),a=this.hot.toVisualColumn(o),s=this.hot.getSourceDataAtCell(n,o),l="";if(i!==null&&a!==null&&(l=this.hot.getCellMeta(i,a).className||""),l.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ce(t_||(t_=OTt(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),n,o));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(n,o){n&&o!=="ColumnSummary.reset"&&o!=="ColumnSummary.set"&&o!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}},{key:"onAfterRowMove",value:function(n,o){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",o,n.length,n,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return $A}},{key:"PLUGIN_PRIORITY",get:function(){return _Tt}}]),r}(re);function zh(e){return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function NTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LTt(n.key),n)}}function BTt(e,t,r){return t&&n_(e.prototype,t),r&&n_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LTt(e){var t=VTt(e,"string");return zh(t)==="symbol"?t:String(t)}function VTt(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FTt=function(){function e(t,r){NTt(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return BTt(e,[{key:"setPosition",value:function(t,r){this.editorStyle.left="".concat(t,"px"),this.editorStyle.top="".concat(r,"px")}},{key:"setSize",value:function(t,r){if(t&&r){var n=this.getInputElement();n.style.width="".concat(t,"px"),n.style.height="".concat(r,"px")}}},{key:"getSize",value:function(){return{width:fe(this.getInputElement()),height:ke(this.getInputElement())}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){var r=this.getInputElement();r.readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=t||"";this.getInputElement().value=r}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=this.rootDocument.createElement("div"),r=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),q(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),q(t,e.CLASS_EDITOR),q(r,e.CLASS_INPUT),t.appendChild(r),this.container.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const WTt=FTt;var Jt="---------";function UTt(){return{name:Jt}}function YTt(e){return Gt(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function sy(e){return Dt(e,"htSeparator")}function GTt(e){return Dt(e,"htSubmenu")}function ly(e){return Dt(e,"htDisabled")}function uy(e){return Dt(e,"htSelectionDisabled")}function Qa(e){var t=e.getSelected();return!t||t[0]<0?null:t}function zTt(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function QTt(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function _i(e,t){var r={};return T(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function Ko(e,t,r,n,o){T(e,function(i){i.forAll(function(a,s){a>=0&&s>=0&&KTt(a,s,t,r,n,o)})})}function KTt(e,t,r,n,o,i){var a=o(e,t),s=n;a.className&&(r==="vertical"?s=zTt(a.className,n):s=QTt(a.className,n)),i(e,t,"className",s)}function Ir(e,t){var r=!1;return Array.isArray(e)&&T(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function Zr(e){return'<span class="selected">'.concat("","</span>").concat(e)}function XTt(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function e2(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function JTt(e,t){var r=e.slice(0);return r.reverse(),r=e2(r,t),r.reverse(),r}function ZTt(e){var t=[];return T(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function qTt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jt,r=e.slice(0);return r=e2(r,t),r=JTt(r,t),r=ZTt(r),r}function Qh(e){return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}function $Tt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ePt(n.key),n)}}function tPt(e,t,r){return t&&r_(e.prototype,t),r&&r_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ePt(e){var t=nPt(e,"string");return Qh(t)==="symbol"?t:String(t)}function nPt(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rPt=250,oPt=250,n2=function(){function e(t){$Tt(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return tPt(e,[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){t.wasLastActionShow===!1&&t.runLocalHooks("hide")},oPt)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rPt;this.showDebounced=AR(function(n){t.wasLastActionShow&&t.runLocalHooks("show",n.from.row,n.from.col)},r)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();pe(n2,Tn);const iPt=n2;function au(e){return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function t0(e,t,r){return t=r2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r2(n.key),n)}}function sPt(e,t,r){return t&&o_(e.prototype,t),r&&o_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r2(e){var t=lPt(e,"string");return au(t)==="symbol"?t:String(t)}function lPt(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $i(){return typeof Reflect<"u"&&Reflect.get?$i=Reflect.get.bind():$i=function(e,t,r){var n=uPt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},$i.apply(this,arguments)}function uPt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lo(e),e!==null););return e}function cPt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EO(e,t)}function EO(e,t){return EO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},EO(e,t)}function fPt(e){var t=dPt();return function(){var r=lo(e),n;if(t){var o=lo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hPt(this,n)}}function hPt(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o2(e)}function o2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dPt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lo(e){return lo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lo(e)}var e0="comments",pPt=60,cy=new WeakMap,Or="comment",cs="value",i_="style",fy="readOnly",yPt=function(e){cPt(r,e);var t=fPt(r);function r(n){var o;return aPt(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,cy.set(o2(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return sPt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[e0]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.editor||(this.editor=new WTt(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Re(this)),this.displaySwitch||(this.displaySwitch=new iPt(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(o){return n.addToContextMenu(o)}),this.addHook("afterRenderer",function(o,i,a,s,l,u){return n.onAfterRenderer(o,u)}),this.addHook("afterScrollHorizontally",function(){return n.hide()}),this.addHook("afterScrollVertically",function(){return n.hide()}),this.addHook("afterBeginEditing",function(){return n.hide()}),this.displaySwitch.addLocalHook("hide",function(){return n.hide()}),this.displaySwitch.addLocalHook("show",function(o,i){return n.showAtCell(o,i)}),this.registerListeners(),$i(lo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),$i(lo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){$i(lo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var n=this,o=this.hot.rootDocument;this.eventManager.addEventListener(o,"mouseover",function(i){return n.onMouseOver(i)}),this.eventManager.addEventListener(o,"mousedown",function(i){return n.onMouseDown(i)}),this.eventManager.addEventListener(o,"mouseup",function(){return n.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return n.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(i){return n.onEditorMouseDown(i)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(i){return n.onEditorMouseUp(i)})}},{key:"setRange",value:function(n){this.range=n}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(n){var o=ri(n.target,"TD","TBODY");return!!(o&&Dt(o,"htCommentCell")&&ri(o,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(n){return this.editor.getInputElement()===n.target}},{key:"setComment",value:function(n){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.editor.getValue(),i="";n!=null?i=n:o!=null&&(i=o);var a=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(a,s,t0({},cs,i)),this.hot.render()}},{key:"setCommentAtCell",value:function(n,o,i){this.setRange({from:this.hot._createCellCoords(n,o)}),this.setComment(i)}},{key:"removeComment",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Or),n&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(n,o)}),this.removeComment(i)}},{key:"getComment",value:function(){var n=this.range.from.row,o=this.range.from.col;return this.getCommentMeta(n,o,cs)}},{key:"getCommentAtCell",value:function(n,o){return this.getCommentMeta(n,o,cs)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.range.from,o=n.row,i=n.col;if(o<0||o>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;var a=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(a[Or]?a[Or][cs]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(n,o){return this.setRange({from:this.hot._createCellCoords(n,o)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var n,o,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!i&&(!this.range.from||!this.editor.isVisible()))){var a=this.hot,s=a.rowIndexMapper,l=a.columnIndexMapper,u=this.range.from,c=u.row,f=u.col,h=s.getRenderableFromVisualIndex(c),p=l.getRenderableFromVisualIndex(f),y=h===null;this.editor.setPosition(0,0),h===null&&(h=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),p===null&&(p=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,-1)));var m=h===null,v=p===null;h=(n=h)!==null&&n!==void 0?n:0,p=(o=p)!==null&&o!==void 0?o:0;var w=this.hot,C=w.rootWindow,A=w.view._wt,D=A.wtTable,E=A.getCell({row:h,col:p},!0),G=this.getCommentMeta(c,f,i_);G?this.editor.setSize(G.width,G.height):this.editor.resetSize();var K=v?0:D.getStretchedColumnWidth(p),nt=y&&!m?ke(E):0,z=E.getBoundingClientRect(),X=z.left,Z=z.top,tt=z.width,et=z.height,bt=this.editor.getSize(),yt=bt.width,kt=bt.height,Et=this.hot.rootWindow,P=Et.innerWidth,d=Et.innerHeight,g=this.hot.rootDocument.documentElement,b=X+C.scrollX+K,O=Z+C.scrollY+nt;this.hot.isRtl()&&(b-=yt+K),this.hot.isLtr()&&X+tt+yt>P?b=X+C.scrollX-yt-1:this.hot.isRtl()&&b<-(g.scrollWidth-g.clientWidth)&&(b=X+C.scrollX+K+1),Z+kt>d&&(O-=kt-et+1),this.editor.setPosition(b,O),this.editor.setReadOnlyState(this.getCommentMeta(c,f,fy))}}},{key:"checkSelectionCommentsConsistency",value:function(){var n=this.hot.getSelectedRangeLast();if(!n)return!1;var o=!1,i=n.getTopStartCorner();return this.getCommentMeta(i.row,i.col,cs)&&(o=!0),o}},{key:"updateCommentMeta",value:function(n,o,i){var a=this.hot.getCellMeta(n,o)[Or],s;a?(s=on(a),$d(s,i)):s=i,this.hot.setCellMeta(n,o,Or,s)}},{key:"getCommentMeta",value:function(n,o,i){var a=this.hot.getCellMeta(n,o);if(a[Or])return a[Or][i]}},{key:"onMouseDown",value:function(n){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(n)){var o=ri(n.target,"TD","TBODY"),i=null;o&&(i=this.hot.getCoords(o)),(!o||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}},{key:"onMouseOver",value:function(n){var o=cy.get(this),i=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Dt(n.target,"wtBorder")||o.cellBelowCursor===n.target||!this.editor))if(o.cellBelowCursor=i.elementFromPoint(n.clientX,n.clientY),this.targetIsCellWithComment(n)){var a=this.hot._createCellRange(this.hot.getCoords(n.target));this.displaySwitch.show(a)}else oi(n.target,i)&&!this.targetIsCommentTextArea(n)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(n,o){o[Or]&&o[Or][cs]&&q(n,o.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(n){var o=cy.get(this);o.tempEditorDimensions={width:fe(n.target),height:ke(n.target)}}},{key:"onEditorMouseUp",value:function(n){var o=cy.get(this),i=fe(n.target),a=ke(n.target);(i!==o.tempEditorDimensions.width+1||a!==o.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,t0({},i_,{width:i,height:a}))}},{key:"onContextMenuAddComment",value:function(){var n=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:n.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var n=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(i,a){i>=0&&a>=0&&n.removeCommentAtCell(i,a,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var n=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(i,a){if(i>=0&&a>=0){var s=!!n.getCommentMeta(i,a,fy);n.updateCommentMeta(i,a,t0({},fy,!s))}})}},{key:"addToContextMenu",value:function(n){var o=this,i=function(){return o.hot.rowIndexMapper.getRenderableIndexesLength()>0&&o.hot.columnIndexMapper.getRenderableIndexesLength()>0};n.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return o.checkSelectionCommentsConsistency()?o.hot.getTranslatedPhrase(Zv):o.hot.getTranslatedPhrase(Jv)},callback:function(){return o.onContextMenuAddComment()},disabled:function(){return i()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(qv)},callback:function(){return o.onContextMenuRemoveComment()},disabled:function(){return i()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var a=this,s=this.getTranslatedPhrase($v),l=Ir(this.getSelectedRangeLast(),function(u,c){var f=a.getCellMeta(u,c)[Or];if(f&&(f=f[fy]),f)return!0});return l&&(s=Zr(s)),s},callback:function(){return o.onContextMenuMakeReadOnly()},disabled:function(){return i()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner())||!o.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var n=this.hot.getSettings()[e0];if(zt(n))return n.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),$i(lo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return e0}},{key:"PLUGIN_PRIORITY",get:function(){return pPt}}]),r}(re);function Kh(e){return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function gPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vPt(n.key),n)}}function mPt(e,t,r){return t&&a_(e.prototype,t),r&&a_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vPt(e){var t=bPt(e,"string");return Kh(t)==="symbol"?t:String(t)}function bPt(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wPt=function(){function e(t){gPt(this,e),this.hot=t,this.commands={},this.commonCallback=null}return mPt(e,[{key:"registerCommand",value:function(t,r){this.commands[t]=r}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var r=this,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];var a=t.split(":"),s=a[0],l=a.length===2?a[1]:null,u=this.commands[s];if(!u)throw new Error("Menu command '".concat(s,"' not exists."));if(l&&u.submenu&&(u=APt(l,u.submenu.items)),u.disabled!==!0&&!(typeof u.disabled=="function"&&u.disabled.call(this.hot)===!0)&&!Te(u,"submenu")){var c=[];typeof u.callback=="function"&&c.push(u.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),o.unshift(a.join(":")),T(c,function(f){return f.apply(r.hot,o)})}}}]),e}();function APt(e,t){var r;return T(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const i2=wPt;var zn="alignment";function SPt(){return{key:zn,name:function(){return this.getTranslatedPhrase(tb)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(zn,":left"),name:function(){var e=this,t=this.getTranslatedPhrase(eb),r=Ir(this.getSelectedRange(),function(n,o){var i=e.getCellMeta(n,o).className;if(i&&i.indexOf("htLeft")!==-1)return!0});return r&&(t=Zr(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=_i(t,function(i,a){return e.getCellMeta(i,a).className}),n="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",r,t,n,o),Ko(t,n,o,function(i,a){return e.getCellMeta(i,a)},function(i,a,s,l){return e.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat(zn,":center"),name:function(){var e=this,t=this.getTranslatedPhrase(nb),r=Ir(this.getSelectedRange(),function(n,o){var i=e.getCellMeta(n,o).className;if(i&&i.indexOf("htCenter")!==-1)return!0});return r&&(t=Zr(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=_i(t,function(i,a){return e.getCellMeta(i,a).className}),n="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",r,t,n,o),Ko(t,n,o,function(i,a){return e.getCellMeta(i,a)},function(i,a,s,l){return e.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat(zn,":right"),name:function(){var e=this,t=this.getTranslatedPhrase(rb),r=Ir(this.getSelectedRange(),function(n,o){var i=e.getCellMeta(n,o).className;if(i&&i.indexOf("htRight")!==-1)return!0});return r&&(t=Zr(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=_i(t,function(i,a){return e.getCellMeta(i,a).className}),n="horizontal",o="htRight";this.runHooks("beforeCellAlignment",r,t,n,o),Ko(t,n,o,function(i,a){return e.getCellMeta(i,a)},function(i,a,s,l){return e.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat(zn,":justify"),name:function(){var e=this,t=this.getTranslatedPhrase(ob),r=Ir(this.getSelectedRange(),function(n,o){var i=e.getCellMeta(n,o).className;if(i&&i.indexOf("htJustify")!==-1)return!0});return r&&(t=Zr(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=_i(t,function(i,a){return e.getCellMeta(i,a).className}),n="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",r,t,n,o),Ko(t,n,o,function(i,a){return e.getCellMeta(i,a)},function(i,a,s,l){return e.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{name:Jt},{key:"".concat(zn,":top"),name:function(){var e=this,t=this.getTranslatedPhrase(ib),r=Ir(this.getSelectedRange(),function(n,o){var i=e.getCellMeta(n,o).className;if(i&&i.indexOf("htTop")!==-1)return!0});return r&&(t=Zr(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=_i(t,function(i,a){return e.getCellMeta(i,a).className}),n="vertical",o="htTop";this.runHooks("beforeCellAlignment",r,t,n,o),Ko(t,n,o,function(i,a){return e.getCellMeta(i,a)},function(i,a,s,l){return e.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat(zn,":middle"),name:function(){var e=this,t=this.getTranslatedPhrase(ab),r=Ir(this.getSelectedRange(),function(n,o){var i=e.getCellMeta(n,o).className;if(i&&i.indexOf("htMiddle")!==-1)return!0});return r&&(t=Zr(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=_i(t,function(i,a){return e.getCellMeta(i,a).className}),n="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",r,t,n,o),Ko(t,n,o,function(i,a){return e.getCellMeta(i,a)},function(i,a,s,l){return e.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat(zn,":bottom"),name:function(){var e=this,t=this.getTranslatedPhrase(sb),r=Ir(this.getSelectedRange(),function(n,o){var i=e.getCellMeta(n,o).className;if(i&&i.indexOf("htBottom")!==-1)return!0});return r&&(t=Zr(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=_i(t,function(i,a){return e.getCellMeta(i,a).className}),n="vertical",o="htBottom";this.runHooks("beforeCellAlignment",r,t,n,o),Ko(t,n,o,function(i,a){return e.getCellMeta(i,a)},function(i,a,s,l){return e.setCellMeta(i,a,s,l)}),this.render()},disabled:!1}]}}}var rw="clear_column";function CPt(){return{key:rw,name:function(){return this.getTranslatedPhrase(Vv)},callback:function(e,t){var r=t[0].start.col,n=t[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(t[0].start.row,t[0].end.row),n,"ContextMenu.clearColumn")},disabled:function(){var e=Qa(this);return e?!this.selection.isSelectedByColumnHeader():!0}}}var bp="col_left";function OPt(){return{key:bp,name:function(){return this.getTranslatedPhrase(jv)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Qa(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var t=this.countCols();return t===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var wp="col_right";function kPt(){return{key:wp,name:function(){return this.getTranslatedPhrase(Dv)},callback:function(){var e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Qa(this);return e?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Ap="make_read_only";function RPt(){return{key:Ap,name:function(){var e=this,t=this.getTranslatedPhrase(Lv),r=Ir(this.getSelectedRange(),function(n,o){return e.getCellMeta(n,o).readOnly});return r&&(t=Zr(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=Ir(t,function(n,o){return e.getCellMeta(n,o).readOnly});T(t,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"readOnly",!r)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var ow="redo";function EPt(){return{key:ow,name:function(){return this.getTranslatedPhrase(Bv)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function TPt(e,t){return xPt(e)||IPt(e,t)||MPt(e,t)||PPt()}function PPt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MPt(e,t){if(e){if(typeof e=="string")return s_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s_(e,t)}}function s_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IPt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function xPt(e){if(Array.isArray(e))return e}var Sp="remove_col";function jPt(){return{key:Sp,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var r=TPt(e[0],4),n=r[1],o=r[3];n-o!==0&&(t=1)}return this.getTranslatedPhrase(Hv,t)},callback:function(){this.alter("remove_col",Nwt(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Qa(this);if(!e)return!0;var t=this.countCols();return this.selection.isSelectedByCorner()?t===0:this.selection.isSelectedByRowHeader()||t===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function DPt(e,t){return BPt(e)||NPt(e,t)||HPt(e,t)||_Pt()}function _Pt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HPt(e,t){if(e){if(typeof e=="string")return l_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l_(e,t)}}function l_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NPt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function BPt(e){if(Array.isArray(e))return e}var iw="remove_row";function LPt(){return{key:iw,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var r=DPt(e[0],3),n=r[0],o=r[2];n-o!==0&&(t=1)}return this.getTranslatedPhrase(_v,t)},callback:function(){this.alter("remove_row",Bwt(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var e=Qa(this);if(!e)return!0;var t=this.countRows();return this.selection.isSelectedByCorner()?t===0:this.selection.isSelectedByColumnHeader()||t===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var aw="row_above";function VPt(){return{key:aw,name:function(){return this.getTranslatedPhrase(Iv)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled:function(){var e=Qa(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var t=this.countRows();return t===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var sw="row_below";function FPt(){return{key:sw,name:function(){return this.getTranslatedPhrase(xv)},callback:function(){var e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled:function(){var e=Qa(this);return e?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Xh="no_items";function WPt(){return{key:Xh,name:function(){return this.getTranslatedPhrase(XR)},disabled:!0,isCommand:!1}}var lw="undo";function UPt(){return{key:lw,name:function(){return this.getTranslatedPhrase(Nv)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Jh(e){return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}var un;function Mn(e,t,r){return t=YPt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YPt(e){var t=GPt(e,"string");return Jh(t)==="symbol"?t:String(t)}function GPt(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zPt=[aw,sw,bp,wp,rw,iw,Sp,lw,ow,Ap,zn,Jt,Xh],QPt=(un={},Mn(un,Jt,UTt),Mn(un,Xh,WPt),Mn(un,aw,VPt),Mn(un,sw,FPt),Mn(un,bp,OPt),Mn(un,wp,kPt),Mn(un,rw,CPt),Mn(un,iw,LPt),Mn(un,Sp,jPt),Mn(un,lw,UPt),Mn(un,ow,EPt),Mn(un,Ap,RPt),Mn(un,zn,SPt),un);function a2(){var e={};return Qt(QPt,function(t,r){e[r]=t()}),e}function Zh(e){return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zh(e)}function KPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JPt(n.key),n)}}function XPt(e,t,r){return t&&u_(e.prototype,t),r&&u_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JPt(e){var t=ZPt(e,"string");return Zh(t)==="symbol"?t:String(t)}function ZPt(e,t){if(Zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qPt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;KPt(this,e),this.hot=t,this.predefinedItems=a2(),this.defaultOrderPattern=r}return XPt(e,[{key:"setPredefinedItems",value:function(t){var r=this,n={};this.defaultOrderPattern.length=0,Qt(t,function(o,i){var a="";o.name===Jt?(n[Jt]=o,a=Jt):isNaN(parseInt(i,10))?(o.key=o.key===void 0?i:o.key,n[i]=o,a=o.key):(n[o.key]=o,a=o.key),r.defaultOrderPattern.push(a)}),this.predefinedItems=n}},{key:"getItems",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return $Pt(t,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function $Pt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),zt(o)?Qt(o,function(i,a){var s=r[typeof i=="string"?i:a];s||(s=i),zt(i)?Ve(s,i):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=a),n.push(s)}):T(o,function(i,a){var s=r[i];!s&&zPt.indexOf(i)>=0||(s||(s={name:i,key:"".concat(a)}),zt(i)&&Ve(s,i),s.key===void 0&&(s.key=a),n.push(s))}),n}const s2=qPt;function qh(e){return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function tMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nMt(n.key),n)}}function eMt(e,t,r){return t&&c_(e.prototype,t),r&&c_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nMt(e){var t=rMt(e,"string");return qh(t)==="symbol"?t:String(t)}function rMt(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oMt=function(){function e(t,r){tMt(this,e);var n=tl(r),o=Oa(r),i,a,s,l,u,c;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),s=parseInt(t.left,10),u=t.height||0,c=t.width||0,a=i,l=s,i+=n,s+=o):this.type==="event"&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),u=t.target.clientHeight,c=t.target.clientWidth,a=i-n,l=s-o),this.top=i,this.topRelative=a,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=c}return eMt(e,[{key:"getSourceType",value:function(t){var r="literal";return t instanceof Event&&(r="event"),r}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=r}},{key:"fitsOnRight",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=r}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}]),e}();const iMt=oMt;function $h(e){return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(e)}function f_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function h_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f_(Object(r),!0).forEach(function(n){aMt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aMt(e,t,r){return t=l2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l2(n.key),n)}}function lMt(e,t,r){return t&&d_(e.prototype,t),r&&d_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l2(e){var t=uMt(e,"string");return $h(t)==="symbol"?t:String(t)}function uMt(e,t){if($h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p_=215,u2="menu",cMt=u2,c2=function(){function e(t,r){sMt(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:p_,container:this.hot.rootDocument.documentElement},this.eventManager=new Re(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return lMt(e,[{key:"registerEvents",value:function(){for(var t=this,r=this.hot.rootWindow;r;)this.eventManager.addEventListener(r.document,"mousedown",function(n){return t.onDocumentMouseDown(n)}),this.eventManager.addEventListener(r.document,"contextmenu",function(n){return t.onDocumentContextMenu(n)}),r=xf(r)}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[t]=r}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var r=AR(function(h){return t.openSubMenu(h)},300),n=this.options.minWidth||p_,o=!1,i=Ln(this.menuItems,function(h){return h.key===Xh&&(o=!0),XTt(h,t.hot)});if(i.length<1&&!o)i.push(a2()[Xh]);else if(i.length===0)return;i=qTt(i,Jt);var a=!1,s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(h){return ht(h)&&h<n?n:h},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(h,p,y,m,v,w){return t.menuItemRenderer(h,p,y,m,v,w)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(h,p){t.isAllSubMenusClosed()?r(p.row):t.openSubMenu(p.row)},rowHeights:function(h){return i[h].name===Jt?1:23},afterOnCellContextMenu:function(h){h.preventDefault(),SS()&&a&&t.hasSelectedItem()&&t.close(!0)},beforeOnCellMouseUp:function(h){t.hasSelectedItem()&&(a=!t.isCommandPassive(t.getSelectedItem()),t.executeCommand(h))},afterOnCellMouseUp:function(h){(!SS()||!bi(h))&&a&&t.hasSelectedItem()&&(cr()||Kk()?setTimeout(function(){return t.close(!0)},325):t.close(!0))},afterUnlisten:function(){!t.hasSelectedItem()&&t.isOpened()&&t.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new nE(this.container,s),this.hotMenu.addHook("afterInit",function(){return t.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return t.onAfterSelection.apply(t,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var l=this.hotMenu.getShortcutManager(),u=l.addContext(cMt),c={group:u2},f=h_(h_({},c),{},{runOnlyIf:function(h){return _f(h.target)===!1||t.container.contains(h.target)===!1}});l.setActiveContextName("menu"),u.addShortcuts([{keys:[["Escape"]],callback:function(){t.keyEvent=!0,t.close(),t.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var h=t.hotMenu.getSelectedLast();t.keyEvent=!0,h?t.selectNextCell(h[0],h[1]):t.selectFirstCell(),t.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var h=t.hotMenu.getSelectedLast();t.keyEvent=!0,h?t.selectPrevCell(h[0],h[1]):t.selectLastCell(),t.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var h=t.hotMenu.getSelectedLast();if(t.keyEvent=!0,h){var p=t.openSubMenu(h[0]);p&&p.selectFirstCell()}t.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var h=t.hotMenu.getSelectedLast();t.keyEvent=!0,h&&t.isSubMenu()&&(t.close(),t.parentMenu&&t.parentMenu.hotMenu.listen()),t.keyEvent=!1}},{keys:[["Enter"]],callback:function(h){var p=t.hotMenu.getSelectedLast();t.keyEvent=!0,t.hotMenu.getSourceDataAtRow(p[0]).submenu||(t.executeCommand(h),t.close(!0)),t.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var h=t.hotMenu.getSelectedLast();t.keyEvent=!0,h?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.selectFirstCell(),t.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var h=t.hotMenu.getSelectedLast();t.keyEvent=!0,h?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.selectLastCell(),t.keyEvent=!1}}],f),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var r=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!r||!GTt(r))return!1;var n=this.hotMenu.getSourceDataAtRow(t),o=new e(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(n.submenu.items),o.open(),o.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=o,o}},{key:"closeSubMenu",value:function(t){var r=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[r.key];n&&(n.destroy(),delete this.hotSubMenus[r.key])}},{key:"closeAllSubMenus",value:function(){var t=this;T(this.hotMenu.getData(),function(r,n){return t.closeSubMenu(n)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(t){if(!(!this.isOpened()||!this.hasSelectedItem())){var r=this.getSelectedItem();if(this.runLocalHooks("select",r,t),!this.isCommandPassive(r)){var n=this.hot.getSelectedRange(),o=n?YTt(n):[];this.runLocalHooks("executeCommand",r.key,o,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,o,t)}}}},{key:"isCommandPassive",value:function(t){var r=t.isCommand,n=t.name,o=t.disabled,i=t.submenu,a=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return r===!1||n===Jt||a===!0||i}},{key:"setPosition",value:function(t){var r=new iMt(t,this.container.ownerDocument.defaultView);this.options.keepInViewport?(r.fitsBelow(this.container)?this.setPositionBelowCursor(r):r.fitsAbove(this.container)?this.setPositionAboveCursor(r):this.setPositionBelowCursor(r),this.hot.isLtr()?this.setHorizontalPositionForLtr(r):this.setHorizontalPositionForRtl(r)):(this.setPositionBelowCursor(r),this.setPositionOnRightOfCursor(r))}},{key:"setHorizontalPositionForRtl",value:function(t){t.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(t):this.setPositionOnRightOfCursor(t)}},{key:"setHorizontalPositionForLtr",value:function(t){t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)}},{key:"setPositionAboveCursor",value:function(t){var r=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(r=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(r,"px")}},{key:"setPositionBelowCursor",value:function(t){var r=this.offset.below+t.top+1;this.isSubMenu()&&(r=t.top-1),this.container.style.top="".concat(r,"px")}},{key:"setPositionOnRightOfCursor",value:function(t){var r=t.left;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),o=n.right;r+=t.cellWidth+o-(t.left+t.cellWidth)}else r+=this.offset.right;this.container.style.left="".concat(r,"px")}},{key:"setPositionOnLeftOfCursor",value:function(t){var r=this.offset.left+t.left-this.container.offsetWidth;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),o=n.left;r-=t.left-o}this.container.style.left="".concat(r,"px")}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);sy(t)||ly(t)||uy(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,r=this.hotMenu.getCell(t,0);sy(r)||ly(r)||uy(r)?this.selectPrevCell(t,0):(this.hotMenu.selectCell(t,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(t,0,!0,!1))}},{key:"selectNextCell",value:function(t,r){var n=t+1,o=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,r):null;o&&(sy(o)||ly(o)||uy(o)?this.selectNextCell(n,r):this.hotMenu.selectCell(n,r))}},{key:"selectPrevCell",value:function(t,r){var n=t-1,o=n>=0?this.hotMenu.getCell(n,r):null;o&&(sy(o)||ly(o)||uy(o)?this.selectPrevCell(n,r):this.hotMenu.selectCell(n,r))}},{key:"menuItemRenderer",value:function(t,r,n,o,i,a){var s=this,l=t.getSourceDataAtRow(n),u=this.hot.rootDocument.createElement("div"),c=function(m){return Te(m,"submenu")},f=function(m){return new RegExp(Jt,"i").test(m.name)},h=function(m){return m.disabled===!0||typeof m.disabled=="function"&&m.disabled.call(s.hot)===!0},p=function(m){return m.disableSelection},y=a;typeof y=="function"&&(y=y.call(this.hot)),yr(r),q(u,"htItemWrapper"),r.appendChild(u),f(l)?q(r,"htSeparator"):typeof l.renderer=="function"?(q(r,"htCustomMenuRenderer"),r.appendChild(l.renderer(t,u,n,o,i,y))):Ya(u,y),h(l)?(q(r,"htDisabled"),this.eventManager.addEventListener(r,"mouseenter",function(){return t.deselectCell()})):p(l)?(q(r,"htSelectionDisabled"),this.eventManager.addEventListener(r,"mouseenter",function(){return t.deselectCell()})):c(l)?(q(r,"htSubmenu"),p(l)?this.eventManager.addEventListener(r,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(r,"mouseenter",function(){return t.selectCell(n,o,void 0,void 0,!1,!1)})):(Bt(r,["htSubmenu","htDisabled"]),p(l)?this.eventManager.addEventListener(r,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(r,"mouseenter",function(){return t.selectCell(n,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=this.options.container.ownerDocument,n=t,o;return n&&(ge(n)&&(n=n.call(this.hot),n===null||he(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n="".concat(this.options.className,"Sub_").concat(n),o=r.querySelector(".".concat(this.options.className,".").concat(n))),o||(o=r.createElement("div"),q(o,"htMenu ".concat(this.options.className)),n&&q(o,n),this.options.container.appendChild(o)),o}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var t=this.hotMenu.view._wt.wtTable,r=this.hotMenu.getSettings().data,n=t.hider.style,o=t.holder.style,i=parseInt(n.width,10),a=_e(r,function(s,l){return s+(l.name===Jt?1:26)},0);o.width="".concat(i+3,"px"),o.height="".concat(a+3,"px"),n.height=o.height}},{key:"onAfterSelection",value:function(t,r,n,o,i){this.keyEvent===!1&&(i.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!oi(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!oi(t.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(t){this.isOpened()&&Dt(t.target,"htCore")&&oi(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}]),e}();pe(c2,Tn);const bE=c2;function su(e){return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function fMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dMt(n.key),n)}}function hMt(e,t,r){return t&&y_(e.prototype,t),r&&y_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dMt(e){var t=pMt(e,"string");return su(t)==="symbol"?t:String(t)}function pMt(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ta(){return typeof Reflect<"u"&&Reflect.get?ta=Reflect.get.bind():ta=function(e,t,r){var n=yMt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ta.apply(this,arguments)}function yMt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uo(e),e!==null););return e}function gMt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TO(e,t)}function TO(e,t){return TO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},TO(e,t)}function mMt(e){var t=bMt();return function(){var r=uo(e),n;if(t){var o=uo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vMt(this,n)}}function vMt(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f2(e)}function f2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bMt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uo(e){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uo(e)}var hy="contextMenu",wMt=70;gt.getSingleton().register("afterContextMenuDefaultOptions");gt.getSingleton().register("beforeContextMenuShow");gt.getSingleton().register("afterContextMenuShow");gt.getSingleton().register("afterContextMenuHide");gt.getSingleton().register("afterContextMenuExecute");var h2=function(e){gMt(r,e);var t=mMt(r);function r(n){var o;return fMt(this,r),o=t.call(this,n),o.eventManager=new Re(f2(o)),o.commandExecutor=new i2(o.hot),o.itemsFactory=null,o.menu=null,o}return hMt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hy]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[hy];typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),this.menu=new bE(this.hot,{className:"htContextMenu",keepInViewport:!0,container:o.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return n.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=n.executeCommand).call.apply(i,[n].concat(s))}),this.addHook("afterOnCellContextMenu",function(i){return n.onAfterOnCellContextMenu(i)}),ta(uo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ta(uo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),ta(uo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(n){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var o=0,i=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var a=this.hot.rootWindow.frameElement,s=a.getBoundingClientRect(),l=s.top,u=s.left;o=l-tl(n.view),i=u-Oa(n.view)}else o=-1*tl(this.menu.hotMenu.rootWindow),i=-1*Oa(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(n.pageY,10)+o,left:parseInt(n.pageX,10)+i})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(n){var o;this.itemsFactory===null&&this.prepareMenuItems();for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(o=this.commandExecutor).execute.apply(o,[n].concat(a))}},{key:"prepareMenuItems",value:function(){var n=this;this.itemsFactory=new s2(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[hy],i={items:this.itemsFactory.getItems(o)};this.hot.runHooks("afterContextMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);var a=this.itemsFactory.getItems(o);this.hot.runHooks("beforeContextMenuSetItems",a),this.menu.setMenuItems(a),T(a,function(s){return n.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(n){var o=this.hot.getSettings(),i=o.rowHeaders,a=o.colHeaders;function s(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}var l=n.target;this.close(),!Dt(l,"handsontableInput")&&(n.preventDefault(),n.stopPropagation(),!(!(i||a)&&!s(l)&&!(Dt(l,"current")&&Dt(l,"wtBorder")))&&this.open(n))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ta(uo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hy}},{key:"PLUGIN_PRIORITY",get:function(){return wMt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[aw,sw,Jt,bp,wp,Jt,iw,Sp,Jt,lw,ow,Jt,Ap,Jt,zn]}}]),r}(re);h2.SEPARATOR={name:Jt};function AMt(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(Fv)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function SMt(e){return{key:"copy_column_headers_only",name:function(){var t=this.getSelectedRangeLast(),r=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Yv,r)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function CMt(e){return{key:"copy_with_column_group_headers",name:function(){var t=this.getSelectedRangeLast(),r=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Uv,r)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function OMt(e){return{key:"copy_with_column_headers",name:function(){var t=this.getSelectedRangeLast(),r=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Wv,r)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function kMt(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(Gv)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function td(e){return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function RMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TMt(n.key),n)}}function EMt(e,t,r){return t&&g_(e.prototype,t),r&&g_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TMt(e){var t=PMt(e,"string");return td(t)==="symbol"?t:String(t)}function PMt(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MMt=function(){function e(){RMt(this,e),this.data={}}return EMt(e,[{key:"setData",value:function(t,r){this.data[t]=r}},{key:"getData",value:function(t){return this.data[t]||void 0}}]),e}();function ed(e){return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}function m_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xMt(n.key),n)}}function IMt(e,t,r){return t&&m_(e.prototype,t),r&&m_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xMt(e){var t=jMt(e,"string");return ed(t)==="symbol"?t:String(t)}function jMt(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _Mt=IMt(function e(){DMt(this,e),this.clipboardData=new MMt});function nd(e){return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function HMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BMt(n.key),n)}}function NMt(e,t,r){return t&&v_(e.prototype,t),r&&v_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BMt(e){var t=LMt(e,"string");return nd(t)==="symbol"?t:String(t)}function LMt(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wE=function(){function e(t){HMt(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Re(this),this.listenersCount=new WeakSet,this.container=t}return NMt(e,[{key:"useSecondaryElement",value:function(){var t=WMt(this.container);this.listenersCount.has(t)||(this.listenersCount.add(t),b_(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(t){this.listenersCount.has(t)||(this.listenersCount.add(t),b_(this.eventManager,t,this)),this.mainElement=t}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",cr()||uW(this.mainElement)}}]),e}();pe(wE,Tn);var km=new WeakMap;function VMt(e){var t=new wE(e),r=km.get(e);return r=isNaN(r)?0:r,km.set(e,r+1),t}function FMt(e){e.eventManager.clear()}var n0=function(e,t){return function(r){return t.runLocalHooks(e,r)}};function b_(e,t,r){e.addEventListener(t,"copy",n0("copy",r)),e.addEventListener(t,"cut",n0("cut",r)),e.addEventListener(t,"paste",n0("paste",r))}var Rm=new WeakMap;function WMt(e){var t=Rm.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Rm.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function w_(e){if(e instanceof wE){var t=km.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),FMt(e),t<=0){t=0;var r=Rm.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Rm.delete(e.container)),e.mainElement=null}km.set(e.container,t)}}function rd(e){return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}function UMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GMt(n.key),n)}}function YMt(e,t,r){return t&&A_(e.prototype,t),r&&A_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GMt(e){var t=zMt(e,"string");return rd(t)==="symbol"?t:String(t)}function zMt(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S_(e,t){d2(e,t),t.add(e)}function fs(e,t,r){d2(e,t),t.set(e,r)}function d2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dy(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function hn(e,t){var r=p2(e,t,"get");return QMt(e,r)}function QMt(e,t){return t.get?t.get.call(e):t.value}function hs(e,t,r){var n=p2(e,t,"set");return KMt(e,n,r),r}function p2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function KMt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Uo=new WeakMap,r0=new WeakMap,Vc=new WeakMap,PO=new WeakMap,MO=new WeakMap,Fc=new WeakMap,py=new WeakSet,C_=new WeakSet,XMt=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;UMt(this,e),S_(this,C_),S_(this,py),fs(this,Uo,{writable:!0,value:void 0}),fs(this,r0,{writable:!0,value:void 0}),fs(this,Vc,{writable:!0,value:void 0}),fs(this,PO,{writable:!0,value:void 0}),fs(this,MO,{writable:!0,value:void 0}),fs(this,Fc,{writable:!0,value:void 0}),hs(this,r0,r),hs(this,Vc,n),hs(this,PO,o),hs(this,MO,i),hs(this,Fc,a)}return YMt(e,[{key:"setSelectedRange",value:function(t){hs(this,Uo,t)}},{key:"getCellsRange",value:function(){if(hn(this,r0).call(this)===0||hn(this,Vc).call(this)===0)return null;var t=hn(this,Uo).getTopStartCorner(),r=t.row,n=t.col,o=hn(this,Uo).getBottomEndCorner(),i=o.row,a=o.col,s=dy(this,C_,JMt).call(this,r,i),l=dy(this,py,o0).call(this,n,a),u=i!==s||a!==l;return{isRangeTrimmed:u,startRow:r,startCol:n,endRow:s,endCol:l}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(hn(this,Vc).call(this)===0||hn(this,Fc).call(this)===0)return null;var t=hn(this,Uo).getTopStartCorner(),r=t.col,n=hn(this,Uo).getBottomEndCorner(),o=n.col,i=dy(this,py,o0).call(this,r,o),a=o!==i;return{isRangeTrimmed:a,startRow:-1,startCol:r,endRow:-1,endCol:i}}},{key:"getAllColumnHeadersRange",value:function(){if(hn(this,Vc).call(this)===0||hn(this,Fc).call(this)===0)return null;var t=hn(this,Uo).getTopStartCorner(),r=t.col,n=hn(this,Uo).getBottomEndCorner(),o=n.col,i=dy(this,py,o0).call(this,r,o),a=o!==i;return{isRangeTrimmed:a,startRow:-hn(this,Fc).call(this),startCol:r,endRow:-1,endCol:i}}}]),e}();function o0(e,t){return Math.min(t,Math.max(e+hn(this,MO).call(this)-1,e))}function JMt(e,t){return Math.min(t,Math.max(e+hn(this,PO).call(this)-1,e))}function y2(e){var t=[],r=[];return T(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Ct(o,i,function(l){t.indexOf(l)===-1&&t.push(l)});var a=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);Ct(a,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:t,columns:r}}function ZMt(e,t){return eIt(e)||tIt(e,t)||$Mt(e,t)||qMt()}function qMt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Mt(e,t){if(e){if(typeof e=="string")return O_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O_(e,t)}}function O_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tIt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function eIt(e){if(Array.isArray(e))return e}function Da(e){return Da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(e)}function nIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m2(n.key),n)}}function rIt(e,t,r){return t&&k_(e.prototype,t),r&&k_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ea(){return typeof Reflect<"u"&&Reflect.get?ea=Reflect.get.bind():ea=function(e,t,r){var n=oIt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ea.apply(this,arguments)}function oIt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=co(e),e!==null););return e}function iIt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IO(e,t)}function IO(e,t){return IO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},IO(e,t)}function aIt(e){var t=lIt();return function(){var r=co(e),n;if(t){var o=co(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sIt(this,n)}}function sIt(e,t){if(t&&(Da(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fn(e)}function fn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lIt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function co(e){return co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},co(e)}function uIt(e,t){g2(e,t),t.add(e)}function Hi(e,t,r){g2(e,t),t.set(e,r)}function g2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(e,t,r){return t=m2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m2(e){var t=cIt(e,"string");return Da(t)==="symbol"?t:String(t)}function cIt(e,t){if(Da(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Da(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fIt(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function In(e,t){var r=v2(e,t,"get");return hIt(e,r)}function hIt(e,t){return t.get?t.get.call(e):t.value}function Gr(e,t,r){var n=v2(e,t,"set");return dIt(e,n,r),r}function v2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function dIt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}gt.getSingleton().register("afterCopyLimit");gt.getSingleton().register("modifyCopyableRange");gt.getSingleton().register("beforeCut");gt.getSingleton().register("afterCut");gt.getSingleton().register("beforePaste");gt.getSingleton().register("afterPaste");gt.getSingleton().register("beforeCopy");gt.getSingleton().register("afterCopy");var yy="copyPaste",pIt=80,yIt=["fragmentSelection"],R_=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),i0=new WeakMap,a0=new WeakMap,s0=new WeakMap,ps=new WeakMap,gy=new WeakMap,my=new WeakMap,ys=new WeakMap,E_=new WeakSet,gIt=function(e){iIt(r,e);var t=aIt(r);function r(){var n;nIt(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),uIt(fn(n),E_),ds(fn(n),"columnsLimit",1/0),ds(fn(n),"rowsLimit",1/0),ds(fn(n),"pasteMode","overwrite"),ds(fn(n),"uiContainer",n.hot.rootDocument.body),Hi(fn(n),i0,{writable:!0,value:!1}),Hi(fn(n),a0,{writable:!0,value:!1}),Hi(fn(n),s0,{writable:!0,value:!1}),Hi(fn(n),ps,{writable:!0,value:"cells-only"}),Hi(fn(n),gy,{writable:!0,value:!1}),Hi(fn(n),my,{writable:!0,value:!1}),Hi(fn(n),ys,{writable:!0,value:new XMt({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),ds(fn(n),"copyableRanges",[]),ds(fn(n),"focusableElement",void 0),n}return rIt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[yy]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings(),i=o[yy];if(Da(i)==="object"){var a,s;this.pasteMode=(a=i.pasteMode)!==null&&a!==void 0?a:this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,Gr(this,i0,!!i.copyColumnHeaders),Gr(this,a0,!!i.copyColumnGroupHeaders),Gr(this,s0,!!i.copyColumnHeadersOnly),this.uiContainer=(s=i.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(l){return n.onAfterContextMenuDefaultOptions(l)}),this.addHook("afterOnCellMouseUp",function(){return n.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return n.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return n.onBeforeKeyDown()}),this.focusableElement=VMt(this.uiContainer),this.focusableElement.addLocalHook("copy",function(l){return n.onCopy(l)}).addLocalHook("cut",function(l){return n.onCut(l)}).addLocalHook("paste",function(l){return n.onPaste(l)}),ea(co(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ea(co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&w_(this.focusableElement),ea(co(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Gr(this,ps,n),Gr(this,gy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Gr(this,my,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(n){return mf(this.getRangedData(n))}},{key:"getRangedData",value:function(n){var o=this,i=[],a=y2(n),s=a.rows,l=a.columns;return T(s,function(u){var c=[];T(l,function(f){u<0?c.push(o.hot.getColHeader(f,u)):c.push(o.hot.getCopyableData(u,f))}),i.push(c)}),i}},{key:"paste",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;if(!(!n&&!o)){var i=new _Mt;n&&i.clipboardData.setData("text/plain",n),o&&i.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(i)}}},{key:"setCopyableText",value:function(){var n=this.hot.getSelectedRangeLast();if(n){In(this,ys).setSelectedRange(n);var o=new Map([["headers",null],["cells",null]]);In(this,ps)==="column-headers-only"?o.set("headers",In(this,ys).getMostBottomColumnHeadersRange()):(In(this,ps)==="with-column-headers"?o.set("headers",In(this,ys).getMostBottomColumnHeadersRange()):In(this,ps)==="with-column-group-headers"&&o.set("headers",In(this,ys).getAllColumnHeadersRange()),o.set("cells",In(this,ys).getCellsRange())),this.copyableRanges=Array.from(o.values()).filter(function(c){return c!==null}).map(function(c){var f=c.startRow,h=c.startCol,p=c.endRow,y=c.endCol;return{startRow:f,startCol:h,endRow:p,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var i=o.get("cells");if(i!==null&&i.isRangeTrimmed){var a=i.startRow,s=i.startCol,l=i.endRow,u=i.endCol;this.hot.runHooks("afterCopyLimit",l-a+1,u-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var n,o=(n=this.hot.getActiveEditor())===null||n===void 0?void 0:n.TEXTAREA;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var n;return(n=this.hot.getActiveEditor())===null||n===void 0?void 0:n.isOpened()}},{key:"populateValues",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(n.length){for(var i=n.length,a=n[0].length,s=[],l=o.getTopStartCorner(),u=l.row,c=l.col,f=o.getBottomEndCorner(),h=f.row,p=f.col,y=u,m=c,v=u,w=c;s.length<i||y<=h;){var C=this.hot.getCellMeta(y,c),A=C.skipRowOnPaste,D=C.visualRow;if(y=D+1,A!==!0){v=D,m=c;for(var E=[],G=s.length%i;E.length<a||m<=p;){var K=this.hot.getCellMeta(u,m),nt=K.skipColumnOnPaste,z=K.visualCol;if(m=z+1,nt!==!0){w=z;var X=E.length%a;E.push(n[G][X])}}s.push(E)}}return this.hot.populateFromArray(u,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[u,c,v,w]}}},{key:"onCopy",value:function(n){if(!(!this.hot.isListening()&&!In(this,gy)||this.isEditorOpened())){this.setCopyableText(),Gr(this,gy,!1);var o=this.getRangedData(this.copyableRanges),i=fIt(this,E_,mIt).call(this,this.copyableRanges),a=!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,i);if(a){var s=mf(o);if(n&&n.clipboardData){var l=KS(o,this.hot.rootDocument);n.clipboardData.setData("text/plain",s),n.clipboardData.setData("text/html",[R_,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",o,this.copyableRanges,i)}Gr(this,ps,"cells-only"),n.preventDefault()}}},{key:"onCut",value:function(n){if(!(!this.hot.isListening()&&!In(this,my)||this.isEditorOpened())){this.setCopyableText(),Gr(this,my,!1);var o=this.getRangedData(this.copyableRanges),i=!!this.hot.runHooks("beforeCut",o,this.copyableRanges);if(i){var a=mf(o);if(n&&n.clipboardData){var s=KS(o,this.hot.rootDocument);n.clipboardData.setData("text/plain",a),n.clipboardData.setData("text/html",[R_,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}n.preventDefault()}}},{key:"onPaste",value:function(n){if(!(!this.hot.isListening()||this.isEditorOpened())){n&&n.preventDefault&&n.preventDefault();var o;if(n&&typeof n.clipboardData<"u"){var i=Sv(n.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(i&&/(<table)|(<TABLE)/g.test(i)){var a=xW(i,this.hot.rootDocument);o=a.data}else o=n.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=iAt(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var s=this.populateValues(o),l=ZMt(s,4),u=l[0],c=l[1],f=l[2],h=l[3];this.hot.selectCell(u,c,Math.min(this.hot.countRows()-1,f),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:"---------"},AMt(this)),In(this,i0)&&n.items.push(OMt(this)),In(this,a0)&&n.items.push(CMt(this)),In(this,s0)&&n.items.push(SMt(this)),n.items.push(kMt(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&aW())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var n=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||n!==this.focusableElement.getFocusableElement()&&n!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(w_(this.focusableElement),this.focusableElement=null),ea(co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yy}},{key:"SETTING_KEYS",get:function(){return[yy].concat(yIt)}},{key:"PLUGIN_PRIORITY",get:function(){return pIt}}]),r}(re);function mIt(e){for(var t=y2(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function b2(e,t){return"border_row".concat(e,"col").concat(t)}function rf(){return{width:1,color:"#000"}}function fo(){return{hide:!0}}function vIt(){return{width:1,color:"#000",cornerVisible:!1}}function l0(e){if(ht(e.start)||ht(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ht(e.end)||ht(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function Wc(e){return ht(e.start)&&(e.left=e.start),ht(e.end)&&(e.right=e.end),e}function u0(e,t){return{id:b2(e,t),border:vIt(),row:e,col:t,top:fo(),bottom:fo(),start:fo(),end:fo()}}function bIt(e,t){return Te(t,"border")&&t.border&&(e.border=t.border),Te(t,"top")&&ht(t.top)&&(t.top?(zt(t.top)||(t.top=rf()),e.top=t.top):(t.top=fo(),e.top=t.top)),Te(t,"bottom")&&ht(t.bottom)&&(t.bottom?(zt(t.bottom)||(t.bottom=rf()),e.bottom=t.bottom):(t.bottom=fo(),e.bottom=t.bottom)),Te(t,"start")&&ht(t.start)&&(t.start?(zt(t.start)||(t.start=rf()),e.start=t.start):(t.start=fo(),e.start=t.start)),Te(t,"end")&&ht(t.end)&&(t.end?(zt(t.end)||(t.end=rf()),e.end=t.end):(t.end=fo(),e.end=t.end)),e}function jo(e,t){var r=!1;return T(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!Te(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function uw(e){return'<span class="selected">'.concat("","</span>").concat(e)}function wIt(e){return e.some(function(t){return ht(t.left)||ht(t.right)})}function AIt(e){return e.some(function(t){return ht(t.start)||ht(t.end)})}var SIt=new Map([["left","start"],["right","end"]]);function CIt(e){var t;return(t=SIt.get(e))!==null&&t!==void 0?t:e}function OIt(e){return{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(fb),r=jo(this,"bottom");return r&&(t=uw(t)),t},callback:function(t,r){var n=jo(this,"bottom");e.prepareBorder(r,"bottom",n)}}}function kIt(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var r=this.getTranslatedPhrase(hb),n=jo(this,t);return n&&(r=uw(r)),r},callback:function(r,n){var o=jo(this,t);e.prepareBorder(n,t,o)}}}function RIt(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(db)},callback:function(t,r){e.prepareBorder(r,"noBorders")},disabled:function(){return!jo(this)}}}function EIt(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var r=this.getTranslatedPhrase(cb),n=jo(this,t);return n&&(r=uw(r)),r},callback:function(r,n){var o=jo(this,t);e.prepareBorder(n,t,o)}}}function TIt(e){return{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(ub),r=jo(this,"top");return r&&(t=uw(t)),t},callback:function(t,r){var n=jo(this,"top");e.prepareBorder(r,"top",n)}}}function lu(e){return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function T_(e,t){return xIt(e)||IIt(e,t)||MIt(e,t)||PIt()}function PIt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MIt(e,t){if(e){if(typeof e=="string")return P_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P_(e,t)}}function P_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IIt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function xIt(e){if(Array.isArray(e))return e}function jIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A2(n.key),n)}}function DIt(e,t,r){return t&&M_(e.prototype,t),r&&M_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function na(){return typeof Reflect<"u"&&Reflect.get?na=Reflect.get.bind():na=function(e,t,r){var n=_It(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},na.apply(this,arguments)}function _It(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function HIt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xO(e,t)}function xO(e,t){return xO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},xO(e,t)}function NIt(e){var t=LIt();return function(){var r=ho(e),n;if(t){var o=ho(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return BIt(this,n)}}function BIt(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w2(e)}function w2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LIt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ho(e)}function VIt(e,t,r){return t=A2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A2(e){var t=FIt(e,"string");return lu(t)==="symbol"?t:String(t)}function FIt(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vy="customBorders",WIt=90,UIt=function(e){HIt(r,e);var t=NIt(r);function r(){var n;jIt(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),VIt(w2(n),"savedBorders",[]),n}return DIt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vy]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return n.onAfterContextMenuDefaultOptions(o)}),this.addHook("init",function(){return n.onAfterInit()}),na(ho(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),na(ho(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),na(ho(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(n,o){var i=this,a=["top","bottom","start","end"],s=null;o&&(this.checkSettingsCohesion([o]),a=Object.keys(o),s=l0(o));var l=xl(n),u=Ih(l);T(n,function(c){for(var f=u(c),h=T_(f,4),p=h[0],y=h[1],m=h[2],v=h[3],w=function(A){for(var D=function(G){T(a,function(K){i.prepareBorderFromCustomAdded(A,G,s,CIt(K))})},E=y;E<=v;E+=1)D(E)},C=p;C<=m;C+=1)w(C)}),this.hot.view.render()}},{key:"getBorders",value:function(n){var o=this;if(!Array.isArray(n))return this.savedBorders;var i=xl(n),a=Ih(i),s=[];return T(n,function(l){for(var u=a(l),c=T_(u,4),f=c[0],h=c[1],p=c[2],y=c[3],m=function(w){for(var C=function(D){T(o.savedBorders,function(E){E.row===w&&E.col===D&&s.push(Wc(E))})},A=h;A<=y;A+=1)C(A)},v=f;v<=p;v+=1)m(v)}),s}},{key:"clearBorders",value:function(n){var o=this;n?this.setBorders(n):(T(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange(),o.hot.removeCellMeta(i.row,i.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(n,o){var i=this.checkSavedBorders(n);i||this.savedBorders.push(n);var a=this.hot._createCellRange(this.hot._createCellCoords(n.row,n.col)),s=this.checkCustomSelections(n,a,o);s||this.hot.selection.highlight.addCustomSelection({border:n,visualCellRange:a})}},{key:"prepareBorderFromCustomAdded",value:function(n,o,i,a){var s=this.hot.countRows(),l=this.hot.countCols();if(!(n>=s||o>=l)){var u=u0(n,o);i&&(u=bIt(u,i),T(this.hot.selection.highlight.customSelections,function(c){if(u.id===c.settings.id)return Object.assign(c.settings,i),u.id=c.settings.id,u.top=c.settings.top,u.bottom=c.settings.bottom,u.start=c.settings.start,u.end=c.settings.end,!1})),this.hot.setCellMeta(n,o,"borders",Wc(u)),this.insertBorderIntoSettings(u,a)}}},{key:"prepareBorderFromCustomAddedRange",value:function(n,o){var i=this,a=Math.min(n.to.row,this.hot.countRows()-1),s=Math.min(n.to.col,this.hot.countCols()-1);Ct(n.from.row,a,function(l){Ct(n.from.col,s,function(u){var c=u0(l,u),f=0;l===n.from.row&&Te(o,"top")&&(f+=1,c.top=o.top),l===n.to.row&&Te(o,"bottom")&&(f+=1,c.bottom=o.bottom),u===n.from.col&&Te(o,"start")&&(f+=1,c.start=o.start),u===n.to.col&&Te(o,"end")&&(f+=1,c.end=o.end),f>0&&(i.hot.setCellMeta(l,u,"borders",Wc(c)),i.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(n,o){var i=b2(n,o);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(n,o,"borders")}},{key:"setBorder",value:function(n,o,i,a){var s=this.hot.getCellMeta(n,o).borders;if(!s||s.border===void 0?s=u0(n,o):s=l0(s),a){s[i]=fo();var l=this.countHide(s);if(l===4)this.removeAllBorders(n,o);else{var u=this.checkCustomSelectionsFromContextMenu(s,i,a);u||this.insertBorderIntoSettings(s),this.hot.setCellMeta(n,o,"borders",Wc(s))}}else{s[i]=rf();var c=this.checkCustomSelectionsFromContextMenu(s,i,a);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(n,o,"borders",Wc(s))}}},{key:"prepareBorder",value:function(n,o,i){var a=this;T(n,function(s){var l=s.start,u=s.end;if(l.row===u.row&&l.col===u.col)o==="noBorders"?a.removeAllBorders(l.row,l.col):a.setBorder(l.row,l.col,o,i);else switch(o){case"noBorders":Ct(l.col,u.col,function(c){Ct(l.row,u.row,function(f){a.removeAllBorders(f,c)})});break;case"top":Ct(l.col,u.col,function(c){a.setBorder(l.row,c,o,i)});break;case"bottom":Ct(l.col,u.col,function(c){a.setBorder(u.row,c,o,i)});break;case"start":Ct(l.row,u.row,function(c){a.setBorder(c,l.col,o,i)});break;case"end":Ct(l.row,u.row,function(c){a.setBorder(c,u.col,o,i)});break}})}},{key:"createCustomBorders",value:function(n){var o=this;T(n,function(i){var a=l0(i);i.range?o.prepareBorderFromCustomAddedRange(i.range,a):o.prepareBorderFromCustomAdded(i.row,i.col,a)})}},{key:"countHide",value:function(n){var o=n.top,i=n.bottom,a=n.start,s=n.end,l=[o,i,a,s];return _e(l,function(u,c){var f=u;return c&&c.hide&&(f+=1),f},0)}},{key:"clearBordersFromSelectionSettings",value:function(n){var o=Gt(this.hot.selection.highlight.customSelections,function(i){return i.settings.id}).indexOf(n);o>-1&&this.hot.selection.highlight.customSelections[o].clear()}},{key:"clearNullCellRange",value:function(){var n=this;T(this.hot.selection.highlight.customSelections,function(o,i){if(o.cellRange===null)return n.hot.selection.highlight.customSelections[i].destroy(),n.hot.selection.highlight.customSelections.splice(i,1),!1})}},{key:"hideBorders",value:function(){var n=this;T(this.savedBorders,function(o){n.clearBordersFromSelectionSettings(o.id),n.clearNullCellRange()})}},{key:"spliceBorder",value:function(n){var o=Gt(this.savedBorders,function(i){return i.id}).indexOf(n);o>-1&&this.savedBorders.splice(o,1)}},{key:"checkSavedBorders",value:function(n){var o=this,i=!1,a=this.countHide(n);return a===4?(this.spliceBorder(n.id),i=!0):T(this.savedBorders,function(s,l){if(n.id===s.id)return o.savedBorders[l]=n,i=!0,!1}),i}},{key:"checkCustomSelectionsFromContextMenu",value:function(n,o,i){var a=!1;return T(this.hot.selection.highlight.customSelections,function(s){if(n.id===s.settings.id)return Qt(s.instanceBorders,function(l){l.toggleHiddenClass(o,i)}),a=!0,!1}),a}},{key:"checkCustomSelections",value:function(n,o,i){var a=this.countHide(n),s=!1;return a===4?(this.removeAllBorders(n.row,n.col),s=!0):T(this.hot.selection.highlight.customSelections,function(l){if(n.id===l.settings.id)return l.visualCellRange=o,l.commit(),i&&Qt(l.instanceBorders,function(u){u.changeBorderStyle(i,n)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var n=this.hot.getSettings()[vy];if(Array.isArray(n)){var o=on(n);this.checkSettingsCohesion(o),o.length||(this.savedBorders=o),this.createCustomBorders(o)}else n!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(n){var o=wIt(n),i=AIt(n);if(o&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&o)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(n){this.hot.getSettings()[vy]&&n.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(lb)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[TIt(this),EIt(this),OIt(this),kIt(this),RIt(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){na(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return vy}},{key:"PLUGIN_PRIORITY",get:function(){return WIt}}]),r}(re);function uu(e){return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function YIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zIt(n.key),n)}}function GIt(e,t,r){return t&&I_(e.prototype,t),r&&I_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zIt(e){var t=QIt(e,"string");return uu(t)==="symbol"?t:String(t)}function QIt(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ra(){return typeof Reflect<"u"&&Reflect.get?ra=Reflect.get.bind():ra=function(e,t,r){var n=KIt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ra.apply(this,arguments)}function KIt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function XIt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jO(e,t)}function jO(e,t){return jO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},jO(e,t)}function JIt(e){var t=qIt();return function(){var r=po(e),n;if(t){var o=po(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZIt(this,n)}}function ZIt(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S2(e)}function S2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qIt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},po(e)}var x_="dragToScroll",$It=100,txt=function(e){XIt(r,e);var t=JIt(r);function r(n){var o;return YIt(this,r),o=t.call(this,n),o.eventManager=new Re(S2(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return GIt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[x_]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return n.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return n.setupListening(o)}),this.registerEvents(),ra(po(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ra(po(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),ra(po(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(n){this.boundaries=n}},{key:"setCallback",value:function(n){this.callback=n}},{key:"check",value:function(n,o){var i=0,a=0;o<this.boundaries.top?a=o-this.boundaries.top:o>this.boundaries.bottom&&(a=o-this.boundaries.bottom),n<this.boundaries.left?i=n-this.boundaries.left:n>this.boundaries.right&&(i=n-this.boundaries.right),this.callback(i,a)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var n=this,o=this.hot.rootWindow,i=o;i;)this.eventManager.addEventListener(i.document,"contextmenu",function(){return n.unlisten()}),this.eventManager.addEventListener(i.document,"mouseup",function(){return n.unlisten()}),this.eventManager.addEventListener(i.document,"mousemove",function(a){return n.onMouseMove(a)}),i=xf(i)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(n){if(!bi(n)){var o=this.hot.view._wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(i,a){i<0?o.scrollLeft-=50:i>0&&(o.scrollLeft+=50),a<0?o.scrollTop-=20:a>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(n){this.isListening()&&this.check(n.clientX,n.clientY)}},{key:"destroy",value:function(){ra(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return x_}},{key:"PLUGIN_PRIORITY",get:function(){return $It}}]),r}(re);function cu(e){return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function ext(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rxt(n.key),n)}}function nxt(e,t,r){return t&&j_(e.prototype,t),r&&j_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rxt(e){var t=oxt(e,"string");return cu(t)==="symbol"?t:String(t)}function oxt(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oa(){return typeof Reflect<"u"&&Reflect.get?oa=Reflect.get.bind():oa=function(e,t,r){var n=ixt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},oa.apply(this,arguments)}function ixt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function axt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DO(e,t)}function DO(e,t){return DO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},DO(e,t)}function sxt(e){var t=uxt();return function(){var r=yo(e),n;if(t){var o=yo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lxt(this,n)}}function lxt(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C2(e)}function C2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uxt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yo(e)}gt.getSingleton().register("afterDropdownMenuDefaultOptions");gt.getSingleton().register("beforeDropdownMenuShow");gt.getSingleton().register("afterDropdownMenuShow");gt.getSingleton().register("afterDropdownMenuHide");gt.getSingleton().register("afterDropdownMenuExecute");var c0="dropdownMenu",cxt=230,f0="changeType",O2=function(e){axt(r,e);var t=sxt(r);function r(n){var o;return ext(this,r),o=t.call(this,n),o.eventManager=new Re(C2(o)),o.commandExecutor=new i2(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return nxt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[c0]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.itemsFactory=new s2(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[c0],i={items:this.itemsFactory.getItems(o)};this.registerEvents(),typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),oa(yo(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){n.hot.runHooks("afterDropdownMenuDefaultOptions",i),n.itemsFactory.setPredefinedItems(i.items);var a=n.itemsFactory.getItems(o);n.menu&&n.menu.destroy(),n.menu=new bE(n.hot,{className:"htDropdownMenu",keepInViewport:!0,container:o.uiContainer||n.hot.rootDocument.body}),n.hot.runHooks("beforeDropdownMenuSetItems",a),n.menu.setMenuItems(a),n.menu.addLocalHook("beforeOpen",function(){return n.onMenuBeforeOpen()}),n.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()}),n.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()}),n.menu.addLocalHook("executeCommand",function(){for(var s,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return(s=n.executeCommand).call.apply(s,[n].concat(u))}),T(a,function(s){return n.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),oa(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),oa(yo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return n.onTableClick(o)})}},{key:"open",value:function(n){this.menu&&(this.menu.open(),n.width&&this.menu.setOffset("left",n.width),this.menu.setPosition(n))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(n){for(var o,i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(o=this.commandExecutor).execute.apply(o,[n].concat(a))}},{key:"setListening",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(n?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(n){if(n.stopPropagation(),Dt(n.target,f0)&&!this.menu.isOpened()){var o=0,i=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var a=this.hot.rootWindow.frameElement,s=a.getBoundingClientRect(),l=s.top,u=s.left;o=l,i=u}var c=n.target.getBoundingClientRect();this.open({left:c.left+i,top:c.top+n.target.offsetHeight+3+o,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(n,o){var i=o.parentNode;if(i){var a=i.parentNode.childNodes,s=Array.prototype.indexOf.call(a,i);if(!(n<0||s!==a.length-1)){var l=o.querySelector(".".concat(f0));if(!(this.enabled&&l)){if(!this.enabled){l&&l.parentNode.removeChild(l);return}var u=this.hot.rootDocument.createElement("button");u.className=f0,u.type="button",u.onclick=function(){return!1},o.firstChild.insertBefore(u,o.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),oa(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return c0}},{key:"PLUGIN_PRIORITY",get:function(){return cxt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[bp,wp,Jt,Sp,Jt,rw,Jt,Ap,Jt,zn]}}]),r}(re);O2.SEPARATOR={name:Jt};function od(e){return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function fxt(e,t){return yxt(e)||pxt(e,t)||dxt(e,t)||hxt()}function hxt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dxt(e,t){if(e){if(typeof e=="string")return D_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D_(e,t)}}function D_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function yxt(e){if(Array.isArray(e))return e}function gxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function __(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vxt(n.key),n)}}function mxt(e,t,r){return t&&__(e.prototype,t),r&&__(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vxt(e){var t=bxt(e,"string");return od(t)==="symbol"?t:String(t)}function bxt(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wxt=function(){function e(t){gxt(this,e),this.hot=t,this.options={}}return mxt(e,[{key:"setOptions",value:function(t){this.options=t}},{key:"getData",value:function(){var t=this,r=this._getDataRange(),n=r.startRow,o=r.startCol,i=r.endRow,a=r.endCol,s=this.options,l=[];return Ct(n,i,function(u){var c=[];!s.exportHiddenRows&&t._isHiddenRow(u)||(Ct(o,a,function(f){!s.exportHiddenColumns&&t._isHiddenColumn(f)||c.push(t.hot.getDataAtCell(u,f))}),l.push(c))}),l}},{key:"getRowHeaders",value:function(){var t=this,r=[];if(this.options.rowHeaders){var n=this._getDataRange(),o=n.startRow,i=n.endRow,a=this.hot.getRowHeader();Ct(o,i,function(s){!t.options.exportHiddenRows&&t._isHiddenRow(s)||r.push(a[s])})}return r}},{key:"getColumnHeaders",value:function(){var t=this,r=[];if(this.options.columnHeaders){var n=this._getDataRange(),o=n.startCol,i=n.endCol,a=this.hot.getColHeader();Ct(o,i,function(s){!t.options.exportHiddenColumns&&t._isHiddenColumn(s)||r.push(a[s])})}return r}},{key:"_getDataRange",value:function(){var t=this.hot.countCols()-1,r=this.hot.countRows()-1,n=fxt(this.options.range,4),o=n[0],i=o===void 0?0:o,a=n[1],s=a===void 0?0:a,l=n[2],u=l===void 0?r:l,c=n[3],f=c===void 0?t:c;return i=Math.max(i,0),s=Math.max(s,0),u=Math.min(u,r),f=Math.min(f,t),{startRow:i,startCol:s,endRow:u,endCol:f}}},{key:"_isHiddenRow",value:function(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}},{key:"_isHiddenColumn",value:function(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}]),e}();const Axt=wxt;function id(e){return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function Sxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oxt(n.key),n)}}function Cxt(e,t,r){return t&&H_(e.prototype,t),r&&H_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oxt(e){var t=kxt(e,"string");return id(t)==="symbol"?t:String(t)}function kxt(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rxt=function(){function e(t,r){Sxt(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return Cxt(e,[{key:"_mergeOptions",value:function(t){var r=yn(this.constructor.DEFAULT_OPTIONS),n=new Date;return r=Ve(yn(e.DEFAULT_OPTIONS),r),r=Ve(r,t),r.filename=mR(r.filename,{YYYY:n.getFullYear(),MM:"".concat(n.getMonth()+1).padStart(2,"0"),DD:"".concat(n.getDate()).padStart(2,"0")}),r}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const Ext=Rxt;function fu(e){return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function Txt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mxt(n.key),n)}}function Pxt(e,t,r){return t&&N_(e.prototype,t),r&&N_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mxt(e){var t=Ixt(e,"string");return fu(t)==="symbol"?t:String(t)}function Ixt(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xxt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_O(e,t)}function _O(e,t){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},_O(e,t)}function jxt(e){var t=Hxt();return function(){var r=Em(e),n;if(t){var o=Em(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Dxt(this,n)}}function Dxt(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _xt(e)}function _xt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hxt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Em(e){return Em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Em(e)}var Nxt="\r",Bxt='"',Lxt=`
`,Vxt=function(e){xxt(r,e);var t=jxt(r);function r(){return Txt(this,r),t.apply(this,arguments)}return Pxt(r,[{key:"export",value:function(){var n=this,o=this.options,i=this.dataProvider.getData(),a=this.dataProvider.getColumnHeaders(),s=a.length>0,l=this.dataProvider.getRowHeaders(),u=l.length>0,c=o.bom?"\uFEFF":"";return s&&(a=Gt(a,function(f){return n._escapeCell(f,!0)}),u&&(c+=o.columnDelimiter),c+=a.join(o.columnDelimiter),c+=o.rowDelimiter),T(i,function(f,h){h>0&&(c+=o.rowDelimiter),u&&(c+=n._escapeCell(l[h])+o.columnDelimiter),c+=f.map(function(p){return n._escapeCell(p)}).join(o.columnDelimiter)}),c}},{key:"_escapeCell",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=Pe(n);return i!==""&&(o||i.indexOf(Nxt)>=0||i.indexOf(Bxt)>=0||i.indexOf(Lxt)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i='"'.concat(i,'"')),i}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(Ext);const Fxt=Vxt;function ad(e){return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function Wxt(e,t,r){return t=Uxt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uxt(e){var t=Yxt(e,"string");return ad(t)==="symbol"?t:String(t)}function Yxt(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gxt="csv",HO=Wxt({},Gxt,Fxt);function zxt(e,t,r){return typeof HO[e]=="function"?new HO[e](t,r):null}function hu(e){return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function Qxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xxt(n.key),n)}}function Kxt(e,t,r){return t&&B_(e.prototype,t),r&&B_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xxt(e){var t=Jxt(e,"string");return hu(t)==="symbol"?t:String(t)}function Jxt(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zxt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NO(e,t)}function NO(e,t){return NO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},NO(e,t)}function qxt(e){var t=ejt();return function(){var r=Tm(e),n;if(t){var o=Tm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $xt(this,n)}}function $xt(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tjt(e)}function tjt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ejt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tm(e){return Tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tm(e)}var njt="exportFile",rjt=240,ojt=function(e){Zxt(r,e);var t=qxt(r);function r(){return Qxt(this,r),t.apply(this,arguments)}return Kxt(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(n,o).export()}},{key:"exportAsBlob",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(n,o))}},{key:"downloadFile",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.hot,a=i.rootDocument,s=i.rootWindow,l=this._createTypeFormatter(n,o),u=this._createBlob(l),c=s.URL||s.webkitURL,f=a.createElement("a"),h="".concat(l.options.filename,".").concat(l.options.fileExtension);if(f.download!==void 0){var p=c.createObjectURL(u);f.style.display="none",f.setAttribute("href",p),f.setAttribute("download",h),a.body.appendChild(f),f.dispatchEvent(new MouseEvent("click")),a.body.removeChild(f),setTimeout(function(){c.revokeObjectURL(p)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(u,h)}},{key:"_createTypeFormatter",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!HO[n])throw new Error('Export format type "'.concat(n,'" is not supported.'));return zxt(n,new Axt(this.hot),o)}},{key:"_createBlob",value:function(n){var o=null;return typeof Blob<"u"&&(o=new Blob([n.export()],{type:"".concat(n.options.mimeType,";charset=").concat(n.options.encoding)})),o}}],[{key:"PLUGIN_KEY",get:function(){return njt}},{key:"PLUGIN_PRIORITY",get:function(){return rjt}}]),r}(re);function sd(e){return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}function ijt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sjt(n.key),n)}}function ajt(e,t,r){return t&&L_(e.prototype,t),r&&L_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sjt(e){var t=ljt(e,"string");return sd(t)==="symbol"?t:String(t)}function ljt(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k2=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;ijt(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Mv)}return ajt(e,[{key:"reset",value:function(){T(this.elements,function(t){return t.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(t){this.state&&this.setState(this.state.getValueAtIndex(t))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(t){this.state&&this.state.setValueAtIndex(t,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,function(t){return t.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();pe(k2,Tn);const cw=k2;var ld={};function wi(e,t){if(!ld[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=ld[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function Ws(e){if(!ld[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return ld[e].descriptor}function Ye(e,t,r){r.key=e,ld[e]={condition:t,descriptor:r}}var tn="none";function ujt(){return!0}Ye(tn,ujt,{name:pp,inputsCount:0,showOperators:!1});var Af="empty";function cjt(e){return Qe(e.value)}Ye(Af,cjt,{name:wb,inputsCount:0,showOperators:!0});var sg="not_empty";function fjt(e,t){return!wi(Af,t)(e)}Ye(sg,fjt,{name:Ab,inputsCount:0,showOperators:!0});function hjt(e,t){return gjt(e)||yjt(e,t)||pjt(e,t)||djt()}function djt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pjt(e,t){if(e){if(typeof e=="string")return V_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V_(e,t)}}function V_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yjt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function gjt(e){if(Array.isArray(e))return e}var Sf="eq";function mjt(e,t){var r=hjt(t,1),n=r[0];return Pe(e.value).toLocaleLowerCase(e.meta.locale)===Pe(n)}Ye(Sf,mjt,{name:Sb,inputsCount:1,showOperators:!0});var lg="neq";function vjt(e,t){return!wi(Sf,t)(e)}Ye(lg,vjt,{name:Cb,inputsCount:1,showOperators:!0});function bjt(e,t){return Cjt(e)||Sjt(e,t)||Ajt(e,t)||wjt()}function wjt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ajt(e,t){if(e){if(typeof e=="string")return F_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F_(e,t)}}function F_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sjt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Cjt(e){if(Array.isArray(e))return e}var R2="gt";function Ojt(e,t){var r=bjt(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}Ye(R2,Ojt,{name:Tb,inputsCount:1,showOperators:!0});function kjt(e,t){return Pjt(e)||Tjt(e,t)||Ejt(e,t)||Rjt()}function Rjt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ejt(e,t){if(e){if(typeof e=="string")return W_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W_(e,t)}}function W_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tjt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Pjt(e){if(Array.isArray(e))return e}var E2="gte";function Mjt(e,t){var r=kjt(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}Ye(E2,Mjt,{name:Pb,inputsCount:1,showOperators:!0});function Ijt(e,t){return _jt(e)||Djt(e,t)||jjt(e,t)||xjt()}function xjt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jjt(e,t){if(e){if(typeof e=="string")return U_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U_(e,t)}}function U_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Djt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _jt(e){if(Array.isArray(e))return e}var T2="lt";function Hjt(e,t){var r=Ijt(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}Ye(T2,Hjt,{name:Mb,inputsCount:1,showOperators:!0});function Njt(e,t){return Fjt(e)||Vjt(e,t)||Ljt(e,t)||Bjt()}function Bjt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ljt(e,t){if(e){if(typeof e=="string")return Y_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y_(e,t)}}function Y_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vjt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Fjt(e){if(Array.isArray(e))return e}var P2="lte";function Wjt(e,t){var r=Njt(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}Ye(P2,Wjt,{name:Ib,inputsCount:1,showOperators:!0});function Ujt(e,t){return Qjt(e)||zjt(e,t)||Gjt(e,t)||Yjt()}function Yjt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gjt(e,t){if(e){if(typeof e=="string")return G_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G_(e,t)}}function G_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zjt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Qjt(e){if(Array.isArray(e))return e}var AE="date_after";function Kjt(e,t){var r=Ujt(t,1),n=r[0],o=$(e.value,e.meta.dateFormat),i=$(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Ye(AE,Kjt,{name:Db,inputsCount:1,showOperators:!0});function Xjt(e,t){return $jt(e)||qjt(e,t)||Zjt(e,t)||Jjt()}function Jjt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zjt(e,t){if(e){if(typeof e=="string")return z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z_(e,t)}}function z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qjt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function $jt(e){if(Array.isArray(e))return e}var SE="date_before";function tDt(e,t){var r=Xjt(t,1),n=r[0],o=$(e.value,e.meta.dateFormat),i=$(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Ye(SE,tDt,{name:_b,inputsCount:1,showOperators:!0});function eDt(e,t){return iDt(e)||oDt(e,t)||rDt(e,t)||nDt()}function nDt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rDt(e,t){if(e){if(typeof e=="string")return Q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q_(e,t)}}function Q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oDt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function iDt(e){if(Array.isArray(e))return e}var Pm="between";function aDt(e,t){var r=eDt(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var s=parseFloat(i,10),l=parseFloat(a,10);i=Math.min(s,l),a=Math.max(s,l)}else if(e.meta.type==="date"){var u=wi(SE,[a]),c=wi(AE,[i]);return u(e)&&c(e)}return e.value>=i&&e.value<=a}Ye(Pm,aDt,{name:xb,inputsCount:2,showOperators:!0});var M2="not_between";function sDt(e,t){return!wi(Pm,t)(e)}Ye(M2,sDt,{name:jb,inputsCount:2,showOperators:!0});function lDt(e,t){return hDt(e)||fDt(e,t)||cDt(e,t)||uDt()}function uDt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cDt(e,t){if(e){if(typeof e=="string")return K_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K_(e,t)}}function K_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fDt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function hDt(e){if(Array.isArray(e))return e}var I2="begins_with";function dDt(e,t){var r=lDt(t,1),n=r[0];return Pe(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Pe(n))}Ye(I2,dDt,{name:Ob,inputsCount:1,showOperators:!0});var pDt=jt,x2=Yd,yDt=Hr.f,gDt=Va,X_=Ue,mDt=Nk,vDt=Rn,bDt=Bk,J_=x2("".endsWith),wDt=x2("".slice),ADt=Math.min,j2=bDt("endsWith"),SDt=!j2&&!!function(){var e=yDt(String.prototype,"endsWith");return e&&!e.writable}();pDt({target:"String",proto:!0,forced:!SDt&&!j2},{endsWith:function(e){var t=X_(vDt(this));mDt(e);var r=arguments.length>1?arguments[1]:void 0,n=t.length,o=r===void 0?n:ADt(gDt(r),n),i=X_(e);return J_?J_(t,i,o):wDt(t,o-i.length,o)===i}});function CDt(e,t){return EDt(e)||RDt(e,t)||kDt(e,t)||ODt()}function ODt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kDt(e,t){if(e){if(typeof e=="string")return Z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z_(e,t)}}function Z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RDt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function EDt(e){if(Array.isArray(e))return e}var D2="ends_with";function TDt(e,t){var r=CDt(t,1),n=r[0];return Pe(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Pe(n))}Ye(D2,TDt,{name:kb,inputsCount:1,showOperators:!0});function PDt(e,t){return jDt(e)||xDt(e,t)||IDt(e,t)||MDt()}function MDt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IDt(e,t){if(e){if(typeof e=="string")return q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q_(e,t)}}function q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xDt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function jDt(e){if(Array.isArray(e))return e}var CE="contains";function DDt(e,t){var r=PDt(t,1),n=r[0];return Pe(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Pe(n))>=0}Ye(CE,DDt,{name:Rb,inputsCount:1,showOperators:!0});var _2="not_contains";function _Dt(e,t){return!wi(CE,t)(e)}Ye(_2,_Dt,{name:Eb,inputsCount:1,showOperators:!0});var H2="date_tomorrow";function HDt(e){var t=$(e.value,e.meta.dateFormat);return t.isValid()?t.isSame($().subtract(-1,"days").startOf("day"),"d"):!1}Ye(H2,HDt,{name:Nb,inputsCount:0});var N2="date_today";function NDt(e){var t=$(e.value,e.meta.dateFormat);return t.isValid()?t.isSame($().startOf("day"),"d"):!1}Ye(N2,NDt,{name:Hb,inputsCount:0});var B2="date_yesterday";function BDt(e){var t=$(e.value,e.meta.dateFormat);return t.isValid()?t.isSame($().subtract(1,"days").startOf("day"),"d"):!1}Ye(B2,BDt,{name:Bb,inputsCount:0});WV();function LDt(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var BO=new Set([1]).has(1),VDt=BO&&typeof Array.from=="function";function Cp(e){var t=e;return BO&&(t=new Set(t)),function(r){var n;return BO?n=t.has(r):n=!!~t.indexOf(r),n}}function L2(e){return e??""}function LO(e){var t=e;return VDt?t=Array.from(new Set(t)):t=Yk(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function $_(e,t,r,n){var o=[],i=e===t,a;return i||(a=Cp(t)),T(e,function(s){var l=!1;(i||a(s))&&(l=!0);var u={checked:l,value:s,visualValue:LDt(s,r)};n&&n(u),o.push(u)}),o}function V2(e,t){return YDt(e)||UDt(e,t)||WDt(e,t)||FDt()}function FDt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WDt(e,t){if(e){if(typeof e=="string")return tH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tH(e,t)}}function tH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UDt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function YDt(e){if(Array.isArray(e))return e}var ia="by_value";function GDt(e,t){var r=V2(t,1),n=r[0];return n(e.value)}Ye(ia,GDt,{name:"By value",inputsCount:0,inputValuesDecorator:function(e){var t=V2(e,1),r=t[0];return[Cp(r)]},showOperators:!1});var ud={};function zDt(e){if(!ud[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=ud[e].func;return function(r,n){return t(r,n)}}function QDt(e){return ud[e].name}function OE(e,t,r){ud[e]={name:t,func:r}}var li="conjunction",KDt=Fb;function XDt(e,t){return e.every(function(r){return r.func(t)})}OE(li,KDt,XDt);var Mm="disjunction",JDt=yp;function ZDt(e,t){return e.some(function(r){return r.func(t)})}OE(Mm,JDt,ZDt);var kE="disjunctionWithExtraCondition",qDt=yp;function $Dt(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}OE(kE,qDt,$Dt);function cd(e){return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}var Uc;function h0(e,t,r){return t=t_t(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t_t(e){var t=e_t(e,"string");return cd(t)==="symbol"?t:String(t)}function e_t(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n_t="numeric",F2="text",r_t="date",eH=(Uc={},h0(Uc,n_t,[tn,Jt,Af,sg,Jt,Sf,lg,Jt,R2,E2,T2,P2,Pm,M2]),h0(Uc,F2,[tn,Jt,Af,sg,Jt,Sf,lg,Jt,I2,D2,Jt,CE,_2]),h0(Uc,r_t,[tn,Jt,Af,sg,Jt,Sf,lg,Jt,SE,AE,Pm,Jt,H2,N2,B2]),Uc);function o_t(e){var t=[],r=e;return eH[r]||(r=F2),T(eH[r],function(n){var o;n===Jt?o={name:Jt}:o=yn(Ws(n)),t.push(o)}),t}function fd(e){return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function i_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s_t(n.key),n)}}function a_t(e,t,r){return t&&nH(e.prototype,t),r&&nH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s_t(e){var t=l_t(e,"string");return fd(t)==="symbol"?t:String(t)}function l_t(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d0="built",p0="building",rH=["click","input","keydown","keypress","keyup","focus","blur","change"],W2=function(){function e(t,r){i_t(this,e),this.hot=t,this.eventManager=new Re(this),this.options=Ve(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return a_t(e,[{key:"setValue",value:function(t){this.options.value=t,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===p0?this._element:this.buildState===d0?(this.update(),this._element):(this.buildState=p0,this.build(),this.buildState=d0,this._element)}},{key:"isBuilt",value:function(){return this.buildState===d0}},{key:"translateIfPossible",value:function(t){return typeof t=="string"&&t.startsWith(vn)?this.hot.getTranslatedPhrase(t):t}},{key:"build",value:function(){var t=this,r=function(o,i){t.eventManager.addEventListener(o,i,function(a){return t.runLocalHooks(i,a,t)})};if(this.buildState||(this.buildState=p0),this.options.className&&q(this._element,this.options.className),this.options.children.length)T(this.options.children,function(o){return t._element.appendChild(o.element)});else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);Qt(this.options,function(o,i){n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=t.translateIfPossible(o))}),this._element.appendChild(n),T(rH,function(o){return r(n,o)})}else T(rH,function(o){return r(t._element,o)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return yn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();pe(W2,Tn);const ui=W2;function du(e){return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function u_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f_t(n.key),n)}}function c_t(e,t,r){return t&&oH(e.prototype,t),r&&oH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f_t(e){var t=h_t(e,"string");return du(t)==="symbol"?t:String(t)}function h_t(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ug(){return typeof Reflect<"u"&&Reflect.get?ug=Reflect.get.bind():ug=function(e,t,r){var n=d_t(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ug.apply(this,arguments)}function d_t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pu(e),e!==null););return e}function p_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VO(e,t)}function VO(e,t){return VO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},VO(e,t)}function y_t(e){var t=m_t();return function(){var r=pu(e),n;if(t){var o=pu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g_t(this,n)}}function g_t(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U2(e)}function U2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pu(e){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pu(e)}var by=new WeakMap,v_t=function(e){p_t(r,e);var t=y_t(r);function r(n,o){var i;return u_t(this,r),i=t.call(this,n,Ve(r.DEFAULTS,o)),by.set(U2(i),{}),i.registerHooks(),i}return c_t(r,[{key:"registerHooks",value:function(){var n=this;this.addLocalHook("click",function(){return n.onClick()}),this.addLocalHook("keyup",function(o){return n.onKeyup(o)})}},{key:"build",value:function(){ug(pu(r.prototype),"build",this).call(this);var n=by.get(this),o=this.hot.rootDocument.createElement("div");n.input=this._element.firstChild,q(this._element,"htUIInput"),q(o,"htUIInputIcon"),this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=by.get(this).input;n.type=this.options.type,n.placeholder=this.translateIfPossible(this.options.placeholder),n.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&by.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(n){this.options.value=n.target.value}}],[{key:"DEFAULTS",get:function(){return yn({placeholder:"",type:"text",tagName:"input"})}}]),r}(ui);const Us=v_t;function yu(e){return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function b_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A_t(n.key),n)}}function w_t(e,t,r){return t&&iH(e.prototype,t),r&&iH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A_t(e){var t=S_t(e,"string");return yu(t)==="symbol"?t:String(t)}function S_t(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ys(){return typeof Reflect<"u"&&Reflect.get?Ys=Reflect.get.bind():Ys=function(e,t,r){var n=C_t(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Ys.apply(this,arguments)}function C_t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ci(e),e!==null););return e}function O_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FO(e,t)}function FO(e,t){return FO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},FO(e,t)}function k_t(e){var t=E_t();return function(){var r=ci(e),n;if(t){var o=ci(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R_t(this,n)}}function R_t(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y2(e)}function Y2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ci(e){return ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ci(e)}var wy=new WeakMap,T_t=function(e){O_t(r,e);var t=k_t(r);function r(n,o){var i;return b_t(this,r),i=t.call(this,n,Ve(r.DEFAULTS,o)),wy.set(Y2(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return w_t(r,[{key:"registerHooks",value:function(){var n=this;this.addLocalHook("click",function(){return n.onClick()})}},{key:"setItems",value:function(n){this.items=this.translateNames(n),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(n){var o=this;return T(n,function(i){i.name=o.translateIfPossible(i.name)}),n}},{key:"build",value:function(){var n=this;Ys(ci(r.prototype),"build",this).call(this),this.menu=new bE(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var o=new ui(this.hot,{className:"htUISelectCaption"}),i=new ui(this.hot,{className:"htUISelectDropdown"}),a=wy.get(this);a.caption=o,a.captionElement=o.element,a.dropdown=i,T([o,i],function(s){return n._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return n.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return n.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n;this.options.value?n=this.options.value.name:n=this.menu.hot.getTranslatedPhrase(pp),wy.get(this).captionElement.textContent=n,Ys(ci(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var n=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?n.left-5:n.left-31,top:n.top-1,width:n.width,height:n.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(n){n.name!==Jt&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var n=wy.get(this),o=n.caption,i=n.dropdown;o&&o.destroy(),i&&i.destroy(),Ys(ci(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return yn({className:"htUISelect",wrapIt:!1})}}]),r}(ui);const aH=T_t;function gu(e){return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function P_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I_t(n.key),n)}}function M_t(e,t,r){return t&&sH(e.prototype,t),r&&sH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I_t(e){var t=x_t(e,"string");return gu(t)==="symbol"?t:String(t)}function x_t(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cg(){return typeof Reflect<"u"&&Reflect.get?cg=Reflect.get.bind():cg=function(e,t,r){var n=j_t(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},cg.apply(this,arguments)}function j_t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mu(e),e!==null););return e}function D_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WO(e,t)}function WO(e,t){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},WO(e,t)}function __t(e){var t=B_t();return function(){var r=mu(e),n;if(t){var o=mu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return H_t(this,n)}}function H_t(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N_t(e)}function N_t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(e){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mu(e)}var L_t=function(e){D_t(r,e);var t=__t(r);function r(n,o){var i;return P_t(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new aH(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new Us(i.hot,{placeholder:Qb})),i.elements.push(new Us(i.hot,{placeholder:Kb})),i.registerHooks(),i}return M_t(r,[{key:"registerHooks",value:function(){var n=this;this.getSelectElement().addLocalHook("select",function(o){return n.onConditionSelect(o)}),this.getSelectElement().addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),T(this.getInputElements(),function(o){o.addLocalHook("keydown",function(i){return n.onInputKeyDown(i)})})}},{key:"setState",value:function(n){var o=this;if(this.reset(),!!n){var i=yn(n.command);i.name.startsWith(Ie)&&(i.name=this.hot.getTranslatedPhrase(i.name)),this.getSelectElement().setValue(i),T(n.args,function(a,s){if(s>i.inputsCount-1)return!1;var l=o.getInputElement(s);l.setValue(a),l[i.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return l.focus()},10)})}}},{key:"getState",value:function(){var n=this.getSelectElement().getValue()||Ws(tn),o=[];return T(this.getInputElements(),function(i,a){n.inputsCount>a&&o.push(i.getValue())}),{command:n,args:o}}},{key:"updateState",value:function(n,o){var i=Ws(n?n.name:tn);this.state.setValueAtIndex(o,{command:i,args:n?n.args:[]}),n||T(this.getInputElements(),function(a){return a.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(n){return n instanceof aH})[0]}},{key:"getInputElement",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[n]}},{key:"getInputElements",value:function(){return this.elements.filter(function(n){return n instanceof Us})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(o,i,a,s,l,u){q(i.parentNode,"htFiltersMenuCondition"),n.addSeparator&&q(i.parentNode,"border");var c=n.hot.rootDocument.createElement("div");return q(c,"htFiltersMenuLabel"),c.textContent=u,i.appendChild(c),i.parentNode.hasAttribute("ghost-table")||T(n.elements,function(f){return i.appendChild(f.element)}),i}}}},{key:"reset",value:function(){var n=this.hot.getPlugin("filters").getSelectedColumn(),o=[Ws(tn)];if(n!==null){var i=n.visualIndex;o=o_t(this.hot.getDataType(0,i,this.hot.countRows(),i))}T(this.getInputElements(),function(a){return a.hide()}),this.getSelectElement().setItems(o),cg(mu(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(n){T(this.getInputElements(),function(o,i){o[n.inputsCount>i?"show":"hide"](),i===0&&setTimeout(function(){return o.focus()},10)}),this.runLocalHooks("change",n)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(n){rl(n.keyCode,"ENTER")?(this.runLocalHooks("accept"),gr(n)):rl(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),gr(n))}}]),r}(cw);const y0=L_t;function vu(e){return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}function V_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W_t(n.key),n)}}function F_t(e,t,r){return t&&lH(e.prototype,t),r&&lH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W_t(e){var t=U_t(e,"string");return vu(t)==="symbol"?t:String(t)}function U_t(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fg(){return typeof Reflect<"u"&&Reflect.get?fg=Reflect.get.bind():fg=function(e,t,r){var n=Y_t(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},fg.apply(this,arguments)}function Y_t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function G_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UO(e,t)}function UO(e,t){return UO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},UO(e,t)}function z_t(e){var t=K_t();return function(){var r=bu(e),n;if(t){var o=bu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Q_t(this,n)}}function Q_t(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G2(e)}function G2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bu(e)}var Ay=new WeakMap,X_t=function(e){G_t(r,e);var t=z_t(r);function r(n,o){var i;return V_t(this,r),i=t.call(this,n,Ve(r.DEFAULTS,o)),Ay.set(G2(i),{}),i}return F_t(r,[{key:"build",value:function(){fg(bu(r.prototype),"build",this).call(this);var n=Ay.get(this);n.input=this._element.firstChild;var o=this.hot.rootDocument.createElement("label");o.textContent=this.translateIfPossible(this.options.label.textContent),o.htmlFor=this.translateIfPossible(this.options.label.htmlFor),n.label=o,this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=Ay.get(this);n.input.checked=this.options.checked,n.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=n,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Ay.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return yn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(ui);const uH=X_t;function wu(e){return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}var cH;function J_t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Z_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$_t(n.key),n)}}function q_t(e,t,r){return t&&fH(e.prototype,t),r&&fH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $_t(e){var t=tHt(e,"string");return wu(t)==="symbol"?t:String(t)}function tHt(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eHt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},YO(e,t)}function nHt(e){var t=iHt();return function(){var r=Im(e),n;if(t){var o=Im(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rHt(this,n)}}function rHt(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oHt(e)}function oHt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iHt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Im(e){return Im=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Im(e)}var hH=0,aHt=function(e){eHt(r,e);var t=nHt(r);function r(n,o){var i;return Z_t(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return q_t(r,[{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(o,i){return q(i.parentNode,"htFiltersMenuOperators"),i.parentNode.hasAttribute("ghost-table")||T(n.elements,function(a){return i.appendChild(a.element)}),i}}}},{key:"buildOperatorsElement",value:function(){var n=this,o=[li,Mm];T(o,function(i){var a=new uH(n.hot,{name:"operator",label:{htmlFor:i,textContent:QDt(i)},value:i,checked:i===o[hH],id:i});a.addLocalHook("change",function(s){return n.onRadioInputChange(s)}),n.elements.push(a)})}},{key:"setChecked",value:function(n){if(this.elements.length<n)throw Error(ce(cH||(cH=J_t(["Radio button with index "," doesn't exist."])),n));T(this.elements,function(o,i){o.setChecked(i===n)})}},{key:"getActiveOperationId",value:function(){var n=this.elements.find(function(o){return o instanceof uH&&o.isChecked()});return n?n.getValue():li}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(n){this.reset(),n&&this.getActiveOperationId()!==n&&T(this.elements,function(o){o.setChecked(o.getValue()===n)})}},{key:"updateState",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:li,o=arguments.length>1?arguments[1]:void 0,i=n;i===kE&&(i=Mm),this.state.setValueAtIndex(o,i)}},{key:"reset",value:function(){this.setChecked(hH)}},{key:"onRadioInputChange",value:function(n){this.setState(n.target.value)}}]),r}(cw);const sHt=aHt;var lHt=Kt,uHt=Rn,dH=Ue,cHt=/"/g,fHt=lHt("".replace),hHt=function(e,t,r,n){var o=dH(uHt(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+fHt(dH(n),cHt,"&quot;")+'"'),i+">"+o+"</"+t+">"},dHt=Wt,pHt=function(e){return dHt(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},yHt=jt,gHt=hHt,mHt=pHt;yHt({target:"String",proto:!0,forced:mHt("link")},{link:function(e){return gHt(this,"a","href",e)}});function Au(e){return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function vHt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wHt(n.key),n)}}function bHt(e,t,r){return t&&pH(e.prototype,t),r&&pH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wHt(e){var t=AHt(e,"string");return Au(t)==="symbol"?t:String(t)}function AHt(e,t){if(Au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hg(){return typeof Reflect<"u"&&Reflect.get?hg=Reflect.get.bind():hg=function(e,t,r){var n=SHt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},hg.apply(this,arguments)}function SHt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Su(e),e!==null););return e}function CHt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},GO(e,t)}function OHt(e){var t=RHt();return function(){var r=Su(e),n;if(t){var o=Su(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kHt(this,n)}}function kHt(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z2(e)}function z2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RHt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Su(e){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Su(e)}var g0=new WeakMap,EHt=function(e){CHt(r,e);var t=OHt(r);function r(n,o){var i;return vHt(this,r),i=t.call(this,n,Ve(r.DEFAULTS,o)),g0.set(z2(i),{}),i}return bHt(r,[{key:"build",value:function(){hg(Su(r.prototype),"build",this).call(this);var n=g0.get(this);n.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(g0.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return yn({href:"#",tagName:"a"})}}]),r}(ui);const yH=EHt;function Cu(e){return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function gH(e){return IHt(e)||MHt(e)||PHt(e)||THt()}function THt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PHt(e,t){if(e){if(typeof e=="string")return zO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zO(e,t)}}function MHt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IHt(e){if(Array.isArray(e))return zO(e)}function zO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xHt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DHt(n.key),n)}}function jHt(e,t,r){return t&&mH(e.prototype,t),r&&mH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DHt(e){var t=_Ht(e,"string");return Cu(t)==="symbol"?t:String(t)}function _Ht(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gs(){return typeof Reflect<"u"&&Reflect.get?Gs=Reflect.get.bind():Gs=function(e,t,r){var n=HHt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Gs.apply(this,arguments)}function HHt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fi(e),e!==null););return e}function NHt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QO(e,t)}function QO(e,t){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},QO(e,t)}function BHt(e){var t=VHt();return function(){var r=fi(e),n;if(t){var o=fi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LHt(this,n)}}function LHt(e,t){if(t&&(Cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q2(e)}function Q2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VHt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fi(e){return fi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fi(e)}var FHt=new WeakMap,WHt="multipleSelect.itemBox",UHt=function(e){NHt(r,e);var t=BHt(r);function r(n,o){var i;return xHt(this,r),i=t.call(this,n,Ve(r.DEFAULTS,o)),FHt.set(Q2(i),{}),i.searchInput=new Us(i.hot,{placeholder:zb,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new yH(i.hot,{textContent:Wb,className:"htUISelectAll"}),i.clearAllUI=new yH(i.hot,{textContent:Ub,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return jHt(r,[{key:"registerHooks",value:function(){var n=this;this.searchInput.addLocalHook("keydown",function(o){return n.onInputKeyDown(o)}),this.searchInput.addLocalHook("input",function(o){return n.onInput(o)}),this.selectAllUI.addLocalHook("click",function(o){return n.onSelectAllClick(o)}),this.clearAllUI.addLocalHook("click",function(o){return n.onClearAllClick(o)})}},{key:"setItems",value:function(n){this.items=n,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(n){this.locale=n}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return gH(this.items)}},{key:"getValue",value:function(){return GHt(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var n=this;Gs(fi(r.prototype),"build",this).call(this);var o=this.hot.rootDocument,i=o.createElement("div"),a=new ui(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(a.element),this._element.appendChild(i);var s=function(l){if(n._element){n.itemsBox&&n.itemsBox.destroy(),q(l,"htUIMultipleSelectHot"),n.itemsBox=new n.hot.constructor(l,{data:n.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(f,h,p,y,m,v){f.title=v.instance.getDataAtRowProp(h,v.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return n.itemsBox.container.scrollWidth-qe(o)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:n.hot.isRtl()?"rtl":"ltr"}),n.itemsBox.init();var u=n.itemsBox.getShortcutManager(),c=u.getContext("grid");c.addShortcut({keys:[["Escape"]],callback:function(f){n.runLocalHooks("keydown",f,n)},group:WHt})}};s(i),setTimeout(function(){return s(i)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(YHt(this.items,this.options.value)),Gs(fi(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Gs(fi(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(n){var o=this,i=n.target.value.toLocaleLowerCase(this.getLocale()),a;i===""?a=gH(this.items):a=Ln(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(o.getLocale()).indexOf(i)>=0}),this.itemsBox.loadData(a)}},{key:"onInputKeyDown",value:function(n){this.runLocalHooks("keydown",n,this);var o=SR(rl,n.keyCode);o("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(gr(n),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(n){var o=[];n.preventDefault(),T(this.itemsBox.getSourceData(),function(i,a){i.checked=!0,o.push(RC(i,a)[0])}),this.itemsBox.setSourceDataAtCell(o)}},{key:"onClearAllClick",value:function(n){var o=[];n.preventDefault(),T(this.itemsBox.getSourceData(),function(i,a){i.checked=!1,o.push(RC(i,a)[0])}),this.itemsBox.setSourceDataAtCell(o)}}],[{key:"DEFAULTS",get:function(){return yn({className:"htUIMultipleSelect",value:[]})}}]),r}(ui);const vH=UHt;function YHt(e,t){var r=Cp(t);return Gt(e,function(n){return n.checked=r(n.value),n})}function GHt(e){var t=[];return T(e,function(r){r.checked&&t.push(r.value)}),t}function Ou(e){return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function zHt(e,t){return JHt(e)||XHt(e,t)||KHt(e,t)||QHt()}function QHt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KHt(e,t){if(e){if(typeof e=="string")return bH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bH(e,t)}}function bH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XHt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function JHt(e){if(Array.isArray(e))return e}function ZHt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Ht(n.key),n)}}function qHt(e,t,r){return t&&wH(e.prototype,t),r&&wH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ht(e){var t=tNt(e,"string");return Ou(t)==="symbol"?t:String(t)}function tNt(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dg(){return typeof Reflect<"u"&&Reflect.get?dg=Reflect.get.bind():dg=function(e,t,r){var n=eNt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},dg.apply(this,arguments)}function eNt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ku(e),e!==null););return e}function nNt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},KO(e,t)}function rNt(e){var t=aNt();return function(){var r=ku(e),n;if(t){var o=ku(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oNt(this,n)}}function oNt(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iNt(e)}function iNt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aNt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ku(e){return ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ku(e)}var sNt=function(e){nNt(r,e);var t=rNt(r);function r(n,o){var i;return ZHt(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new vH(i.hot)),i.registerHooks(),i}return qHt(r,[{key:"registerHooks",value:function(){var n=this;this.getMultipleSelectElement().addLocalHook("keydown",function(o){return n.onInputKeyDown(o)})}},{key:"setState",value:function(n){if(this.reset(),n&&n.command.key===ia){var o=this.getMultipleSelectElement();o.setItems(n.itemsSnapshot),o.setValue(n.args[0]),o.setLocale(n.locale)}}},{key:"getState",value:function(){var n=this.getMultipleSelectElement(),o=n.getItems();return{command:{key:n.isSelectedAllValues()||!o.length?tn:ia},args:[n.getValue()],itemsSnapshot:o}}},{key:"updateState",value:function(n){var o=this,i=function(a,s,l,u,c){var f=Ln(s,function(D){return D.name===ia}),h=zHt(f,1),p=h[0],y={},m=o.hot.getTranslatedPhrase(vh);if(p){var v=LO(Gt(u(a,c),function(D){return D.value}));l&&(p.args[0]=l);var w=[],C=$_(v,p.args[0],m,function(D){D.checked&&w.push(D.value)}),A=n.editedConditionStack.column;y.locale=o.hot.getCellMeta(0,A).locale,y.args=[w],y.command=Ws(ia),y.itemsSnapshot=C}else y.args=[],y.command=Ws(tn);o.state.setValueAtIndex(a,y)};i(n.editedConditionStack.column,n.editedConditionStack.conditions,n.conditionArgsChange,n.filteredRowsFactory),n.dependentConditionStacks.length&&i(n.dependentConditionStacks[0].column,n.dependentConditionStacks[0].conditions,n.conditionArgsChange,n.filteredRowsFactory,n.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(n){return n instanceof vH})[0]}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(o,i,a,s,l,u){q(i.parentNode,"htFiltersMenuValue");var c=n.hot.rootDocument.createElement("div");return q(c,"htFiltersMenuLabel"),c.textContent=u,i.appendChild(c),i.parentNode.hasAttribute("ghost-table")||T(n.elements,function(f){return i.appendChild(f.element)}),i}}}},{key:"reset",value:function(){var n=this.hot.getTranslatedPhrase(vh),o=LO(this._getColumnVisibleValues()),i=$_(o,o,n);this.getMultipleSelectElement().setItems(i),dg(ku(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(o);var a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}},{key:"onInputKeyDown",value:function(n){rl(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),gr(n))}},{key:"_getColumnVisibleValues",value:function(){var n=this.hot.getPlugin("filters").getSelectedColumn();return n===null?[]:Gt(this.hot.getDataAtCol(n.visualIndex),function(o){return L2(o)})}}]),r}(cw);const lNt=sNt;function Ru(e){return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function uNt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fNt(n.key),n)}}function cNt(e,t,r){return t&&AH(e.prototype,t),r&&AH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fNt(e){var t=hNt(e,"string");return Ru(t)==="symbol"?t:String(t)}function hNt(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dNt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},XO(e,t)}function pNt(e){var t=mNt();return function(){var r=xm(e),n;if(t){var o=xm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yNt(this,n)}}function yNt(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gNt(e)}function gNt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mNt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xm(e){return xm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xm(e)}var vNt=function(e){dNt(r,e);var t=pNt(r);function r(n,o){var i;return uNt(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new Us(i.hot,{type:"button",value:Yb,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new Us(i.hot,{type:"button",value:Gb,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return cNt(r,[{key:"registerHooks",value:function(){var n=this;T(this.elements,function(o){o.addLocalHook("click",function(i,a){return n.onButtonClick(i,a)})})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(o,i){return q(i.parentNode,"htFiltersMenuActionBar"),i.parentNode.hasAttribute("ghost-table")||T(n.elements,function(a){return i.appendChild(a.element)}),i}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(n,o){o.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(cw);const bNt=vNt;function hd(e){return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}var SH,CH;function OH(e,t){return CNt(e)||SNt(e,t)||ANt(e,t)||wNt()}function wNt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ANt(e,t){if(e){if(typeof e=="string")return kH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kH(e,t)}}function kH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SNt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function CNt(e){if(Array.isArray(e))return e}function RH(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ONt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RNt(n.key),n)}}function kNt(e,t,r){return t&&EH(e.prototype,t),r&&EH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RNt(e){var t=ENt(e,"string");return hd(t)==="symbol"?t:String(t)}function ENt(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TH="ConditionCollection.filteringStates",K2=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;ONt(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Mv,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(TH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return kNt(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(t,r){var n,o=this.filteringStates.getValueAtIndex(r),i=(n=o==null?void 0:o.conditions)!==null&&n!==void 0?n:[],a=o==null?void 0:o.operation;return this.isMatchInConditions(i,t,a)}},{key:"isMatchInConditions",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:li;return t.length?zDt(n)(t,r):!0}},{key:"addCondition",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:li,o=arguments.length>3?arguments[3]:void 0,i=this.hot.getCellMeta(0,t).locale,a=Gt(r.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(i):c}),s=r.name||r.command.key;this.runLocalHooks("beforeAdd",t);var l=this.getOperation(t);if(l){if(l!==n)throw Error(ce(SH||(SH=RH(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),t,l))}else if(he(ud[n]))throw new Error(ce(CH||(CH=RH(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var u=this.getConditions(t);u.length===0?this.filteringStates.setValueAtIndex(t,{operation:n,conditions:[{name:s,args:a,func:wi(s,a)}]},o):u.push({name:s,args:a,func:wi(s,a)}),this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function(t){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(t))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}},{key:"getOperation",value:function(t){var r;return(r=this.filteringStates.getValueAtIndex(t))===null||r===void 0?void 0:r.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(t){var r=OH(t,1),n=r[0];return n})}},{key:"getColumnStackPosition",value:function(t){return this.getFilteredColumns().indexOf(t)}},{key:"exportAllConditions",value:function(){return _e(this.filteringStates.getEntries(),function(t,r){var n=OH(r,2),o=n[0],i=n[1],a=i.operation,s=i.conditions;return t.push({column:o,operation:a,conditions:Gt(s,function(l){var u=l.name,c=l.args;return{name:u,args:c}})}),t},[])}},{key:"importAllConditions",value:function(t){var r=this;this.clean(),T(t,function(n){T(n.conditions,function(o){return r.addCondition(n.column,o)})})}},{key:"removeConditions",value:function(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(t,r){var n=this.getConditions(t);return r?n.some(function(o){return o.name===r}):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(TH),this.filteringStates=null,this.clearLocalHooks()}}]),e}();pe(K2,Tn);const X2=K2;function dd(e){return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function TNt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MNt(n.key),n)}}function PNt(e,t,r){return t&&PH(e.prototype,t),r&&PH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MNt(e){var t=INt(e,"string");return dd(t)==="symbol"?t:String(t)}function INt(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xNt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};TNt(this,e),this.conditionCollection=t,this.columnDataFactory=r}return PNt(e,[{key:"filter",value:function(){var t=this,r=[];return T(this.conditionCollection.getFilteredColumns(),function(n,o){var i=t.columnDataFactory(n);o&&(i=t._getIntersectData(i,r)),r=t.filterByColumn(n,i)}),r}},{key:"filterByColumn",value:function(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[];return T(n,function(i){i!==void 0&&r.conditionCollection.isMatch(i,t)&&o.push(i)}),o}},{key:"_getIntersectData",value:function(t,r){var n=[];return T(r,function(o){var i=o.meta.visualRow;t[i]!==void 0&&(n[i]=t[i])}),n}}]),e}();const J2=xNt;function pd(e){return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function jNt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Nt(n.key),n)}}function DNt(e,t,r){return t&&MH(e.prototype,t),r&&MH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Nt(e){var t=HNt(e,"string");return pd(t)==="symbol"?t:String(t)}function HNt(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z2=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};jNt(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return DNt(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var t=this;this.grouping=!1,T(this.changes,function(r){t.updateStatesAtColumn(r)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}},{key:"updateStatesAtColumn",value:function(t,r){var n=this;if(this.grouping){this.changes.indexOf(t)===-1&&this.changes.push(t);return}var o=this.conditionCollection.exportAllConditions(),i=this.conditionCollection.getColumnStackPosition(t);i===-1&&(i=this.latestEditedColumnPosition);var a=o.slice(0,i),s=o.slice(i);s.length&&s[0].column===t&&s.shift();var l=hW(function(c,f){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],p=new X2(n.hot,!1),y=[].concat(c,h);p.importAllConditions(y);var m=n.columnDataFactory(f),v;p.isEmpty()?v=m:v=new J2(p,function(C){return n.columnDataFactory(C)}).filter(),v=Gt(v,function(C){return C.meta.visualRow});var w=Cp(v);return p.destroy(),Ln(m,function(C){return w(C.meta.visualRow)})})(a),u=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:u},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:r})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var t=this;T(this.latestOrderStack,function(r){t.updateStatesAtColumn(r)})}},{key:"destroy",value:function(){var t=this;this.clearLocalHooks(),Qt(this,function(r,n){t[n]=null})}}]),e}();pe(Z2,Tn);const NNt=Z2;function Eu(e){return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}var IH;function BNt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function LNt(e,t){return UNt(e)||WNt(e,t)||FNt(e,t)||VNt()}function VNt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FNt(e,t){if(e){if(typeof e=="string")return xH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xH(e,t)}}function xH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WNt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function UNt(e){if(Array.isArray(e))return e}function YNt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zNt(n.key),n)}}function GNt(e,t,r){return t&&jH(e.prototype,t),r&&jH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zNt(e){var t=QNt(e,"string");return Eu(t)==="symbol"?t:String(t)}function QNt(e,t){if(Eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zs(){return typeof Reflect<"u"&&Reflect.get?zs=Reflect.get.bind():zs=function(e,t,r){var n=KNt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},zs.apply(this,arguments)}function KNt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hi(e),e!==null););return e}function XNt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},JO(e,t)}function JNt(e){var t=qNt();return function(){var r=hi(e),n;if(t){var o=hi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZNt(this,n)}}function ZNt(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q2(e)}function q2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qNt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hi(e){return hi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hi(e)}var DH="filters",$Nt=250,tBt=function(e){XNt(r,e);var t=JNt(r);function r(n){var o;return YNt(this,r),o=t.call(this,n),o.eventManager=new Re(q2(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return GNt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DH]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new dp),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var o=this.hot.getSettings().dropdownMenu,i=o&&o.uiContainer||this.hot.rootDocument.body,a=function(f){return f.addLocalHook("accept",function(){return n.onActionBarSubmit("accept")}),f.addLocalHook("cancel",function(){return n.onActionBarSubmit("cancel")}),f.addLocalHook("change",function(h){return n.onComponentChange(f,h)}),f},s=function(){return"".concat(n.hot.getTranslatedPhrase(Lb),":")},l=function(){return"".concat(n.hot.getTranslatedPhrase(Vb),":")};if(!this.components.get("filter_by_condition")){var u=new y0(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:i});u.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition",a(u))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new sHt(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new y0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});c.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition2",a(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",a(new lNt(this.hot,{id:"filter_by_value",name:l}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",a(new bNt(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new X2(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new NNt(this.hot,this.conditionCollection,function(f){return n.getDataMapAtColumn(f)}),this.conditionUpdateObserver.addLocalHook("update",function(f){return n.updateComponents(f)})),this.components.forEach(function(f){return f.show()}),this.addHook("beforeDropdownMenuSetItems",function(f){return n.onBeforeDropdownMenuSetItems(f)}),this.addHook("afterDropdownMenuDefaultOptions",function(f){return n.onAfterDropdownMenuDefaultOptions(f)}),this.addHook("afterDropdownMenuShow",function(){return n.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return n.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(f){return n.onAfterChange(f)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),zs(hi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var n=this;if(this.enabled){var o;(o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(i,a){i.destroy(),n.components.set(a,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}zs(hi(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(n,o,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:li,s=this.hot.toPhysicalColumn(n);this.conditionCollection.addCondition(s,{command:{key:o},args:i},a)}},{key:"removeConditions",value:function(n){var o=this.hot.toPhysicalColumn(n);this.conditionCollection.removeConditions(o)}},{key:"clearConditions",value:function(n){if(n===void 0)this.conditionCollection.clean();else{var o=this.hot.toPhysicalColumn(n);this.conditionCollection.removeConditions(o)}}},{key:"filter",value:function(){var n=this,o=this._createDataFilter(),i=!this.conditionCollection.isEmpty(),a=[],s=this.conditionCollection.exportAllConditions(),l=this.hot.runHooks("beforeFilter",s);if(l!==!1)if(i){var u=[];this.hot.batchExecution(function(){n.filtersRowsMap.clear(),a=Gt(o.filter(),function(f){return f.meta.visualRow});var c=Cp(a);Ct(n.hot.countSourceRows()-1,function(f){c(f)||u.push(f)}),T(u,function(f){n.filtersRowsMap.setValueAtIndex(f,!0)})},!0),a.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var n,o=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return o?{visualIndex:o.col,physicalIndex:this.hot.toPhysicalColumn(o.col)}:null}},{key:"clearColumnSelection",value:function(){var n=this.getSelectedColumn();n!==null&&this.hot.selectCell(0,n.visualIndex)}},{key:"getDataMapAtColumn",value:function(n){var o=this,i=this.hot.toVisualColumn(n),a=[];return T(this.hot.getSourceDataAtCol(i),function(s,l){var u,c=o.hot.getCellMeta(l,i),f=c.row,h=c.col,p=c.visualCol,y=c.visualRow,m=c.type,v=c.instance,w=c.dateFormat,C=c.locale,A=(u=o.hot.getDataAtCell(o.hot.toVisualRow(l),i))!==null&&u!==void 0?u:s;a.push({meta:{row:f,col:h,visualCol:p,visualRow:y,type:m,instance:v,dateFormat:w,locale:C},value:L2(A)})}),a}},{key:"onAfterChange",value:function(n){var o=this;n&&T(n,function(i){var a=LNt(i,2),s=a[1],l=o.hot.propToCol(s);o.conditionCollection.hasConditions(l)&&o.updateValueComponentCondition(l)})}},{key:"updateValueComponentCondition",value:function(n){var o=this.hot.getDataAtCol(n),i=LO(o);this.conditionUpdateObserver.updateStatesAtColumn(n,i)}},{key:"restoreComponents",value:function(n){var o,i=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex;n.forEach(function(a){a.isHidden()||a.restoreState(i)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var n=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){n.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(n){n.items.push({name:Jt}),this.components.forEach(function(o){n.items.push(o.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(n,o,i,a){var s=n;return s===Mm&&o.command.key!==tn&&i.command.key!==tn&&a.command.key!==tn?s=kE:a.command.key!==tn&&(o.command.key===tn||i.command.key===tn)&&(s=li),s}},{key:"onActionBarSubmit",value:function(n){var o;if(n==="accept"){var i=this.getSelectedColumn();if(i===null){var a;(a=this.dropdownMenuPlugin)===null||a===void 0||a.close();return}var s=i.physicalIndex,l=this.components.get("filter_by_condition").getState(),u=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),f=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),l,u,c);this.conditionUpdateObserver.groupChanges();var h=this.conditionCollection.getColumnStackPosition(s);h===-1&&(h=void 0),this.conditionCollection.removeConditions(s),l.command.key!==tn&&(this.conditionCollection.addCondition(s,l,f,h),u.command.key!==tn&&this.conditionCollection.addCondition(s,u,f,h)),c.command.key!==tn&&this.conditionCollection.addCondition(s,c,f,h),this.conditionUpdateObserver.flush(),this.components.forEach(function(p){return p.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(o=this.dropdownMenuPlugin)===null||o===void 0||o.close()}},{key:"onComponentChange",value:function(n,o){this.updateDependentComponentsVisibility(),n.constructor===y0&&!o.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var n=this.components.get("filter_by_condition"),o=n.getState(),i=o.command,a=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];i.showOperators?this.showComponents.apply(this,a):this.hideComponents.apply(this,a)}},{key:"onAfterGetColHeader",value:function(n,o){var i=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(i)?q(o,"htFiltersActive"):Bt(o,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new J2(o,function(i){return n.getDataMapAtColumn(i)})}},{key:"updateComponents",value:function(n){var o;if((o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled){var i=n.editedConditionStack,a=i.conditions,s=i.column,l=a.filter(function(f){return f.name===ia}),u=a.filter(function(f){return f.name!==ia});if(l.length>=2||u.length>=3)de(ce(IH||(IH=BNt([`The filter conditions have been applied properly, but couldnt be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnt be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(u[0],s),this.components.get("filter_by_condition2").updateState(u[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(n)}}}},{key:"getIndexesOfComponents",value:function(){var n=[];if(!this.dropdownMenuPlugin)return n;for(var o=this.dropdownMenuPlugin.menu,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return T(a,function(l){T(o.menuItems,function(u,c){u.key===l.getMenuItemDescriptor().key&&n.push(c)})}),n}},{key:"changeComponentsVisibility",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var o=this.dropdownMenuPlugin.menu,i=o.hotMenu,a=i.getPlugin("hiddenRows"),s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];var c=this.getIndexesOfComponents.apply(this,l);n?a.showRows(c):a.hideRows(c),i.render()}}},{key:"hideComponents",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.changeComponentsVisibility.apply(this,[!1].concat(o))}},{key:"showComponents",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.changeComponentsVisibility.apply(this,[!0].concat(o))}},{key:"destroy",value:function(){var n=this;this.enabled&&(this.components.forEach(function(o,i){o!==null&&(o.destroy(),n.components.set(i,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),zs(hi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DH}},{key:"PLUGIN_PRIORITY",get:function(){return $Nt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(re);function yd(e){return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function _H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Cf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_H(Object(r),!0).forEach(function(n){eBt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_H(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eBt(e,t,r){return t=nBt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nBt(e){var t=rBt(e,"string");return yd(t)==="symbol"?t:String(t)}function rBt(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $2="internal-use-in-handsontable",oBt={licenseKey:$2,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function tG(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[pn])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function eG(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function iBt(e){var t,r=e[pn],n=eG(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=tG(e);return Cf(Cf(Cf({},oBt),n),o)}function aBt(e){var t,r=e[pn],n=eG(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=tG(e);return Cf(Cf({},n),o)}function ZO(e){return ZO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZO(e)}function fw(){var e="engine_relationship",t=tr(pn);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function RE(){var e="shared_engine_usage",t=tr(pn);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function sBt(e){var t=e.getSettings(),r=t[pn],n=r==null?void 0:r.engine;if(r===!0||he(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return lBt((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(ZO(n)==="object"&&he(n.hyperformula)){var i=fw(),a=RE().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:$2}),n}return null}function lBt(e,t,r){var n=t[pn],o=iBt(t),i=fw(),a=RE();uBt(e,n.functions),cBt(e,n.language);var s=e.buildEmpty(o);return i.set(s,[r]),a.set(s,[r.guid]),fBt(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function HH(e){var t,r=fw(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function NH(e,t){if(e){var r=fw(),n=r.get(e),o=RE(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function uBt(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){de(a.message)}})}function cBt(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){de(n.message)}}}function fBt(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(s){de(s.message)}}),e.resumeEvaluation())}function hBt(e,t){return(he(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function nG(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function dBt(e){return nG(e)?e.substr(1):e}function pBt(e){return mBt(e)||gBt(e)||rG(e)||yBt()}function yBt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gBt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mBt(e){if(Array.isArray(e))return qO(e)}function BH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function LH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BH(Object(r),!0).forEach(function(n){pg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ai(e){return Ai=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ai(e)}function gs(e,t){return wBt(e)||bBt(e,t)||rG(e,t)||vBt()}function vBt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rG(e,t){if(e){if(typeof e=="string")return qO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qO(e,t)}}function qO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bBt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function wBt(e){if(Array.isArray(e))return e}function ABt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oG(n.key),n)}}function SBt(e,t,r){return t&&VH(e.prototype,t),r&&VH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aa(){return typeof Reflect<"u"&&Reflect.get?aa=Reflect.get.bind():aa=function(e,t,r){var n=CBt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},aa.apply(this,arguments)}function CBt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function OBt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$O(e,t)}function $O(e,t){return $O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},$O(e,t)}function kBt(e){var t=EBt();return function(){var r=go(e),n;if(t){var o=go(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return RBt(this,n)}}function RBt(e,t){if(t&&(Ai(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wi(e)}function Wi(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EBt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},go(e)}function pg(e,t,r){return t=oG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oG(e){var t=TBt(e,"string");return Ai(t)==="symbol"?t:String(t)}function TBt(e,t){if(Ai(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ai(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m0(e,t,r){PBt(e,t),t.set(e,r)}function PBt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ms(e,t,r){var n=iG(e,t,"set");return MBt(e,n,r),r}function MBt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function vs(e,t){var r=iG(e,t,"get");return IBt(e,r)}function iG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function IBt(e,t){return t.get?t.get.call(e):t.value}var pn="formulas",xBt=260,FH="row_move";gt.getSingleton().register("afterNamedExpressionAdded");gt.getSingleton().register("afterNamedExpressionRemoved");gt.getSingleton().register("afterSheetAdded");gt.getSingleton().register("afterSheetRemoved");gt.getSingleton().register("afterSheetRenamed");gt.getSingleton().register("afterFormulasValuesUpdate");var bs=function(e){return e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto"},Ni=new WeakMap,v0=new WeakMap,Yc=new WeakMap,jBt=function(e){OBt(r,e);var t=kBt(r);function r(){var n;ABt(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),m0(Wi(n),Ni,{writable:!0,value:!1}),m0(Wi(n),v0,{writable:!0,value:!1}),m0(Wi(n),Yc,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),pg(Wi(n),"staticRegister",tr("formulas")),pg(Wi(n),"engine",null),pg(Wi(n),"sheetName",null),n}return SBt(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[pn]}},{key:"enablePlugin",value:function(){var n,o=this;if(!this.enabled){if(this.engine=(n=sBt(this.hot))!==null&&n!==void 0?n:this.engine,!this.engine){de("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeUpdateData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterUpdateData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("modifyData",function(){return o.onModifyData.apply(o,arguments)}),this.addHook("modifySourceData",function(){return o.onModifySourceData.apply(o,arguments)}),this.addHook("beforeValidate",function(){return o.onBeforeValidate.apply(o,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return o.onAfterSetSourceDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtCell",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("beforeCreateRow",function(){return o.onBeforeCreateRow.apply(o,arguments)}),this.addHook("beforeCreateCol",function(){return o.onBeforeCreateCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("beforeRemoveCol",function(){return o.onBeforeRemoveCol.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("beforeUndo",function(a){(a==null?void 0:a.actionType)!==FH&&o.engine.undo()}),this.addHook("beforeRedo",function(a){(a==null?void 0:a.actionType)!==FH&&o.engine.redo()}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("beforeAutofill",function(){return o.onBeforeAutofill.apply(o,arguments)}),vs(this,Yc).forEach(function(a){var s=gs(a,2),l=s[0],u=s[1];return o.engine.on(l,u)}),aa(go(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var n=this;vs(this,Yc).forEach(function(o){var i=gs(o,2),a=i[0],s=i[1];return n.engine.off(a,s)}),NH(this.engine,this.hot),this.engine=null,aa(go(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(n){this.engine.updateConfig(aBt(this.hot.getSettings()));var o=this.hot.getSettings()[pn];if(ht(o)&&ht(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!n.data&&this.sheetName===null){var i=this.hot.getSettings()[pn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}aa(go(r.prototype),"updatePlugin",this).call(this,n)}},{key:"destroy",value:function(){var n=this;vs(this,Yc).forEach(function(o){var i,a=gs(o,2),s=a[0],l=a[1];return(i=n.engine)===null||i===void 0?void 0:i.off(s,l)}),ms(this,Yc,null),NH(this.engine,this.hot),this.engine=null,aa(go(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(n,o,i,a,s){return!s&&n>=i?a+(n-i):o}},{key:"toPhysicalRowPosition",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(n,this.hot.toPhysicalRow(n),this.hot.countRows(),this.hot.countSourceRows(),o)}},{key:"toPhysicalColumnPosition",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(n,this.hot.toPhysicalColumn(n),this.hot.countCols(),this.hot.countSourceCols(),o)}},{key:"addSheet",value:function(n,o){if(ht(o)&&!jU(o))return de("The provided data should be an array of arrays."),!1;if(n!=null&&this.engine.doesSheetExist(n))return de("Sheet with the provided name already exists."),!1;try{var i=this.engine.addSheet(n??void 0);return o&&this.engine.setSheetContent(this.engine.getSheetId(i),o),i}catch(a){return de(a.message),!1}}},{key:"switchSheet",value:function(n){if(!this.engine.doesSheetExist(n)){CR("The sheet named `".concat(n,"` does not exist, switch aborted."));return}this.sheetName=n;var o=this.engine.getSheetSerialized(this.sheetId);o.length>0&&this.hot.loadData(o,"".concat(kn(pn),".switchSheet"))}},{key:"getCellType",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,a=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(o);return a!==null&&s!==null?this.engine.getCellType({sheet:i,row:a,col:s}):"EMPTY"}},{key:"isFormulaCellType",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,a=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(o);return a===null||s===null?!1:this.engine.doesCellHaveFormula({sheet:i,row:a,col:s})}},{key:"renderDependentSheets",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=new Set;n.forEach(function(s){var l,u=s==null||(l=s.address)===null||l===void 0?void 0:l.sheet;u!==void 0&&(a.has(u)||a.add(u))}),HH(this.engine).forEach(function(s,l){if((i||l!==o.sheetId)&&a.has(l)){var u;s.render(),(u=s.view)===null||u===void 0||u.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=function(l){var u,c=(u=l==null?void 0:l.address)!==null&&u!==void 0?u:{},f=c.row,h=c.col,p=c.sheet;return ht(p)?"".concat(p,":").concat(f,"x").concat(h):""},s=new Set(i.map(function(l){return a(l)}));n.forEach(function(l){var u,c,f=(u=l.address)!==null&&u!==void 0?u:{},h=f.row,p=f.col,y=ht(h)?o.hot.toVisualRow(h):null,m=ht(p)?o.hot.toVisualColumn(p):null;if(!(y===null||m===null)){var v=l==null||(c=l.address)===null||c===void 0?void 0:c.sheet,w=a(l);if(v!==void 0&&!s.has(w)){var C=HH(o.engine).get(v);if(!C)return;C.validateCell(C.getDataAtCell(y,m),C.getCellMeta(y,m),function(){})}}})}},{key:"syncChangeWithEngine",value:function(n,o,i){var a={row:this.toPhysicalRowPosition(n),col:this.toPhysicalColumnPosition(o),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(a)){de("Not possible to set cell data at ".concat(JSON.stringify(a)));return}return this.engine.setCellContents(a,i)}},{key:"onBeforeValidate",value:function(n,o,i){var a=this.hot.propToCol(i);if(this.isFormulaCellType(o,a)){var s={row:this.hot.toPhysicalRow(o),col:this.hot.toPhysicalColumn(a),sheet:this.sheetId},l=this.engine.getCellValue(s);return Ai(l)==="object"&&l!==null?l.value:l}return n}},{key:"onBeforeAutofill",value:function(n,o,i){var a=this,s=function(c){return LH(LH({},c),{},{sheet:a.sheetId})},l={start:s(o.getTopStartCorner()),end:s(o.getBottomEndCorner())},u={start:s(i.getTopStartCorner()),end:s(i.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(u)===!1?!1:this.engine.getFillRangeData(l,u)}},{key:"onBeforeLoadData",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";i.includes(kn(pn))||ms(this,v0,he(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!i.includes(kn(pn)))if(this.sheetName=hBt(this.engine,this.hot.getSettings()[pn].sheetName),vs(this,v0))this.switchSheet(this.sheetName);else{var a=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,a)){ms(this,Ni,!0);var s=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(s),ms(this,Ni,!1)}}}},{key:"onModifyData",value:function(n,o,i,a){if(!(a!=="get"||vs(this,Ni)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(n),l=this.isFormulaCellType(s,o);if(!l){var u=this.getCellType(s,o);if(u!=="ARRAY"){nG(i.value)&&(i.value=dBt(i.value));return}}var c={row:n,col:this.toPhysicalColumnPosition(o),sheet:this.sheetId},f=this.engine.getCellValue(c),h=Ai(f)==="object"&&f!==null?f.value:f;i.value=h}}},{key:"onModifySourceData",value:function(n,o,i,a){if(!(a!=="get"||vs(this,Ni)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(n),l=this.hot.propToCol(o),u=this.isFormulaCellType(s,l);if(!u){var c=this.getCellType(s,l);if(c!=="ARRAY")return}var f=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(f.width===0&&f.height===0)){var h={row:n,col:this.toPhysicalColumnPosition(l),sheet:this.sheetId};i.value=this.engine.getCellSerialized(h)}}}},{key:"onAfterSetDataAtCell",value:function(n,o){var i=this;if(!bs(o)){var a=[],s=[],l=this.engine.batch(function(){n.forEach(function(u){var c=gs(u,4),f=c[0],h=c[1],p=c[3],y=i.hot.propToCol(h),m=i.hot.toPhysicalRow(f),v=i.hot.toPhysicalColumn(y),w={row:m,col:v,sheet:i.sheetId};m!==null&&v!==null?i.syncChangeWithEngine(f,y,p):a.push([f,y,p]),s.push({address:w})})});a.length&&this.hot.addHookOnce("afterChange",function(){var u=i.engine.batch(function(){a.forEach(function(c){var f=gs(c,3),h=f[0],p=f[1],y=f[2];i.syncChangeWithEngine(h,p,y)})});i.renderDependentSheets(u,!0)}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(n,o){var i=this;if(!bs(o)){var a=[],s=[];n.forEach(function(l){var u=gs(l,4),c=u[0],f=u[1],h=u[3],p=i.hot.propToCol(f);if(Nn(p)){var y={row:c,col:i.toPhysicalColumnPosition(p),sheet:i.sheetId};if(!i.engine.isItPossibleToSetCellContents(y)){de("Not possible to set source cell data at ".concat(JSON.stringify(y)));return}s.push({address:y}),a.push.apply(a,pBt(i.engine.setCellContents(y,h)))}}),this.renderDependentSheets(a),this.validateDependentCells(a,s)}}},{key:"onBeforeCreateRow",value:function(n,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(n),o]))return!1}},{key:"onBeforeCreateCol",value:function(n,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(n),o]))return!1}},{key:"onBeforeRemoveRow",value:function(n,o,i){var a=this,s=i.every(function(l){return a.engine.isItPossibleToRemoveRows(a.sheetId,[l,1])});return s===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(n,o,i){var a=this,s=i.every(function(l){return a.engine.isItPossibleToRemoveColumns(a.sheetId,[l,1])});return s===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(n,o,i){if(!bs(i)){var a=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(n),o]);this.renderDependentSheets(a)}}},{key:"onAfterCreateCol",value:function(n,o,i){if(!bs(i)){var a=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(n),o]);this.renderDependentSheets(a)}}},{key:"onAfterRemoveRow",value:function(n,o,i,a){var s=this;if(!bs(a)){var l=i.sort().reverse(),u=this.engine.batch(function(){l.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(u)}}},{key:"onAfterRemoveCol",value:function(n,o,i,a){var s=this;if(!bs(a)){var l=i.sort().reverse(),u=this.engine.batch(function(){l.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(u)}}},{key:"onAfterDetachChild",value:function(n,o,i){var a,s=this;ms(this,Ni,!0);var l=this.hot.getSourceDataArray(i,0,i+(((a=o.__children)===null||a===void 0?void 0:a.length)||0),this.hot.countSourceCols());ms(this,Ni,!1),l.forEach(function(u,c){u.forEach(function(f,h){s.engine.setCellContents({col:h,row:i+c,sheet:s.sheetId},[[f]])})})}},{key:"onEngineValuesUpdated",value:function(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}},{key:"onEngineNamedExpressionsAdded",value:function(n,o){this.hot.runHooks("afterNamedExpressionAdded",n,o)}},{key:"onEngineNamedExpressionsRemoved",value:function(n,o){this.hot.runHooks("afterNamedExpressionRemoved",n,o)}},{key:"onEngineSheetAdded",value:function(n){this.hot.runHooks("afterSheetAdded",n)}},{key:"onEngineSheetRenamed",value:function(n,o){this.hot.runHooks("afterSheetRenamed",n,o)}},{key:"onEngineSheetRemoved",value:function(n,o){this.hot.runHooks("afterSheetRemoved",n,o)}}],[{key:"PLUGIN_KEY",get:function(){return pn}},{key:"PLUGIN_PRIORITY",get:function(){return xBt}}]),r}(re);function DBt(e,t){return BBt(e)||NBt(e,t)||HBt(e,t)||_Bt()}function _Bt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HBt(e,t){if(e){if(typeof e=="string")return WH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WH(e,t)}}function WH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NBt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function BBt(e){if(Array.isArray(e))return e}function LBt(e){return{key:"hidden_columns_hide",name:function(){var t=this.getSelectedLast(),r=0;if(Array.isArray(t)){var n=DBt(t,4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(gb,r)},callback:function(){for(var t=this.getSelectedRangeLast(),r=t.from,n=t.to,o=Math.max(Math.min(r.col,n.col),0),i=Math.max(r.col,n.col),a=[],s=o;s<=i;s+=1)a.push(s);e.hideColumns(a);var l=a[a.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(l,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Sy(e){return UBt(e)||WBt(e)||FBt(e)||VBt()}function VBt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FBt(e,t){if(e){if(typeof e=="string")return t1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t1(e,t)}}function WBt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UBt(e){if(Array.isArray(e))return t1(e)}function t1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YBt(e){var t=[];return{key:"hidden_columns_show",name:function(){var r=t.length>1?1:0;return this.getTranslatedPhrase(mb,r)},callback:function(){var r,n;if(t.length!==0){var o=t[0],i=t[t.length-1];o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&r!==void 0?r:0,i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&n!==void 0?n:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countCols();a||this.selectColumns(o,i)}},disabled:!1,hidden:function(){var r=this,n=Gt(e.getHiddenColumns(),function(w){return r.toPhysicalColumn(w)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,a=o.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(i),u=s.getRenderableFromVisualIndex(a),c=s.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,p=u-l+1;if(h>p){var y=c.slice(i,a+1);f.push.apply(f,Sy(y.filter(function(w){return n.includes(w)})))}}else if(l===0&&l<i)f.push.apply(f,Sy(c.slice(0,i)));else if(l===null)f.push.apply(f,Sy(c.slice(0,this.countCols())));else{var m=this.countCols()-1,v=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));u===v&&m>a&&f.push.apply(f,Sy(c.slice(a+1)))}return T(f,function(w){t.push(r.toVisualColumn(w))}),t.length===0}}}function Tu(e){return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function GBt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QBt(n.key),n)}}function zBt(e,t,r){return t&&UH(e.prototype,t),r&&UH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QBt(e){var t=KBt(e,"string");return Tu(t)==="symbol"?t:String(t)}function KBt(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sa(){return typeof Reflect<"u"&&Reflect.get?sa=Reflect.get.bind():sa=function(e,t,r){var n=XBt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},sa.apply(this,arguments)}function XBt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function JBt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e1(e,t)}function e1(e,t){return e1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},e1(e,t)}function ZBt(e){var t=$Bt();return function(){var r=mo(e),n;if(t){var o=mo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qBt(this,n)}}function qBt(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n1(e)}function n1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Bt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mo(e)}function YH(e,t,r){tLt(e,t),t.set(e,r)}function tLt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xn(e,t){var r=aG(e,t,"get");return eLt(e,r)}function eLt(e,t){return t.get?t.get.call(e):t.value}function Gc(e,t,r){var n=aG(e,t,"set");return nLt(e,n,r),r}function aG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function nLt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}gt.getSingleton().register("beforeHideColumns");gt.getSingleton().register("afterHideColumns");gt.getSingleton().register("beforeUnhideColumns");gt.getSingleton().register("afterUnhideColumns");var b0="hiddenColumns",rLt=310,kr=new WeakMap,Rr=new WeakMap,oLt=function(e){JBt(r,e);var t=ZBt(r);function r(){var n;GBt(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),YH(n1(n),kr,{writable:!0,value:{}}),YH(n1(n),Rr,{writable:!0,value:null}),n}return zBt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[b0]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[b0];zt(o)&&(Gc(this,kr,o),he(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),Gc(this,Rr,new Pv),xn(this,Rr).addLocalHook("init",function(){return n.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,xn(this,Rr)),this.addHook("afterContextMenuDefaultOptions",function(){return n.onAfterContextMenuDefaultOptions.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(i,a,s){return n.onAfterGetCellMeta(i,a,s)}),this.addHook("modifyColWidth",function(i,a){return n.onModifyColWidth(i,a)}),this.addHook("afterGetColHeader",function(){return n.onAfterGetColHeader.apply(n,arguments)}),this.addHook("modifyCopyableRange",function(i){return n.onModifyCopyableRange(i)}),sa(mo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sa(mo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Gc(this,kr,{}),sa(mo(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(n){var o=this,i=this.getHiddenColumns(),a=this.isValidConfig(n),s=i,l=xn(this,Rr).getValues().slice(),u=n.length>0;if(a&&u){var c=n.map(function(h){return o.hot.toPhysicalColumn(h)});T(c,function(h){l[h]=!1}),s=_e(l,function(h,p,y){return p&&h.push(o.hot.toVisualColumn(y)),h},[])}var f=this.hot.runHooks("beforeUnhideColumns",i,s,a&&u);f!==!1&&(a&&u&&xn(this,Rr).setValues(l),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",i,s,a&&u,a&&s.length<i.length))}},{key:"showColumn",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.showColumns(o)}},{key:"hideColumns",value:function(n){var o=this,i=this.getHiddenColumns(),a=this.isValidConfig(n),s=i;a&&(s=Array.from(new Set(i.concat(n))));var l=this.hot.runHooks("beforeHideColumns",i,s,a);l!==!1&&(a&&this.hot.batchExecution(function(){T(n,function(u){xn(o,Rr).setValueAtIndex(o.hot.toPhysicalColumn(u),!0)})},!0),this.hot.runHooks("afterHideColumns",i,s,a,a&&s.length>i.length))}},{key:"hideColumn",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.hideColumns(o)}},{key:"getHiddenColumns",value:function(){var n=this;return Gt(xn(this,Rr).getHiddenIndexes(),function(o){return n.hot.toVisualColumn(o)})}},{key:"isHidden",value:function(n){return xn(this,Rr).getValueAtIndex(this.hot.toPhysicalColumn(n))||!1}},{key:"isValidConfig",value:function(n){var o=this.hot.countCols();return Array.isArray(n)&&n.length>0?n.every(function(i){return Number.isInteger(i)&&i>=0&&i<o}):!1}},{key:"resetCellsMeta",value:function(){T(this.hot.getCellsMeta(),function(n){n&&(n.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(n,o){if(this.isHidden(o))return 0;if(xn(this,kr).indicators&&(this.isHidden(o+1)||this.isHidden(o-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}},{key:"onAfterGetCellMeta",value:function(n,o,i){if(xn(this,kr).copyPasteEnabled===!1&&this.isHidden(o)&&(i.skipColumnOnPaste=!0),this.isHidden(o-1))i.className=i.className||"",i.className.indexOf("afterHiddenColumn")===-1&&(i.className+=" afterHiddenColumn");else if(i.className){var a=i.className.split(" ");if(a.length>0){var s=a.indexOf("afterHiddenColumn");s>-1&&a.splice(s,1),i.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(n){var o=this;if(xn(this,kr).copyPasteEnabled)return n;var i=[],a=function(s,l,u,c){i.push({startRow:s,endRow:l,startCol:u,endCol:c})};return T(n,function(s){var l=!0,u=0;Ct(s.startCol,s.endCol,function(c){o.isHidden(c)?(l||a(s.startRow,s.endRow,u,c-1),l=!0):(l&&(u=c),c===s.endCol&&a(s.startRow,s.endRow,u,c),l=!1)})}),i}},{key:"onAfterGetColHeader",value:function(n,o){if(!(!xn(this,kr).indicators||n<0)){var i=[];n>=1&&this.isHidden(n-1)&&i.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&i.push("beforeHiddenColumn"),q(o,i)}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:Jt},LBt(this),YBt(this))}},{key:"onMapInit",value:function(){Array.isArray(xn(this,kr).columns)&&this.hideColumns(xn(this,kr).columns)}},{key:"destroy",value:function(){Gc(this,kr,null),Gc(this,Rr,null),sa(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return b0}},{key:"PLUGIN_PRIORITY",get:function(){return rLt}}]),r}(re);function iLt(e,t){return uLt(e)||lLt(e,t)||sLt(e,t)||aLt()}function aLt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sLt(e,t){if(e){if(typeof e=="string")return GH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GH(e,t)}}function GH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lLt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function uLt(e){if(Array.isArray(e))return e}function cLt(e){return{key:"hidden_rows_hide",name:function(){var t=this.getSelectedLast(),r=0;if(Array.isArray(t)){var n=iLt(t,3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(vb,r)},callback:function(){for(var t=this.getSelectedRangeLast(),r=t.from,n=t.to,o=Math.max(Math.min(r.row,n.row),0),i=Math.max(r.row,n.row),a=[],s=o;s<=i;s+=1)a.push(s);e.hideRows(a);var l=a[a.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(l,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Cy(e){return pLt(e)||dLt(e)||hLt(e)||fLt()}function fLt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hLt(e,t){if(e){if(typeof e=="string")return r1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r1(e,t)}}function dLt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pLt(e){if(Array.isArray(e))return r1(e)}function r1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yLt(e){var t=[];return{key:"hidden_rows_show",name:function(){var r=t.length>1?1:0;return this.getTranslatedPhrase(bb,r)},callback:function(){var r,n;if(t.length!==0){var o=t[0],i=t[t.length-1];o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&r!==void 0?r:0,i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&n!==void 0?n:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countRows();a||this.selectRows(o,i)}},disabled:!1,hidden:function(){var r=this,n=Gt(e.getHiddenRows(),function(w){return r.toPhysicalRow(w)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,a=o.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(i),u=s.getRenderableFromVisualIndex(a),c=s.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,p=u-l+1;if(h>p){var y=c.slice(i,a+1);f.push.apply(f,Cy(y.filter(function(w){return n.includes(w)})))}}else if(l===0&&l<i)f.push.apply(f,Cy(c.slice(0,i)));else if(l===null)f.push.apply(f,Cy(c.slice(0,this.countRows())));else{var m=this.countRows()-1,v=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));u===v&&m>a&&f.push.apply(f,Cy(c.slice(a+1)))}return T(f,function(w){t.push(r.toVisualRow(w))}),t.length===0}}}function Pu(e){return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function gLt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vLt(n.key),n)}}function mLt(e,t,r){return t&&zH(e.prototype,t),r&&zH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vLt(e){var t=bLt(e,"string");return Pu(t)==="symbol"?t:String(t)}function bLt(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function la(){return typeof Reflect<"u"&&Reflect.get?la=Reflect.get.bind():la=function(e,t,r){var n=wLt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},la.apply(this,arguments)}function wLt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function ALt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o1(e,t)}function o1(e,t){return o1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},o1(e,t)}function SLt(e){var t=OLt();return function(){var r=vo(e),n;if(t){var o=vo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return CLt(this,n)}}function CLt(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return i1(e)}function i1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OLt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vo(e)}function QH(e,t,r){kLt(e,t),t.set(e,r)}function kLt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gn(e,t){var r=sG(e,t,"get");return RLt(e,r)}function RLt(e,t){return t.get?t.get.call(e):t.value}function zc(e,t,r){var n=sG(e,t,"set");return ELt(e,n,r),r}function sG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ELt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}gt.getSingleton().register("beforeHideRows");gt.getSingleton().register("afterHideRows");gt.getSingleton().register("beforeUnhideRows");gt.getSingleton().register("afterUnhideRows");var w0="hiddenRows",TLt=320,zr=new WeakMap,Er=new WeakMap,PLt=function(e){ALt(r,e);var t=SLt(r);function r(){var n;gLt(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),QH(i1(n),zr,{writable:!0,value:{}}),QH(i1(n),Er,{writable:!0,value:null}),n}return mLt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[w0]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[w0];zt(o)&&(zc(this,zr,o),he(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),zc(this,Er,new Pv),Gn(this,Er).addLocalHook("init",function(){return n.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Gn(this,Er)),this.addHook("afterContextMenuDefaultOptions",function(){return n.onAfterContextMenuDefaultOptions.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(i,a,s){return n.onAfterGetCellMeta(i,a,s)}),this.addHook("modifyRowHeight",function(i,a){return n.onModifyRowHeight(i,a)}),this.addHook("afterGetRowHeader",function(){return n.onAfterGetRowHeader.apply(n,arguments)}),this.addHook("modifyCopyableRange",function(i){return n.onModifyCopyableRange(i)}),la(vo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),la(vo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),zc(this,zr,{}),la(vo(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(n){var o=this,i=this.getHiddenRows(),a=this.isValidConfig(n),s=i,l=Gn(this,Er).getValues().slice(),u=n.length>0;if(a&&u){var c=n.map(function(h){return o.hot.toPhysicalRow(h)});T(c,function(h){l[h]=!1}),s=_e(l,function(h,p,y){return p&&h.push(o.hot.toVisualRow(y)),h},[])}var f=this.hot.runHooks("beforeUnhideRows",i,s,a&&u);f!==!1&&(a&&u&&Gn(this,Er).setValues(l),this.hot.runHooks("afterUnhideRows",i,s,a&&u,a&&s.length<i.length))}},{key:"showRow",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.showRows(o)}},{key:"hideRows",value:function(n){var o=this,i=this.getHiddenRows(),a=this.isValidConfig(n),s=i;a&&(s=Array.from(new Set(i.concat(n))));var l=this.hot.runHooks("beforeHideRows",i,s,a);l!==!1&&(a&&this.hot.batchExecution(function(){T(n,function(u){Gn(o,Er).setValueAtIndex(o.hot.toPhysicalRow(u),!0)})},!0),this.hot.runHooks("afterHideRows",i,s,a,a&&s.length>i.length))}},{key:"hideRow",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.hideRows(o)}},{key:"getHiddenRows",value:function(){var n=this;return Gt(Gn(this,Er).getHiddenIndexes(),function(o){return n.hot.toVisualRow(o)})}},{key:"isHidden",value:function(n){return Gn(this,Er).getValueAtIndex(this.hot.toPhysicalRow(n))||!1}},{key:"isValidConfig",value:function(n){var o=this.hot.countRows();return Array.isArray(n)&&n.length>0?n.every(function(i){return Number.isInteger(i)&&i>=0&&i<o}):!1}},{key:"resetCellsMeta",value:function(){T(this.hot.getCellsMeta(),function(n){n&&(n.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(n,o){return this.isHidden(o)?0:n}},{key:"onAfterGetCellMeta",value:function(n,o,i){if(Gn(this,zr).copyPasteEnabled===!1&&this.isHidden(n)&&(i.skipRowOnPaste=!0),this.isHidden(n-1))i.className=i.className||"",i.className.indexOf("afterHiddenRow")===-1&&(i.className+=" afterHiddenRow");else if(i.className){var a=i.className.split(" ");if(a.length>0){var s=a.indexOf("afterHiddenRow");s>-1&&a.splice(s,1),i.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(n){var o=this;if(Gn(this,zr).copyPasteEnabled)return n;var i=[],a=function(s,l,u,c){i.push({startRow:s,endRow:l,startCol:u,endCol:c})};return T(n,function(s){var l=!0,u=0;Ct(s.startRow,s.endRow,function(c){o.isHidden(c)?(l||a(u,c-1,s.startCol,s.endCol),l=!0):(l&&(u=c),c===s.endRow&&a(u,c,s.startCol,s.endCol),l=!1)})}),i}},{key:"onAfterGetRowHeader",value:function(n,o){if(!(!Gn(this,zr).indicators||n<0)){var i=[];n>=1&&this.isHidden(n-1)&&i.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&i.push("beforeHiddenRow"),q(o,i)}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:Jt},cLt(this),yLt(this))}},{key:"onMapInit",value:function(){Array.isArray(Gn(this,zr).rows)&&this.hideRows(Gn(this,zr).rows)}},{key:"destroy",value:function(){zc(this,zr,null),zc(this,Er,null),la(vo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return w0}},{key:"PLUGIN_PRIORITY",get:function(){return TLt}}]),r}(re);function MLt(e,t){return DLt(e)||jLt(e,t)||xLt(e,t)||ILt()}function ILt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xLt(e,t){if(e){if(typeof e=="string")return KH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KH(e,t)}}function KH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jLt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function DLt(e){if(Array.isArray(e))return e}function _Lt(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(zv)},callback:function(t,r){var n=MLt(r,1),o=n[0].start.col;e.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),r=!1;return(t===void 0||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function HLt(e,t){return VLt(e)||LLt(e,t)||BLt(e,t)||NLt()}function NLt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BLt(e,t){if(e){if(typeof e=="string")return XH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XH(e,t)}}function XH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LLt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function VLt(e){if(Array.isArray(e))return e}function FLt(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(Qv)},callback:function(t,r){var n=HLt(r,1),o=n[0].start.col;e.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),r=!1;return(t===void 0||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function Mu(e){return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function WLt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YLt(n.key),n)}}function ULt(e,t,r){return t&&JH(e.prototype,t),r&&JH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YLt(e){var t=GLt(e,"string");return Mu(t)==="symbol"?t:String(t)}function GLt(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qs(){return typeof Reflect<"u"&&Reflect.get?Qs=Reflect.get.bind():Qs=function(e,t,r){var n=zLt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Qs.apply(this,arguments)}function zLt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=di(e),e!==null););return e}function QLt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a1(e,t)}function a1(e,t){return a1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},a1(e,t)}function KLt(e){var t=JLt();return function(){var r=di(e),n;if(t){var o=di(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return XLt(this,n)}}function XLt(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lG(e)}function lG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JLt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function di(e){return di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},di(e)}gt.getSingleton().register("beforeColumnFreeze");gt.getSingleton().register("afterColumnFreeze");gt.getSingleton().register("beforeColumnUnfreeze");gt.getSingleton().register("afterColumnUnfreeze");var ZH="manualColumnFreeze",ZLt=110,Qc=new WeakMap,qLt=function(e){QLt(r,e);var t=KLt(r);function r(n){var o;return WLt(this,r),o=t.call(this,n),Qc.set(lG(o),{afterFirstUse:!1}),o}return ULt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ZH]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return n.addContextMenuEntry(o)}),this.addHook("beforeColumnMove",function(o,i){return n.onBeforeColumnMove(o,i)}),Qs(di(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=Qc.get(this);n.afterFirstUse=!1,Qs(di(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qs(di(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(n){var o=Qc.get(this),i=this.hot.getSettings(),a=i.fixedColumnsStart<this.hot.countCols()&&n>i.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",n,a);s!==!1&&(a&&(this.hot.columnIndexMapper.moveIndexes(n,i.fixedColumnsStart),i._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",n,a))}},{key:"unfreezeColumn",value:function(n){var o=Qc.get(this),i=this.hot.getSettings(),a=i.fixedColumnsStart>0&&n<=i.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",n,a);s!==!1&&(a&&(i._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(n,i.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",n,a))}},{key:"addContextMenuEntry",value:function(n){n.items.push({name:"---------"},_Lt(this),FLt(this))}},{key:"onBeforeColumnMove",value:function(n,o){var i=Qc.get(this);if(i.afterFirstUse){var a=this.hot.getSettings().fixedColumnsStart;if(o<a||n.some(function(s){return s<a}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return ZH}},{key:"PLUGIN_PRIORITY",get:function(){return ZLt}}]),r}(re);function gd(e){return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function $Lt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eVt(n.key),n)}}function tVt(e,t,r){return t&&qH(e.prototype,t),r&&qH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eVt(e){var t=nVt(e,"string");return gd(t)==="symbol"?t:String(t)}function nVt(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A0=0,$H=1,tN=2,ws="px",rVt=function(){function e(t){$Lt(this,e),this.hot=t,this._element=null,this.state=A0,this.inlineProperty=t.isRtl()?"right":"left"}return tVt(e,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=tN}},{key:"build",value:function(){this.state===A0&&(this._element=this.hot.rootDocument.createElement("div"),this.state=$H)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=A0}},{key:"isAppended",value:function(){return this.state===tN}},{key:"isBuilt",value:function(){return this.state>=$H}},{key:"setPosition",value:function(t,r){Nn(t)&&(this._element.style.top=t+ws),Nn(r)&&(this._element.style[this.inlineProperty]=r+ws)}},{key:"getPosition",value:function(){var t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}},{key:"setSize",value:function(t,r){Nn(t)&&(this._element.style.width=t+ws),Nn(r)&&(this._element.style.height=r+ws)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,r){Nn(t)&&(this._element.style.marginTop=t+ws),Nn(r)&&(this._element.style["margin".concat(kn(this.inlineProperty))]=r+ws)}},{key:"getOffset",value:function(){var t=this._element.style,r="margin".concat(kn(this.inlineProperty));return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[r]?parseInt(t[r],10):0}}}]),e}();const uG=rVt;function Iu(e){return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iu(e)}function oVt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aVt(n.key),n)}}function iVt(e,t,r){return t&&eN(e.prototype,t),r&&eN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aVt(e){var t=sVt(e,"string");return Iu(t)==="symbol"?t:String(t)}function sVt(e,t){if(Iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yg(){return typeof Reflect<"u"&&Reflect.get?yg=Reflect.get.bind():yg=function(e,t,r){var n=lVt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},yg.apply(this,arguments)}function lVt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xu(e),e!==null););return e}function uVt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s1(e,t)}function s1(e,t){return s1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},s1(e,t)}function cVt(e){var t=dVt();return function(){var r=xu(e),n;if(t){var o=xu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fVt(this,n)}}function fVt(e,t){if(t&&(Iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hVt(e)}function hVt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dVt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xu(e)}var pVt="ht__manualColumnMove--backlight",yVt=function(e){uVt(r,e);var t=cVt(r);function r(){return oVt(this,r),t.apply(this,arguments)}return iVt(r,[{key:"build",value:function(){yg(xu(r.prototype),"build",this).call(this),q(this._element,pVt)}}]),r}(uG);const gVt=yVt;function ju(e){return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function mVt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bVt(n.key),n)}}function vVt(e,t,r){return t&&nN(e.prototype,t),r&&nN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bVt(e){var t=wVt(e,"string");return ju(t)==="symbol"?t:String(t)}function wVt(e,t){if(ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gg(){return typeof Reflect<"u"&&Reflect.get?gg=Reflect.get.bind():gg=function(e,t,r){var n=AVt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},gg.apply(this,arguments)}function AVt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Du(e),e!==null););return e}function SVt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l1(e,t)}function l1(e,t){return l1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},l1(e,t)}function CVt(e){var t=RVt();return function(){var r=Du(e),n;if(t){var o=Du(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OVt(this,n)}}function OVt(e,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kVt(e)}function kVt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RVt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Du(e){return Du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Du(e)}var EVt="ht__manualColumnMove--guideline",TVt=function(e){SVt(r,e);var t=CVt(r);function r(){return mVt(this,r),t.apply(this,arguments)}return vVt(r,[{key:"build",value:function(){gg(Du(r.prototype),"build",this).call(this),q(this._element,EVt)}}]),r}(uG);const PVt=TVt;function _u(e){return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function MVt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xVt(n.key),n)}}function IVt(e,t,r){return t&&rN(e.prototype,t),r&&rN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xVt(e){var t=jVt(e,"string");return _u(t)==="symbol"?t:String(t)}function jVt(e,t){if(_u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ua(){return typeof Reflect<"u"&&Reflect.get?ua=Reflect.get.bind():ua=function(e,t,r){var n=DVt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ua.apply(this,arguments)}function DVt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function _Vt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u1(e,t)}function u1(e,t){return u1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},u1(e,t)}function HVt(e){var t=BVt();return function(){var r=bo(e),n;if(t){var o=bo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return NVt(this,n)}}function NVt(e,t){if(t&&(_u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c1(e)}function c1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BVt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bo(e)}gt.getSingleton().register("beforeColumnMove");gt.getSingleton().register("afterColumnMove");var S0="manualColumnMove",LVt=120,Yo=new WeakMap,oN="ht__manualColumnMove",Oy="show-ui",C0="on-moving--columns",O0="after-selection--columns",VVt=function(e){_Vt(r,e);var t=HVt(r);function r(n){var o;return MVt(this,r),o=t.call(this,n),Yo.set(c1(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new Re(c1(o)),o.backlight=new gVt(n),o.guideline=new PVt(n),o}return IVt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[S0]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return n.onBeforeOnCellMouseOver.apply(n,arguments)}),this.addHook("afterScrollVertically",function(){return n.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,oN),ua(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ua(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Bt(this.hot.rootElement,oN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ua(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(n,o){return this.moveColumns([n],o)}},{key:"moveColumns",value:function(n,o){var i=Yo.get(this),a=i.cachedDropIndex,s=this.isMovePossible(n,o),l=this.hot.runHooks("beforeColumnMove",n,o,a,s);if(i.cachedDropIndex=void 0,l!==!1){s&&this.hot.columnIndexMapper.moveIndexes(n,o);var u=s&&this.isColumnOrderChanged(n,o);return this.hot.runHooks("afterColumnMove",n,o,a,s,u),u}}},{key:"dragColumn",value:function(n,o){return this.dragColumns([n],o)}},{key:"dragColumns",value:function(n,o){var i=this.countFinalIndex(n,o),a=Yo.get(this);return a.cachedDropIndex=o,this.moveColumns(n,i)}},{key:"isMovePossible",value:function(n,o){var i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),a=n.length+o>i,s=o<0,l=n.some(function(c){return c<0}),u=n.some(function(c){return c>=i});return!(a||s||l||u)}},{key:"isColumnOrderChanged",value:function(n,o){return n.some(function(i,a){return i-a!==o})}},{key:"countFinalIndex",value:function(n,o){var i=_e(n,function(a,s){return s<o&&(a+=1),a},0);return o-i}},{key:"getColumnsWidth",value:function(n,o){for(var i=this.hot.columnIndexMapper,a=0,s=n;s<=o;s+=1){var l=i.getRenderableFromVisualIndex(s);s<0?a+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:l!==null&&(a+=this.hot.view._wt.wtTable.getStretchedColumnWidth(l)||0)}return a}},{key:"moveBySettingsOrLoad",value:function(){var n=this.hot.getSettings()[S0];if(Array.isArray(n))this.moveColumns(n,0);else if(n!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsStart",value:function(n){return n<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",n),n.value?n.value:[]}},{key:"prepareColumnsToMoving",value:function(n,o){var i=[];return Ct(n,o,function(a){i.push(a)}),i}},{key:"refreshPositions",value:function(){var n=Yo.get(this),o=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(n.hoveredColumn)&&o>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1));var i=this.hot.view._wt.wtTable,a=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof a.scrollX=="number"?a.scrollX:a.scrollLeft,l=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,n.hoveredColumn-1),u=i.hider.offsetWidth,c=i.TBODY.offsetLeft,f=this.backlight.getOffset().start,h=this.backlight.getSize().width,p=0,y=0;if(this.hot.isRtl()){var m=this.hot.rootWindow,v=fe(this.hot.rootElement),w=m.innerWidth-n.rootElementOffset-v;y=m.innerWidth-n.target.eventPageX-w-(a.scrollX===void 0?s:0)}else y=n.target.eventPageX-(n.rootElementOffset-(a.scrollX===void 0?s:0));if(n.hasRowHeaders&&(p=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(n.hoveredColumn)&&(l+=s),l+=p,n.hoveredColumn<0)n.fixedColumnsStart>0?n.target.col=0:n.target.col=o>0?o-1:o;else if(n.target.TD.offsetWidth/2+l<=y){var C=n.hoveredColumn>=n.countCols?n.countCols-1:n.hoveredColumn;n.target.col=C+1,l+=n.target.TD.offsetWidth}else n.target.col=n.hoveredColumn;var A=y,D=l;y+h+f>=u?A=u-h-f:y+f<c+p&&(A=c+p+Math.abs(f)),l>=u-1?D=u-1:D===0?D=1:a.scrollX!==void 0&&n.hoveredColumn<n.fixedColumnsStart&&(D-=n.rootElementOffset<=a.scrollX?n.rootElementOffset:0),this.backlight.setPosition(null,A),this.guideline.setPosition(null,D)}},{key:"registerEvents",value:function(){var n=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(i){return n.onMouseMove(i)}),this.eventManager.addEventListener(o,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i,a){var s=this.hot.view._wt.wtTable,l=this.hot.selection.isSelectedByColumnHeader(),u=this.hot.getSelectedRangeLast(),c=Yo.get(this),f=Dt(n.target,"sortAction");if(!u||!l||c.pressed||n.button!==0||f){c.pressed=!1,c.columnsToMove.length=0,Bt(this.hot.rootElement,[C0,Oy]);return}var h=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&p&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var y=u.from,m=u.to,v=Math.min(y.col,m.col),w=Math.max(y.col,m.col);if(o.row<0&&o.col>=v&&o.col<=w){a.column=!0,c.pressed=!0,c.target.eventPageX=n.pageX,c.target.eventOffsetX=n.offsetX,c.hoveredColumn=o.col,c.target.TD=i,c.target.col=o.col,c.columnsToMove=this.prepareColumnsToMoving(v,w),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Le(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,A=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,D=o.col<c.fixedColumnsStart,E=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),G=Math.abs(n.offsetX-(this.hot.isRtl()?n.target.offsetWidth:0)),K=this.getColumnsWidth(v,o.col-1)+G,nt=this.getColumnsWidth(C,v-1)+(D?E:0)+K;this.backlight.setPosition(A,nt),this.backlight.setSize(this.getColumnsWidth(v,w),s.hider.offsetHeight-A),this.backlight.setOffset(null,-K),q(this.hot.rootElement,C0)}else Bt(this.hot.rootElement,O0),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(n){var o=Yo.get(this);if(o.pressed){if(n.target===this.backlight.element){var i=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(i)})}o.target.eventPageX=n.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(n,o,i,a){var s=this.hot.getSelectedRangeLast(),l=Yo.get(this);!s||!l.pressed||(l.columnsToMove.indexOf(o.col)>-1?Bt(this.hot.rootElement,Oy):q(this.hot.rootElement,Oy),a.row=!0,a.column=!0,a.cell=!0,l.hoveredColumn=o.col,l.target.TD=i)}},{key:"onMouseUp",value:function(){var n=Yo.get(this),o=n.target.col,i=n.columnsToMove.length;if(n.hoveredColumn=void 0,n.pressed=!1,n.backlightWidth=0,Bt(this.hot.rootElement,[C0,Oy,O0]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,O0),!(i<1||o===void 0)){var a=n.columnsToMove[0],s=this.hot.toPhysicalColumn(a),l=this.dragColumns(n.columnsToMove,o);if(n.columnsToMove.length=0,l===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var u=this.hot.toVisualColumn(s),c=u+i-1;this.hot.selectColumns(u,c)}}}},{key:"onAfterScrollVertically",value:function(){var n=this.hot.view._wt.wtTable,o=n.getColumnHeaderHeight(0)+1,i=n.holder.scrollTop,a=o+i;this.backlight.setPosition(a),this.backlight.setSize(null,n.hider.offsetHeight-a)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ua(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return S0}},{key:"PLUGIN_PRIORITY",get:function(){return LVt}}]),r}(re);function Hu(e){return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function FVt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UVt(n.key),n)}}function WVt(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UVt(e){var t=YVt(e,"string");return Hu(t)==="symbol"?t:String(t)}function YVt(e,t){if(Hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(e,t,r){var n=GVt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ca.apply(this,arguments)}function GVt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function zVt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f1(e,t)}function f1(e,t){return f1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},f1(e,t)}function QVt(e){var t=XVt();return function(){var r=wo(e),n;if(t){var o=wo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KVt(this,n)}}function KVt(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h1(e)}function h1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XVt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wo(e)}var ky="manualColumnResize",JVt=130,aN="manualColumnWidths",k0=new WeakMap,ZVt=function(e){zVt(r,e);var t=QVt(r);function r(n){var o;FVt(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Re(h1(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,k0.set(h1(o),{config:void 0}),q(o.handle,"manualColumnResizer"),q(o.guide,"manualColumnResizerGuide"),o}return WVt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[ky]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.columnWidthsMap=new Oi,this.columnWidthsMap.addLocalHook("init",function(){return n.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(o,i){return n.onModifyColWidth(o,i)}),this.addHook("beforeStretchingColumnWidth",function(o,i){return n.onBeforeStretchingColumnWidth(o,i)}),this.addHook("beforeColumnResize",function(o,i,a){return n.onBeforeColumnResize(o,i,a)}),this.bindEvents(),ca(wo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ca(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=k0.get(this);n.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),ca(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",aN,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var n={};return this.hot.runHooks("persistentStateLoad",aN,n),n.value}},{key:"setManualSize",value:function(n,o){var i=Math.max(o,20),a=this.hot.toPhysicalColumn(n);return this.columnWidthsMap.setValueAtIndex(a,i),i}},{key:"clearManualSize",value:function(n){var o=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(o,null)}},{key:"onMapInit",value:function(){var n=this,o=k0.get(this),i=this.hot.getSettings()[ky],a=this.loadManualColumnWidths();typeof a<"u"?this.hot.batchExecution(function(){a.forEach(function(s,l){n.columnWidthsMap.setValueAtIndex(l,s)})},!0):Array.isArray(i)?(this.hot.batchExecution(function(){i.forEach(function(s,l){n.columnWidthsMap.setValueAtIndex(l,s)})},!0),o.config=i):i===!0&&Array.isArray(o.config)&&this.hot.batchExecution(function(){o.config.forEach(function(s,l){n.columnWidthsMap.setValueAtIndex(l,s)})},!0)}},{key:"setupHandlePosition",value:function(n){var o=this;if(n.parentNode){this.currentTH=n;var i=this.hot.view._wt,a=i.wtTable.getCoords(this.currentTH),s=a.col;if(!(s<0)){var l=ke(this.currentTH),u=this.currentTH.getBoundingClientRect(),c=s<i.getSetting("fixedColumnsStart"),f;c&&(f=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,a.row,a.col)),f||(f=i.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,a.row,a.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){var p=this.hot.getSelectedRange();T(p,function(y){var m=y.getTopStartCorner().col,v=y.getBottomEndCorner().col;Ct(m,v,function(w){o.selectedCols.includes(w)||o.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=f.start-6,this.startWidth=parseInt(u.width,10),this.handle.style.top="".concat(f.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(l,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var n=parseInt(ke(this.handle),10),o=parseInt(this.handle.style.top,10)+n,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);q(this.handle,"active"),q(this.guide,"active"),this.guide.style.top="".concat(o,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(i-n,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Bt(this.handle,"active"),Bt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(n){return!!ri(n,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(n){return n.tagName!=="TABLE"?n.tagName==="TH"?n:this.getClosestTHParent(n.parentNode):null}},{key:"onMouseOver",value:function(n){if(!wR(n.target)&&this.checkIfColumnHeader(n.target)){var o=this.getClosestTHParent(n.target);if(!o)return;var i=o.getAttribute("colspan");o&&(i===null||i==="1")&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,o=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.adjustElementsSize(!0)},i=function(s,l){var u=n.hot.runHooks("beforeColumnResize",n.newSize,s,!0);u!==void 0&&(n.newSize=u),n.hot.getSettings().stretchH==="all"?n.clearManualSize(s):n.setManualSize(s,n.newSize),n.saveManualColumnWidths(),n.hot.runHooks("afterColumnResize",n.newSize,s,!0),l&&o()};if(this.dblclick>=2){var a=this.selectedCols.length;a>1?(T(this.selectedCols,function(s){i(s)}),o()):T(this.selectedCols,function(s){i(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var o=this;Dt(n.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=n.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(n){var o=this;if(this.pressed){var i=(n.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+i,T(this.selectedCols,function(a){o.newSize=o.setManualSize(a,o.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var n=this,o=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.adjustElementsSize(!0)},i=function(s,l){n.hot.runHooks("beforeColumnResize",n.newSize,s,!1),l&&o(),n.saveManualColumnWidths(),n.hot.runHooks("afterColumnResize",n.newSize,s,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var a=this.selectedCols.length;a>1?(T(this.selectedCols,function(s){i(s)}),o()):T(this.selectedCols,function(s){i(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var n=this,o=this.hot,i=o.rootWindow,a=o.rootElement;this.eventManager.addEventListener(a,"mouseover",function(s){return n.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return n.onMouseDown(s)}),this.eventManager.addEventListener(i,"mousemove",function(s){return n.onMouseMove(s)}),this.eventManager.addEventListener(i,"mouseup",function(){return n.onMouseUp()})}},{key:"onModifyColWidth",value:function(n,o){var i=n;if(this.enabled){var a=this.hot.toPhysicalColumn(o),s=this.columnWidthsMap.getValueAtIndex(a);this.hot.getSettings()[ky]&&s&&(i=s)}return i}},{key:"onBeforeStretchingColumnWidth",value:function(n,o){var i=this.columnWidthsMap.getValueAtIndex(o);return i===null&&(i=n),i}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){ca(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ky}},{key:"PLUGIN_PRIORITY",get:function(){return JVt}}]),r}(re);function md(e){return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function qVt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tFt(n.key),n)}}function $Vt(e,t,r){return t&&sN(e.prototype,t),r&&sN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tFt(e){var t=eFt(e,"string");return md(t)==="symbol"?t:String(t)}function eFt(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R0=0,lN=1,uN=2,As="px",nFt=function(){function e(t){qVt(this,e),this.hot=t,this._element=null,this.state=R0}return $Vt(e,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=uN}},{key:"build",value:function(){this.state===R0&&(this._element=this.hot.rootDocument.createElement("div"),this.state=lN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=R0}},{key:"isAppended",value:function(){return this.state===uN}},{key:"isBuilt",value:function(){return this.state>=lN}},{key:"setPosition",value:function(t,r){t!==void 0&&(this._element.style.top=t+As),r!==void 0&&(this._element.style.left=r+As)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,r){t&&(this._element.style.width=t+As),r&&(this._element.style.height=r+As)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,r){t&&(this._element.style.marginTop=t+As),r&&(this._element.style.marginLeft=r+As)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const cG=nFt;function Nu(e){return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function rFt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iFt(n.key),n)}}function oFt(e,t,r){return t&&cN(e.prototype,t),r&&cN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iFt(e){var t=aFt(e,"string");return Nu(t)==="symbol"?t:String(t)}function aFt(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mg(){return typeof Reflect<"u"&&Reflect.get?mg=Reflect.get.bind():mg=function(e,t,r){var n=sFt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},mg.apply(this,arguments)}function sFt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bu(e),e!==null););return e}function lFt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d1(e,t)}function d1(e,t){return d1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},d1(e,t)}function uFt(e){var t=hFt();return function(){var r=Bu(e),n;if(t){var o=Bu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cFt(this,n)}}function cFt(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fFt(e)}function fFt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hFt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bu(e){return Bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bu(e)}var dFt="ht__manualRowMove--backlight",pFt=function(e){lFt(r,e);var t=uFt(r);function r(){return rFt(this,r),t.apply(this,arguments)}return oFt(r,[{key:"build",value:function(){mg(Bu(r.prototype),"build",this).call(this),q(this._element,dFt)}}]),r}(cG);const yFt=pFt;function Lu(e){return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function gFt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vFt(n.key),n)}}function mFt(e,t,r){return t&&fN(e.prototype,t),r&&fN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vFt(e){var t=bFt(e,"string");return Lu(t)==="symbol"?t:String(t)}function bFt(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vg(){return typeof Reflect<"u"&&Reflect.get?vg=Reflect.get.bind():vg=function(e,t,r){var n=wFt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},vg.apply(this,arguments)}function wFt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vu(e),e!==null););return e}function AFt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p1(e,t)}function p1(e,t){return p1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},p1(e,t)}function SFt(e){var t=kFt();return function(){var r=Vu(e),n;if(t){var o=Vu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return CFt(this,n)}}function CFt(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OFt(e)}function OFt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kFt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vu(e){return Vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vu(e)}var RFt="ht__manualRowMove--guideline",EFt=function(e){AFt(r,e);var t=SFt(r);function r(){return gFt(this,r),t.apply(this,arguments)}return mFt(r,[{key:"build",value:function(){vg(Vu(r.prototype),"build",this).call(this),q(this._element,RFt)}}]),r}(cG);const TFt=EFt;function Fu(e){return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}function PFt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IFt(n.key),n)}}function MFt(e,t,r){return t&&hN(e.prototype,t),r&&hN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IFt(e){var t=xFt(e,"string");return Fu(t)==="symbol"?t:String(t)}function xFt(e,t){if(Fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(e,t,r){var n=jFt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},fa.apply(this,arguments)}function jFt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function DFt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y1(e,t)}function y1(e,t){return y1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},y1(e,t)}function _Ft(e){var t=NFt();return function(){var r=Ao(e),n;if(t){var o=Ao(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return HFt(this,n)}}function HFt(e,t){if(t&&(Fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g1(e)}function g1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NFt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ao(e)}gt.getSingleton().register("beforeRowMove");gt.getSingleton().register("afterRowMove");var E0="manualRowMove",BFt=140,Go=new WeakMap,dN="ht__manualRowMove",Ry="show-ui",T0="on-moving--rows",P0="after-selection--rows",LFt=function(e){DFt(r,e);var t=_Ft(r);function r(n){var o;return PFt(this,r),o=t.call(this,n),Go.set(g1(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new Re(g1(o)),o.backlight=new yFt(n),o.guideline=new TFt(n),o}return MFt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[E0]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return n.onBeforeOnCellMouseOver.apply(n,arguments)}),this.addHook("afterScrollHorizontally",function(){return n.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,dN),fa(Ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),fa(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Bt(this.hot.rootElement,dN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),fa(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(n,o){return this.moveRows([n],o)}},{key:"moveRows",value:function(n,o){var i=Go.get(this),a=i.cachedDropIndex,s=this.isMovePossible(n,o),l=this.hot.runHooks("beforeRowMove",n,o,a,s);if(i.cachedDropIndex=void 0,l!==!1){s&&this.hot.rowIndexMapper.moveIndexes(n,o);var u=s&&this.isRowOrderChanged(n,o);return this.hot.runHooks("afterRowMove",n,o,a,s,u),u}}},{key:"dragRow",value:function(n,o){return this.dragRows([n],o)}},{key:"dragRows",value:function(n,o){var i=this.countFinalIndex(n,o),a=Go.get(this);return a.cachedDropIndex=o,this.moveRows(n,i)}},{key:"isMovePossible",value:function(n,o){var i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),a=n.length+o>i,s=o<0,l=n.some(function(c){return c<0}),u=n.some(function(c){return c>=i});return!(a||s||l||u)}},{key:"isRowOrderChanged",value:function(n,o){return n.some(function(i,a){return i-a!==o})}},{key:"countFinalIndex",value:function(n,o){var i=_e(n,function(a,s){return s<o&&(a+=1),a},0);return o-i}},{key:"getRowsHeight",value:function(n,o){for(var i=this.hot.rowIndexMapper,a=0,s=n;s<=o;s++){var l=i.getRenderableFromVisualIndex(s);l!==null&&(a+=this.hot.view._wt.wtTable.getRowHeight(l)||23)}return a}},{key:"moveBySettingsOrLoad",value:function(){var n=this.hot.getSettings()[E0];if(Array.isArray(n))this.moveRows(n,0);else if(n!==void 0){var o=this.persistentStateLoad();o.length&&this.moveRows(o,0)}}},{key:"isFixedRowTop",value:function(n){return n<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(n){return n>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowMove",n),n.value?n.value:[]}},{key:"prepareRowsToMoving",value:function(){var n=this.hot.getSelectedRangeLast(),o=[];if(!n)return o;var i=n.from,a=n.to,s=Math.min(i.row,a.row),l=Math.max(i.row,a.row);return Ct(s,l,function(u){o.push(u)}),o}},{key:"refreshPositions",value:function(){var n=Go.get(this),o=n.target.coords,i=this.hot.view.getFirstFullyVisibleRow(),a=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(o.row)&&i>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1)),this.isFixedRowBottom(o.row)&&a<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a+1,1),void 0,!0);var l=this.hot.view._wt.wtTable,u=n.target.TD,c=Le(this.hot.rootElement),f=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,o.row-1),h=n.target.eventPageY-c.top+l.holder.scrollTop,p=l.hider.offsetHeight,y=l.TBODY.offsetTop,m=this.backlight.getOffset().top,v=this.backlight.getSize().height;this.isFixedRowTop(o.row)&&(f+=l.holder.scrollTop),o.row<0?n.target.row=i>0?i-1:i:u.offsetHeight/2+f<=h?(n.target.row=o.row+1,f+=o.row===0?u.offsetHeight-1:u.offsetHeight):n.target.row=o.row;var w=h,C=f;h+v+m>=p?w=p-v-m:h+m<y&&(w=y+Math.abs(m)),f>=p-1&&(C=p-1),this.backlight.setPosition(w),this.guideline.setPosition(C)}},{key:"registerEvents",value:function(){var n=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(i){return n.onMouseMove(i)}),this.eventManager.addEventListener(o,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i,a){var s=this.hot.view._wt,l=s.wtTable,u=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),f=this.hot.getSelectedRangeLast(),h=Go.get(this);if(!f||!c||h.pressed||n.button!==0){h.pressed=!1,h.rowsToMove.length=0,Bt(this.hot.rootElement,[T0,Ry]);return}var p=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();p&&y&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var m=f.from,v=f.to,w=Math.min(m.row,v.row),C=Math.max(m.row,v.row);if(o.col<0&&o.row>=w&&o.row<=C){a.row=!0,h.pressed=!0,h.target.eventPageY=n.pageY,h.target.coords=o,h.target.TD=i,h.rowsToMove=this.prepareRowsToMoving();var A=l.holder.scrollLeft+u.getRowHeaderWidth();this.backlight.setPosition(null,A),this.backlight.setSize(l.hider.offsetWidth-A,this.getRowsHeight(w,C)),this.backlight.setOffset((this.getRowsHeight(w,o.row-1)+n.offsetY)*-1,null),q(this.hot.rootElement,T0),this.refreshPositions()}else Bt(this.hot.rootElement,P0),h.pressed=!1,h.rowsToMove.length=0}},{key:"onMouseMove",value:function(n){var o=Go.get(this);if(o.pressed){if(n.target===this.backlight.element){var i=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,i)})}o.target.eventPageY=n.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(n,o,i,a){var s=this.hot.getSelectedRangeLast(),l=Go.get(this);!s||!l.pressed||(l.rowsToMove.indexOf(o.row)>-1?Bt(this.hot.rootElement,Ry):q(this.hot.rootElement,Ry),a.row=!0,a.column=!0,a.cell=!0,l.target.coords=o,l.target.TD=i)}},{key:"onMouseUp",value:function(){var n=Go.get(this),o=n.target.row,i=n.rowsToMove.length;if(n.pressed=!1,n.backlightHeight=0,Bt(this.hot.rootElement,[T0,Ry,P0]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,P0),!(i<1||o===void 0)){var a=n.rowsToMove[0],s=this.hot.toPhysicalRow(a),l=this.dragRows(n.rowsToMove,o);if(n.rowsToMove.length=0,l===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var u=this.hot.toVisualRow(s),c=u+i-1;this.hot.selectRows(u,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var n=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtViewport.getRowHeaderWidth(),i=n.holder.scrollLeft,a=o+i;this.backlight.setPosition(null,a),this.backlight.setSize(n.hider.offsetWidth-a)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),fa(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return E0}},{key:"PLUGIN_PRIORITY",get:function(){return BFt}}]),r}(re);function Wu(e){return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function VFt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WFt(n.key),n)}}function FFt(e,t,r){return t&&pN(e.prototype,t),r&&pN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WFt(e){var t=UFt(e,"string");return Wu(t)==="symbol"?t:String(t)}function UFt(e,t){if(Wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(e,t,r){var n=YFt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ha.apply(this,arguments)}function YFt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function GFt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m1(e,t)}function m1(e,t){return m1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},m1(e,t)}function zFt(e){var t=KFt();return function(){var r=So(e),n;if(t){var o=So(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QFt(this,n)}}function QFt(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v1(e)}function v1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KFt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},So(e)}var Ey="manualRowResize",XFt=30,yN="manualRowHeights",M0=new WeakMap,JFt=function(e){GFt(r,e);var t=zFt(r);function r(n){var o;VFt(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Re(v1(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,M0.set(v1(o),{config:void 0}),q(o.handle,"manualRowResizer"),q(o.guide,"manualRowResizerGuide"),o}return FFt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Ey]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.rowHeightsMap=new Oi,this.rowHeightsMap.addLocalHook("init",function(){return n.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(o,i){return n.onModifyRowHeight(o,i)}),this.bindEvents(),ha(So(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ha(So(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=M0.get(this);n.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ha(So(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",yN,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var n={};return this.hot.runHooks("persistentStateLoad",yN,n),n.value}},{key:"setManualSize",value:function(n,o){var i=this.hot.toPhysicalRow(n),a=Math.max(o,WW.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(i,a),a}},{key:"setupHandlePosition",value:function(n){var o=this;this.currentTH=n;var i=this.hot.view,a=i._wt,s=a.wtTable.getCoords(this.currentTH),l=s.row;if(!(l<0)){var u=fe(this.currentTH),c=this.currentTH.getBoundingClientRect(),f=l<a.getSetting("fixedRowsTop"),h=l>=i.countNotHiddenRowIndexes(0,1)-a.getSetting("fixedRowsBottom"),p;f?p=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):h&&(p=a.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),p||(p=a.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){var m=this.hot.getSelectedRange();T(m,function(v){var w=v.getTopStartCorner().row,C=v.getBottomStartCorner().row;Ct(w,C,function(A){o.selectedRows.includes(A)||o.selectedRows.push(A)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=p.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(p.start,"px"),this.handle.style.width="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var n=parseInt(fe(this.handle),10),o=parseInt(this.handle.style[this.inlineDir],10)+n,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);q(this.handle,"active"),q(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(o,"px"),this.guide.style.width="".concat(i-n,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Bt(this.handle,"active"),Bt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(n){var o,i,a=ri(n,["TH"],this.hot.rootElement);return a&&((o=n.parentNode)===null||o===void 0||(i=o.parentNode)===null||i===void 0?void 0:i.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(n){return n.tagName!=="TABLE"?n.tagName==="TH"?n:this.getClosestTHParent(n.parentNode):null}},{key:"getActualRowHeight",value:function(n){var o=this.hot.view._wt.wtTable.getRowHeight(n);return o!==void 0&&this.newSize<o?o:this.newSize}},{key:"onMouseOver",value:function(n){if(!wR(n.target)&&this.checkIfRowHeader(n.target)){var o=this.getClosestTHParent(n.target);o&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,o=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.adjustElementsSize(!0)},i=function(s,l){var u=n.hot.runHooks("beforeRowResize",n.getActualRowHeight(s),s,!0);u!==void 0&&(n.newSize=u),n.setManualSize(s,n.newSize),n.hot.runHooks("afterRowResize",n.getActualRowHeight(s),s,!0),l&&o()};if(this.dblclick>=2){var a=this.selectedRows.length;a>1?(T(this.selectedRows,function(s){i(s)}),o()):T(this.selectedRows,function(s){i(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var o=this;Dt(n.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=n.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(n){var o=this;this.pressed&&(this.currentHeight=this.startHeight+(n.pageY-this.startY),T(this.selectedRows,function(i){o.newSize=o.setManualSize(i,o.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var n=this,o=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.adjustElementsSize(!0)},i=function(s,l){n.hot.runHooks("beforeRowResize",n.getActualRowHeight(s),s,!1),l&&o(),n.saveManualRowHeights(),n.hot.runHooks("afterRowResize",n.getActualRowHeight(s),s,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var a=this.selectedRows.length;a>1?(T(this.selectedRows,function(s){i(s)}),o()):T(this.selectedRows,function(s){i(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var n=this,o=this.hot,i=o.rootElement,a=o.rootWindow;this.eventManager.addEventListener(i,"mouseover",function(s){return n.onMouseOver(s)}),this.eventManager.addEventListener(i,"mousedown",function(s){return n.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return n.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return n.onMouseUp()})}},{key:"onModifyRowHeight",value:function(n,o){var i=n;if(this.enabled){var a=this.hot.toPhysicalRow(o),s=this.rowHeightsMap.getValueAtIndex(a);this.hot.getSettings()[Ey]&&s&&(i=s)}return i}},{key:"onMapInit",value:function(){var n=this,o=M0.get(this),i=this.hot.getSettings()[Ey],a=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof a<"u"?a.forEach(function(s,l){n.rowHeightsMap.setValueAtIndex(l,s)}):Array.isArray(i)?(i.forEach(function(s,l){n.rowHeightsMap.setValueAtIndex(l,s)}),o.config=i):i===!0&&Array.isArray(o.config)&&o.config.forEach(function(s,l){n.rowHeightsMap.setValueAtIndex(l,s)})},!0)}},{key:"destroy",value:function(){ha(So(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ey}},{key:"PLUGIN_PRIORITY",get:function(){return XFt}}]),r}(re);function vd(e){return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}var gN,mN,vN,bN;function Ty(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ZFt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Ft(n.key),n)}}function qFt(e,t,r){return t&&wN(e.prototype,t),r&&wN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ft(e){var t=tWt(e,"string");return vd(t)==="symbol"?t:String(t)}function tWt(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eWt=function(){function e(t,r,n,o,i,a){ZFt(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return qFt(e,[{key:"normalize",value:function(t){var r=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(t,r){return this.row<=t&&this.col<=r&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=r}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,r){var n=t[0]||t[1],o=r+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",a=t[0]?"col":"row",s=Math.min(r,o),l=Math.max(r,o),u=this[a],c=this[a]+this[i]-1;if(u>=r&&(this[a]+=n),n>0)r<=c&&r>u&&(this[i]+=n);else if(n<0){if(s<=u&&l>=c)return this.removed=!0,!1;if(u>=s&&u<=l){var f=l-u+1,h=Math.abs(n)-f;this[a]-=h+n,this[i]-=f}else if(u<=s&&c>=l)this[i]+=n;else if(u<=s&&c>=s&&c<l){var p=c-s+1;this[i]-=p}}return!0}},{key:"isFarther",value:function(t,r){return t?r==="down"?t.row+t.rowspan-1<this.row+this.rowspan-1:r==="up"?t.row>this.row:r==="right"?t.col+t.colspan-1<this.col+this.colspan-1:r==="left"?t.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(t){return ce(gN||(gN=Ty(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(t){return ce(mN||(mN=Ty(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function(t){return ce(vN||(vN=Ty(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function(t){return ce(bN||(bN=Ty(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),t.row,t.col)}},{key:"containsNegativeValues",value:function(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function(t){return t.colspan===1&&t.rowspan===1}},{key:"containsZeroSpan",value:function(t){return t.colspan===0||t.rowspan===0}},{key:"isOutOfBounds",value:function(t,r,n){return t.row<0||t.col<0||t.row>=r||t.row+t.rowspan-1>=r||t.col>=n||t.col+t.colspan-1>=n}}]),e}();const Mr=eWt;function b1(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function bd(e){return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}var AN;function nWt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function SN(e){return aWt(e)||iWt(e)||oWt(e)||rWt()}function rWt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oWt(e,t){if(e){if(typeof e=="string")return w1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w1(e,t)}}function iWt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aWt(e){if(Array.isArray(e))return w1(e)}function w1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sWt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uWt(n.key),n)}}function lWt(e,t,r){return t&&CN(e.prototype,t),r&&CN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uWt(e){var t=cWt(e,"string");return bd(t)==="symbol"?t:String(t)}function cWt(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fWt=function(){function e(t){sWt(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return lWt(e,[{key:"get",value:function(t,r){var n=this.mergedCells,o=!1;return T(n,function(i){return i.row<=t&&i.row+i.rowspan-1>=t&&i.col<=r&&i.col+i.colspan-1>=r?(o=i,!1):!0}),o}},{key:"getByRange",value:function(t){var r=this.mergedCells,n=!1;return T(r,function(o){return o.row<=t.from.row&&o.row+o.rowspan-1>=t.to.row&&o.col<=t.from.col&&o.col+o.colspan-1>=t.to.col?(n=o,n):!0}),n}},{key:"getWithinRange",value:function(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCells,i=[],a=t;if(!a.includesRange){var s=this.hot._createCellCoords(a.from.row,a.from.col),l=this.hot._createCellCoords(a.to.row,a.to.col);a=this.hot._createCellRange(s,s,l)}return T(o,function(u){var c=r.hot._createCellCoords(u.row,u.col),f=r.hot._createCellCoords(u.row+u.rowspan-1,u.col+u.colspan-1),h=r.hot._createCellRange(c,c,f);n?a.overlaps(h)&&i.push(u):a.includesRange(h)&&i.push(u)}),i.length?i:!1}},{key:"add",value:function(t){var r=this.mergedCells,n=t.row,o=t.col,i=t.rowspan,a=t.colspan,s=new Mr(n,o,i,a,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,o),u=this.isOverlapping(s);return!l&&!u?(this.hot&&s.normalize(this.hot),r.push(s),s):(de(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(t,r){var n=this.mergedCells,o=this.get(t,r),i=o?this.mergedCells.indexOf(o):-1;return o&&i!==-1?(n.splice(i,1),o):!1}},{key:"clear",value:function(){var t=this,r=this.mergedCells,n=[],o=[];T(r,function(i){var a=t.hot.getCell(i.row,i.col);a&&n.push([a,t.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,T(n,function(i,a){Ct(0,i.rowspan-1,function(s){Ct(0,i.colspan-1,function(l){if(l!==0||s!==0){var u=t.hot.getCell(i.row+s,i.col+l);u&&o.push([u,null,null,null])}})}),n[a][1]=null}),T(n,function(i){b1.apply(void 0,SN(i))}),T(o,function(i){b1.apply(void 0,SN(i))})}},{key:"isOverlapping",value:function(t){var r=this,n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)),o=!1;return T(this.mergedCells,function(i){var a=r.hot._createCellRange(r.hot._createCellCoords(0,0),r.hot._createCellCoords(i.row,i.col),r.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1));return a.overlaps(n)?(o=!0,!1):!0}),o}},{key:"isFirstRenderableMergedCell",value:function(t,r){var n=this.get(t,r);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===r}},{key:"getFirstRenderableCoords",value:function(t,r){var n=this.get(t,r);if(!n||this.isFirstRenderableMergedCell(t,r))return this.hot._createCellCoords(t,r);var o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(o,i)}},{key:"shiftCollections",value:function(t,r,n){var o=this,i=[0,0];switch(t){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}T(this.mergedCells,function(a){a.shift(i,r)}),Vg(this.mergedCells.length-1,0,function(a){var s=o.mergedCells[a];s&&s.removed&&o.mergedCells.splice(o.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(t){return ce(AN||(AN=nWt(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),t.row,t.col)}}]),e}();const hWt=fWt;function wd(e){return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function Bi(e,t){return gWt(e)||yWt(e,t)||pWt(e,t)||dWt()}function dWt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pWt(e,t){if(e){if(typeof e=="string")return ON(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ON(e,t)}}function ON(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yWt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function gWt(e){if(Array.isArray(e))return e}function mWt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bWt(n.key),n)}}function vWt(e,t,r){return t&&kN(e.prototype,t),r&&kN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bWt(e){var t=wWt(e,"string");return wd(t)==="symbol"?t:String(t)}function wWt(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AWt=function(){function e(t){mWt(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return vWt(e,[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var r=this.mergedCellsCollection.get(t[0],t[1]);r&&(t[2]=t[0]+r.rowspan-1,t[3]=t[1]+r.colspan-1)}}},{key:"getDirection",value:function(t,r){var n=null;return r[0]===t[0]&&r[1]===t[1]&&r[3]===t[3]?n="down":r[2]===t[2]&&r[1]===t[1]&&r[3]===t[3]?n="up":r[1]===t[1]&&r[2]===t[2]?n="right":n="left",n}},{key:"snapDragArea",value:function(t,r,n,o){var i=r.slice(0),a=this.getAutofillSize(t,r,n),s=Bi(t,4),l=s[0],u=s[1],c=s[2],f=s[3],h=["up","down"].indexOf(n)>-1,p=h?c-l+1:f-u+1,y=Math.floor(a/p)*p,m=a-y,v=this.getFarthestCollection(t,r,n,o);if(v){if(n==="down"){var w=v.row+v.rowspan-l-m,C=i[2]+w;C>=this.plugin.hot.countRows()?i[2]-=m:i[2]+=m?w:0}else if(n==="right"){var A=v.col+v.colspan-u-m,D=i[3]+A;D>=this.plugin.hot.countCols()?i[3]-=m:i[3]+=m?A:0}else if(n==="up"){var E=c-m-v.row+1,G=i[0]+E;G<0?i[0]+=m:i[0]-=m?E:0}else if(n==="left"){var K=f-m-v.col+1,nt=i[1]+K;nt<0?i[1]+=m:i[1]-=m?K:0}}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:o,fillSize:a,dragArea:i,cycleLength:p}),i}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),Ve(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,r,n){var o=Bi(t,4),i=o[0],a=o[1],s=o[2],l=o[3],u=Bi(r,4),c=u[0],f=u[1],h=u[2],p=u[3];switch(n){case"up":return i-c;case"down":return h-s;case"left":return a-f;case"right":return p-l;default:return null}}},{key:"getDragArea",value:function(t,r,n){var o=Bi(t,4),i=o[0],a=o[1],s=o[2],l=o[3],u=Bi(r,4),c=u[0],f=u[1],h=u[2],p=u[3];switch(n){case"up":return[c,f,i-1,l];case"down":return[s+1,a,h,l];case"left":return[c,f,s,a-1];case"right":return[i,l+1,h,p];default:return null}}},{key:"getFarthestCollection",value:function(t,r,n,o){var i=Bi(t,4),a=i[0],s=i[1],l=i[2],u=i[3],c=["up","down"].indexOf(n)>-1,f=c?l:u,h=c?a:s,p=this.getAutofillSize(t,r,n),y=c?l-a+1:u-s+1,m=Math.floor(p/y)*y,v=p-m,w=null,C=null,A=null;switch(n){case"up":w="includesVertically",A=f-v+1;break;case"left":w="includesHorizontally",A=f-v+1;break;case"down":w="includesVertically",A=h+v-1;break;case"right":w="includesHorizontally",A=h+v-1;break}return T(o,function(D){D[w](A)&&D.isFarther(C,n)&&(C=D)}),C}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var r=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=function(c,f){switch(o){case"up":return c.row-f>=r.from.row;case"down":return c.row+c.rowspan-1+f<=r.to.row;case"left":return c.col-f>=r.from.column;case"right":return c.col+c.colspan-1+f<=r.to.column;default:return null}},a=0,s=null,l=1;do for(var u=0;u<n.length;u+=1){if(s=n[u],a=l*this.currentFillData.cycleLength,i(s,a))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:s.row-a,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+a,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-a,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+a,colspan:s.colspan});break}u===n.length-1&&(l+=1)}while(i(s,a));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(t){var r=this,n={min:null,max:null},o={min:null,max:null};return T(t,function(i){var a=i[0],s=r.plugin.hot.propToCol(i[1]);(n.min===null||a<n.min)&&(n.min=a),(n.max===null||a>n.max)&&(n.max=a),(o.min===null||s<o.min)&&(o.min=s),(o.max===null||s>o.max)&&(o.max=s)}),{from:{row:n.min,column:o.min},to:{row:n.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,r,n){var o=this.getDragArea(t,r,n),i=Bi(o,4),a=i[0],s=i[1],l=i[2],u=i[3],c=this.plugin.hot._createCellCoords(a,s),f=this.plugin.hot._createCellCoords(l,u),h=this.plugin.hot._createCellRange(c,c,f);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}]),e}();const SWt=AWt;function Ad(e){return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function CWt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kWt(n.key),n)}}function OWt(e,t,r){return t&&RN(e.prototype,t),r&&RN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kWt(e){var t=RWt(e,"string");return Ad(t)==="symbol"?t:String(t)}function RWt(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EWt=function(){function e(t){CWt(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return OWt(e,[{key:"snapDelta",value:function(t,r,n){var o=r.to,i=o.row+t.row,a=o.col+t.col;t.row?this.jumpOverMergedCell(t,n,i):t.col&&this.jumpOverMergedCell(t,n,a)}},{key:"jumpOverMergedCell",value:function(t,r,n){var o=t.row||t.col,i=null,a=null,s=null;t.row?(i=r.includesVertically(n),a=r.row,s=r.getLastRow()):t.col&&(i=r.includesHorizontally(n),a=r.col,s=r.getLastColumn()),o!==0&&(o>0?i&&n!==a&&(o+=s-n+1):i&&n!==s&&(o-=n-a+1),t.row?t.row=o:t.col&&(t.col=o))}},{key:"getUpdatedSelectionRange",value:function(t,r){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+r.row,t.to.col+r.col))}},{key:"getSelectedMergedCellClassName",value:function(t,r,n,o){var i=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(o!==void 0){var u=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,r);if(u){var c=this.plugin.mergedCellsCollection.get(t,r);if(c){var f=c.getLastRow(),h=c.getLastColumn(),p=i<=c.row&&a<=c.col&&s>=f&&l>=h;if(p)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(o);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(t,r){var n=[];if(!r||!t)return!1;for(var o=0;o<t.rowspan;o+=1)for(var i=0;i<t.colspan;i+=1)n.push(this.hot._createCellCoords(t.row+o,t.col+i));for(var a=0;a<n.length;a+=1){for(var s=[],l=0;l<r.length;l+=1)s[l]=r[l].includes(n[a]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var t=[],r=0;r<=7;r+=1)t.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(r));return t.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),t}}]),e}();const TWt=EWt;function PWt(e){return{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var r=e.mergedCellsCollection.get(t[0],t[1]);if(r.row===t[0]&&r.col===t[1]&&r.row+r.rowspan-1===t[2]&&r.col+r.colspan-1===t[3])return this.getTranslatedPhrase(Xv)}return this.getTranslatedPhrase(Kv)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var t=this.getSelectedLast();if(!t)return!0;var r=Mr.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return r||this.selection.isSelectedByCorner()},hidden:!1}}function Uu(e){return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function MWt(e,t){return jWt(e)||xWt(e,t)||fG(e,t)||IWt()}function IWt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xWt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function jWt(e){if(Array.isArray(e))return e}function DWt(e){return NWt(e)||HWt(e)||fG(e)||_Wt()}function _Wt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fG(e,t){if(e){if(typeof e=="string")return A1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A1(e,t)}}function HWt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NWt(e){if(Array.isArray(e))return A1(e)}function A1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BWt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VWt(n.key),n)}}function LWt(e,t,r){return t&&EN(e.prototype,t),r&&EN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VWt(e){var t=FWt(e,"string");return Uu(t)==="symbol"?t:String(t)}function FWt(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ks(){return typeof Reflect<"u"&&Reflect.get?Ks=Reflect.get.bind():Ks=function(e,t,r){var n=WWt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Ks.apply(this,arguments)}function WWt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pi(e),e!==null););return e}function UWt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S1(e,t)}function S1(e,t){return S1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},S1(e,t)}function YWt(e){var t=zWt();return function(){var r=pi(e),n;if(t){var o=pi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GWt(this,n)}}function GWt(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hG(e)}function hG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zWt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pi(e){return pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pi(e)}gt.getSingleton().register("beforeMergeCells");gt.getSingleton().register("afterMergeCells");gt.getSingleton().register("beforeUnmergeCells");gt.getSingleton().register("afterUnmergeCells");var of="mergeCells",QWt=150,TN=new WeakMap,PN=of,KWt=function(e){UWt(r,e);var t=YWt(r);function r(n){var o;return BWt(this,r),o=t.call(this,n),TN.set(hG(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return LWt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[of]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mergedCellsCollection=new hWt(this),this.autofillCalculations=new SWt(this),this.selectionCalculations=new TWt(this),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("modifyTransformStart",function(){return n.onModifyTransformStart.apply(n,arguments)}),this.addHook("afterModifyTransformStart",function(){return n.onAfterModifyTransformStart.apply(n,arguments)}),this.addHook("modifyTransformEnd",function(){return n.onModifyTransformEnd.apply(n,arguments)}),this.addHook("modifyGetCellCoords",function(){return n.onModifyGetCellCoords.apply(n,arguments)}),this.addHook("beforeSetRangeStart",function(){return n.onBeforeSetRangeStart.apply(n,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return n.onBeforeSetRangeStart.apply(n,arguments)}),this.addHook("beforeSetRangeEnd",function(){return n.onBeforeSetRangeEnd.apply(n,arguments)}),this.addHook("afterIsMultipleSelection",function(){return n.onAfterIsMultipleSelection.apply(n,arguments)}),this.addHook("afterRenderer",function(){return n.onAfterRenderer.apply(n,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return n.addMergeActionsToContextMenu.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(){return n.onAfterGetCellMeta.apply(n,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return n.onAfterViewportRowCalculatorOverride.apply(n,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return n.onAfterViewportColumnCalculatorOverride.apply(n,arguments)}),this.addHook("modifyAutofillRange",function(){return n.onModifyAutofillRange.apply(n,arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol.apply(n,arguments)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeDrawBorders",function(){return n.onBeforeDrawAreaBorders.apply(n,arguments)}),this.addHook("afterDrawSelection",function(){return n.onAfterDrawSelection.apply(n,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return n.onBeforeRemoveCellClassNames.apply(n,arguments)}),this.addHook("beforeUndoStackChange",function(o,i){if(i==="MergeCells")return!1}),this.registerShortcuts(),Ks(pi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Ks(pi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings()[of];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(n),Ks(pi(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var n=this;if(zk()){var o=[],i=[];this.mergedCellsCollection.mergedCells.forEach(function(a){for(var s=a.row,l=a.rowspan,u=s+1;u<s+l;u++)i.push(u)}),i=DWt(new Set(i)),i.forEach(function(a){var s=n.hot.rowIndexMapper.getRenderableFromVisualIndex(a);n.hot.view._wt.wtOverlays.getOverlays(!0).map(function(l){return(l==null?void 0:l.name)==="master"?l:l.clone.wtTable}).forEach(function(l){var u=l.getRow(s);u&&(u.style.background=nl(u,"backgroundColor").replace(")",", 0.99)"),o.push(u))})}),this.hot._registerTimeout(function(){o.forEach(function(a){a.style.background=nl(a,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(n){var o=!0;return n?(Mr.containsNegativeValues(n)?(de(Mr.NEGATIVE_VALUES_WARNING(n)),o=!1):Mr.isOutOfBounds(n,this.hot.countRows(),this.hot.countCols())?(de(Mr.IS_OUT_OF_BOUNDS_WARNING(n)),o=!1):Mr.isSingleCell(n)?(de(Mr.IS_SINGLE_CELL(n)),o=!1):Mr.containsZeroSpan(n)&&(de(Mr.ZERO_SPAN_WARNING(n)),o=!1),o):!1}},{key:"generateFromSettings",value:function(n){var o=this;if(Array.isArray(n)){var i=[];if(T(n,function(a){if(o.validateSetting(a)){var s=o.hot._createCellCoords(a.row,a.col),l=o.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),u=o.hot._createCellRange(s,s,l);o.mergeRange(u,!0,!0),Ct(a.row,a.row+a.rowspan-1,function(c){Ct(a.col,a.col+a.colspan-1,function(f){c===a.row&&f===a.col||i.push([c,f,null])})})}}),i.length===0)return;this.hot.setDataAtCell(i)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o?!0:this.validateSetting(n)}},{key:"toggleMergeOnSelection",value:function(){var n=this.hot.getSelectedRangeLast();if(n){n.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=n.from,i=n.to;this.toggleMerge(n),this.hot.selectCell(o.row,o.col,i.row,i.col,!1)}}},{key:"mergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(n){n.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=n.from,i=n.to;this.unmergeRange(n,!0),this.mergeRange(n),this.hot.selectCell(o.row,o.col,i.row,i.col,!1)}}},{key:"unmergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(n){var o=n.from,i=n.to;this.unmergeRange(n,!0),this.hot.selectCell(o.row,o.col,i.row,i.col,!1)}}},{key:"mergeRange",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=n.getTopStartCorner(),l=n.getBottomEndCorner(),u={row:s.row,col:s.col,rowspan:l.row-s.row+1,colspan:l.col-s.col+1},c=[],f=null;if(!this.canMergeRange(u,i))return!1;this.hot.runHooks("beforeMergeCells",n,i),Ct(0,u.rowspan-1,function(p){Ct(0,u.colspan-1,function(y){var m=null;c[p]||(c[p]=[]),p===0&&y===0?m=o.hot.getSourceDataAtCell(o.hot.toPhysicalRow(u.row),o.hot.toPhysicalColumn(u.col)):o.hot.setCellMeta(u.row+p,u.col+y,"hidden",!0),c[p][y]=m})}),this.hot.setCellMeta(u.row,u.col,"spanned",!0);var h=this.mergedCellsCollection.add(u);return h?(a?f=[u.row,u.col,c]:this.hot.populateFromArray(u.row,u.col,c,void 0,void 0,this.pluginName),i||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",n,u,i),f):!0}},{key:"unmergeRange",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.mergedCellsCollection.getWithinRange(n);a&&(this.hot.runHooks("beforeUnmergeCells",n,i),T(a,function(s){o.mergedCellsCollection.remove(s.row,s.col),Ct(0,s.rowspan-1,function(l){Ct(0,s.colspan-1,function(u){o.hot.removeCellMeta(s.row+l,s.col+u,"hidden")})}),o.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",n,i),this.hot.render())}},{key:"toggleMerge",value:function(n){var o=this.mergedCellsCollection.get(n.from.row,n.from.col),i=o.row===n.from.row&&o.col===n.from.col&&o.row+o.rowspan-1===n.to.row&&o.col+o.colspan-1===n.to.col;i?this.unmergeRange(n):this.mergeSelection(n)}},{key:"merge",value:function(n,o,i,a){var s=this.hot._createCellCoords(n,o),l=this.hot._createCellCoords(i,a);this.mergeRange(this.hot._createCellRange(s,s,l))}},{key:"unmerge",value:function(n,o,i,a){var s=this.hot._createCellCoords(n,o),l=this.hot._createCellCoords(i,a);this.unmergeRange(this.hot._createCellRange(s,s,l))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[of]),this.hot.render()}},{key:"registerShortcuts",value:function(){var n=this,o=this.hot.getShortcutManager(),i=o.getContext("grid");i.addShortcut({keys:[["Control","m"]],callback:function(){n.toggleMerge(n.hot.getSelectedRangeLast()),n.hot.render()},runOnlyIf:function(a){return!a.altKey},group:PN})}},{key:"unregisterShortcuts",value:function(){var n=this.hot.getShortcutManager(),o=n.getContext("grid");o.removeShortcutsByGroup(PN)}},{key:"onAfterIsMultipleSelection",value:function(n){if(n){for(var o=this.mergedCellsCollection.mergedCells,i=this.hot.getSelectedRangeLast(),a=0;a<o.length;a+=1)if(i.from.row===o[a].row&&i.from.col===o[a].col&&i.to.row===o[a].row+o[a].rowspan-1&&i.to.col===o[a].col+o[a].colspan-1)return!1}return n}},{key:"onModifyTransformStart",value:function(n){var o=TN.get(this),i=this.hot.getSelectedRangeLast(),a={row:n.row,col:n.col},s=null,l=this.hot._createCellCoords(i.highlight.row,i.highlight.col),u=this.mergedCellsCollection.get(l.row,l.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),u){var c=this.hot._createCellCoords(u.row,u.col),f=this.hot._createCellCoords(u.row+u.rowspan-1,u.col+u.colspan-1),h=this.hot._createCellRange(c,c,f);h.includes(o.lastDesiredCoords)||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),a.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-l.row:a.row,a.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-l.col:a.col,n.row>0?a.row=u.row+u.rowspan-1-l.row+n.row:n.row<0&&(a.row=l.row-u.row+n.row),n.col>0?a.col=u.col+u.colspan-1-l.col+n.col:n.col<0&&(a.col=l.col-u.col+n.col)}s=this.hot._createCellCoords(i.highlight.row+a.row,i.highlight.col+a.col);var p=this.mergedCellsCollection.get(s.row,s.col);if(p){var y=this.mergedCellsCollection.getFirstRenderableCoords(p.row,p.col);o.lastDesiredCoords=s,a={row:y.row-l.row,col:y.col-l.col}}a.row!==0&&(n.row=a.row),a.col!==0&&(n.col=a.col)}},{key:"onModifyTransformEnd",value:function(n){var o=this,i=this.hot.getSelectedRangeLast(),a=yn(n),s=this.selectionCalculations.getUpdatedSelectionRange(i,n),l=yn(a),u=this.mergedCellsCollection.getWithinRange(s,!0);do l=yn(a),this.selectionCalculations.getUpdatedSelectionRange(i,a),T(u,function(c){o.selectionCalculations.snapDelta(a,i,c)});while(a.row!==l.row||a.col!==l.col);n.row=a.row,n.col=a.col}},{key:"onModifyGetCellCoords",value:function(n,o){if(!(n<0||o<0)){var i=this.mergedCellsCollection.get(n,o);if(i){var a=i.row,s=i.col,l=i.colspan,u=i.rowspan;return[a,s,a+u-1,s+l-1]}}}},{key:"addMergeActionsToContextMenu",value:function(n){n.items.push({name:"---------"},PWt(this))}},{key:"onAfterRenderer",value:function(n,o,i){var a=this.mergedCellsCollection.get(o,i),s=zt(a)?yn(a):void 0;if(zt(s)){var l=this.hot,u=l.rowIndexMapper,c=l.columnIndexMapper,f=s.row,h=s.col,p=s.colspan,y=s.rowspan,m=this.translateMergedCellToRenderable(f,y,h,p),v=MWt(m,2),w=v[0],C=v[1],A=u.getRenderableFromVisualIndex(o),D=c.getRenderableFromVisualIndex(i),E=w-A+1,G=C-D+1;s.row=u.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,E),s.colspan=Math.min(s.colspan,G)}b1(n,s,o,i)}},{key:"onBeforeSetRangeStart",value:function(n){if(this.mergedCellsCollection.isFirstRenderableMergedCell(n.row,n.col)){var o=this.mergedCellsCollection.get(n.row,n.col),i=[o.row,o.col];n.row=i[0],n.col=i[1]}}},{key:"onBeforeSetRangeEnd",value:function(n){var o=this.hot.getSelectedRangeLast();o.highlight=this.hot._createCellCoords(o.highlight.row,o.highlight.col),o.to=n;var i=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{i=!1;for(var a=0;a<this.mergedCellsCollection.mergedCells.length;a+=1){var s=this.mergedCellsCollection.mergedCells[a],l=s.getRange();o.expandByRange(l)&&(n.row=o.to.row,n.col=o.to.col,i=!0)}}while(i)}},{key:"onAfterGetCellMeta",value:function(n,o,i){var a=this.mergedCellsCollection.get(n,o);a&&(a.row!==n||a.col!==o?i.copyable=!1:(i.rowspan=a.rowspan,i.colspan=a.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(n){var o=this.hot.countCols();this.modifyViewportRowStart(n,o),this.modifyViewportRowEnd(n,o)}},{key:"modifyViewportRowStart",value:function(n,o){for(var i=this.hot.rowIndexMapper,a=i.getVisualFromRenderableIndex(n.startRow),s=0;s<o;s+=1){var l=this.mergedCellsCollection.get(a,s);if(zt(l)){var u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l.row,1));if(u<n.startRow){n.startRow=u,this.modifyViewportRowStart(n,o);return}}}}},{key:"modifyViewportRowEnd",value:function(n,o){for(var i=this.hot.rowIndexMapper,a=i.getVisualFromRenderableIndex(n.endRow),s=0;s<o;s+=1){var l=this.mergedCellsCollection.get(a,s);if(zt(l)){var u=l.row+l.rowspan-1,c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(c>n.endRow){n.endRow=c,this.modifyViewportRowEnd(n,o);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var o=this.hot.countRows();this.modifyViewportColumnStart(n,o),this.modifyViewportColumnEnd(n,o)}},{key:"modifyViewportColumnStart",value:function(n,o){for(var i=this.hot.columnIndexMapper,a=i.getVisualFromRenderableIndex(n.startColumn),s=0;s<o;s+=1){var l=this.mergedCellsCollection.get(s,a);if(zt(l)){var u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l.col,1));if(u<n.startColumn){n.startColumn=u,this.modifyViewportColumnStart(n,o);return}}}}},{key:"modifyViewportColumnEnd",value:function(n,o){for(var i=this.hot.columnIndexMapper,a=i.getVisualFromRenderableIndex(n.endColumn),s=0;s<o;s+=1){var l=this.mergedCellsCollection.get(s,a);if(zt(l)){var u=l.col+l.colspan-1,c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(c>n.endColumn){n.endColumn=c,this.modifyViewportColumnEnd(n,o);return}}}}},{key:"translateMergedCellToRenderable",value:function(n,o,i,a){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,c,f;o===0?c=l.getNearestNotHiddenIndex(n,1):c=l.getNearestNotHiddenIndex(n+o-1,-1),a===0?f=u.getNearestNotHiddenIndex(i,1):f=u.getNearestNotHiddenIndex(i+a-1,-1);var h=n>=0?l.getRenderableFromVisualIndex(c):n,p=i>=0?u.getRenderableFromVisualIndex(f):i;return[h,p]}},{key:"onModifyAutofillRange",value:function(n,o){this.autofillCalculations.correctSelectionAreaSize(o);var i=this.autofillCalculations.getDirection(o,n),a=n;if(this.autofillCalculations.dragAreaOverlapsCollections(o,a,i))return a=o,a;var s=this.mergedCellsCollection.getWithinRange({from:{row:o[0],col:o[1]},to:{row:o[2],col:o[3]}});return s&&(a=this.autofillCalculations.snapDragArea(o,a,i,s)),a}},{key:"onAfterCreateCol",value:function(n,o){this.mergedCellsCollection.shiftCollections("right",n,o)}},{key:"onAfterRemoveCol",value:function(n,o){this.mergedCellsCollection.shiftCollections("left",n,o)}},{key:"onAfterCreateRow",value:function(n,o,i){i!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,o)}},{key:"onAfterRemoveRow",value:function(n,o){this.mergedCellsCollection.shiftCollections("up",n,o)}},{key:"onAfterChange",value:function(n,o){o==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}},{key:"onBeforeDrawAreaBorders",value:function(n,o){if(o&&o==="area"){var i=this.hot.getSelectedRangeLast(),a=this.mergedCellsCollection.getWithinRange(i);T(a,function(s){i.getBottomEndCorner().row===s.getLastRow()&&i.getBottomEndCorner().col===s.getLastColumn()&&(n[2]=s.row,n[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(n,o,i){if(this.enabled){var a=this.mergedCellsCollection.get(n.row,n.col);if(a){var s=o>0,l=o<0,u=i<0,c=i>0,f=a.row+a.rowspan-1===this.hot.countRows()-1,h=a.row===0,p=a.col+a.colspan-1===this.hot.countCols()-1,y=a.col===0;(s&&f||l&&h||c&&p||u&&y)&&(n.row=a.row,n.col=a.col)}}}},{key:"onAfterDrawSelection",value:function(n,o,i,a){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(n,o,i,a)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return of}},{key:"PLUGIN_PRIORITY",get:function(){return QWt}}]),r}(re);function MN(e){return qWt(e)||ZWt(e)||JWt(e)||XWt()}function XWt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JWt(e,t){if(e){if(typeof e=="string")return IN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IN(e,t)}}function IN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZWt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qWt(e){if(Array.isArray(e))return e}function $Wt(e,t){return function(r,n){var o=MN(r),i=o.slice(1),a=MN(n),s=a.slice(1);return function l(u){var c=e[u],f=t[u],h=i[u],p=s[u],y=f.multiColumnSorting,m=y.compareFunctionFactory?y.compareFunctionFactory:JY(f.type),v=m(c,f,y)(h,p);if(v===Dr){var w=u+1;if(typeof t[w]<"u")return l(w)}return v}(0)}}var xN;function tUt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jN(){de(ce(xN||(xN=tUt(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var dG="sort";function eUt(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(dG,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function nUt(e){var t=e.className.split(" "),r=new RegExp("^".concat(dG,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function Yu(e){return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function rUt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iUt(n.key),n)}}function oUt(e,t,r){return t&&DN(e.prototype,t),r&&DN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iUt(e){var t=aUt(e,"string");return Yu(t)==="symbol"?t:String(t)}function aUt(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dn(){return typeof Reflect<"u"&&Reflect.get?Dn=Reflect.get.bind():Dn=function(e,t,r){var n=sUt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Dn.apply(this,arguments)}function sUt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dn(e),e!==null););return e}function lUt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C1(e,t)}function C1(e,t){return C1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},C1(e,t)}function uUt(e){var t=hUt();return function(){var r=dn(e),n;if(t){var o=dn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cUt(this,n)}}function cUt(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fUt(e)}function fUt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hUt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dn(e){return dn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dn(e)}var O1="multiColumnSorting",dUt=170,pUt="append",_N="columnSorting";XY(O1,$Wt);var yUt=function(e){lUt(r,e);var t=uUt(r);function r(n){var o;return rUt(this,r),o=t.call(this,n),o.pluginKey=O1,o}return oUt(r,[{key:"isEnabled",value:function(){return Dn(dn(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[_N]&&jN(),Dn(dn(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Dn(dn(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(n){Dn(dn(r.prototype),"sort",this).call(this,n)}},{key:"clearSort",value:function(){Dn(dn(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Dn(dn(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(n){return Dn(dn(r.prototype),"getSortConfig",this).call(this,n)}},{key:"setSortConfig",value:function(n){Dn(dn(r.prototype),"setSortConfig",this).call(this,n)}},{key:"getNormalizedSortConfigs",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(n)?n:[n]}},{key:"updateHeaderClasses",value:function(n){for(var o,i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(o=Dn(dn(r.prototype),"updateHeaderClasses",this)).call.apply(o,[this,n].concat(a)),Bt(n,nUt(n)),this.enabled!==!1&&q(n,eUt.apply(void 0,a))}},{key:"onUpdateSettings",value:function(n){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[_N]&&jN(),Dn(dn(r.prototype),"onUpdateSettings",this).call(this,n)}},{key:"onAfterOnCellMouseDown",value:function(n,o){AO(o.row,o.col,n)!==!1&&this.wasClickableHeaderClicked(n,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(o.col),this.sort(this.getNextSortConfig(o.col,pUt))):this.sort(this.getColumnNextConfig(o.col)))}}],[{key:"PLUGIN_KEY",get:function(){return O1}},{key:"PLUGIN_PRIORITY",get:function(){return dUt}}]),r}(qY);function Gu(e){return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function gUt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vUt(n.key),n)}}function mUt(e,t,r){return t&&HN(e.prototype,t),r&&HN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vUt(e){var t=bUt(e,"string");return Gu(t)==="symbol"?t:String(t)}function bUt(e,t){if(Gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bg(){return typeof Reflect<"u"&&Reflect.get?bg=Reflect.get.bind():bg=function(e,t,r){var n=wUt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},bg.apply(this,arguments)}function wUt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zu(e),e!==null););return e}function AUt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k1(e,t)}function k1(e,t){return k1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},k1(e,t)}function SUt(e){var t=kUt();return function(){var r=zu(e),n;if(t){var o=zu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return CUt(this,n)}}function CUt(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OUt(e)}function OUt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kUt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zu(e){return zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zu(e)}var RUt="multipleSelectionHandles",EUt=160,TUt=function(e){AUt(r,e);var t=SUt(r);function r(n){var o;return gUt(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return mUt(r,[{key:"isEnabled",value:function(){return cr()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Re(this)),this.registerListeners(),bg(zu(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var n=this,o=this,i=this.hot.rootElement;function a(s){if(o.dragged.length===1)return o.dragged.splice(0,o.dragged.length),!0;var l=o.dragged.indexOf(s);if(l===-1)return!1;l===0?o.dragged=o.dragged.slice(0,1):l===1&&(o.dragged=o.dragged.slice(-1))}this.eventManager.addEventListener(i,"touchstart",function(s){var l;if(Dt(s.target,"topSelectionHandle-HitArea"))return l=o.hot.getSelectedRangeLast(),o.dragged.push("top"),o.touchStartRange={width:l.getWidth(),height:l.getHeight(),direction:l.getDirection()},s.preventDefault(),!1;if(Dt(s.target,"bottomSelectionHandle-HitArea"))return l=o.hot.getSelectedRangeLast(),o.dragged.push("bottom"),o.touchStartRange={width:l.getWidth(),height:l.getHeight(),direction:l.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(i,"touchend",function(s){if(Dt(s.target,"topSelectionHandle-HitArea"))return a.call(o,"top"),o.touchStartRange=void 0,s.preventDefault(),!1;if(Dt(s.target,"bottomSelectionHandle-HitArea"))return a.call(o,"bottom"),o.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(i,"touchmove",function(s){var l=n.hot.rootDocument,u,c,f,h,p,y;if(o.dragged.length!==0){var m=l.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!m||m===o.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(u=o.hot.getCoords(m),u.col===-1&&(u.col=0),c=o.hot.getSelectedRangeLast(),f=c.getWidth(),h=c.getHeight(),p=c.getDirection(),f===1&&h===1&&o.hot.selection.setRangeEnd(u),y=o.getCurrentRangeCoords(c,u,o.touchStartRange.direction,p,o.dragged[0]),y.start!==null&&o.hot.selection.setRangeStart(y.start),o.hot.selection.setRangeEnd(y.end),o.lastSetCell=m),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(n,o,i,a,s){var l=n.getTopStartCorner(),u=n.getBottomEndCorner(),c=n.getBottomStartCorner(),f=n.getTopEndCorner(),h={start:null,end:null};switch(i){case"NE-SW":switch(a){case"NE-SW":case"NW-SE":s==="top"?h={start:this.hot._createCellCoords(o.row,n.highlight.col),end:this.hot._createCellCoords(c.row,o.col)}:h={start:this.hot._createCellCoords(n.highlight.row,o.col),end:this.hot._createCellCoords(o.row,l.col)};break;case"SE-NW":s==="bottom"&&(h={start:this.hot._createCellCoords(u.row,o.col),end:this.hot._createCellCoords(o.row,l.col)});break}break;case"NW-SE":switch(a){case"NE-SW":s==="top"?h={start:o,end:c}:h.end=o;break;case"NW-SE":s==="top"?h={start:o,end:u}:h.end=o;break;case"SE-NW":s==="top"?h={start:o,end:l}:h.end=o;break;case"SW-NE":s==="top"?h={start:o,end:f}:h.end=o;break}break;case"SW-NE":switch(a){case"NW-SE":s==="bottom"?h={start:this.hot._createCellCoords(o.row,l.col),end:this.hot._createCellCoords(c.row,o.col)}:h={start:this.hot._createCellCoords(l.row,o.col),end:this.hot._createCellCoords(o.row,u.col)};break;case"SW-NE":s==="top"?h={start:this.hot._createCellCoords(n.highlight.row,o.col),end:this.hot._createCellCoords(o.row,u.col)}:h={start:this.hot._createCellCoords(o.row,l.col),end:this.hot._createCellCoords(l.row,o.col)};break;case"SE-NW":s==="bottom"?h={start:this.hot._createCellCoords(o.row,f.col),end:this.hot._createCellCoords(l.row,o.col)}:s==="top"&&(h={start:c,end:o});break}break;case"SE-NW":switch(a){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(h.end=o);break;case"SE-NW":s==="top"?h.end=o:h={start:o,end:l};break}break}return h}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return RUt}},{key:"PLUGIN_PRIORITY",get:function(){return EUt}}]),r}(re);function R1(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,s=e.collapsible,l=s===void 0?!1:s,u=e.crossHiddenColumns,c=u===void 0?[]:u,f=e.isCollapsed,h=f===void 0?!1:f,p=e.isHidden,y=p===void 0?!1:p,m=e.isRoot,v=m===void 0?!1:m,w=e.isPlaceholder,C=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:l,isCollapsed:h,crossHiddenColumns:c,isHidden:y,isRoot:v,isPlaceholder:C}}function pG(){return{label:"",isPlaceholder:!0}}function NN(e){return xUt(e)||IUt(e)||MUt(e)||PUt()}function PUt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MUt(e,t){if(e){if(typeof e=="string")return E1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E1(e,t)}}function IUt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xUt(e){if(Array.isArray(e))return E1(e)}function E1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jUt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;T(e,function(o){var i=[],a=0;r.push(i),T(o,function(s){var l=R1();if(zt(s)){var u=s.label,c=s.colspan;l.label=Pe(u),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c)}else l.label=Pe(s);a+=l.origColspan;var f=!1;if(a>=t&&(l.colspan=l.origColspan-(a-t),l.origColspan=l.colspan,f=!0),i.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)i.push(pG());return!f})});var n=Math.max.apply(Math,NN(Gt(r,function(o){return o.length})));return T(r,function(o){if(o.length<n){var i=Gt(new Array(n-o.length),function(){return R1()});o.splice.apply(o,[o.length,0].concat(NN(i)))}}),r}function Sd(e){return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}var DUt=["row","col"];function BN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _Ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BN(Object(r),!0).forEach(function(n){HUt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HUt(e,t,r){return t=yG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NUt(e,t){if(e==null)return{};var r=BUt(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BUt(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function LUt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yG(n.key),n)}}function VUt(e,t,r){return t&&LN(e.prototype,t),r&&LN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yG(e){var t=FUt(e,"string");return Sd(t)==="symbol"?t:String(t)}function FUt(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I0(e,t,r){WUt(e,t),t.set(e,r)}function WUt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(e,t){var r=gG(e,t,"get");return UUt(e,r)}function UUt(e,t){return t.get?t.get.call(e):t.value}function Kc(e,t,r){var n=gG(e,t,"set");return YUt(e,n,r),r}function gG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function YUt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var VN=["label","collapsible"],Qr=new WeakMap,Li=new WeakMap,x0=new WeakMap,GUt=function(){function e(){LUt(this,e),I0(this,Qr,{writable:!0,value:[]}),I0(this,Li,{writable:!0,value:0}),I0(this,x0,{writable:!0,value:1/0})}return VUt(e,[{key:"setColumnsLimit",value:function(t){Kc(this,x0,t)}},{key:"setData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Kc(this,Qr,jUt(t,rr(this,x0))),Kc(this,Li,rr(this,Qr).length)}},{key:"getData",value:function(){return rr(this,Qr)}},{key:"mergeWith",value:function(t){var r=this;T(t,function(n){var o=n.row,i=n.col,a=NUt(n,DUt),s=r.getHeaderSettings(o,i);s!==null&&Ve(s,a,VN)})}},{key:"map",value:function(t){T(rr(this,Qr),function(r){T(r,function(n){var o=t(_Ut({},n));zt(o)&&Ve(n,o,VN)})})}},{key:"getHeaderSettings",value:function(t,r){var n;if(t>=rr(this,Li)||t<0)return null;var o=rr(this,Qr)[t];return r>=o.length?null:(n=o[r])!==null&&n!==void 0?n:null}},{key:"getHeadersSettings",value:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=[];if(t>=rr(this,Li)||t<0)return o;for(var i=rr(this,Qr)[t],a=0,s=r;s<i.length;s++){var l=i[s];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=l.colspan,o.push(l),l.colspan>1&&(s+=l.colspan-1),a===n)break;if(a>n)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return rr(this,Li)}},{key:"getColumnsCount",value:function(){return rr(this,Li)>0?rr(this,Qr)[0].length:0}},{key:"clear",value:function(){Kc(this,Qr,[]),Kc(this,Li,0)}}]),e}();function Cd(e){return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function FN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function WN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FN(Object(r),!0).forEach(function(n){wg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zUt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mG(n.key),n)}}function QUt(e,t,r){return t&&UN(e.prototype,t),r&&UN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wg(e,t,r){return t=mG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mG(e){var t=KUt(e,"string");return Cd(t)==="symbol"?t:String(t)}function KUt(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XUt(e){return $Ut(e)||qUt(e)||ZUt(e)||JUt()}function JUt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZUt(e,t){if(e){if(typeof e=="string")return T1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T1(e,t)}}function qUt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Ut(e){if(Array.isArray(e))return T1(e)}function T1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var tYt="DF-pre-order";function vG(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=vG.call(this.childs[n],e,t)}return r}var eYt="DF-post-order";function bG(e,t){for(var r=0;r<this.childs.length;r++){var n=bG.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var wG="BF";function nYt(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,XUt(o.childs)),e.call(t,o)!==!1&&n()}}n()}var rYt=wG,YN=new Map([[tYt,vG],[eYt,bG],[wG,nYt]]),GN=function(){function e(t){zUt(this,e),wg(this,"data",{}),wg(this,"parent",null),wg(this,"childs",[]),this.data=t}return QUt(e,[{key:"addChild",value:function(t){t.parent=this,this.childs.push(t)}},{key:"cloneTree",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,r=new e(WN({},t.data)),n=0;n<t.childs.length;n++)r.addChild(this.cloneTree(t.childs[n]));return r}},{key:"replaceTreeWith",value:function(t){this.data=WN({},t.data),this.childs=[];for(var r=0;r<t.childs.length;r++)this.addChild(t.childs[r])}},{key:"walkDown",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rYt;if(!YN.has(r))throw new Error('Traversal strategy "'.concat(r,'" does not exist'));YN.get(r).call(this,t,this)}},{key:"walkUp",value:function(t){var r=this,n=function o(i){var a=t.call(r,i);a!==!1&&i.parent!==null&&o(i.parent)};n(this)}}]),e}();function Od(e){return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function zN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function QN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zN(Object(r),!0).forEach(function(n){oYt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oYt(e,t,r){return t=AG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iYt(e,t){return uYt(e)||lYt(e,t)||sYt(e,t)||aYt()}function aYt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sYt(e,t){if(e){if(typeof e=="string")return KN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KN(e,t)}}function KN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lYt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function uYt(e){if(Array.isArray(e))return e}function cYt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AG(n.key),n)}}function fYt(e,t,r){return t&&XN(e.prototype,t),r&&XN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AG(e){var t=hYt(e,"string");return Od(t)==="symbol"?t:String(t)}function hYt(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j0(e,t,r){dYt(e,t),t.set(e,r)}function dYt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cn(e,t){var r=SG(e,t,"get");return pYt(e,r)}function pYt(e,t){return t.get?t.get.call(e):t.value}function yYt(e,t,r){var n=SG(e,t,"set");return gYt(e,n,r),r}function SG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function gYt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ss=new WeakMap,Vi=new WeakMap,Cs=new WeakMap,mYt=function(){function e(t){cYt(this,e),j0(this,Ss,{writable:!0,value:new Map}),j0(this,Vi,{writable:!0,value:new Map}),j0(this,Cs,{writable:!0,value:null}),yYt(this,Cs,t)}return fYt(e,[{key:"getRoots",value:function(){return Array.from(cn(this,Ss).values())}},{key:"getRootByColumn",value:function(t){var r;return cn(this,Vi).has(t)&&(r=cn(this,Ss).get(cn(this,Vi).get(t))),r}},{key:"getNode",value:function(t,r){var n=this.getRootByColumn(r);if(n){var o=r-cn(this,Vi).get(r),i=0,a;return n.walkDown(function(s){var l=s.data,u=l.origColspan,c=l.headerLevel;if(t===c){if(o>=i&&o<=i+u-1)return a=s,a.data.isRoot=r===a.data.columnIndex,!1;i+=u}}),a}}},{key:"rebuildTreeIndex",value:function(){var t=this,r=0;cn(this,Vi).clear(),T(cn(this,Ss),function(n){for(var o=iYt(n,2),i=o[1].data.colspan,a=r;a<r+i;a++)cn(t,Vi).set(a,r);r+=i})}},{key:"buildTree",value:function(){this.clear();for(var t=cn(this,Cs).getColumnsCount(),r=0;r<t;){var n=cn(this,Cs).getHeaderSettings(0,r),o=new GN;cn(this,Ss).set(r,o),this.buildLeaves(o,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(t,r,n){var o=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,a=cn(this,Cs).getHeadersSettings(n,r,i);n+=1,T(a,function(s){var l=QN(QN({},s),{},{headerLevel:n-1,columnIndex:r}),u;n===1?(t.data=l,u=t):(u=new GN(l),t.addChild(u)),n<cn(o,Cs).getLayersCount()&&o.buildLeaves(u,r,n,s.origColspan),r+=s.origColspan})}},{key:"clear",value:function(){cn(this,Ss).clear(),cn(this,Vi).clear()}}]),e}();function CG(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function jm(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function Dm(e){return jm(e,"origColspan")===e.data.origColspan}function EE(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Dm(e);if(n)return EE(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)T(o,function(f){f.replaceTreeWith(f.data.clonedTree),f.data.clonedTree=null;var h=f.data;a+=h.colspan,CG(f,function(p){i.add(p)})});else{var s=t.colspan,l=t.origColspan,u=t.columnIndex;a=l-s;for(var c=1;c<l;c++)i.add(u+c)}return e.walkUp(function(f){var h=f.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):Dm(f)&&(h.isCollapsed=jm(f,"isCollapsed"))}),{rollbackModification:function(){return TE(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function TE(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Dm(e);if(o)return TE(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)T(i,function(h){CG(h,function(p){a.add(p)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(p){var y=p.data;y.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var c=l+u;a.add(c)}var f=r.colspan-((t=jm(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var p=h.data;p.colspan-=f,p.colspan<=1?(p.colspan=1,p.isCollapsed=!0):Dm(h)&&(p.isCollapsed=jm(h,"isCollapsed"))}),{rollbackModification:function(){return EE(e)},affectedColumns:Array.from(a),colspanCompensation:f}}var JN;function vYt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bYt(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ce(JN||(JN=vYt([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var ZN;function wYt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function AYt(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ce(ZN||(ZN=wYt([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var qN=new Map([["collapse",TE],["expand",EE],["hide-column",bYt],["show-column",AYt]]);function SYt(e,t,r){if(!qN.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return qN.get(e)(t,r)}var CYt=["crossHiddenColumns"];function OYt(e,t){if(e==null)return{};var r=kYt(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kYt(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Py(e){var t=[];return T(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,s=o.headerLevel,l=o.crossHiddenColumns,u=EYt(t,s),c=!1,f=a;f<a+i;f++){var h=l.includes(f);if(h||c)u.push(pG());else{var p=RYt(o);p.isRoot=!0,u.push(p),c=!0}}})}),t}function RYt(e){var t=R1(e);t.crossHiddenColumns;var r=OYt(t,CYt);return r}function EYt(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function kd(e){return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}var TYt=["row"];function $N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function tB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$N(Object(r),!0).forEach(function(n){PYt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$N(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PYt(e,t,r){return t=OG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MYt(e,t){if(e==null)return{};var r=IYt(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function IYt(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function xYt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OG(n.key),n)}}function jYt(e,t,r){return t&&eB(e.prototype,t),r&&eB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OG(e){var t=DYt(e,"string");return kd(t)==="symbol"?t:String(t)}function DYt(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D0(e,t,r){_Yt(e,t),t.set(e,r)}function _Yt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xc(e,t,r){var n=kG(e,t,"set");return HYt(e,n,r),r}function HYt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function je(e,t){var r=kG(e,t,"get");return NYt(e,r)}function kG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function NYt(e,t){return t.get?t.get.call(e):t.value}var Tr=new WeakMap,jn=new WeakMap,Fi=new WeakMap,BYt=function(){function e(){xYt(this,e),D0(this,Tr,{writable:!0,value:new GUt}),D0(this,jn,{writable:!0,value:new mYt(je(this,Tr))}),D0(this,Fi,{writable:!0,value:[[]]})}return jYt(e,[{key:"setState",value:function(t){je(this,Tr).setData(t);var r=!1;try{je(this,jn).buildTree()}catch{je(this,jn).clear(),je(this,Tr).clear(),r=!0}return Xc(this,Fi,Py(je(this,jn).getRoots())),r}},{key:"setColumnsLimit",value:function(t){je(this,Tr).setColumnsLimit(t)}},{key:"mergeStateWith",value:function(t){var r=this,n=Gt(t,function(o){var i=o.row,a=MYt(o,TYt);return tB({row:i<0?r.rowCoordsToLevel(i):i},a)});je(this,Tr).mergeWith(n),je(this,jn).buildTree(),Xc(this,Fi,Py(je(this,jn).getRoots()))}},{key:"mapState",value:function(t){je(this,Tr).map(t),je(this,jn).buildTree(),Xc(this,Fi,Py(je(this,jn).getRoots()))}},{key:"mapNodes",value:function(t){return _e(je(this,jn).getRoots(),function(r,n){return n.walkDown(function(o){var i=t(o.data);i!==void 0&&r.push(i)}),r},[])}},{key:"triggerNodeModification",value:function(t,r,n){r<0&&(r=this.rowCoordsToLevel(r));var o=je(this,jn).getNode(r,n),i;return o&&(i=SYt(t,o,n),Xc(this,Fi,Py(je(this,jn).getRoots()))),i}},{key:"triggerColumnModification",value:function(t,r){return this.triggerNodeModification(t,-1,r)}},{key:"rowCoordsToLevel",value:function(t){if(t>=0)return null;var r=t+Math.max(this.getLayersCount(),1);return r<0?null:r}},{key:"levelToRowCoords",value:function(t){if(t<0)return null;var r=t-Math.max(this.getLayersCount(),1);return r>=0?null:r}},{key:"getHeaderSettings",value:function(t,r){var n,o;return t<0&&(t=this.rowCoordsToLevel(t)),t===null||t>=this.getLayersCount()?null:(n=(o=je(this,Fi)[t])===null||o===void 0?void 0:o[r])!==null&&n!==void 0?n:null}},{key:"getHeaderTreeNodeData",value:function(t,r){if(t<0&&(t=this.rowCoordsToLevel(t)),t===null||t>=this.getLayersCount())return null;var n=je(this,jn).getNode(t,r);return n?tB({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(t,r){var n,o=(n=this.getHeaderSettings(t,r))!==null&&n!==void 0?n:{isRoot:!0},i=o.isRoot;if(i)return r;for(var a=r-1;a>=0;){var s,l=(s=this.getHeaderSettings(t,a))!==null&&s!==void 0?s:{isRoot:!0},u=l.isRoot;if(u)break;a-=1}return a}},{key:"getLayersCount",value:function(){return je(this,Tr).getLayersCount()}},{key:"getColumnsCount",value:function(){return je(this,Tr).getColumnsCount()}},{key:"clear",value:function(){Xc(this,Fi,[]),je(this,Tr).clear(),je(this,jn).clear()}}]),e}();function Rd(e){return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function LYt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RG(n.key),n)}}function VYt(e,t,r){return t&&nB(e.prototype,t),r&&nB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jc(e,t,r){return t=RG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RG(e){var t=FYt(e,"string");return Rd(t)==="symbol"?t:String(t)}function FYt(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WYt=function(){function e(t,r){LYt(this,e),Jc(this,"hot",void 0),Jc(this,"nestedHeaderSettingsGetter",void 0),Jc(this,"layersCount",0),Jc(this,"container",void 0),Jc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return VYt(e,[{key:"setLayersCount",value:function(t){return this.layersCount=t,this}},{key:"getWidth",value:function(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var t=this.container.querySelectorAll("tr:last-of-type th"),r=t.length;this.widthsMap.clear();for(var n=0;n<r;n++){var o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),i=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(i,t[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(t){for(var r=this.hot,n=r.rootDocument,o=r.columnIndexMapper,i=n.createDocumentFragment(),a=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,l=o.getRenderableIndexesLength(),u=0;u<this.layersCount;u++){for(var c=n.createElement("tr"),f=0;f<l;f++){var h=o.getVisualFromRenderableIndex(f);h===null&&(h=f);var p=n.createElement("th"),y=this.nestedHeaderSettingsGetter(u,h);if(y&&(!y.isPlaceholder||y.isHidden)){var m=y.label;s&&(m+='<button class="changeType"></button>'),Ya(p,m),p.colSpan=y.colspan,c.appendChild(p)}}a.appendChild(c)}i.appendChild(a),t.appendChild(i)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const UYt=WYt;function Qu(e){return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(e)}var rB,oB;function iB(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function YYt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EG(n.key),n)}}function GYt(e,t,r){return t&&aB(e.prototype,t),r&&aB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(e,t,r){var n=zYt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},da.apply(this,arguments)}function zYt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function QYt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P1(e,t)}function P1(e,t){return P1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},P1(e,t)}function KYt(e){var t=JYt();return function(){var r=Co(e),n;if(t){var o=Co(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return XYt(this,n)}}function XYt(e,t){if(t&&(Qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return af(e)}function af(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JYt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Co(e)}function sB(e,t,r){return t=EG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EG(e){var t=ZYt(e,"string");return Qu(t)==="symbol"?t:String(t)}function ZYt(e,t){if(Qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lB(e,t,r){qYt(e,t),t.set(e,r)}function qYt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function My(e,t,r){var n=TG(e,t,"set");return $Yt(e,n,r),r}function $Yt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ee(e,t){var r=TG(e,t,"get");return t2t(e,r)}function TG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function t2t(e,t){return t.get?t.get.call(e):t.value}var uB="nestedHeaders",e2t=280,Ne=new WeakMap,zo=new WeakMap,n2t=function(e){QYt(r,e);var t=KYt(r);function r(){var n;YYt(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),lB(af(n),Ne,{writable:!0,value:new BYt}),lB(af(n),zo,{writable:!0,value:null}),sB(af(n),"ghostTable",new UYt(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),sB(af(n),"detectedOverlappedHeaders",!1),n}return GYt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[uB]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings(),i=o.nestedHeaders;(!Array.isArray(i)||!Array.isArray(i[0]))&&de(ce(rB||(rB=iB([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return n.onInit()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("afterOnCellMouseDown",function(){return n.onAfterOnCellMouseDown.apply(n,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return n.onBeforeOnCellMouseOver.apply(n,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(a){return n.onAfterGetColumnHeaderRenderers(a)}),this.addHook("modifyColWidth",function(){return n.onModifyColWidth.apply(n,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return n.onModifyColumnHeaderValue.apply(n,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return n.onBeforeHighlightingColumnHeader.apply(n,arguments)}),this.addHook("beforeCopy",function(){return n.onBeforeCopy.apply(n,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return n.onAfterViewportColumnCalculatorOverride.apply(n,arguments)}),da(Co(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var n=this;if(this.hot.view){var o=this.hot.getSettings(),i=o.nestedHeaders;Ee(this,Ne).setColumnsLimit(this.hot.countCols()),Array.isArray(i)&&(this.detectedOverlappedHeaders=Ee(this,Ne).setState(i)),this.detectedOverlappedHeaders&&de(ce(oB||(oB=iB([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(a,s){var l=a===!0?"hide-column":"show-column";Ee(n,Ne).triggerColumnModification(l,s)}),!Ee(this,zo)&&this.enabled&&My(this,zo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(a){a.forEach(function(s){var l=s.op,u=s.index,c=s.newValue;if(l==="replace"){var f=c===!0?"hide-column":"show-column";Ee(n,Ne).triggerColumnModification(f,u)}}),n.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),da(Co(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Ee(this,Ne).clear(),Ee(this,zo).unsubscribe(),My(this,zo,null),this.ghostTable.clear(),da(Co(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Ee(this,Ne)}},{key:"getLayersCount",value:function(){return Ee(this,Ne).getLayersCount()}},{key:"getHeaderSettings",value:function(n,o){return Ee(this,Ne).getHeaderSettings(n,o)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var n=this.hot.view._wt,o=n.getSetting("columnHeaders").length,i=n.wtTable.THEAD,a=n.wtOverlays.topOverlay.clone.wtTable.THEAD,s=n.wtOverlays.topInlineStartCornerOverlay?n.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=0;l<o;l++){var u=i.childNodes[l];if(!u)break;for(var c=a.childNodes[l],f=s?s.childNodes[l]:null,h=0,p=u.childNodes.length;h<p;h++)u.childNodes[h].removeAttribute("colspan"),Bt(u.childNodes[h],"hiddenHeader"),c&&c.childNodes[h]&&(c.childNodes[h].removeAttribute("colspan"),Bt(c.childNodes[h],"hiddenHeader")),s&&f&&f.childNodes[h]&&(f.childNodes[h].removeAttribute("colspan"),Bt(f.childNodes[h],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(n){var o=this,i=this.hot.view._wt.getSetting("fixedColumnsStart");return function(a,s){var l,u=o.hot,c=u.columnIndexMapper,f=u.view,h=c.getVisualFromRenderableIndex(a);h===null&&(h=a),s.removeAttribute("colspan"),Bt(s,"hiddenHeader");var p=(l=Ee(o,Ne).getHeaderSettings(n,h))!==null&&l!==void 0?l:{label:""},y=p.colspan,m=p.isHidden,v=p.isPlaceholder;if(v||m)q(s,"hiddenHeader");else if(y>1){var w,C,A=f._wt.wtOverlays,D=(w=A.topInlineStartCornerOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(s),E=(C=A.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),G=D||E?Math.min(y,i-a):y;G>1&&s.setAttribute("colspan",G)}o.hot.view.appendColHeader(h,s,function(){return o.getColumnHeaderValue.apply(o,arguments)},n)}}},{key:"getColumnHeaderValue",value:function(n,o){var i,a=(i=Ee(this,Ne).getHeaderSettings(o,n))!==null&&i!==void 0?i:{},s=a.isHidden,l=a.isPlaceholder;return l||s?"":this.hot.getColHeader(n,o)}},{key:"onBeforeHighlightingColumnHeader",value:function(n,o,i){var a=Ee(this,Ne).getHeaderTreeNodeData(o,n);if(!a)return n;var s=i.classNames,l=i.columnCursor,u=i.selectionType,c=i.selectionWidth,f=Ee(this,Ne).getHeaderSettings(o,n),h=f.isRoot,p=f.colspan;if(u===gp){if(!h)return a.columnIndex}else u===Jb&&(p>c-l||!h)&&(s.length=0);return n}},{key:"onBeforeCopy",value:function(n,o,i){var a=i.columnHeadersCount;if(a!==0)for(var s=0;s<o.length;s++){var l=o[s],u=l.startRow,c=l.startCol,f=l.endRow,h=l.endCol,p=f-u+1,y=c-h+1;if(u>=0||y===1)break;for(var m=c;m<=h;m++)for(var v=u;v<=f;v++){var w,C=p+v,A=m-c;if(A!==0){var D=(w=Ee(this,Ne).getHeaderTreeNodeData(v,m))===null||w===void 0?void 0:w.isRoot;D===!1&&(n[C][A]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i,a){var s=this._getHeaderTreeNodeDataByCoords(o);s&&(a.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(n,o){var i=this._getHeaderTreeNodeDataByCoords(o);if(i){var a=this.hot.selection,s=a.isSelected()?a.getSelectedRange().current():null,l=[],u=i.columnIndex,c=i.origColspan,f=!a.inInSelection(o);n.shiftKey&&s?o.col<s.from.col?l.push(s.getTopEndCorner().col,u,o.row):o.col>s.from.col?l.push(s.getTopStartCorner().col,u+c-1,o.row):l.push(u,u+c-1,o.row):(kv(n)||bi(n)&&f)&&l.push(u,u+c-1,o.row),a.selectColumns.apply(a,l)}}},{key:"onBeforeOnCellMouseOver",value:function(n,o,i,a){var s;if(this.hot.view.isMouseDown()){var l=this._getHeaderTreeNodeDataByCoords(o);if(l){var u=l.columnIndex,c=l.origColspan,f=this.hot.getSelectedRangeLast(),h=f.getTopStartCorner(),p=f.getBottomEndCorner(),y=f.from;a.column=!0,a.cell=!0;var m=[];o.col<y.col?m.push(p.col,u):o.col>y.col?m.push(h.col,u+c-1):m.push(u,u+c-1),(s=this.hot).selectColumns.apply(s,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(n){n.length=0;for(var o=0;o<Ee(this,Ne).getLayersCount();o++)n.push(this.headerRendererFactory(o))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){for(var o=Ee(this,Ne).getLayersCount(),i=n.startColumn,a=!!o,s=0;s<o;s++){var l=Ee(this,Ne).findLeftMostColumnIndex(s,n.startColumn),u=this.hot.columnIndexMapper.getRenderableFromVisualIndex(l);if(l>=0&&(a=!1),Nn(u)&&u<n.startColumn){i=u;break}}n.startColumn=a?Ee(this,Ne).getHeaderTreeNodeData(0,i).columnIndex:i}},{key:"onModifyColWidth",value:function(n,o){var i=this.ghostTable.getWidth(o);return n>i?n:i}},{key:"onModifyColumnHeaderValue",value:function(n,o,i){var a,s=(a=Ee(this,Ne).getHeaderTreeNodeData(i,o))!==null&&a!==void 0?a:{label:""},l=s.label;return l}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(n,o){o||this.updatePlugin()}},{key:"destroy",value:function(){My(this,Ne,null),Ee(this,zo)!==null&&(Ee(this,zo).unsubscribe(),My(this,zo,null)),da(Co(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(n){if(!(n.row>=0||n.col<0))return Ee(this,Ne).getHeaderTreeNodeData(n.row,n.col)}}],[{key:"PLUGIN_KEY",get:function(){return uB}},{key:"PLUGIN_PRIORITY",get:function(){return e2t}}]),r}(re);function cB(e){return a2t(e)||i2t(e)||o2t(e)||r2t()}function r2t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o2t(e,t){if(e){if(typeof e=="string")return M1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M1(e,t)}}function i2t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function a2t(e){if(Array.isArray(e))return M1(e)}function M1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ku(e){return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function s2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u2t(n.key),n)}}function l2t(e,t,r){return t&&fB(e.prototype,t),r&&fB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u2t(e){var t=c2t(e,"string");return Ku(t)==="symbol"?t:String(t)}function c2t(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f2t=function(){function e(t,r){s2t(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return l2t(e,[{key:"setData",value:function(t){this.data=t}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}},{key:"updateWithData",value:function(t){this.setData(t),this.rewriteCache()}},{key:"rewriteCache",value:function(){var t=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ct(0,this.data.length-1,function(r){t.cacheNode(t.data[r],0,null)})}},{key:"cacheNode",value:function(t,r,n){var o=this;this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(t)&&T(t.__children,function(i){o.cacheNode(i,r+1,t)})}},{key:"getDataObject",value:function(t){return t==null?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function(t,r,n,o){var i=this,a=!1,s=r;if(isNaN(s)&&s.end)return s;var l=t;return l||(l={__children:this.data},a=!0,s-=1),n!=null&&s===n?{result:l,end:!0}:o!=null&&l===o?{result:s,end:!0}:(s+=1,l.__children&&T(l.__children,function(u){if(i.parentReference.set(u,a?null:l),s=i.readTreeNodes(u,s,n,o),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var t=this.mockNode();return t.__children=this.data,t}},{key:"mockNode",value:function(){var t={};return Qt(this.data[0],function(r,n){t[n]=null}),t}},{key:"getRowIndex",value:function(t){return t==null?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function(t){var r=null;isNaN(t)?r=t:r=this.getDataObject(t);var n=this.getRowParent(t);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}},{key:"countAllRows",value:function(){var t={__children:this.data};return this.countChildren(t)}},{key:"countChildren",value:function(t){var r=this,n=0,o=t;return isNaN(o)||(o=this.getDataObject(o)),!o||!o.__children?0:(T(o.__children,function(i){n+=1,i.__children&&(n+=r.countChildren(i))}),n)}},{key:"getRowParent",value:function(t){var r;return isNaN(t)?r=t:r=this.getDataObject(t),this.getRowObjectParent(r)}},{key:"getRowObjectParent",value:function(t){return!t||Ku(t)!=="object"?null:this.cache.nodeInfo.get(t).parent}},{key:"getRowLevel",value:function(t){var r=null;return isNaN(t)?r=t:r=this.getDataObject(t),r?this.getRowObjectLevel(r):null}},{key:"getRowObjectLevel",value:function(t){return t==null?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function(t){var r=t;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}},{key:"isChild",value:function(t){return this.getRowParent(t)!==null}},{key:"getChild",value:function(t,r){var n;return((n=t.__children)===null||n===void 0?void 0:n[r])||null}},{key:"isRowHighestLevel",value:function(t){return!this.isChild(t)}},{key:"isParent",value:function(t){var r,n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}},{key:"addChild",value:function(t,r){var n=r;this.hot.runHooks("beforeAddChild",t,n);var o=null;t&&(o=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(t)+1,1);var i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();var a=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",t,n)}},{key:"addChildAtIndex",value:function(t,r,n){var o=n,i;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",t,o,r),t){var a=this.getRowIndex(t),s=a+r+1;this.hot.runHooks("beforeCreateRow",s,1),t.__children.splice(r,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),i=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),i=this.getRowIndex(this.data[r]);o=this.getDataObject(i),this.hot.runHooks("afterAddChild",t,o,r)}},{key:"addSibling",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",n=this.translateTrimmedRow(t),o=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null);break}}},{key:"detachFromParent",value:function(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=null,i=[];Array.isArray(t)?(Ct(t[0],t[2],function(v){var w=r.translateTrimmedRow(v);i.push(r.getDataObject(w))}),Ct(0,i.length-2,function(v){r.detachFromParent(i[v],!1)}),o=i[i.length-1]):o=t;var a=this.getRowIndex(o),s=this.countChildren(o),l=this.getRowIndexWithinParent(o),u=this.getRowParent(o),c=this.getRowParent(u),f=this.getRowIndex(c),h=null;if(this.hot.runHooks("beforeDetachChild",u,o),l!=null){var p=Array.from(new Array(a+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",a,s+1,p,this.plugin.pluginName),u.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",a,s+1,p,this.plugin.pluginName),c){h=f+this.countChildren(c);var y=this.getChild(c,this.countChildren(c)-1),m=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),c.__children.push(o)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",u,o,this.getRowIndex(o)),n&&this.hot.render()}},{key:"filterData",value:function(t,r,n){var o=this,i=[];T(n,function(a){i.push(o.getDataObject(a))}),T(i,function(a){var s=o.getRowIndexWithinParent(a),l=o.getRowParent(a);l===null?o.data.splice(s,1):l.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(t,r,n){var o=this.getDataObject(t-1),i=null,a=t;if(o&&o.__children&&o.__children.length===0?(i=o,a=0):t<this.countAllRows()&&(i=this.getRowParent(t),a=this.getRowIndexWithinParent(t)),i)if(n){var s;(s=i.__children).splice.apply(s,[a,r].concat(cB(n)))}else i.__children.splice(a,r);else if(n){var l;(l=this.data).splice.apply(l,[a,r].concat(cB(n)))}else this.data.splice(a,r);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(t){var r=t,n=null;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(t,r,n,o){var i=r===this.hot.countRows(),a=this.getRowParent(t),s=this.getRowIndexWithinParent(t),l=a.__children.slice(s,s+1),u=t>r,c=i?this.getRowParent(r-1):this.getRowParent(r);c==null&&(c=this.getRowParent(r-1)),c==null&&(c=this.getDataObject(r-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(r),c.__children=[]);var f=i||n||o?c.__children.length:this.getRowIndexWithinParent(r),h=a===c;c.__children.splice(f,0,l[0]),a.__children.splice(s+(u&&h?1:0),1),this.syncRowWithRawSource(a),h||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}},{key:"untranslateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}]),e}();const h2t=f2t;function Ed(e){return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}function hB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p2t(n.key),n)}}function d2t(e,t,r){return t&&hB(e.prototype,t),r&&hB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p2t(e){var t=y2t(e,"string");return Ed(t)==="symbol"?t:String(t)}function y2t(e,t){if(Ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var m2t=d2t(function e(t,r){g2t(this,e),this.hot=r,this.plugin=t});const PE=m2t;function Xu(e){return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function v2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w2t(n.key),n)}}function b2t(e,t,r){return t&&dB(e.prototype,t),r&&dB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w2t(e){var t=A2t(e,"string");return Xu(t)==="symbol"?t:String(t)}function A2t(e,t){if(Xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S2t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I1(e,t)}function I1(e,t){return I1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},I1(e,t)}function C2t(e){var t=R2t();return function(){var r=_m(e),n;if(t){var o=_m(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return O2t(this,n)}}function O2t(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k2t(e)}function k2t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R2t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _m(e){return _m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_m(e)}var E2t=function(e){S2t(r,e);var t=C2t(r);function r(n,o){var i;return v2t(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return b2t(r,[{key:"appendLevelIndicators",value:function(n,o){var i=this.hot.toPhysicalRow(n),a=this.dataManager.getRowLevel(i),s=this.dataManager.getDataObject(i),l=o.getElementsByTagName("DIV")[0],u=l.querySelector("span.rowHeader"),c=l.querySelectorAll('[class^="ht_nesting"]');if(T(c,function(y){y&&l.removeChild(y)}),q(o,r.CSS_CLASSES.indicatorContainer),a){var f=this.hot.rootDocument,h=u.cloneNode(!0);l.innerHTML="",Ct(0,a-1,function(){var y=f.createElement("SPAN");q(y,r.CSS_CLASSES.emptyIndicator),l.appendChild(y)}),l.appendChild(h)}if(this.dataManager.hasChildren(s)){var p=this.hot.rootDocument.createElement("DIV");q(o,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?q(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):q(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),l.appendChild(p)}}},{key:"updateRowHeaderWidth",value:function(n){var o=n;o||(o=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*o+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(PE);const PG=E2t;function Ju(e){return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function pB(e){return I2t(e)||M2t(e)||P2t(e)||T2t()}function T2t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P2t(e,t){if(e){if(typeof e=="string")return x1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x1(e,t)}}function M2t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function I2t(e){if(Array.isArray(e))return x1(e)}function x1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D2t(n.key),n)}}function j2t(e,t,r){return t&&yB(e.prototype,t),r&&yB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D2t(e){var t=_2t(e,"string");return Ju(t)==="symbol"?t:String(t)}function _2t(e,t){if(Ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H2t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j1(e,t)}function j1(e,t){return j1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},j1(e,t)}function N2t(e){var t=V2t();return function(){var r=Hm(e),n;if(t){var o=Hm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return B2t(this,n)}}function B2t(e,t){if(t&&(Ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L2t(e)}function L2t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V2t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hm(e){return Hm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hm(e)}var F2t=function(e){H2t(r,e);var t=N2t(r);function r(n,o){var i;return x2t(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,a)},shiftStash:function(a,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),T(i.lastCollapsedRows,function(u,c){u>=a&&u<s&&(i.lastCollapsedRows[c]=u+l)})},applyStash:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,a),i.lastCollapsedRows=void 0},trimStash:function(a,s){Ct(a,a+s-1,function(l){var u=i.lastCollapsedRows.indexOf(l);u>-1&&i.lastCollapsedRows.splice(u,1)})}},i}return j2t(r,[{key:"collapseChildren",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],l=null,u=null,c=null;return isNaN(n)?(l=n,u=this.dataManager.getRowIndex(l)):(l=this.dataManager.getDataObject(n),u=n),this.dataManager.hasChildren(l)&&T(l.__children,function(f){s.push(o.dataManager.getRowIndex(f))}),c=this.collapseRows(s,!0,!1),a&&this.trimRows(c),i&&this.renderAndAdjust(),this.collapsedRows.indexOf(u)===-1&&this.collapsedRows.push(u),c}},{key:"collapseMultipleChildren",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];T(n,function(l){s.push.apply(s,pB(o.collapseChildren(l,!1,!1)))}),a&&this.trimRows(s),i&&this.renderAndAdjust()}},{key:"collapseRow",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([n],o)}},{key:"collapseRows",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return T(n,function(l){s.push(l),i&&o.collapseChildRows(l,s)}),a&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(n)){var s=this.dataManager.getDataObject(n);T(s.__children,function(l){var u=o.dataManager.getRowIndex(l);i.push(u),o.collapseChildRows(u,i)})}a&&this.trimRows(i)}},{key:"expandRow",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([n],o)}},{key:"expandRows",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return T(n,function(l){s.push(l),i&&o.expandChildRows(l,s)}),a&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(n)){var s=this.dataManager.getDataObject(n);T(s.__children,function(l){if(!o.isAnyParentCollapsed(l)){var u=o.dataManager.getRowIndex(l);i.push(u),o.expandChildRows(u,i)}})}a&&this.untrimRows(i)}},{key:"expandChildren",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],l=null,u=null,c=null;return isNaN(n)?(l=n,u=this.dataManager.getRowIndex(n)):(l=this.dataManager.getDataObject(n),u=n),this.collapsedRows.splice(this.collapsedRows.indexOf(u),1),this.dataManager.hasChildren(l)&&T(l.__children,function(f){var h=o.dataManager.getRowIndex(f);s.push(h)}),c=this.expandRows(s,!0,!1),a&&this.untrimRows(c),i&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];T(n,function(l){s.push.apply(s,pB(o.expandChildren(l,!1,!1)))}),a&&this.untrimRows(s),i&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var n=this,o=this.dataManager.getData(),i=[];T(o,function(a){n.dataManager.hasChildren(a)&&i.push(a)}),this.collapseMultipleChildren(i),this.renderAndAdjust()}},{key:"expandAll",value:function(){var n=this,o=this.dataManager.getData(),i=[];T(o,function(a){n.dataManager.hasChildren(a)&&i.push(a)}),this.expandMultipleChildren(i),this.renderAndAdjust()}},{key:"trimRows",value:function(n){var o=this;this.hot.batchExecution(function(){T(n,function(i){o.plugin.collapsedRowsMap.setValueAtIndex(i,!0)})},!0)}},{key:"untrimRows",value:function(n){var o=this;this.hot.batchExecution(function(){T(n,function(i){o.plugin.collapsedRowsMap.setValueAtIndex(i,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(n){var o=this,i=isNaN(n)?n:this.dataManager.getDataObject(n),a=!0;return i===null&&(i={__children:this.dataManager.data}),this.dataManager.hasChildren(i)&&T(i.__children,function(s){var l=o.dataManager.getRowIndex(s);if(!o.plugin.collapsedRowsMap.getValueAtIndex(l))return a=!1,!1}),a}},{key:"isAnyParentCollapsed",value:function(n){for(var o=n;o!==null;){o=this.dataManager.getRowParent(o);var i=this.dataManager.getRowIndex(o);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}},{key:"toggleState",value:function(n,o){if(!(o.col>=0)){var i=this.translateTrimmedRow(o.row);Dt(n.target,PG.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),gr(n))}}},{key:"translateTrimmedRow",value:function(n){return this.hot.toPhysicalRow(n)}},{key:"untranslateTrimmedRow",value:function(n){return this.hot.toVisualRow(n)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(PE);const W2t=F2t;function Zu(e){return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function U2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G2t(n.key),n)}}function Y2t(e,t,r){return t&&gB(e.prototype,t),r&&gB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function G2t(e){var t=z2t(e,"string");return Zu(t)==="symbol"?t:String(t)}function z2t(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q2t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D1(e,t)}function D1(e,t){return D1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},D1(e,t)}function K2t(e){var t=J2t();return function(){var r=Nm(e),n;if(t){var o=Nm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return X2t(this,n)}}function X2t(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MG(e)}function MG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J2t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nm(e){return Nm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nm(e)}var mB=new WeakMap,Z2t=function(e){Q2t(r,e);var t=K2t(r);function r(n,o){var i;return U2t(this,r),i=t.call(this,n,o),mB.set(MG(i),{row_above:function(a,s){var l=s[s.length-1];i.dataManager.addSibling(l.start.row,"above")},row_below:function(a,s){var l=s[s.length-1];i.dataManager.addSibling(l.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return Y2t(r,[{key:"appendOptions",value:function(n){var o=this,i=[{key:"add_child",name:function(){return this.getTranslatedPhrase(pb)},callback:function(){var a=o.dataManager.translateTrimmedRow(o.hot.getSelectedLast()[0]),s=o.dataManager.getDataObject(a);o.dataManager.addChild(s)},disabled:function(){var a=o.hot.getSelectedLast();return!a||a[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(yb)},callback:function(){o.dataManager.detachFromParent(o.hot.getSelectedLast())},disabled:function(){var a=o.hot.getSelectedLast(),s=o.dataManager.translateTrimmedRow(a[0]),l=o.dataManager.getRowParent(s);return!l||!a||a[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{name:"---------"}];return Ct(0,n.items.length-1,function(a){if(a===0)return T(i,function(s,l){n.items.splice(a+l,0,s)}),!1}),this.modifyRowInsertingOptions(n)}},{key:"modifyRowInsertingOptions",value:function(n){var o=mB.get(this);return Ct(0,n.items.length-1,function(i){var a=o[n.items[i].key];a!=null&&(n.items[i].callback=a)}),n}}]),r}(PE);const q2t=Z2t;function Td(e){return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}var vB;function bB(e){return nGt(e)||eGt(e)||tGt(e)||$2t()}function $2t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tGt(e,t){if(e){if(typeof e=="string")return _1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _1(e,t)}}function eGt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nGt(e){if(Array.isArray(e))return _1(e)}function _1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rGt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function oGt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aGt(n.key),n)}}function iGt(e,t,r){return t&&wB(e.prototype,t),r&&wB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aGt(e){var t=sGt(e,"string");return Td(t)==="symbol"?t:String(t)}function sGt(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lGt=function(){function e(t){oGt(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return iGt(e,[{key:"onBeforeRowMove",value:function(t,r,n,o){var i=this,a=this.displayAPICompatibilityWarning({rows:t,finalIndex:r,dropIndex:n,movePossible:o});if(a)return!1;this.movedToCollapsed=!1;var s=n===this.hot.countRows(),l=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),u=!0,c=t.map(function(m){if(!u)return!1;var v=i.dataManager.translateTrimmedRow(m);return u=i.shouldAllowMoving(v,l),v}),f=c.indexOf(l)===-1;if(!u||!f)return!1;var h=this.getBaseParent(c),p=this.getTargetParent(s,l),y=h===p;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(p),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,l,y),this.moveRows(c,l,p),this.dataManager.rewriteCache(),this.moveCellsMeta(c,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,r,n,o,o&&this.isRowOrderChanged(t,r)),this.hot.render(),this.selectCells(t,n),!1}},{key:"displayAPICompatibilityWarning",value:function(t){var r=t.rows,n=t.finalIndex,o=t.dropIndex,i=t.movePossible,a=!1;return he(o)&&(de(ce(vB||(vB=rGt([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",r,n,o,i,!1),a=!0),a}},{key:"shouldAllowMoving",value:function(t,r){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===r||r===0)}},{key:"getBaseParent",value:function(t){return this.dataManager.getRowParent(t[0])}},{key:"getTargetParent",value:function(t,r){var n=this.dataManager.getRowParent(t?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(t,r,n){n||(Math.max.apply(Math,bB(t))<=r?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],r,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,t[0],t.length))}},{key:"moveRows",value:function(t,r,n){var o=this,i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(function(){t.forEach(function(a){o.dataManager.moveRow(a,r,o.movedToCollapsed,i)})})}},{key:"moveCellsMeta",value:function(t,r){var n=this,o,i=[],a=Math.max.apply(Math,bB(t))<r;t.forEach(function(s){i.push(n.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(t[0],t.length),(o=this.hot).spliceCellsMeta.apply(o,[r-(a?i.length:0),0].concat(i))}},{key:"selectCells",value:function(t,r){var n=t.length,o=0,i=0,a=null,s=null;if(this.movedToCollapsed){var l=null;t[n-1]<r?l=this.dataManager.translateTrimmedRow(r-n):l=this.dataManager.translateTrimmedRow(r);var u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);o=this.dataManager.untranslateTrimmedRow(c),i=o}else t[n-1]<r?(i=r-1,o=i-n+1):(o=r,i=o+n-1);a=this.hot.selection,s=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(o,0)),a.setRangeEnd(this.hot._createCellCoords(i,s),!0)}},{key:"isRowOrderChanged",value:function(t,r){return t.some(function(n,o){return n-o!==r})}}]),e}();function qu(e){return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function uGt(e){return dGt(e)||hGt(e)||fGt(e)||cGt()}function cGt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fGt(e,t){if(e){if(typeof e=="string")return H1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H1(e,t)}}function hGt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dGt(e){if(Array.isArray(e))return H1(e)}function H1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pGt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gGt(n.key),n)}}function yGt(e,t,r){return t&&AB(e.prototype,t),r&&AB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gGt(e){var t=mGt(e,"string");return qu(t)==="symbol"?t:String(t)}function mGt(e,t){if(qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(e,t,r){var n=vGt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},pa.apply(this,arguments)}function vGt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function bGt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N1(e,t)}function N1(e,t){return N1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},N1(e,t)}function wGt(e){var t=SGt();return function(){var r=Oo(e),n;if(t){var o=Oo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return AGt(this,n)}}function AGt(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IG(e)}function IG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SGt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oo(e)}var _0="nestedRows",CGt=300,Kr=new WeakMap,OGt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",kGt=function(e){bGt(r,e);var t=wGt(r);function r(n){var o;return pGt(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,Kr.set(IG(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return yGt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[_0]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new dp),this.dataManager=new h2t(this,this.hot),this.collapsingUI=new W2t(this,this.hot),this.headersUI=new PG(this,this.hot),this.contextMenuUI=new q2t(this,this.hot),this.rowMoveController=new lGt(this),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("beforeViewRender",function(){return n.onBeforeViewRender.apply(n,arguments)}),this.addHook("modifyRowData",function(){return n.onModifyRowData.apply(n,arguments)}),this.addHook("modifySourceLength",function(){return n.onModifySourceLength.apply(n,arguments)}),this.addHook("beforeDataSplice",function(){return n.onBeforeDataSplice.apply(n,arguments)}),this.addHook("filterData",function(){return n.onFilterData.apply(n,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return n.onAfterContextMenuDefaultOptions.apply(n,arguments)}),this.addHook("afterGetRowHeader",function(){return n.onAfterGetRowHeader.apply(n,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("beforeRemoveRow",function(){return n.onBeforeRemoveRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("beforeAddChild",function(){return n.onBeforeAddChild.apply(n,arguments)}),this.addHook("afterAddChild",function(){return n.onAfterAddChild.apply(n,arguments)}),this.addHook("beforeDetachChild",function(){return n.onBeforeDetachChild.apply(n,arguments)}),this.addHook("afterDetachChild",function(){return n.onAfterDetachChild.apply(n,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return n.onModifyRowHeaderWidth.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("beforeRowMove",function(){return n.onBeforeRowMove.apply(n,arguments)}),this.addHook("beforeLoadData",function(o){return n.onBeforeLoadData(o)}),this.addHook("beforeUpdateData",function(o){return n.onBeforeLoadData(o)}),pa(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),pa(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var n=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(n),pa(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(n,o,i,a){return this.rowMoveController.onBeforeRowMove(n,o,i,a)}},{key:"disableCoreAPIModifiers",value:function(){var n=Kr.get(this);n.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var n=Kr.get(this);n.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i){this.collapsingUI.toggleState(n,o,i)}},{key:"onModifyRowData",value:function(n){var o=Kr.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.getDataObject(n)}},{key:"onModifySourceLength",value:function(){var n=Kr.get(this);if(!n.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(n,o,i){var a=Kr.get(this);return a.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(n)?!0:(this.dataManager.spliceData(n,o,i),!1)}},{key:"onFilterData",value:function(n,o,i){var a=Kr.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],o),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*o),this.dataManager.filterData(n,o,i),a.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(n){return this.contextMenuUI.appendOptions(n)}},{key:"onAfterGetRowHeader",value:function(n,o){this.headersUI.appendLevelIndicators(n,o)}},{key:"onModifyRowHeaderWidth",value:function(n){return this.headersUI.rowHeaderWidthCache||n}},{key:"onAfterRemoveRow",value:function(n,o,i,a){var s=this;if(a!==this.pluginName){var l=Kr.get(this);setTimeout(function(){l.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(n,o,i){var a=this,s=Array.from(i.reduce(function(l,u){if(a.dataManager.isParent(u)){var c=a.dataManager.getDataObject(u).__children;return l.add(u),Array.isArray(c)&&c.forEach(function(f){return l.add(a.dataManager.getRowIndex(f))}),l}return l.add(u)},new Set));i.length=0,i.push.apply(i,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(n,o){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(o)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(n,o,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var n=Math.max.apply(Math,uGt(this.dataManager.cache.levels));n>0&&this.headersUI.updateRowHeaderWidth(n)}},{key:"onBeforeViewRender",value:function(n,o){var i=Kr.get(this);i.skipRender&&(o.skipRender=!0)}},{key:"destroy",value:function(){pa(Oo(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(n){if(!DU(n)){CR(OGt),this.hot.getSettings()[_0]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return _0}},{key:"PLUGIN_PRIORITY",get:function(){return CGt}}]),r}(re);function Pd(e){return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}function RGt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TGt(n.key),n)}}function EGt(e,t,r){return t&&SB(e.prototype,t),r&&SB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TGt(e){var t=PGt(e,"string");return Pd(t)==="symbol"?t:String(t)}function PGt(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MGt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;RGt(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return EGt(e,[{key:"saveValue",value:function(t,r){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(t),JSON.stringify(r)),this.savedKeys.indexOf(t)===-1&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,r){var n=typeof t>"u"?r:t,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return o===null?void 0:JSON.parse(o)}},{key:"reset",value:function(t){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(t))}},{key:"resetAll",value:function(){var t=this;T(this.savedKeys,function(r,n){t.rootWindow.localStorage.removeItem("".concat(t.prefix,"_").concat(t.savedKeys[n]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),r=typeof t=="string"?JSON.parse(t):void 0;this.savedKeys=r||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const IGt=MGt;function $u(e){return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function xGt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DGt(n.key),n)}}function jGt(e,t,r){return t&&CB(e.prototype,t),r&&CB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DGt(e){var t=_Gt(e,"string");return $u(t)==="symbol"?t:String(t)}function _Gt(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(e,t,r){var n=HGt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ya.apply(this,arguments)}function HGt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function NGt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B1(e,t)}function B1(e,t){return B1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},B1(e,t)}function BGt(e){var t=FGt();return function(){var r=ko(e),n;if(t){var o=ko(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LGt(this,n)}}function LGt(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VGt(e)}function VGt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FGt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ko(e)}gt.getSingleton().register("persistentStateSave");gt.getSingleton().register("persistentStateLoad");gt.getSingleton().register("persistentStateReset");var OB="persistentState",WGt=0,UGt=function(e){NGt(r,e);var t=BGt(r);function r(n){var o;return xGt(this,r),o=t.call(this,n),o.storage=void 0,o}return jGt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[OB]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.storage||(this.storage=new IGt(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(o,i){return n.saveValue(o,i)}),this.addHook("persistentStateLoad",function(o,i){return n.loadValue(o,i)}),this.addHook("persistentStateReset",function(){return n.resetValue()}),ya(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,ya(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ya(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(n,o){o.value=this.storage.loadValue(n)}},{key:"saveValue",value:function(n,o){this.storage.saveValue(n,o)}},{key:"resetValue",value:function(n){typeof n>"u"?this.storage.resetAll():this.storage.reset(n)}},{key:"destroy",value:function(){ya(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return OB}},{key:"PLUGIN_PRIORITY",get:function(){return WGt}}]),r}(re);function tc(e){return tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tc(e)}function YGt(e){return KGt(e)||QGt(e)||zGt(e)||GGt()}function GGt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zGt(e,t){if(e){if(typeof e=="string")return L1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L1(e,t)}}function QGt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KGt(e){if(Array.isArray(e))return L1(e)}function L1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XGt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZGt(n.key),n)}}function JGt(e,t,r){return t&&kB(e.prototype,t),r&&kB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZGt(e){var t=qGt(e,"string");return tc(t)==="symbol"?t:String(t)}function qGt(e,t){if(tc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(e,t,r){var n=$Gt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ga.apply(this,arguments)}function $Gt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function tzt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V1(e,t)}function V1(e,t){return V1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},V1(e,t)}function ezt(e){var t=ozt();return function(){var r=Ro(e),n;if(t){var o=Ro(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nzt(this,n)}}function nzt(e,t){if(t&&(tc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rzt(e)}function rzt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ozt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ro(e)}var H0="search",izt=190,azt="htSearchResult",szt=function(e,t,r,n,o){e.getCellMeta(t,r).isSearchResult=o},lzt=function(e,t,r){return he(e)||e===null||!e.toLocaleLowerCase||e.length===0||he(t)||t===null?!1:t.toString().toLocaleLowerCase(r.locale).indexOf(e.toLocaleLowerCase(r.locale))!==-1},uzt=function(e){tzt(r,e);var t=ezt(r);function r(n){var o;return XGt(this,r),o=t.call(this,n),o.callback=szt,o.queryMethod=lzt,o.searchResultClass=azt,o}return JGt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[H0]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[H0];this.updatePluginSettings(o),this.addHook("beforeRenderer",function(){return n.onBeforeRenderer.apply(n,arguments)}),ga(Ro(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var n=this,o=function(){return n.onBeforeRenderer.apply(n,arguments)};this.hot.addHook("beforeRenderer",o),this.hot.addHookOnce("afterViewRender",function(){n.hot.removeHook("beforeRenderer",o)}),ga(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ga(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),l=this.hot.countCols(),u=[],c=this.hot;return Ct(0,s-1,function(f){Ct(0,l-1,function(h){var p=o.hot.getDataAtCell(f,h),y=o.hot.getCellMeta(f,h),m=y.search.callback||i,v=y.search.queryMethod||a,w=v(n,p,y);if(w){var C={row:f,col:h,data:p};u.push(C)}m&&m(c,f,h,p,w)})}),u}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(n){this.callback=n}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(n){this.queryMethod=n}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(n){this.searchResultClass=n}},{key:"updatePluginSettings",value:function(n){zt(n)&&(n.searchResultClass&&this.setSearchResultClass(n.searchResultClass),n.queryMethod&&this.setQueryMethod(n.queryMethod),n.callback&&this.setCallback(n.callback))}},{key:"onBeforeRenderer",value:function(n,o,i,a,s,l){var u=l.className||[],c=[];if(typeof u=="string")c=u.split(" ");else{var f;(f=c).push.apply(f,YGt(u))}this.isEnabled()&&l.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),l.className=c.join(" ")}},{key:"destroy",value:function(){ga(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return H0}},{key:"PLUGIN_PRIORITY",get:function(){return izt}}]),r}(re);function ec(e){return ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ec(e)}function czt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hzt(n.key),n)}}function fzt(e,t,r){return t&&RB(e.prototype,t),r&&RB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hzt(e){var t=dzt(e,"string");return ec(t)==="symbol"?t:String(t)}function dzt(e,t){if(ec(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ec(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xs(){return typeof Reflect<"u"&&Reflect.get?Xs=Reflect.get.bind():Xs=function(e,t,r){var n=pzt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Xs.apply(this,arguments)}function pzt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yi(e),e!==null););return e}function yzt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F1(e,t)}function F1(e,t){return F1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},F1(e,t)}function gzt(e){var t=bzt();return function(){var r=yi(e),n;if(t){var o=yi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mzt(this,n)}}function mzt(e,t){if(t&&(ec(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vzt(e)}function vzt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bzt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yi(e){return yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yi(e)}var wzt="touchScroll",Azt=200,Szt=function(e){yzt(r,e);var t=gzt(r);function r(n){var o;return czt(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return fzt(r,[{key:"isEnabled",value:function(){return Fk()}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterViewRender",function(){return n.onAfterViewRender()}),this.registerEvents(),Xs(yi(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Xs(yi(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Xs(yi(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.addHook("beforeTouchScroll",function(){return n.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return n.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var n=this.hot.view._wt.wtOverlays,o=n.topOverlay,i=n.bottomOverlay,a=n.inlineStartOverlay,s=n.topInlineStartCornerOverlay,l=n.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(o),i.clone&&this.scrollbars.push(i),this.scrollbars.push(a),s&&this.scrollbars.push(s),l&&l.clone&&this.scrollbars.push(l),this.clones=[],o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&l.clone&&this.clones.push(l.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,T(this.clones,function(n){q(n,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var n=this;this.freezeOverlays=!1,T(this.clones,function(o){Bt(o,"hide-tween"),q(o,"show-tween")}),this.hot._registerTimeout(function(){T(n.clones,function(o){Bt(o,"show-tween")})},400),T(this.scrollbars,function(o){o.refresh(),o.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return wzt}},{key:"PLUGIN_PRIORITY",get:function(){return Azt}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(re);function nc(e){return nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nc(e)}function Czt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kzt(n.key),n)}}function Ozt(e,t,r){return t&&EB(e.prototype,t),r&&EB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kzt(e){var t=Rzt(e,"string");return nc(t)==="symbol"?t:String(t)}function Rzt(e,t){if(nc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(e,t,r){var n=Ezt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ma.apply(this,arguments)}function Ezt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function Tzt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W1(e,t)}function W1(e,t){return W1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},W1(e,t)}function Pzt(e){var t=xzt();return function(){var r=Eo(e),n;if(t){var o=Eo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mzt(this,n)}}function Mzt(e,t){if(t&&(nc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Izt(e)}function Izt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xzt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Eo(e)}var Iy="trimRows",jzt=330,Dzt=function(e){Tzt(r,e);var t=Pzt(r);function r(n){var o;return Czt(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return Ozt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Iy]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new dp),this.trimmedRowsMap.addLocalHook("init",function(){return n.onMapInit()}),ma(Eo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this,o=this.hot.getSettings()[Iy];Array.isArray(o)&&this.hot.batchExecution(function(){n.trimmedRowsMap.clear(),T(o,function(i){n.trimmedRowsMap.setValueAtIndex(i,!0)})},!0),ma(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),ma(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(n){var o=this,i=this.getTrimmedRows(),a=this.isValidConfig(n),s=i;a&&(s=Array.from(new Set(i.concat(n))));var l=this.hot.runHooks("beforeTrimRow",i,s,a);l!==!1&&(a&&this.hot.batchExecution(function(){T(n,function(u){o.trimmedRowsMap.setValueAtIndex(u,!0)})},!0),this.hot.runHooks("afterTrimRow",i,s,a,a&&s.length>i.length))}},{key:"trimRow",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.trimRows(o)}},{key:"untrimRows",value:function(n){var o=this.getTrimmedRows(),i=this.isValidConfig(n),a=o,s=this.trimmedRowsMap.getValues().slice(),l=n.length>0;i&&l&&(T(n,function(c){s[c]=!1}),a=_e(s,function(c,f,h){return f&&c.push(h),c},[]));var u=this.hot.runHooks("beforeUntrimRow",o,a,i&&l);u!==!1&&(i&&l&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",o,a,i&&l,i&&a.length<o.length))}},{key:"untrimRow",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.untrimRows(o)}},{key:"isTrimmed",value:function(n){return this.trimmedRowsMap.getValueAtIndex(n)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(n){var o=this.hot.countSourceRows();return n.every(function(i){return Number.isInteger(i)&&i>=0&&i<o})}},{key:"onMapInit",value:function(){var n=this,o=this.hot.getSettings()[Iy];Array.isArray(o)&&this.hot.batchExecution(function(){T(o,function(i){n.trimmedRowsMap.setValueAtIndex(i,!0)})},!0)}},{key:"destroy",value:function(){ma(Eo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Iy}},{key:"PLUGIN_PRIORITY",get:function(){return jzt}}]),r}(re);function rc(e){return rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rc(e)}function xG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_zt(n.key),n)}}function jG(e,t,r){return t&&TB(e.prototype,t),r&&TB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _zt(e){var t=Hzt(e,"string");return rc(t)==="symbol"?t:String(t)}function Hzt(e,t){if(rc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U1(e,t)}function U1(e,t){return U1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},U1(e,t)}function _G(e){var t=Lzt();return function(){var r=Bm(e),n;if(t){var o=Bm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nzt(this,n)}}function Nzt(e,t){if(t&&(rc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bzt(e)}function Bzt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lzt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bm(e){return Bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bm(e)}function Vzt(e){return Uzt(e)||Wzt(e)||NG(e)||Fzt()}function Fzt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wzt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uzt(e){if(Array.isArray(e))return Y1(e)}function HG(e,t){return zzt(e)||Gzt(e,t)||NG(e,t)||Yzt()}function Yzt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NG(e,t){if(e){if(typeof e=="string")return Y1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y1(e,t)}}function Y1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gzt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function zzt(e){if(Array.isArray(e))return e}var BG="undoRedo",Qzt="undoRedo";function dt(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(l){var u=HG(l,4),c=u[2],f=u[3];return c!==f});if(a){var s=function(){var l=r.reduce(function(c,f){return c.push(Vzt(f)),c},[]);T(l,function(c){c[1]=e.propToCol(c[1])});var u=i>1?o.getSelected():[[l[0][0],l[0][1]]];return new dt.ChangeAction(l,u)};t.done(s,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new dt.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),l=on(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new dt.RemoveRowAction(s,l,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new dt.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),l=(t.instance.countCols()+r)%t.instance.countCols(),u=[],c=[],f=[];Ct(s.length-1,function(y){var m=[],v=s[y];Ct(l,l+(n-1),function(w){m.push(v[e.toPhysicalColumn(w)])}),u.push(m)}),Ct(n-1,function(y){f.push(e.toPhysicalColumn(l+y))}),Array.isArray(e.getSettings().colHeaders)&&Ct(n-1,function(y){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(l+y)]||null)});var h=e.columnIndexMapper.getIndexesSequence(),p=e.rowIndexMapper.getIndexesSequence();return new dt.RemoveColumnAction(l,f,u,c,h,p,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new dt.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new dt.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new dt.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new dt.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new dt.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}dt.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};dt.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=on(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};dt.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=on(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};dt.prototype.isUndoAvailable=function(){return this.doneActions.length>0};dt.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};dt.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};dt.prototype.isEnabled=function(){return this.enabled};dt.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,Jzt(e),this.registerShortcuts(),e.addHook("afterChange",LG)}};dt.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,Zzt(e),this.unregisterShortcuts(),e.removeHook("afterChange",LG)}};dt.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};dt.Action=function(){};dt.Action.prototype.undo=function(){};dt.Action.prototype.redo=function(){};dt.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Ho(dt.ChangeAction,dt.Action);dt.ChangeAction.prototype.undo=function(e,t){for(var r=on(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=HG(r[s],2),c=u[0],f=u[1];e.getSettings().minSpareRows&&c+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(c+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&f+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(f+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};dt.ChangeAction.prototype.redo=function(e,t){for(var r=on(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};dt.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Ho(dt.CreateRowAction,dt.Action);dt.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};dt.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};dt.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Ho(dt.RemoveRowAction,dt.Action);dt.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(s){var l=parseInt(s,10);o.push([r.index+a,isNaN(l)?s:l,i[s]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};dt.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};dt.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Ho(dt.CreateColumnAction,dt.Action);dt.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};dt.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};dt.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Ho(dt.RemoveColumnAction,dt.Action);dt.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(f,h,p){return p[r.indexes.indexOf(o[h])]},a=this.data.length,s=[],l=0;l<a;l++)s.push(Gt(this.data[l],i));var u=Gt(this.headers,i),c=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),T(e.getSourceDataArray(),function(f,h){T(o,function(p,y){f[p]=s[h][y],c.push([h,p,f[p]])})}),e.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(o[0],o.length),typeof this.headers<"u"&&T(u,function(f,h){e.getSettings().colHeaders[o[h]]=f}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};dt.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};dt.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};dt.CellAlignmentAction.prototype.undo=function(e,t){var r=this;T(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};dt.CellAlignmentAction.prototype.redo=function(e,t){Ko(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};dt.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Ho(dt.FiltersAction,dt.Action);dt.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};dt.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var Kzt=function(e){DG(r,e);var t=_G(r);function r(n,o){var i;xG(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),s=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,s.row,s.col),i}return jG(r,[{key:"undo",value:function(n,o){var i=n.getPlugin("mergeCells");n.addHookOnce("afterViewRender",o),i.unmergeRange(this.cellRange,!0);var a=this.cellRange.getTopStartCorner();n.populateFromArray(a.row,a.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(n,o){var i=n.getPlugin("mergeCells");n.addHookOnce("afterViewRender",o),i.mergeRange(this.cellRange)}}]),r}(dt.Action);dt.MergeCellsAction=Kzt;var Xzt=function(e){DG(r,e);var t=_G(r);function r(n,o){var i;return xG(this,r),i=t.call(this),i.cellRange=o,i}return jG(r,[{key:"undo",value:function(n,o){var i=n.getPlugin("mergeCells");n.addHookOnce("afterViewRender",o),i.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(n,o){var i=n.getPlugin("mergeCells");n.addHookOnce("afterViewRender",o),i.unmergeRange(this.cellRange,!0),n.render()}}]),r}(dt.Action);dt.UnmergeCellsAction=Xzt;dt.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Ho(dt.RowMoveAction,dt.Action);dt.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(c){return c>r.finalIndex}),a=o.filter(function(c){return c<=r.finalIndex}),s=i.sort(function(c,f){return f-c}).concat(a.sort(function(c,f){return c-f}));e.addHookOnce("afterViewRender",t);for(var l=0;l<s.length;l+=1){var u=e.toVisualRow(s[l]);n.moveRow(u,s[l])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};dt.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};dt.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};dt.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(i){return!i.altKey},o={runOnlyIf:n,group:BG};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};dt.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(BG)};function LG(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function Jzt(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function Zzt(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var Op=gt.getSingleton();Op.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});Op.register("beforeUndo");Op.register("afterUndo");Op.register("beforeRedo");Op.register("afterRedo");dt.PLUGIN_KEY=Qzt;dt.SETTING_KEYS=!0;function qzt(){ee(ukt),ee(Dkt),ee(qkt),ee(GRt),ee(cEt),ee(qY),ee(HTt),ee(yPt),ee(h2),ee(gIt),ee(UIt),ee(txt),ee(O2),ee(ojt),ee(tBt),ee(jBt),ee(oLt),ee(PLt),ee(qLt),ee(VVt),ee(ZVt),ee(LFt),ee(JFt),ee(KWt),ee(yUt),ee(TUt),ee(n2t),ee(kGt),ee(UGt),ee(uzt),ee(Szt),ee(Dzt),ee(dt)}function $zt(){SOt(),NOt(),$Ot(),g1t(),qzt()}function tQt(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var s,l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];a=(s=o[r]).call.apply(s,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var N0,B0,L0,V0,F0;$zt();tQt(xt);xt.__GhostTable=gE;xt._getListenersCounter=tst;xt._getRegisteredMapsCounter=Gmt;xt.EventManager=Re;var eQt=[Ntt,Ytt,cgt,QOt,q$,sat,Yit,alt,Vtt,zit,Iat,tlt],nQt=[rat,xat];xt.helper={};xt.dom={};T(eQt,function(e){T(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(xt.helper[t]=e[t])})});T(nQt,function(e){T(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(xt.dom[t]=e[t])})});xt.cellTypes=(N0=xt.cellTypes)!==null&&N0!==void 0?N0:{};T(vAt(),function(e){xt.cellTypes[e]=eE(e)});xt.cellTypes.registerCellType=ir;xt.cellTypes.getCellType=eE;xt.editors=(B0=xt.editors)!==null&&B0!==void 0?B0:{};T(zat(),function(e){xt.editors["".concat(kn(e),"Editor")]=Lg(e)});xt.editors.registerEditor=Sn;xt.editors.getEditor=Lg;xt.renderers=(L0=xt.renderers)!==null&&L0!==void 0?L0:{};T(Zlt(),function(e){var t=Fg(e);e==="base"&&(xt.renderers.cellDecorator=t),xt.renderers["".concat(kn(e),"Renderer")]=t});xt.renderers.registerRenderer=Pr;xt.renderers.getRenderer=Fg;xt.validators=(V0=xt.validators)!==null&&V0!==void 0?V0:{};T(tut(),function(e){xt.validators["".concat(kn(e),"Validator")]=TR(e)});xt.validators.registerValidator=Is;xt.validators.getValidator=TR;xt.plugins=(F0=xt.plugins)!==null&&F0!==void 0?F0:{};T(ER(),function(e){xt.plugins[e]=lp(e)});xt.plugins["".concat(kn(re.PLUGIN_KEY),"Plugin")]=re;xt.plugins.registerPlugin=ee;xt.plugins.getPlugin=lp;function Md(e){return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}var lt;function ft(e,t,r){return t=rQt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rQt(e){var t=oQt(e,"string");return Md(t)==="symbol"?t:String(t)}function oQt(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iQt=(lt={languageCode:"zh-CN"},ft(lt,Iv,""),ft(lt,xv,""),ft(lt,jv,""),ft(lt,Dv,""),ft(lt,_v,["",""]),ft(lt,Hv,["",""]),ft(lt,Nv,""),ft(lt,Bv,""),ft(lt,Lv,""),ft(lt,Vv,""),ft(lt,tb,""),ft(lt,eb,""),ft(lt,nb,""),ft(lt,rb,""),ft(lt,ob,""),ft(lt,ib,""),ft(lt,ab,""),ft(lt,sb,""),ft(lt,zv,""),ft(lt,Qv,""),ft(lt,lb,""),ft(lt,ub,""),ft(lt,cb,""),ft(lt,fb,""),ft(lt,hb,""),ft(lt,db,""),ft(lt,Jv,""),ft(lt,Zv,""),ft(lt,qv,""),ft(lt,$v,""),ft(lt,Kv,""),ft(lt,Xv,""),ft(lt,Fv,""),ft(lt,Wv,""),ft(lt,Uv,""),ft(lt,Yv,""),ft(lt,Gv,""),ft(lt,pb,""),ft(lt,yb,""),ft(lt,gb,["",""]),ft(lt,mb,["",""]),ft(lt,vb,["",""]),ft(lt,bb,["",""]),ft(lt,pp,""),ft(lt,wb,""),ft(lt,Ab,""),ft(lt,Sb,""),ft(lt,Cb,""),ft(lt,Ob,""),ft(lt,kb,""),ft(lt,Rb,""),ft(lt,Eb,""),ft(lt,Tb,""),ft(lt,Pb,""),ft(lt,Mb,""),ft(lt,Ib,""),ft(lt,xb,""),ft(lt,jb,""),ft(lt,Db,""),ft(lt,_b,""),ft(lt,Hb,""),ft(lt,Nb,""),ft(lt,Bb,""),ft(lt,vh,""),ft(lt,Lb,""),ft(lt,Vb,""),ft(lt,Fb,""),ft(lt,yp,""),ft(lt,Wb,""),ft(lt,Ub,""),ft(lt,Yb,""),ft(lt,Gb,""),ft(lt,zb,""),ft(lt,Qb,""),ft(lt,Kb,""),lt);const aQt=iQt;JR(aQt);const sQt=function(e,t,r,n,o,i,a){if(xt.renderers.getRenderer("text")(e,t,r,n,o,i,a),a.style){const s=t.style;Object.assign(s,a.style)}};xt.renderers.registerRenderer("styleRender",sQt);const lQt=e=>{const t=js(!0),r=e(),n={emit:(s,l)=>{t.value=!0,r==null||r.postMessage({type:s,payload:l})}},o={},i=[],a=[];return r==null||r.addEventListener("message",s=>{const{type:l,payload:u}=s.data,c=o[l];c!=null&&c.length&&c.forEach(f=>f(u)),i.forEach(f=>f(s))}),r==null||r.addEventListener("error",s=>{console.error(s),a.forEach(l=>l(s))}),rz(()=>{r==null||r.terminate()}),{loading:t,worker:n,onWorkerMessage:s=>i.push(s),onWorkerError:s=>a.push(s),onWorkerEvent:(s,l)=>{let u=o[s];u||(u=o[s]=[]),u.push(l)},mapEvents:s=>Array.isArray(s)?s.reduce((l,u)=>(l[u]=c=>n.emit(u,c),l),{}):Object.keys(s).reduce((l,u)=>{const c=s[u];return l[c]=f=>n.emit(u,f),l},{})}},VG=e=>(iz("data-v-7789e35a"),e=e(),az(),e),uQt={class:"excel-wrapper"},cQt={key:0,class:"loading"},fQt=VG(()=>Ag("img",{class:"lg",src:uz,alt:"xlsx"},null,-1)),hQt=VG(()=>Ag("img",{class:"sm",src:cz,alt:"loading"},null,-1)),dQt={class:"table-wrapper"},pQt={class:"btn-group"},yQt=["onClick"],gQt=G1({__name:"XlsxTable",props:{data:null,type:null},setup(e){const t=e,r=js(null),n=js([]),o=js(0);let i;const a={language:"zh-CN",colHeaders:!0,rowHeaders:!0,autoRowSize:!1,autoColumnSize:!1,height:"100%",cells(y,m){const v=i==null?void 0:i.cell;return v&&Object.keys(v).length?v[kSt(y,m)]:{}},columns(y){const m=i==null?void 0:i.columns;return m!=null&&m.length?m[y]:{}},colWidths(y){const m=i==null?void 0:i.colWidths;return typeof m=="number"?m:m&&m[y]||(i==null?void 0:i.defaults.colWidth)},rowHeights(y){const m=i==null?void 0:i.rowHeights;return typeof m=="number"?m:m&&m[y]||(i==null?void 0:i.defaults.rowHeight)},outsideClickDeselects:!1,licenseKey:"non-commercial-and-evaluation"},s=QG(()=>{var y;return(y=r.value)==null?void 0:y.hotInstance}),l=()=>t.type==="binary"?ESt.create():RSt.create(),{loading:u,worker:c,onWorkerEvent:f}=lQt(l),h=y=>{o.value!==y&&(o.value=y,c.emit("parseSheet",{sheet:o.value??n.value[0].id}))},p=()=>oz(()=>{setTimeout(()=>{var y;(y=s.value)==null||y.updateSettings({data:i==null?void 0:i.data,mergeCells:i==null?void 0:i.merge})},0)});return f("sheets",({sheets:y})=>{if(n.value=y,y.length){const[{id:m}]=y;o.value=m,c.emit("parseSheet",{sheet:o.value})}}),f("parseSheet",({sheetData:y})=>{i=y,p()}),KG(()=>t.data,()=>{c.emit("parseWorkbook",{workbook:t.data})}),XG(async()=>{var y;(y=s.value)==null||y.addHook("afterUpdateSettings",()=>u.value=!1),c.emit("parseWorkbook",{workbook:t.data})}),(y,m)=>(Zc(),qc("div",uQt,[NE(u)?(Zc(),qc("div",cQt,[fQt,hQt,JG(" ... ")])):ZG("",!0),Ag("div",dQt,[qG(NE(rE),{ref_key:"table",ref:r,settings:a},null,512)]),Ag("div",pQt,[(Zc(!0),qc($G,null,tz(n.value,v=>(Zc(),qc("button",{key:v.id,style:{padding:"0 30px"},class:ez({active:o.value===v.id}),onClick:w=>h(v.id)},nz(v.name),11,yQt))),128))])]))}}),SQt=lz(gQt,[["__scopeId","data-v-7789e35a"]]);export{SQt as default};
